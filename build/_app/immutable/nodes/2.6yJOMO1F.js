var Ff=Object.defineProperty;var Qs=e=>{throw TypeError(e)};var Uf=(e,t,n)=>t in e?Ff(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Zs=(e,t,n)=>Uf(e,typeof t!="symbol"?t+"":t,n),na=(e,t,n)=>t.has(e)||Qs("Cannot "+n);var pn=(e,t,n)=>(na(e,t,"read from private field"),n?n.call(e):t.get(e)),Vr=(e,t,n)=>t.has(e)?Qs("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ra=(e,t,n,r)=>(na(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Xs=(e,t,n)=>(na(e,t,"access private method"),n);import{b as $s,e as Bf,c as ze,a as Q,n as St,t as ce,f as Kf,d as el}from"../chunks/B6u9Wa-7.js";import{a9 as mu,ao as gu,ap as zf,q as bu,aa as Vf,h as mt,s as $r,N as lr,b as Wf,i as _a,z as h,y as Jn,j as Hf,r as tl,k as ei,c as Hn,af as Yf,m as _u,a as wu,p as Gf,aq as ia,ai as ku,Q as wa,ar as nl,J as Jf,as as rl,at as Qa,au as Qf,a4 as Zf,av as Xf,d as $f,aw as Za,ax as ed,ac as xu,M as td,ay as Su,t as nd,az as rd,$ as we,aA as id,ag as od,ae as ad,o as Iu,aB as sd,aC as ld,aD as ud,aE as cd,aF as fd,aG as dd,g as Eu,_ as Ye,u as Ir,f as Oe,a0 as Ge,al as Ve,C as ke,aH as vd,a1 as P,a2 as E,an as he,n as Er,a3 as H,aI as xt,B as Yn,aJ as mr}from"../chunks/MyxID9jh.js";import{a as hd,i as pd,c as yd,d as tt,b as md,n as gd,e as bd,l as _d,s as Ie,f as oi,g as Ou,r as Cu,j as wd}from"../chunks/B_W0AqVO.js";import{i as pe,r as kd,p as be,b as st}from"../chunks/D16ImUdI.js";import{o as po,a as xd}from"../chunks/Bcl-jklz.js";import{s as gn}from"../chunks/C1tbqaM7.js";const Sd=[];function Li(e,t=!1){return Hi(e,new Map,"",Sd)}function Hi(e,t,n,r,i=null){if(typeof e=="object"&&e!==null){var a=t.get(e);if(a!==void 0)return a;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(mu(e)){var l=Array(e.length);t.set(e,l),i!==null&&t.set(i,l);for(var c=0;c<e.length;c+=1){var d=e[c];c in e&&(l[c]=Hi(d,t,n,r))}return l}if(gu(e)===zf){l={},t.set(e,l),i!==null&&t.set(i,l);for(var v in e)l[v]=Hi(e[v],t,n,r);return l}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return Hi(e.toJSON(),t,n,r,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function ur(e,t){mt&&$r(lr(e)),bu(()=>{var n=t();for(var r in n){var i=n[r];i?e.style.setProperty(r,i):e.style.removeProperty(r)}}),Vf(()=>{e.remove()})}function ct(e,t){return t}function Id(e,t,n,r){for(var i=[],a=t.length,l=0;l<a;l++)Qf(t[l].e,i,!0);var c=a>0&&i.length===0&&n!==null;if(c){var d=n.parentNode;Zf(d),d.append(n),r.clear(),jn(e,t[0].prev,t[a-1].next)}Xf(i,()=>{for(var v=0;v<a;v++){var u=t[v];c||(r.delete(u.k),jn(e,u.prev,u.next)),$f(u.e,!c)}})}function ft(e,t,n,r,i,a=null){var l=e,c={flags:t,items:new Map,first:null},d=(t&Su)!==0;if(d){var v=e;l=mt?$r(lr(v)):v.appendChild(td())}mt&&_a();var u=null,m=!1,y=Jn(()=>{var g=n();return mu(g)?g:g==null?[]:ku(g)});Wf(()=>{var g=h(y),_=g.length;if(m&&_===0)return;m=_===0;let k=!1;if(mt){var O=l.data===Hf;O!==(_===0)&&(l=tl(),$r(l),ei(!1),k=!0)}if(mt){for(var C=null,S,x=0;x<_;x++){if(Hn.nodeType===8&&Hn.data===Yf){l=Hn,k=!0,ei(!1);break}var A=g[x],q=r(A,x);S=Au(Hn,c,C,null,A,q,x,i,t,n),c.items.set(q,S),C=S}_>0&&$r(tl())}mt||Ed(g,c,l,i,t,r,n),a!==null&&(_===0?u?_u(u):u=wu(()=>a(l)):u!==null&&Gf(u,()=>{u=null})),k&&ei(!0),h(y)}),mt&&(l=Hn)}function Ed(e,t,n,r,i,a,l){var Z,oe,se,je;var c=(i&rd)!==0,d=(i&(Za|Qa))!==0,v=e.length,u=t.items,m=t.first,y=m,g,_=null,k,O=[],C=[],S,x,A,q;if(c)for(q=0;q<v;q+=1)S=e[q],x=a(S,q),A=u.get(x),A!==void 0&&((Z=A.a)==null||Z.measure(),(k??(k=new Set)).add(A));for(q=0;q<v;q+=1){if(S=e[q],x=a(S,q),A=u.get(x),A===void 0){var D=y?y.e.nodes_start:n;_=Au(D,t,_,_===null?t.first:_.next,S,x,q,r,i,l),u.set(x,_),O=[],C=[],y=_.next;continue}if(d&&Od(A,S,q,i),(A.e.f&ia)!==0&&(_u(A.e),c&&((oe=A.a)==null||oe.unfix(),(k??(k=new Set)).delete(A))),A!==y){if(g!==void 0&&g.has(A)){if(O.length<C.length){var W=C[0],te;_=W.prev;var J=O[0],Y=O[O.length-1];for(te=0;te<O.length;te+=1)il(O[te],W,n);for(te=0;te<C.length;te+=1)g.delete(C[te]);jn(t,J.prev,Y.next),jn(t,_,J),jn(t,Y,W),y=W,_=Y,q-=1,O=[],C=[]}else g.delete(A),il(A,y,n),jn(t,A.prev,A.next),jn(t,A,_===null?t.first:_.next),jn(t,_,A),_=A;continue}for(O=[],C=[];y!==null&&y.k!==x;)(y.e.f&ia)===0&&(g??(g=new Set)).add(y),C.push(y),y=y.next;if(y===null)continue;A=y}O.push(A),_=A,y=A.next}if(y!==null||g!==void 0){for(var ne=g===void 0?[]:ku(g);y!==null;)(y.e.f&ia)===0&&ne.push(y),y=y.next;var ee=ne.length;if(ee>0){var V=(i&Su)!==0&&v===0?n:null;if(c){for(q=0;q<ee;q+=1)(se=ne[q].a)==null||se.measure();for(q=0;q<ee;q+=1)(je=ne[q].a)==null||je.fix()}Id(t,ne,V,u)}}c&&nd(()=>{var Te;if(k!==void 0)for(A of k)(Te=A.a)==null||Te.apply()}),wa.first=t.first&&t.first.e,wa.last=_&&_.e}function Od(e,t,n,r){(r&Za)!==0&&nl(e.v,t),(r&Qa)!==0?nl(e.i,n):e.i=n}function Au(e,t,n,r,i,a,l,c,d,v){var u=(d&Za)!==0,m=(d&ed)===0,y=u?m?Jf(i):rl(i):i,g=(d&Qa)===0?l:rl(l),_={i:g,v:y,k:a,a:null,e:null,prev:n,next:r};try{return _.e=wu(()=>c(e,y,g,v),mt),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function il(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==r;){var l=xu(a);i.before(a),a=l}}function jn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Cd(e,t,n=!1,r=!1,i=!1){var a=e,l="";we(()=>{var c=wa;if(l===(l=t()??"")){mt&&_a();return}if(c.nodes_start!==null&&(id(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),l!==""){if(mt){Hn.data;for(var d=_a(),v=d;d!==null&&(d.nodeType!==8||d.data!=="");)v=d,d=xu(d);if(d===null)throw od(),ad;$s(Hn,v),a=$r(d);return}var u=l+"";n?u=`<svg>${u}</svg>`:r&&(u=`<math>${u}</math>`);var m=Bf(u);if((n||r)&&(m=lr(m)),$s(lr(m),m.lastChild),n||r)for(;lr(m);)a.before(lr(m));else a.before(m)}})}function Pu(e,t){Iu(()=>{const n=t();return n&&n(e)})}function Tu(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Tu(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Ad(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Tu(e))&&(r&&(r+=" "),r+=t);return r}function Pd(e){return typeof e=="object"?Ad(e):e??""}const ol=[...` 	
\r\f \v\uFEFF`];function Td(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var a=i.length,l=0;(l=r.indexOf(i,l))>=0;){var c=l+a;(l===0||ol.includes(r[l-1]))&&(c===r.length||ol.includes(r[c]))?r=(l===0?"":r.substring(0,l))+r.substring(c+1):l=c}}return r===""?null:r}function al(e,t=!1){var n=t?" !important;":";",r="";for(var i in e){var a=e[i];a!=null&&a!==""&&(r+=" "+i+": "+a+n)}return r}function oa(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function jd(e,t){if(t){var n="",r,i;if(Array.isArray(t)?(r=t[0],i=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,l=0,c=!1,d=[];r&&d.push(...Object.keys(r).map(oa)),i&&d.push(...Object.keys(i).map(oa));var v=0,u=-1;const k=e.length;for(var m=0;m<k;m++){var y=e[m];if(c?y==="/"&&e[m-1]==="*"&&(c=!1):a?a===y&&(a=!1):y==="/"&&e[m+1]==="*"?c=!0:y==='"'||y==="'"?a=y:y==="("?l++:y===")"&&l--,!c&&a===!1&&l===0){if(y===":"&&u===-1)u=m;else if(y===";"||m===k-1){if(u!==-1){var g=oa(e.substring(v,u).trim());if(!d.includes(g)){y!==";"&&m++;var _=e.substring(v,m).trim();n+=" "+_+";"}}v=m+1,u=-1}}}}return r&&(n+=al(r)),i&&(n+=al(i,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function it(e,t,n,r,i,a){var l=e.__className;if(mt||l!==n||l===void 0){var c=Td(n,r,a);(!mt||c!==e.getAttribute("class"))&&(c==null?e.removeAttribute("class"):t?e.className=c:e.setAttribute("class",c)),e.__className=n}else if(a&&i!==a)for(var d in a){var v=!!a[d];(i==null||v!==!!i[d])&&e.classList.toggle(d,v)}return a}function aa(e,t={},n,r){for(var i in n){var a=n[i];t[i]!==a&&(n[i]==null?e.style.removeProperty(i):e.style.setProperty(i,a,r))}}function Gn(e,t,n,r){var i=e.__style;if(mt||i!==t){var a=jd(t,r);(!mt||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}else r&&(Array.isArray(r)?(aa(e,n==null?void 0:n[0],r[0]),aa(e,n==null?void 0:n[1],r[1],"important")):aa(e,n,r));return r}const Wr=Symbol("class"),Hr=Symbol("style"),ju=Symbol("is custom element"),Du=Symbol("is html");function Ru(e){if(mt){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var r=e.value;Re(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var i=e.checked;Re(e,"checked",null),e.checked=i}}};e.__on_r=n,ud(n),hd()}}function Dd(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function Re(e,t,n,r){var i=Nu(e);mt&&(i[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||i[t]!==(i[t]=n)&&(t==="loading"&&(e[fd]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Lu(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function ka(e,t,n,r,i=!1){var a=Nu(e),l=a[ju],c=!a[Du];let d=mt&&l;d&&ei(!1);var v=t||{},u=e.tagName==="OPTION";for(var m in t)m in n||(n[m]=null);n.class?n.class=Pd(n.class):(r||n[Wr])&&(n.class=null),n[Hr]&&(n.style??(n.style=null));var y=Lu(e);for(const x in n){let A=n[x];if(u&&x==="value"&&A==null){e.value=e.__value="",v[x]=A;continue}if(x==="class"){var g=e.namespaceURI==="http://www.w3.org/1999/xhtml";it(e,g,A,r,t==null?void 0:t[Wr],n[Wr]),v[x]=A,v[Wr]=n[Wr];continue}if(x==="style"){Gn(e,A,t==null?void 0:t[Hr],n[Hr]),v[x]=A,v[Hr]=n[Hr];continue}var _=v[x];if(A!==_){v[x]=A;var k=x[0]+x[1];if(k!=="$$")if(k==="on"){const q={},D="$$"+x;let W=x.slice(2);var O=bd(W);if(pd(W)&&(W=W.slice(0,-7),q.capture=!0),!O&&_){if(A!=null)continue;e.removeEventListener(W,v[D],q),v[D]=null}if(A!=null)if(O)e[`__${W}`]=A,tt([W]);else{let te=function(J){v[x].call(this,J)};v[D]=yd(W,e,te,q)}else O&&(e[`__${W}`]=void 0)}else if(x==="style")Re(e,x,A);else if(x==="autofocus")md(e,!!A);else if(!l&&(x==="__value"||x==="value"&&A!=null))e.value=e.__value=A;else if(x==="selected"&&u)Dd(e,A);else{var C=x;c||(C=gd(C));var S=C==="defaultValue"||C==="defaultChecked";if(A==null&&!l&&!S)if(a[x]=null,C==="value"||C==="checked"){let q=e;const D=t===void 0;if(C==="value"){let W=q.defaultValue;q.removeAttribute(C),q.defaultValue=W,q.value=q.__value=D?W:null}else{let W=q.defaultChecked;q.removeAttribute(C),q.defaultChecked=W,q.checked=D?W:!1}}else e.removeAttribute(x);else S||y.includes(C)&&(l||typeof A!="string")?e[C]=A:typeof A!="function"&&Re(e,C,A)}}}d&&ei(!0);for(let x of Object.getOwnPropertySymbols(n))x.description===cd&&Pu(e,()=>n[x]);return v}function Nu(e){return e.__attributes??(e.__attributes={[ju]:e.nodeName.includes("-"),[Du]:e.namespaceURI===sd})}var sl=new Map;function Lu(e){var t=sl.get(e.nodeName);if(t)return t;sl.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=ld(r);for(var a in n)n[a].set&&t.push(a);r=gu(r)}return t}function Xa(e,t,n=t){var r=dd();_d(e,"input",i=>{var a=i?e.defaultValue:e.value;if(a=sa(e)?la(a):a,n(a),r&&a!==(a=t())){var l=e.selectionStart,c=e.selectionEnd;e.value=a??"",c!==null&&(e.selectionStart=l,e.selectionEnd=Math.min(c,e.value.length))}}),(mt&&e.defaultValue!==e.value||Eu(t)==null&&e.value)&&n(sa(e)?la(e.value):e.value),bu(()=>{var i=t();sa(e)&&i===la(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function sa(e){var t=e.type;return t==="number"||t==="range"}function la(e){return e===""?null:+e}var Dn,yr,ci,vo,Mu;const ho=class ho{constructor(t){Vr(this,vo);Vr(this,Dn,new WeakMap);Vr(this,yr);Vr(this,ci);ra(this,ci,t)}observe(t,n){var r=pn(this,Dn).get(t)||new Set;return r.add(n),pn(this,Dn).set(t,r),Xs(this,vo,Mu).call(this).observe(t,pn(this,ci)),()=>{var i=pn(this,Dn).get(t);i.delete(n),i.size===0&&(pn(this,Dn).delete(t),pn(this,yr).unobserve(t))}}};Dn=new WeakMap,yr=new WeakMap,ci=new WeakMap,vo=new WeakSet,Mu=function(){return pn(this,yr)??ra(this,yr,new ResizeObserver(t=>{for(var n of t){ho.entries.set(n.target,n);for(var r of pn(this,Dn).get(n.target)||[])r(n)}}))},Zs(ho,"entries",new WeakMap);let xa=ho;var Rd=new xa({box:"border-box"});function Nd(e,t,n){var r=Rd.observe(e,()=>n(e[t]));Iu(()=>(Eu(()=>n(e[t])),r))}const qu=/^[a-z0-9]+(-[a-z0-9]+)*$/,yo=(e,t,n,r="")=>{const i=e.split(":");if(e.slice(0,1)==="@"){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const c=i.pop(),d=i.pop(),v={provider:i.length>0?i[0]:r,prefix:d,name:c};return t&&!Yi(v)?null:v}const a=i[0],l=a.split("-");if(l.length>1){const c={provider:r,prefix:l.shift(),name:l.join("-")};return t&&!Yi(c)?null:c}if(n&&r===""){const c={provider:r,prefix:"",name:a};return t&&!Yi(c,n)?null:c}return null},Yi=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1,Fu=Object.freeze({left:0,top:0,width:16,height:16}),to=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),mo=Object.freeze({...Fu,...to}),Sa=Object.freeze({...mo,body:"",hidden:!1});function Ld(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function ll(e,t){const n=Ld(e,t);for(const r in Sa)r in to?r in e&&!(r in n)&&(n[r]=to[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function Md(e,t){const n=e.icons,r=e.aliases||Object.create(null),i=Object.create(null);function a(l){if(n[l])return i[l]=[];if(!(l in i)){i[l]=null;const c=r[l]&&r[l].parent,d=c&&a(c);d&&(i[l]=[c].concat(d))}return i[l]}return Object.keys(n).concat(Object.keys(r)).forEach(a),i}function qd(e,t,n){const r=e.icons,i=e.aliases||Object.create(null);let a={};function l(c){a=ll(r[c]||i[c],a)}return l(t),n.forEach(l),ll(e,a)}function Uu(e,t){const n=[];if(typeof e!="object"||typeof e.icons!="object")return n;e.not_found instanceof Array&&e.not_found.forEach(i=>{t(i,null),n.push(i)});const r=Md(e);for(const i in r){const a=r[i];a&&(t(i,qd(e,i,a)),n.push(i))}return n}const Fd={provider:"",aliases:{},not_found:{},...Fu};function ua(e,t){for(const n in t)if(n in e&&typeof e[n]!=typeof t[n])return!1;return!0}function Bu(e){if(typeof e!="object"||e===null)return null;const t=e;if(typeof t.prefix!="string"||!e.icons||typeof e.icons!="object"||!ua(e,Fd))return null;const n=t.icons;for(const i in n){const a=n[i];if(!i||typeof a.body!="string"||!ua(a,Sa))return null}const r=t.aliases||Object.create(null);for(const i in r){const a=r[i],l=a.parent;if(!i||typeof l!="string"||!n[l]&&!r[l]||!ua(a,Sa))return null}return t}const ul=Object.create(null);function Ud(e,t){return{provider:e,prefix:t,icons:Object.create(null),missing:new Set}}function gr(e,t){const n=ul[e]||(ul[e]=Object.create(null));return n[t]||(n[t]=Ud(e,t))}function Ku(e,t){return Bu(t)?Uu(t,(n,r)=>{r?e.icons[n]=r:e.missing.add(n)}):[]}function Bd(e,t,n){try{if(typeof n.body=="string")return e.icons[t]={...n},!0}catch{}return!1}let ai=!1;function zu(e){return typeof e=="boolean"&&(ai=e),ai}function Kd(e){const t=typeof e=="string"?yo(e,!0,ai):e;if(t){const n=gr(t.provider,t.prefix),r=t.name;return n.icons[r]||(n.missing.has(r)?null:void 0)}}function zd(e,t){const n=yo(e,!0,ai);if(!n)return!1;const r=gr(n.provider,n.prefix);return t?Bd(r,n.name,t):(r.missing.add(n.name),!0)}function Vd(e,t){if(typeof e!="object")return!1;if(typeof t!="string"&&(t=e.provider||""),ai&&!t&&!e.prefix){let i=!1;return Bu(e)&&(e.prefix="",Uu(e,(a,l)=>{zd(a,l)&&(i=!0)})),i}const n=e.prefix;if(!Yi({prefix:n,name:"a"}))return!1;const r=gr(t,n);return!!Ku(r,e)}const Vu=Object.freeze({width:null,height:null}),Wu=Object.freeze({...Vu,...to}),Wd=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Hd=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function cl(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(Wd);if(r===null||!r.length)return e;const i=[];let a=r.shift(),l=Hd.test(a);for(;;){if(l){const c=parseFloat(a);isNaN(c)?i.push(a):i.push(Math.ceil(c*t*n)/n)}else i.push(a);if(a=r.shift(),a===void 0)return i.join("");l=!l}}function Yd(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const i=e.indexOf(">",r),a=e.indexOf("</"+t);if(i===-1||a===-1)break;const l=e.indexOf(">",a);if(l===-1)break;n+=e.slice(i+1,a).trim(),e=e.slice(0,r).trim()+e.slice(l+1)}return{defs:n,content:e}}function Gd(e,t){return e?"<defs>"+e+"</defs>"+t:t}function Jd(e,t,n){const r=Yd(e);return Gd(r.defs,t+r.content+n)}const Qd=e=>e==="unset"||e==="undefined"||e==="none";function Zd(e,t){const n={...mo,...e},r={...Wu,...t},i={left:n.left,top:n.top,width:n.width,height:n.height};let a=n.body;[n,r].forEach(k=>{const O=[],C=k.hFlip,S=k.vFlip;let x=k.rotate;C?S?x+=2:(O.push("translate("+(i.width+i.left).toString()+" "+(0-i.top).toString()+")"),O.push("scale(-1 1)"),i.top=i.left=0):S&&(O.push("translate("+(0-i.left).toString()+" "+(i.height+i.top).toString()+")"),O.push("scale(1 -1)"),i.top=i.left=0);let A;switch(x<0&&(x-=Math.floor(x/4)*4),x=x%4,x){case 1:A=i.height/2+i.top,O.unshift("rotate(90 "+A.toString()+" "+A.toString()+")");break;case 2:O.unshift("rotate(180 "+(i.width/2+i.left).toString()+" "+(i.height/2+i.top).toString()+")");break;case 3:A=i.width/2+i.left,O.unshift("rotate(-90 "+A.toString()+" "+A.toString()+")");break}x%2===1&&(i.left!==i.top&&(A=i.left,i.left=i.top,i.top=A),i.width!==i.height&&(A=i.width,i.width=i.height,i.height=A)),O.length&&(a=Jd(a,'<g transform="'+O.join(" ")+'">',"</g>"))});const l=r.width,c=r.height,d=i.width,v=i.height;let u,m;l===null?(m=c===null?"1em":c==="auto"?v:c,u=cl(m,d/v)):(u=l==="auto"?d:l,m=c===null?cl(u,v/d):c==="auto"?v:c);const y={},g=(k,O)=>{Qd(O)||(y[k]=O.toString())};g("width",u),g("height",m);const _=[i.left,i.top,d,v];return y.viewBox=_.join(" "),{attributes:y,viewBox:_,body:a}}const Xd=/\sid="(\S+)"/g,$d="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let ev=0;function tv(e,t=$d){const n=[];let r;for(;r=Xd.exec(e);)n.push(r[1]);if(!n.length)return e;const i="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(a=>{const l=typeof t=="function"?t(a):t+(ev++).toString(),c=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+c+')([")]|\\.[a-z])',"g"),"$1"+l+i+"$3")}),e=e.replace(new RegExp(i,"g"),""),e}const Ia=Object.create(null);function nv(e,t){Ia[e]=t}function Ea(e){return Ia[e]||Ia[""]}function $a(e){let t;if(typeof e.resources=="string")t=[e.resources];else if(t=e.resources,!(t instanceof Array)||!t.length)return null;return{resources:t,path:e.path||"/",maxURL:e.maxURL||500,rotate:e.rotate||750,timeout:e.timeout||5e3,random:e.random===!0,index:e.index||0,dataAfterTimeout:e.dataAfterTimeout!==!1}}const es=Object.create(null),Yr=["https://api.simplesvg.com","https://api.unisvg.com"],Gi=[];for(;Yr.length>0;)Yr.length===1||Math.random()>.5?Gi.push(Yr.shift()):Gi.push(Yr.pop());es[""]=$a({resources:["https://api.iconify.design"].concat(Gi)});function rv(e,t){const n=$a(t);return n===null?!1:(es[e]=n,!0)}function ts(e){return es[e]}const iv=()=>{let e;try{if(e=fetch,typeof e=="function")return e}catch{}};let fl=iv();function ov(e,t){const n=ts(e);if(!n)return 0;let r;if(!n.maxURL)r=0;else{let i=0;n.resources.forEach(l=>{i=Math.max(i,l.length)});const a=t+".json?icons=";r=n.maxURL-i-n.path.length-a.length}return r}function av(e){return e===404}const sv=(e,t,n)=>{const r=[],i=ov(e,t),a="icons";let l={type:a,provider:e,prefix:t,icons:[]},c=0;return n.forEach((d,v)=>{c+=d.length+1,c>=i&&v>0&&(r.push(l),l={type:a,provider:e,prefix:t,icons:[]},c=d.length),l.icons.push(d)}),r.push(l),r};function lv(e){if(typeof e=="string"){const t=ts(e);if(t)return t.path}return"/"}const uv=(e,t,n)=>{if(!fl){n("abort",424);return}let r=lv(t.provider);switch(t.type){case"icons":{const a=t.prefix,c=t.icons.join(","),d=new URLSearchParams({icons:c});r+=a+".json?"+d.toString();break}case"custom":{const a=t.uri;r+=a.slice(0,1)==="/"?a.slice(1):a;break}default:n("abort",400);return}let i=503;fl(e+r).then(a=>{const l=a.status;if(l!==200){setTimeout(()=>{n(av(l)?"abort":"next",l)});return}return i=501,a.json()}).then(a=>{if(typeof a!="object"||a===null){setTimeout(()=>{a===404?n("abort",a):n("next",i)});return}setTimeout(()=>{n("success",a)})}).catch(()=>{n("next",i)})},cv={prepare:sv,send:uv};function fv(e){const t={loaded:[],missing:[],pending:[]},n=Object.create(null);e.sort((i,a)=>i.provider!==a.provider?i.provider.localeCompare(a.provider):i.prefix!==a.prefix?i.prefix.localeCompare(a.prefix):i.name.localeCompare(a.name));let r={provider:"",prefix:"",name:""};return e.forEach(i=>{if(r.name===i.name&&r.prefix===i.prefix&&r.provider===i.provider)return;r=i;const a=i.provider,l=i.prefix,c=i.name,d=n[a]||(n[a]=Object.create(null)),v=d[l]||(d[l]=gr(a,l));let u;c in v.icons?u=t.loaded:l===""||v.missing.has(c)?u=t.missing:u=t.pending;const m={provider:a,prefix:l,name:c};u.push(m)}),t}function Hu(e,t){e.forEach(n=>{const r=n.loaderCallbacks;r&&(n.loaderCallbacks=r.filter(i=>i.id!==t))})}function dv(e){e.pendingCallbacksFlag||(e.pendingCallbacksFlag=!0,setTimeout(()=>{e.pendingCallbacksFlag=!1;const t=e.loaderCallbacks?e.loaderCallbacks.slice(0):[];if(!t.length)return;let n=!1;const r=e.provider,i=e.prefix;t.forEach(a=>{const l=a.icons,c=l.pending.length;l.pending=l.pending.filter(d=>{if(d.prefix!==i)return!0;const v=d.name;if(e.icons[v])l.loaded.push({provider:r,prefix:i,name:v});else if(e.missing.has(v))l.missing.push({provider:r,prefix:i,name:v});else return n=!0,!0;return!1}),l.pending.length!==c&&(n||Hu([e],a.id),a.callback(l.loaded.slice(0),l.missing.slice(0),l.pending.slice(0),a.abort))})}))}let vv=0;function hv(e,t,n){const r=vv++,i=Hu.bind(null,n,r);if(!t.pending.length)return i;const a={id:r,icons:t,callback:e,abort:i};return n.forEach(l=>{(l.loaderCallbacks||(l.loaderCallbacks=[])).push(a)}),i}function pv(e,t=!0,n=!1){const r=[];return e.forEach(i=>{const a=typeof i=="string"?yo(i,t,n):i;a&&r.push(a)}),r}var yv={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function mv(e,t,n,r){const i=e.resources.length,a=e.random?Math.floor(Math.random()*i):e.index;let l;if(e.random){let D=e.resources.slice(0);for(l=[];D.length>1;){const W=Math.floor(Math.random()*D.length);l.push(D[W]),D=D.slice(0,W).concat(D.slice(W+1))}l=l.concat(D)}else l=e.resources.slice(a).concat(e.resources.slice(0,a));const c=Date.now();let d="pending",v=0,u,m=null,y=[],g=[];typeof r=="function"&&g.push(r);function _(){m&&(clearTimeout(m),m=null)}function k(){d==="pending"&&(d="aborted"),_(),y.forEach(D=>{D.status==="pending"&&(D.status="aborted")}),y=[]}function O(D,W){W&&(g=[]),typeof D=="function"&&g.push(D)}function C(){return{startTime:c,payload:t,status:d,queriesSent:v,queriesPending:y.length,subscribe:O,abort:k}}function S(){d="failed",g.forEach(D=>{D(void 0,u)})}function x(){y.forEach(D=>{D.status==="pending"&&(D.status="aborted")}),y=[]}function A(D,W,te){const J=W!=="success";switch(y=y.filter(Y=>Y!==D),d){case"pending":break;case"failed":if(J||!e.dataAfterTimeout)return;break;default:return}if(W==="abort"){u=te,S();return}if(J){u=te,y.length||(l.length?q():S());return}if(_(),x(),!e.random){const Y=e.resources.indexOf(D.resource);Y!==-1&&Y!==e.index&&(e.index=Y)}d="completed",g.forEach(Y=>{Y(te)})}function q(){if(d!=="pending")return;_();const D=l.shift();if(D===void 0){if(y.length){m=setTimeout(()=>{_(),d==="pending"&&(x(),S())},e.timeout);return}S();return}const W={status:"pending",resource:D,callback:(te,J)=>{A(W,te,J)}};y.push(W),v++,m=setTimeout(q,e.rotate),n(D,t,W.callback)}return setTimeout(q),C}function Yu(e){const t={...yv,...e};let n=[];function r(){n=n.filter(c=>c().status==="pending")}function i(c,d,v){const u=mv(t,c,d,(m,y)=>{r(),v&&v(m,y)});return n.push(u),u}function a(c){return n.find(d=>c(d))||null}return{query:i,find:a,setIndex:c=>{t.index=c},getIndex:()=>t.index,cleanup:r}}function dl(){}const ca=Object.create(null);function gv(e){if(!ca[e]){const t=ts(e);if(!t)return;const n=Yu(t),r={config:t,redundancy:n};ca[e]=r}return ca[e]}function bv(e,t,n){let r,i;if(typeof e=="string"){const a=Ea(e);if(!a)return n(void 0,424),dl;i=a.send;const l=gv(e);l&&(r=l.redundancy)}else{const a=$a(e);if(a){r=Yu(a);const l=e.resources?e.resources[0]:"",c=Ea(l);c&&(i=c.send)}}return!r||!i?(n(void 0,424),dl):r.query(t,i,n)().abort}function vl(){}function _v(e){e.iconsLoaderFlag||(e.iconsLoaderFlag=!0,setTimeout(()=>{e.iconsLoaderFlag=!1,dv(e)}))}function wv(e){const t=[],n=[];return e.forEach(r=>{(r.match(qu)?t:n).push(r)}),{valid:t,invalid:n}}function Gr(e,t,n){function r(){const i=e.pendingIcons;t.forEach(a=>{i&&i.delete(a),e.icons[a]||e.missing.add(a)})}if(n&&typeof n=="object")try{if(!Ku(e,n).length){r();return}}catch(i){console.error(i)}r(),_v(e)}function hl(e,t){e instanceof Promise?e.then(n=>{t(n)}).catch(()=>{t(null)}):t(e)}function kv(e,t){e.iconsToLoad?e.iconsToLoad=e.iconsToLoad.concat(t).sort():e.iconsToLoad=t,e.iconsQueueFlag||(e.iconsQueueFlag=!0,setTimeout(()=>{e.iconsQueueFlag=!1;const{provider:n,prefix:r}=e,i=e.iconsToLoad;if(delete e.iconsToLoad,!i||!i.length)return;const a=e.loadIcon;if(e.loadIcons&&(i.length>1||!a)){hl(e.loadIcons(i,r,n),u=>{Gr(e,i,u)});return}if(a){i.forEach(u=>{const m=a(u,r,n);hl(m,y=>{const g=y?{prefix:r,icons:{[u]:y}}:null;Gr(e,[u],g)})});return}const{valid:l,invalid:c}=wv(i);if(c.length&&Gr(e,c,null),!l.length)return;const d=r.match(qu)?Ea(n):null;if(!d){Gr(e,l,null);return}d.prepare(n,r,l).forEach(u=>{bv(n,u,m=>{Gr(e,u.icons,m)})})}))}const xv=(e,t)=>{const n=pv(e,!0,zu()),r=fv(n);if(!r.pending.length){let d=!0;return t&&setTimeout(()=>{d&&t(r.loaded,r.missing,r.pending,vl)}),()=>{d=!1}}const i=Object.create(null),a=[];let l,c;return r.pending.forEach(d=>{const{provider:v,prefix:u}=d;if(u===c&&v===l)return;l=v,c=u,a.push(gr(v,u));const m=i[v]||(i[v]=Object.create(null));m[u]||(m[u]=[])}),r.pending.forEach(d=>{const{provider:v,prefix:u,name:m}=d,y=gr(v,u),g=y.pendingIcons||(y.pendingIcons=new Set);g.has(m)||(g.add(m),i[v][u].push(m))}),a.forEach(d=>{const v=i[d.provider][d.prefix];v.length&&kv(d,v)}),t?hv(t,r,a):vl};function Sv(e,t){const n={...e};for(const r in t){const i=t[r],a=typeof i;r in Vu?(i===null||i&&(a==="string"||a==="number"))&&(n[r]=i):a===typeof n[r]&&(n[r]=r==="rotate"?i%4:i)}return n}const Iv=/[\s,]+/;function Ev(e,t){t.split(Iv).forEach(n=>{switch(n.trim()){case"horizontal":e.hFlip=!0;break;case"vertical":e.vFlip=!0;break}})}function Ov(e,t=0){const n=e.replace(/^-?[0-9.]*/,"");function r(i){for(;i<0;)i+=4;return i%4}if(n===""){const i=parseInt(e);return isNaN(i)?0:r(i)}else if(n!==e){let i=0;switch(n){case"%":i=25;break;case"deg":i=90}if(i){let a=parseFloat(e.slice(0,e.length-n.length));return isNaN(a)?0:(a=a/i,a%1===0?r(a):0)}}return t}function Cv(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}function Av(e){return e.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function Pv(e){return"data:image/svg+xml,"+Av(e)}function Tv(e){return'url("'+Pv(e)+'")'}const pl={...Wu,inline:!1},jv={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Dv={display:"inline-block"},Oa={"background-color":"currentColor"},Gu={"background-color":"transparent"},yl={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},ml={"-webkit-mask":Oa,mask:Oa,background:Gu};for(const e in ml){const t=ml[e];for(const n in yl)t[e+"-"+n]=yl[n]}function Rv(e){return e+(e.match(/^[-0-9.]+$/)?"px":"")}function Nv(e,t){const n=Sv(pl,t),r=t.mode||"svg",i=r==="svg"?{...jv}:{};e.body.indexOf("xlink:")===-1&&delete i["xmlns:xlink"];let a=typeof t.style=="string"?t.style:"";for(let C in t){const S=t[C];if(S!==void 0)switch(C){case"icon":case"style":case"onLoad":case"mode":case"ssr":break;case"inline":case"hFlip":case"vFlip":n[C]=S===!0||S==="true"||S===1;break;case"flip":typeof S=="string"&&Ev(n,S);break;case"color":a=a+(a.length>0&&a.trim().slice(-1)!==";"?";":"")+"color: "+S+"; ";break;case"rotate":typeof S=="string"?n[C]=Ov(S):typeof S=="number"&&(n[C]=S);break;case"ariaHidden":case"aria-hidden":S!==!0&&S!=="true"&&delete i["aria-hidden"];break;default:if(C.slice(0,3)==="on:")break;pl[C]===void 0&&(i[C]=S)}}const l=Zd(e,n),c=l.attributes;if(n.inline&&(a="vertical-align: -0.125em; "+a),r==="svg"){Object.assign(i,c),a!==""&&(i.style=a);let C=0,S=t.id;return typeof S=="string"&&(S=S.replace(/-/g,"_")),{svg:!0,attributes:i,body:tv(l.body,S?()=>S+"ID"+C++:"iconifySvelte")}}const{body:d,width:v,height:u}=e,m=r==="mask"||(r==="bg"?!1:d.indexOf("currentColor")!==-1),y=Cv(d,{...c,width:v+"",height:u+""}),_={"--svg":Tv(y)},k=C=>{const S=c[C];S&&(_[C]=Rv(S))};k("width"),k("height"),Object.assign(_,Dv,m?Oa:Gu);let O="";for(const C in _)O+=C+": "+_[C]+";";return i.style=O+a,{svg:!1,attributes:i}}zu(!0);nv("",cv);if(typeof document<"u"&&typeof window<"u"){const e=window;if(e.IconifyPreload!==void 0){const t=e.IconifyPreload,n="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!Vd(r))&&console.error(n)}catch{console.error(n)}})}if(e.IconifyProviders!==void 0){const t=e.IconifyProviders;if(typeof t=="object"&&t!==null)for(let n in t){const r="IconifyProviders["+n+"] is invalid.";try{const i=t[n];if(typeof i!="object"||!i||i.resources===void 0)continue;rv(n,i)||console.error(r)}catch{console.error(r)}}}}function Lv(e,t,n,r,i){function a(){t.loading&&(t.loading.abort(),t.loading=null)}if(typeof e=="object"&&e!==null&&typeof e.body=="string")return t.name="",a(),{data:{...mo,...e}};let l;if(typeof e!="string"||(l=yo(e,!1,!0))===null)return a(),null;const c=Kd(l);if(!c)return n&&(!t.loading||t.loading.name!==e)&&(a(),t.name="",t.loading={name:e,abort:xv([l],r)}),null;a(),t.name!==e&&(t.name=e,i&&!t.destroyed&&i(e));const d=["iconify"];return l.prefix!==""&&d.push("iconify--"+l.prefix),l.provider!==""&&d.push("iconify--"+l.provider),{data:c,classes:d}}function Mv(e,t){return e?Nv({...mo,...e},t):null}var qv=St("<svg><!></svg>"),Fv=ce("<span></span>");function Pe(e,t){Ye(t,!0);const n={name:"",loading:null,destroyed:!1},r=kd(t,["$$slots","$$events","$$legacy"]);let i=Ve(!1),a=Ve(0),l=Ve(null);Ir(()=>{h(a);const m=!!t.ssr||h(i),y=Lv(t.icon,n,m,c,t.onload),g=y?Mv(y.data,r):null;g&&y.classes&&(g.attributes.class=(typeof r.class=="string"?r.class+" ":"")+y.classes.join(" ")),ke(l,g,!0)});function c(){vd(a)}po(()=>{ke(i,!0)}),xd(()=>{n.destroyed=!0,n.loading&&(n.loading.abort(),n.loading=null)});var d=ze(),v=Oe(d);{var u=m=>{var y=ze(),g=Oe(y);{var _=O=>{var C=qv();let S;var x=P(C);Cd(x,()=>h(l).body,!0),E(C),we(()=>S=ka(C,S,{...h(l).attributes})),Q(O,C)},k=O=>{var C=Fv();let S;we(()=>S=ka(C,S,{...h(l).attributes})),Q(O,C)};pe(g,O=>{h(l).svg?O(_):O(k,!1)})}Q(m,y)};pe(v,m=>{h(l)&&m(u)})}Q(e,d),Ge()}var Uv=ce('<button type="button" class="svelte-ltxfh7"><!></button>');function Dt(e,t){let n=be(t,"size",3,"md"),r=he(()=>{let d=40;switch(n()){case"sm":d=32;break;case"xl":d=56;break;case"2xl":d=96;break;default:d=136;break}return d}),i=he(()=>{let d=24;switch(n()){case"sm":d=20;break;case"xl":d=32;break;case"2xl":d=40;break;default:d=24;break}return d});var a=Uv();a.__click=function(...d){var v;(v=t.onclick)==null||v.apply(this,d)};let l;var c=P(a);Pe(c,{get height(){return h(i)},get icon(){return t.name},get width(){return h(i)}}),E(a),we(()=>l=Gn(a,"",l,{height:h(r),width:h(r)})),Q(e,a)}tt(["click"]);function Bv(e,t,n,r){e.preventDefault(),ke(t,null),h(n).focus(),r.onchange&&r.onchange(h(t))}function Kv(e,t,n){const r=h(t).trim().length===0?null:h(t).trim().toLowerCase();n.onchange&&n.onchange(r)}var zv=ce('<!> <h3 class="svelte-1ereg2t"> </h3> <!>',1),Vv=ce('<button tabindex="-1" type="button" class="svelte-1ereg2t"><!></button>'),Wv=ce('<p class="svelte-1ereg2t"> </p>'),Hv=ce('<div class="search svelte-1ereg2t"><!> <label class="svelte-1ereg2t"><span class="svelte-1ereg2t"><!></span> <input type="text" class="svelte-1ereg2t"> <!></label></div> <h3 class="svelte-1ereg2t"> </h3> <!>',1),Yv=ce('<p class="svelte-1ereg2t"> </p>'),Gv=ce('<div class="svelte-1ereg2t"><div class="svelte-1ereg2t"><!></div> <div class="svelte-1ereg2t"><!></div></div> <h3 class="svelte-1ereg2t"> </h3> <!>',1),Jv=ce("<header><!></header>");function ns(e,t){Ye(t,!0);let n=Ve(void 0),r=Ve(null);function i(m){ke(r,null),m.focus()}function a(){t.oncancel&&t.oncancel()}var l=Jv();let c;var d=P(l);{var v=m=>{var y=zv(),g=Oe(y);gn(g,()=>t.left??Er);var _=H(g,2),k=P(_,!0);E(_);var O=H(_,2);gn(O,()=>t.right),we(()=>Ie(k,t.label)),Q(m,y)},u=(m,y)=>{{var g=k=>{var O=Hv(),C=Oe(O),S=P(C);Dt(S,{name:"material-symbols:arrow-back-rounded",onclick:a});var x=H(S,2),A=P(x),q=P(A);Pe(q,{height:"24",icon:"material-symbols:search-rounded",width:"24"}),E(A);var D=H(A,2);Ru(D),D.__input=[Kv,r,t],Pu(D,()=>i),st(D,V=>ke(n,V),()=>h(n));var W=H(D,2);{var te=V=>{var Z=Vv();Z.__click=[Bv,r,n,t];var oe=P(Z);Pe(oe,{height:"24",icon:"material-symbols:cancel-outline",width:"24"}),E(Z),Q(V,Z)};pe(W,V=>{h(r)!==null&&V(te)})}E(x),E(C);var J=H(C,2),Y=P(J,!0);E(J);var ne=H(J,2);{var ee=V=>{var Z=Wv(),oe=P(Z,!0);E(Z),we(()=>Ie(oe,t.subtitle)),Q(V,Z)};pe(ne,V=>{t.subtitle&&V(ee)})}we(()=>Ie(Y,t.label)),Xa(D,()=>h(r),V=>ke(r,V)),Q(k,O)},_=k=>{var O=Gv(),C=Oe(O),S=P(C),x=P(S);gn(x,()=>t.left),E(S);var A=H(S,2),q=P(A);gn(q,()=>t.right),E(A),E(C);var D=H(C,2),W=P(D,!0);E(D);var te=H(D,2);{var J=Y=>{var ne=Yv(),ee=P(ne,!0);E(ne),we(()=>Ie(ee,t.subtitle)),Q(Y,ne)};pe(te,Y=>{t.subtitle&&Y(J)})}we(()=>Ie(W,t.label)),Q(k,O)};pe(m,k=>{t.variation==="search"?k(g):k(_,!1)},y)}};pe(d,m=>{t.variation==="sm"?m(v):m(u,!1)})}E(l),we(m=>c=it(l,1,"svelte-1ereg2t",null,c,m),[()=>({small:t.variation==="sm"})]),Q(e,l),Ge()}tt(["input","click"]);var Qv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ji={exports:{}},Xv=Ji.exports,gl;function $v(){return gl||(gl=1,function(e,t){(function(n,r){e.exports=r()})(Xv,function(){var n=function(o,s){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var b in p)Object.prototype.hasOwnProperty.call(p,b)&&(f[b]=p[b])})(o,s)},r=function(){return(r=Object.assign||function(o){for(var s,f=1,p=arguments.length;f<p;f++)for(var b in s=arguments[f])Object.prototype.hasOwnProperty.call(s,b)&&(o[b]=s[b]);return o}).apply(this,arguments)};function i(o,s,f){for(var p,b=0,w=s.length;b<w;b++)!p&&b in s||((p=p||Array.prototype.slice.call(s,0,b))[b]=s[b]);return o.concat(p||Array.prototype.slice.call(s))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Qv,l=Object.keys,c=Array.isArray;function d(o,s){return typeof s!="object"||l(s).forEach(function(f){o[f]=s[f]}),o}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var v=Object.getPrototypeOf,u={}.hasOwnProperty;function m(o,s){return u.call(o,s)}function y(o,s){typeof s=="function"&&(s=s(v(o))),(typeof Reflect>"u"?l:Reflect.ownKeys)(s).forEach(function(f){_(o,f,s[f])})}var g=Object.defineProperty;function _(o,s,f,p){g(o,s,d(f&&m(f,"get")&&typeof f.get=="function"?{get:f.get,set:f.set,configurable:!0}:{value:f,configurable:!0,writable:!0},p))}function k(o){return{from:function(s){return o.prototype=Object.create(s.prototype),_(o.prototype,"constructor",o),{extend:y.bind(null,o.prototype)}}}}var O=Object.getOwnPropertyDescriptor,C=[].slice;function S(o,s,f){return C.call(o,s,f)}function x(o,s){return s(o)}function A(o){if(!o)throw new Error("Assertion Failed")}function q(o){a.setImmediate?setImmediate(o):setTimeout(o,0)}function D(o,s){if(typeof s=="string"&&m(o,s))return o[s];if(!s)return o;if(typeof s!="string"){for(var f=[],p=0,b=s.length;p<b;++p){var w=D(o,s[p]);f.push(w)}return f}var I=s.indexOf(".");if(I!==-1){var T=o[s.substr(0,I)];return T==null?void 0:D(T,s.substr(I+1))}}function W(o,s,f){if(o&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof s!="string"&&"length"in s){A(typeof f!="string"&&"length"in f);for(var p=0,b=s.length;p<b;++p)W(o,s[p],f[p])}else{var w,I,T=s.indexOf(".");T!==-1?(w=s.substr(0,T),(I=s.substr(T+1))===""?f===void 0?c(o)&&!isNaN(parseInt(w))?o.splice(w,1):delete o[w]:o[w]=f:W(T=!(T=o[w])||!m(o,w)?o[w]={}:T,I,f)):f===void 0?c(o)&&!isNaN(parseInt(s))?o.splice(s,1):delete o[s]:o[s]=f}}function te(o){var s,f={};for(s in o)m(o,s)&&(f[s]=o[s]);return f}var J=[].concat;function Y(o){return J.apply([],o)}var Yt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Y([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(s){return s+o+"Array"})}))).filter(function(o){return a[o]}),ne=new Set(Yt.map(function(o){return a[o]})),ee=null;function V(o){return ee=new WeakMap,o=function s(f){if(!f||typeof f!="object")return f;var p=ee.get(f);if(p)return p;if(c(f)){p=[],ee.set(f,p);for(var b=0,w=f.length;b<w;++b)p.push(s(f[b]))}else if(ne.has(f.constructor))p=f;else{var I,T=v(f);for(I in p=T===Object.prototype?{}:Object.create(T),ee.set(f,p),f)m(f,I)&&(p[I]=s(f[I]))}return p}(o),ee=null,o}var Z={}.toString;function oe(o){return Z.call(o).slice(8,-1)}var se=typeof Symbol<"u"?Symbol.iterator:"@@iterator",je=typeof se=="symbol"?function(o){var s;return o!=null&&(s=o[se])&&s.apply(o)}:function(){return null};function Te(o,s){return s=o.indexOf(s),0<=s&&o.splice(s,1),0<=s}var fe={};function B(o){var s,f,p,b;if(arguments.length===1){if(c(o))return o.slice();if(this===fe&&typeof o=="string")return[o];if(b=je(o)){for(f=[];!(p=b.next()).done;)f.push(p.value);return f}if(o==null)return[o];if(typeof(s=o.length)!="number")return[o];for(f=new Array(s);s--;)f[s]=o[s];return f}for(s=arguments.length,f=new Array(s);s--;)f[s]=arguments[s];return f}var Ne=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Vt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ft),Le={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Fe(o,s){this.name=o,this.message=s}function Ze(o,s){return o+". Errors: "+Object.keys(s).map(function(f){return s[f].toString()}).filter(function(f,p,b){return b.indexOf(f)===p}).join(`
`)}function He(o,s,f,p){this.failures=s,this.failedKeys=p,this.successCount=f,this.message=Ze(o,s)}function Je(o,s){this.name="BulkError",this.failures=Object.keys(s).map(function(f){return s[f]}),this.failuresByPos=s,this.message=Ze(o,this.failures)}k(Fe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),k(He).from(Fe),k(Je).from(Fe);var It=Vt.reduce(function(o,s){return o[s]=s+"Error",o},{}),Mt=Fe,Se=Vt.reduce(function(o,s){var f=s+"Error";function p(b,w){this.name=f,b?typeof b=="string"?(this.message="".concat(b).concat(w?`
 `+w:""),this.inner=w||null):typeof b=="object"&&(this.message="".concat(b.name," ").concat(b.message),this.inner=b):(this.message=Le[s]||f,this.inner=null)}return k(p).from(Mt),o[s]=p,o},{});Se.Syntax=SyntaxError,Se.Type=TypeError,Se.Range=RangeError;var re=Ft.reduce(function(o,s){return o[s+"Error"]=Se[s],o},{}),ae=Vt.reduce(function(o,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(o[s+"Error"]=Se[s]),o},{});function de(){}function De(o){return o}function Ce(o,s){return o==null||o===De?s:function(f){return s(o(f))}}function ot(o,s){return function(){o.apply(this,arguments),s.apply(this,arguments)}}function Sn(o,s){return o===de?s:function(){var f=o.apply(this,arguments);f!==void 0&&(arguments[0]=f);var p=this.onsuccess,b=this.onerror;this.onsuccess=null,this.onerror=null;var w=s.apply(this,arguments);return p&&(this.onsuccess=this.onsuccess?ot(p,this.onsuccess):p),b&&(this.onerror=this.onerror?ot(b,this.onerror):b),w!==void 0?w:f}}function gt(o,s){return o===de?s:function(){o.apply(this,arguments);var f=this.onsuccess,p=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),f&&(this.onsuccess=this.onsuccess?ot(f,this.onsuccess):f),p&&(this.onerror=this.onerror?ot(p,this.onerror):p)}}function bt(o,s){return o===de?s:function(f){var p=o.apply(this,arguments);d(f,p);var b=this.onsuccess,w=this.onerror;return this.onsuccess=null,this.onerror=null,f=s.apply(this,arguments),b&&(this.onsuccess=this.onsuccess?ot(b,this.onsuccess):b),w&&(this.onerror=this.onerror?ot(w,this.onerror):w),p===void 0?f===void 0?void 0:f:d(p,f)}}function At(o,s){return o===de?s:function(){return s.apply(this,arguments)!==!1&&o.apply(this,arguments)}}function qt(o,s){return o===de?s:function(){var f=o.apply(this,arguments);if(f&&typeof f.then=="function"){for(var p=this,b=arguments.length,w=new Array(b);b--;)w[b]=arguments[b];return f.then(function(){return s.apply(p,w)})}return s.apply(this,arguments)}}ae.ModifyError=He,ae.DexieError=Fe,ae.BulkError=Je;var Xe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Wt(o){Xe=o}var Ht={},pi=100,Yt=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,v(o),o];var s=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[s,v(s),o]}(),Ft=Yt[0],Vt=Yt[1],Yt=Yt[2],Vt=Vt&&Vt.then,Gt=Ft&&Ft.constructor,Pr=!!Yt,Ut=function(o,s){Kt.push([o,s]),In&&(queueMicrotask(Eo),In=!1)},Mn=!0,In=!0,dn=[],Jt=[],qn=De,Bt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:de,pgp:!1,env:{},finalize:de},Ee=Bt,Kt=[],Qt=0,Xn=[];function _e(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Ee;if(typeof o!="function"){if(o!==Ht)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Tr(this,this._value))}this._state=null,this._value=null,++s.ref,function f(p,b){try{b(function(w){if(p._state===null){if(w===p)throw new TypeError("A promise cannot be resolved with itself.");var I=p._lib&&En();w&&typeof w.then=="function"?f(p,function(T,R){w instanceof _e?w._then(T,R):w.then(T,R)}):(p._state=!0,p._value=w,yi(p)),I&&Pt()}},Tr.bind(null,p))}catch(w){Tr(p,w)}}(this,o)}var tn={get:function(){var o=Ee,s=Zt;function f(p,b){var w=this,I=!o.global&&(o!==Ee||s!==Zt),T=I&&!Et(),R=new _e(function(L,U){nn(w,new $n(ks(p,o,I,T),ks(b,o,I,T),L,U,o))});return this._consoleTask&&(R._consoleTask=this._consoleTask),R}return f.prototype=Ht,f},set:function(o){_(this,"then",o&&o.prototype===Ht?tn:{get:function(){return o},set:tn.set})}};function $n(o,s,f,p,b){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof s=="function"?s:null,this.resolve=f,this.reject=p,this.psd=b}function Tr(o,s){var f,p;Jt.push(s),o._state===null&&(f=o._lib&&En(),s=qn(s),o._state=!1,o._value=s,p=o,dn.some(function(b){return b._value===p._value})||dn.push(p),yi(o),f&&Pt())}function yi(o){var s=o._listeners;o._listeners=[];for(var f=0,p=s.length;f<p;++f)nn(o,s[f]);var b=o._PSD;--b.ref||b.finalize(),Qt===0&&(++Qt,Ut(function(){--Qt==0&&Fn()},[]))}function nn(o,s){if(o._state!==null){var f=o._state?s.onFulfilled:s.onRejected;if(f===null)return(o._state?s.resolve:s.reject)(o._value);++s.psd.ref,++Qt,Ut(jr,[f,o,s])}else o._listeners.push(s)}function jr(o,s,f){try{var p,b=s._value;!s._state&&Jt.length&&(Jt=[]),p=Xe&&s._consoleTask?s._consoleTask.run(function(){return o(b)}):o(b),s._state||Jt.indexOf(b)!==-1||function(w){for(var I=dn.length;I;)if(dn[--I]._value===w._value)return dn.splice(I,1)}(s),f.resolve(p)}catch(w){f.reject(w)}finally{--Qt==0&&Fn(),--f.psd.ref||f.psd.finalize()}}function Eo(){Un(Bt,function(){En()&&Pt()})}function En(){var o=Mn;return In=Mn=!1,o}function Pt(){var o,s,f;do for(;0<Kt.length;)for(o=Kt,Kt=[],f=o.length,s=0;s<f;++s){var p=o[s];p[0].apply(null,p[1])}while(0<Kt.length);In=Mn=!0}function Fn(){var o=dn;dn=[],o.forEach(function(p){p._PSD.onunhandled.call(null,p._value,p)});for(var s=Xn.slice(0),f=s.length;f;)s[--f]()}function er(o){return new _e(Ht,!1,o)}function et(o,s){var f=Ee;return function(){var p=En(),b=Ee;try{return zt(f,!0),o.apply(this,arguments)}catch(w){s&&s(w)}finally{zt(b,!1),p&&Pt()}}}y(_e.prototype,{then:tn,_then:function(o,s){nn(this,new $n(null,null,o,s,Ee))},catch:function(o){if(arguments.length===1)return this.then(null,o);var s=o,f=arguments[1];return typeof s=="function"?this.then(null,function(p){return(p instanceof s?f:er)(p)}):this.then(null,function(p){return(p&&p.name===s?f:er)(p)})},finally:function(o){return this.then(function(s){return _e.resolve(o()).then(function(){return s})},function(s){return _e.resolve(o()).then(function(){return er(s)})})},timeout:function(o,s){var f=this;return o<1/0?new _e(function(p,b){var w=setTimeout(function(){return b(new Se.Timeout(s))},o);f.then(p,b).finally(clearTimeout.bind(null,w))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&_(_e.prototype,Symbol.toStringTag,"Dexie.Promise"),Bt.env=mi(),y(_e,{all:function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s,f){o.length===0&&s([]);var p=o.length;o.forEach(function(b,w){return _e.resolve(b).then(function(I){o[w]=I,--p||s(o)},f)})})},resolve:function(o){return o instanceof _e?o:o&&typeof o.then=="function"?new _e(function(s,f){o.then(s,f)}):new _e(Ht,!0,o)},reject:er,race:function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s,f){o.map(function(p){return _e.resolve(p).then(s,f)})})},PSD:{get:function(){return Ee},set:function(o){return Ee=o}},totalEchoes:{get:function(){return Zt}},newPSD:rn,usePSD:Un,scheduler:{get:function(){return Ut},set:function(o){Ut=o}},rejectionMapper:{get:function(){return qn},set:function(o){qn=o}},follow:function(o,s){return new _e(function(f,p){return rn(function(b,w){var I=Ee;I.unhandleds=[],I.onunhandled=w,I.finalize=ot(function(){var T,R=this;T=function(){R.unhandleds.length===0?b():w(R.unhandleds[0])},Xn.push(function L(){T(),Xn.splice(Xn.indexOf(L),1)}),++Qt,Ut(function(){--Qt==0&&Fn()},[])},I.finalize),o()},s,f,p)})}}),Gt&&(Gt.allSettled&&_(_e,"allSettled",function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s){o.length===0&&s([]);var f=o.length,p=new Array(f);o.forEach(function(b,w){return _e.resolve(b).then(function(I){return p[w]={status:"fulfilled",value:I}},function(I){return p[w]={status:"rejected",reason:I}}).then(function(){return--f||s(p)})})})}),Gt.any&&typeof AggregateError<"u"&&_(_e,"any",function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s,f){o.length===0&&f(new AggregateError([]));var p=o.length,b=new Array(p);o.forEach(function(w,I){return _e.resolve(w).then(function(T){return s(T)},function(T){b[I]=T,--p||f(new AggregateError(b))})})})}),Gt.withResolvers&&(_e.withResolvers=Gt.withResolvers));var nt={awaits:0,echoes:0,id:0},Dr=0,tr=[],nr=0,Zt=0,Rr=0;function rn(o,s,f,p){var b=Ee,w=Object.create(b);return w.parent=b,w.ref=0,w.global=!1,w.id=++Rr,Bt.env,w.env=Pr?{Promise:_e,PromiseProp:{value:_e,configurable:!0,writable:!0},all:_e.all,race:_e.race,allSettled:_e.allSettled,any:_e.any,resolve:_e.resolve,reject:_e.reject}:{},s&&d(w,s),++b.ref,w.finalize=function(){--this.parent.ref||this.parent.finalize()},p=Un(w,o,f,p),w.ref===0&&w.finalize(),p}function On(){return nt.id||(nt.id=++Dr),++nt.awaits,nt.echoes+=pi,nt.id}function Et(){return!!nt.awaits&&(--nt.awaits==0&&(nt.id=0),nt.echoes=nt.awaits*pi,!0)}function Cn(o){return nt.echoes&&o&&o.constructor===Gt?(On(),o.then(function(s){return Et(),s},function(s){return Et(),lt(s)})):o}function Oo(){var o=tr[tr.length-1];tr.pop(),zt(o,!1)}function zt(o,s){var f,p=Ee;(s?!nt.echoes||nr++&&o===Ee:!nr||--nr&&o===Ee)||queueMicrotask(s?(function(b){++Zt,nt.echoes&&--nt.echoes!=0||(nt.echoes=nt.awaits=nt.id=0),tr.push(Ee),zt(b,!0)}).bind(null,o):Oo),o!==Ee&&(Ee=o,p===Bt&&(Bt.env=mi()),Pr&&(f=Bt.env.Promise,s=o.env,(p.global||o.global)&&(Object.defineProperty(a,"Promise",s.PromiseProp),f.all=s.all,f.race=s.race,f.resolve=s.resolve,f.reject=s.reject,s.allSettled&&(f.allSettled=s.allSettled),s.any&&(f.any=s.any))))}function mi(){var o=a.Promise;return Pr?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function Un(o,s,f,p,b){var w=Ee;try{return zt(o,!0),s(f,p,b)}finally{zt(w,!1)}}function ks(o,s,f,p){return typeof o!="function"?o:function(){var b=Ee;f&&On(),zt(s,!0);try{return o.apply(this,arguments)}finally{zt(b,!1),p&&queueMicrotask(Et)}}}function Co(o){Promise===Gt&&nt.echoes===0?nr===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}(""+Vt).indexOf("[native code]")===-1&&(On=Et=de);var lt=_e.reject,Bn="￿",vn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",xs="String expected.",rr=[],gi="__dbnames",Ao="readonly",Po="readwrite";function Kn(o,s){return o?s?function(){return o.apply(this,arguments)&&s.apply(this,arguments)}:o:s}var Ss={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function bi(o){return typeof o!="string"||/\./.test(o)?function(s){return s}:function(s){return s[o]===void 0&&o in s&&delete(s=V(s))[o],s}}function Is(){throw Se.Type()}function We(o,s){try{var f=Es(o),p=Es(s);if(f!==p)return f==="Array"?1:p==="Array"?-1:f==="binary"?1:p==="binary"?-1:f==="string"?1:p==="string"?-1:f==="Date"?1:p!=="Date"?NaN:-1;switch(f){case"number":case"Date":case"string":return s<o?1:o<s?-1:0;case"binary":return function(b,w){for(var I=b.length,T=w.length,R=I<T?I:T,L=0;L<R;++L)if(b[L]!==w[L])return b[L]<w[L]?-1:1;return I===T?0:I<T?-1:1}(Os(o),Os(s));case"Array":return function(b,w){for(var I=b.length,T=w.length,R=I<T?I:T,L=0;L<R;++L){var U=We(b[L],w[L]);if(U!==0)return U}return I===T?0:I<T?-1:1}(o,s)}}catch{}return NaN}function Es(o){var s=typeof o;return s!="object"?s:ArrayBuffer.isView(o)?"binary":(o=oe(o),o==="ArrayBuffer"?"binary":o)}function Os(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var Cs=(rt.prototype._trans=function(o,s,f){var p=this._tx||Ee.trans,b=this.name,w=Xe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(o==="readonly"?"read":"write"," ").concat(this.name));function I(L,U,j){if(!j.schema[b])throw new Se.NotFound("Table "+b+" not part of transaction");return s(j.idbtrans,j)}var T=En();try{var R=p&&p.db._novip===this.db._novip?p===Ee.trans?p._promise(o,I,f):rn(function(){return p._promise(o,I,f)},{trans:p,transless:Ee.transless||Ee}):function L(U,j,z,N){if(U.idbdb&&(U._state.openComplete||Ee.letThrough||U._vip)){var F=U._createTransaction(j,z,U._dbSchema);try{F.create(),U._state.PR1398_maxLoop=3}catch(K){return K.name===It.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return L(U,j,z,N)})):lt(K)}return F._promise(j,function(K,M){return rn(function(){return Ee.trans=F,N(K,M,F)})}).then(function(K){if(j==="readwrite")try{F.idbtrans.commit()}catch{}return j==="readonly"?K:F._completion.then(function(){return K})})}if(U._state.openComplete)return lt(new Se.DatabaseClosed(U._state.dbOpenError));if(!U._state.isBeingOpened){if(!U._state.autoOpen)return lt(new Se.DatabaseClosed);U.open().catch(de)}return U._state.dbReadyPromise.then(function(){return L(U,j,z,N)})}(this.db,o,[this.name],I);return w&&(R._consoleTask=w,R=R.catch(function(L){return console.trace(L),lt(L)})),R}finally{T&&Pt()}},rt.prototype.get=function(o,s){var f=this;return o&&o.constructor===Object?this.where(o).first(s):o==null?lt(new Se.Type("Invalid argument to Table.get()")):this._trans("readonly",function(p){return f.core.get({trans:p,key:o}).then(function(b){return f.hook.reading.fire(b)})}).then(s)},rt.prototype.where=function(o){if(typeof o=="string")return new this.db.WhereClause(this,o);if(c(o))return new this.db.WhereClause(this,"[".concat(o.join("+"),"]"));var s=l(o);if(s.length===1)return this.where(s[0]).equals(o[s[0]]);var f=this.schema.indexes.concat(this.schema.primKey).filter(function(T){if(T.compound&&s.every(function(L){return 0<=T.keyPath.indexOf(L)})){for(var R=0;R<s.length;++R)if(s.indexOf(T.keyPath[R])===-1)return!1;return!0}return!1}).sort(function(T,R){return T.keyPath.length-R.keyPath.length})[0];if(f&&this.db._maxKey!==Bn){var w=f.keyPath.slice(0,s.length);return this.where(w).equals(w.map(function(R){return o[R]}))}!f&&Xe&&console.warn("The query ".concat(JSON.stringify(o)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var p=this.schema.idxByName;function b(T,R){return We(T,R)===0}var I=s.reduce(function(j,R){var L=j[0],U=j[1],j=p[R],z=o[R];return[L||j,L||!j?Kn(U,j&&j.multi?function(N){return N=D(N,R),c(N)&&N.some(function(F){return b(z,F)})}:function(N){return b(z,D(N,R))}):U]},[null,null]),w=I[0],I=I[1];return w?this.where(w.name).equals(o[w.keyPath]).filter(I):f?this.filter(I):this.where(s).equals("")},rt.prototype.filter=function(o){return this.toCollection().and(o)},rt.prototype.count=function(o){return this.toCollection().count(o)},rt.prototype.offset=function(o){return this.toCollection().offset(o)},rt.prototype.limit=function(o){return this.toCollection().limit(o)},rt.prototype.each=function(o){return this.toCollection().each(o)},rt.prototype.toArray=function(o){return this.toCollection().toArray(o)},rt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},rt.prototype.orderBy=function(o){return new this.db.Collection(new this.db.WhereClause(this,c(o)?"[".concat(o.join("+"),"]"):o))},rt.prototype.reverse=function(){return this.toCollection().reverse()},rt.prototype.mapToClass=function(o){var s,f=this.db,p=this.name;function b(){return s!==null&&s.apply(this,arguments)||this}(this.schema.mappedClass=o).prototype instanceof Is&&(function(R,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function U(){this.constructor=R}n(R,L),R.prototype=L===null?Object.create(L):(U.prototype=L.prototype,new U)}(b,s=o),Object.defineProperty(b.prototype,"db",{get:function(){return f},enumerable:!1,configurable:!0}),b.prototype.table=function(){return p},o=b);for(var w=new Set,I=o.prototype;I;I=v(I))Object.getOwnPropertyNames(I).forEach(function(R){return w.add(R)});function T(R){if(!R)return R;var L,U=Object.create(o.prototype);for(L in R)if(!w.has(L))try{U[L]=R[L]}catch{}return U}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=T,this.hook("reading",T),o},rt.prototype.defineClass=function(){return this.mapToClass(function(o){d(this,o)})},rt.prototype.add=function(o,s){var f=this,p=this.schema.primKey,b=p.auto,w=p.keyPath,I=o;return w&&b&&(I=bi(w)(o)),this._trans("readwrite",function(T){return f.core.mutate({trans:T,type:"add",keys:s!=null?[s]:null,values:[I]})}).then(function(T){return T.numFailures?_e.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{W(o,w,T)}catch{}return T})},rt.prototype.update=function(o,s){return typeof o!="object"||c(o)?this.where(":id").equals(o).modify(s):(o=D(o,this.schema.primKey.keyPath),o===void 0?lt(new Se.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(s))},rt.prototype.put=function(o,s){var f=this,p=this.schema.primKey,b=p.auto,w=p.keyPath,I=o;return w&&b&&(I=bi(w)(o)),this._trans("readwrite",function(T){return f.core.mutate({trans:T,type:"put",values:[I],keys:s!=null?[s]:null})}).then(function(T){return T.numFailures?_e.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{W(o,w,T)}catch{}return T})},rt.prototype.delete=function(o){var s=this;return this._trans("readwrite",function(f){return s.core.mutate({trans:f,type:"delete",keys:[o]})}).then(function(f){return f.numFailures?_e.reject(f.failures[0]):void 0})},rt.prototype.clear=function(){var o=this;return this._trans("readwrite",function(s){return o.core.mutate({trans:s,type:"deleteRange",range:Ss})}).then(function(s){return s.numFailures?_e.reject(s.failures[0]):void 0})},rt.prototype.bulkGet=function(o){var s=this;return this._trans("readonly",function(f){return s.core.getMany({keys:o,trans:f}).then(function(p){return p.map(function(b){return s.hook.reading.fire(b)})})})},rt.prototype.bulkAdd=function(o,s,f){var p=this,b=Array.isArray(s)?s:void 0,w=(f=f||(b?void 0:s))?f.allKeys:void 0;return this._trans("readwrite",function(I){var L=p.schema.primKey,T=L.auto,L=L.keyPath;if(L&&b)throw new Se.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(b&&b.length!==o.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");var R=o.length,L=L&&T?o.map(bi(L)):o;return p.core.mutate({trans:I,type:"add",keys:b,values:L,wantResults:w}).then(function(F){var j=F.numFailures,z=F.results,N=F.lastResult,F=F.failures;if(j===0)return w?z:N;throw new Je("".concat(p.name,".bulkAdd(): ").concat(j," of ").concat(R," operations failed"),F)})})},rt.prototype.bulkPut=function(o,s,f){var p=this,b=Array.isArray(s)?s:void 0,w=(f=f||(b?void 0:s))?f.allKeys:void 0;return this._trans("readwrite",function(I){var L=p.schema.primKey,T=L.auto,L=L.keyPath;if(L&&b)throw new Se.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(b&&b.length!==o.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");var R=o.length,L=L&&T?o.map(bi(L)):o;return p.core.mutate({trans:I,type:"put",keys:b,values:L,wantResults:w}).then(function(F){var j=F.numFailures,z=F.results,N=F.lastResult,F=F.failures;if(j===0)return w?z:N;throw new Je("".concat(p.name,".bulkPut(): ").concat(j," of ").concat(R," operations failed"),F)})})},rt.prototype.bulkUpdate=function(o){var s=this,f=this.core,p=o.map(function(I){return I.key}),b=o.map(function(I){return I.changes}),w=[];return this._trans("readwrite",function(I){return f.getMany({trans:I,keys:p,cache:"clone"}).then(function(T){var R=[],L=[];o.forEach(function(j,z){var N=j.key,F=j.changes,K=T[z];if(K){for(var M=0,G=Object.keys(F);M<G.length;M++){var X=G[M],$=F[X];if(X===s.schema.primKey.keyPath){if(We($,N)!==0)throw new Se.Constraint("Cannot update primary key in bulkUpdate()")}else W(K,X,$)}w.push(z),R.push(N),L.push(K)}});var U=R.length;return f.mutate({trans:I,type:"put",keys:R,values:L,updates:{keys:p,changeSpecs:b}}).then(function(j){var z=j.numFailures,N=j.failures;if(z===0)return U;for(var F=0,K=Object.keys(N);F<K.length;F++){var M,G=K[F],X=w[Number(G)];X!=null&&(M=N[G],delete N[G],N[X]=M)}throw new Je("".concat(s.name,".bulkUpdate(): ").concat(z," of ").concat(U," operations failed"),N)})})})},rt.prototype.bulkDelete=function(o){var s=this,f=o.length;return this._trans("readwrite",function(p){return s.core.mutate({trans:p,type:"delete",keys:o})}).then(function(I){var b=I.numFailures,w=I.lastResult,I=I.failures;if(b===0)return w;throw new Je("".concat(s.name,".bulkDelete(): ").concat(b," of ").concat(f," operations failed"),I)})},rt);function rt(){}function Nr(o){function s(I,T){if(T){for(var R=arguments.length,L=new Array(R-1);--R;)L[R-1]=arguments[R];return f[I].subscribe.apply(null,L),o}if(typeof I=="string")return f[I]}var f={};s.addEventType=w;for(var p=1,b=arguments.length;p<b;++p)w(arguments[p]);return s;function w(I,T,R){if(typeof I!="object"){var L;T=T||At;var U={subscribers:[],fire:R=R||de,subscribe:function(j){U.subscribers.indexOf(j)===-1&&(U.subscribers.push(j),U.fire=T(U.fire,j))},unsubscribe:function(j){U.subscribers=U.subscribers.filter(function(z){return z!==j}),U.fire=U.subscribers.reduce(T,R)}};return f[I]=s[I]=U}l(L=I).forEach(function(j){var z=L[j];if(c(z))w(j,L[j][0],L[j][1]);else{if(z!=="asap")throw new Se.InvalidArgument("Invalid event config");var N=w(j,De,function(){for(var F=arguments.length,K=new Array(F);F--;)K[F]=arguments[F];N.subscribers.forEach(function(M){q(function(){M.apply(null,K)})})})}})}}function Lr(o,s){return k(s).from({prototype:o}),s}function ir(o,s){return!(o.filter||o.algorithm||o.or)&&(s?o.justLimit:!o.replayFilter)}function To(o,s){o.filter=Kn(o.filter,s)}function jo(o,s,f){var p=o.replayFilter;o.replayFilter=p?function(){return Kn(p(),s())}:s,o.justLimit=f&&!p}function _i(o,s){if(o.isPrimKey)return s.primaryKey;var f=s.getIndexByKeyPath(o.index);if(!f)throw new Se.Schema("KeyPath "+o.index+" on object store "+s.name+" is not indexed");return f}function As(o,s,f){var p=_i(o,s.schema);return s.openCursor({trans:f,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:p,range:o.range}})}function wi(o,s,f,p){var b=o.replayFilter?Kn(o.filter,o.replayFilter()):o.filter;if(o.or){var w={},I=function(T,R,L){var U,j;b&&!b(R,L,function(z){return R.stop(z)},function(z){return R.fail(z)})||((j=""+(U=R.primaryKey))=="[object ArrayBuffer]"&&(j=""+new Uint8Array(U)),m(w,j)||(w[j]=!0,s(T,R,L)))};return Promise.all([o.or._iterate(I,f),Ps(As(o,p,f),o.algorithm,I,!o.keysOnly&&o.valueMapper)])}return Ps(As(o,p,f),Kn(o.algorithm,b),s,!o.keysOnly&&o.valueMapper)}function Ps(o,s,f,p){var b=et(p?function(w,I,T){return f(p(w),I,T)}:f);return o.then(function(w){if(w)return w.start(function(){var I=function(){return w.continue()};s&&!s(w,function(T){return I=T},function(T){w.stop(T),I=de},function(T){w.fail(T),I=de})||b(w.value,w,function(T){return I=T}),I()})})}var Mr=(Ts.prototype.execute=function(o){var s=this["@@propmod"];if(s.add!==void 0){var f=s.add;if(c(f))return i(i([],c(o)?o:[],!0),f).sort();if(typeof f=="number")return(Number(o)||0)+f;if(typeof f=="bigint")try{return BigInt(o)+f}catch{return BigInt(0)+f}throw new TypeError("Invalid term ".concat(f))}if(s.remove!==void 0){var p=s.remove;if(c(p))return c(o)?o.filter(function(b){return!p.includes(b)}).sort():[];if(typeof p=="number")return Number(o)-p;if(typeof p=="bigint")try{return BigInt(o)-p}catch{return BigInt(0)-p}throw new TypeError("Invalid subtrahend ".concat(p))}return f=(f=s.replacePrefix)===null||f===void 0?void 0:f[0],f&&typeof o=="string"&&o.startsWith(f)?s.replacePrefix[1]+o.substring(f.length):o},Ts);function Ts(o){this["@@propmod"]=o}var bf=(Qe.prototype._read=function(o,s){var f=this._ctx;return f.error?f.table._trans(null,lt.bind(null,f.error)):f.table._trans("readonly",o).then(s)},Qe.prototype._write=function(o){var s=this._ctx;return s.error?s.table._trans(null,lt.bind(null,s.error)):s.table._trans("readwrite",o,"locked")},Qe.prototype._addAlgorithm=function(o){var s=this._ctx;s.algorithm=Kn(s.algorithm,o)},Qe.prototype._iterate=function(o,s){return wi(this._ctx,o,s,this._ctx.table.core)},Qe.prototype.clone=function(o){var s=Object.create(this.constructor.prototype),f=Object.create(this._ctx);return o&&d(f,o),s._ctx=f,s},Qe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Qe.prototype.each=function(o){var s=this._ctx;return this._read(function(f){return wi(s,o,f,s.table.core)})},Qe.prototype.count=function(o){var s=this;return this._read(function(f){var p=s._ctx,b=p.table.core;if(ir(p,!0))return b.count({trans:f,query:{index:_i(p,b.schema),range:p.range}}).then(function(I){return Math.min(I,p.limit)});var w=0;return wi(p,function(){return++w,!1},f,b).then(function(){return w})}).then(o)},Qe.prototype.sortBy=function(o,s){var f=o.split(".").reverse(),p=f[0],b=f.length-1;function w(R,L){return L?w(R[f[L]],L-1):R[p]}var I=this._ctx.dir==="next"?1:-1;function T(R,L){return We(w(R,b),w(L,b))*I}return this.toArray(function(R){return R.sort(T)}).then(s)},Qe.prototype.toArray=function(o){var s=this;return this._read(function(f){var p=s._ctx;if(p.dir==="next"&&ir(p,!0)&&0<p.limit){var b=p.valueMapper,w=_i(p,p.table.core.schema);return p.table.core.query({trans:f,limit:p.limit,values:!0,query:{index:w,range:p.range}}).then(function(T){return T=T.result,b?T.map(b):T})}var I=[];return wi(p,function(T){return I.push(T)},f,p.table.core).then(function(){return I})},o)},Qe.prototype.offset=function(o){var s=this._ctx;return o<=0||(s.offset+=o,ir(s)?jo(s,function(){var f=o;return function(p,b){return f===0||(f===1?--f:b(function(){p.advance(f),f=0}),!1)}}):jo(s,function(){var f=o;return function(){return--f<0}})),this},Qe.prototype.limit=function(o){return this._ctx.limit=Math.min(this._ctx.limit,o),jo(this._ctx,function(){var s=o;return function(f,p,b){return--s<=0&&p(b),0<=s}},!0),this},Qe.prototype.until=function(o,s){return To(this._ctx,function(f,p,b){return!o(f.value)||(p(b),s)}),this},Qe.prototype.first=function(o){return this.limit(1).toArray(function(s){return s[0]}).then(o)},Qe.prototype.last=function(o){return this.reverse().first(o)},Qe.prototype.filter=function(o){var s;return To(this._ctx,function(f){return o(f.value)}),(s=this._ctx).isMatch=Kn(s.isMatch,o),this},Qe.prototype.and=function(o){return this.filter(o)},Qe.prototype.or=function(o){return new this.db.WhereClause(this._ctx.table,o,this)},Qe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Qe.prototype.desc=function(){return this.reverse()},Qe.prototype.eachKey=function(o){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(f,p){o(p.key,p)})},Qe.prototype.eachUniqueKey=function(o){return this._ctx.unique="unique",this.eachKey(o)},Qe.prototype.eachPrimaryKey=function(o){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(f,p){o(p.primaryKey,p)})},Qe.prototype.keys=function(o){var s=this._ctx;s.keysOnly=!s.isMatch;var f=[];return this.each(function(p,b){f.push(b.key)}).then(function(){return f}).then(o)},Qe.prototype.primaryKeys=function(o){var s=this._ctx;if(s.dir==="next"&&ir(s,!0)&&0<s.limit)return this._read(function(p){var b=_i(s,s.table.core.schema);return s.table.core.query({trans:p,values:!1,limit:s.limit,query:{index:b,range:s.range}})}).then(function(p){return p.result}).then(o);s.keysOnly=!s.isMatch;var f=[];return this.each(function(p,b){f.push(b.primaryKey)}).then(function(){return f}).then(o)},Qe.prototype.uniqueKeys=function(o){return this._ctx.unique="unique",this.keys(o)},Qe.prototype.firstKey=function(o){return this.limit(1).keys(function(s){return s[0]}).then(o)},Qe.prototype.lastKey=function(o){return this.reverse().firstKey(o)},Qe.prototype.distinct=function(){var o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];if(!o||!o.multi)return this;var s={};return To(this._ctx,function(b){var p=b.primaryKey.toString(),b=m(s,p);return s[p]=!0,!b}),this},Qe.prototype.modify=function(o){var s=this,f=this._ctx;return this._write(function(p){var b,w,I;I=typeof o=="function"?o:(b=l(o),w=b.length,function(M){for(var G=!1,X=0;X<w;++X){var $=b[X],ie=o[$],le=D(M,$);ie instanceof Mr?(W(M,$,ie.execute(le)),G=!0):le!==ie&&(W(M,$,ie),G=!0)}return G});var T=f.table.core,j=T.schema.primaryKey,R=j.outbound,L=j.extractKey,U=200,j=s.db._options.modifyChunkSize;j&&(U=typeof j=="object"?j[T.name]||j["*"]||200:j);function z(M,$){var X=$.failures,$=$.numFailures;F+=M-$;for(var ie=0,le=l(X);ie<le.length;ie++){var me=le[ie];N.push(X[me])}}var N=[],F=0,K=[];return s.clone().primaryKeys().then(function(M){function G($){var ie=Math.min(U,M.length-$);return T.getMany({trans:p,keys:M.slice($,$+ie),cache:"immutable"}).then(function(le){for(var me=[],ue=[],ve=R?[]:null,ge=[],ye=0;ye<ie;++ye){var xe=le[ye],qe={value:V(xe),primKey:M[$+ye]};I.call(qe,qe.value,qe)!==!1&&(qe.value==null?ge.push(M[$+ye]):R||We(L(xe),L(qe.value))===0?(ue.push(qe.value),R&&ve.push(M[$+ye])):(ge.push(M[$+ye]),me.push(qe.value)))}return Promise.resolve(0<me.length&&T.mutate({trans:p,type:"add",values:me}).then(function(Be){for(var Ke in Be.failures)ge.splice(parseInt(Ke),1);z(me.length,Be)})).then(function(){return(0<ue.length||X&&typeof o=="object")&&T.mutate({trans:p,type:"put",keys:ve,values:ue,criteria:X,changeSpec:typeof o!="function"&&o,isAdditionalChunk:0<$}).then(function(Be){return z(ue.length,Be)})}).then(function(){return(0<ge.length||X&&o===Do)&&T.mutate({trans:p,type:"delete",keys:ge,criteria:X,isAdditionalChunk:0<$}).then(function(Be){return z(ge.length,Be)})}).then(function(){return M.length>$+ie&&G($+U)})})}var X=ir(f)&&f.limit===1/0&&(typeof o!="function"||o===Do)&&{index:f.index,range:f.range};return G(0).then(function(){if(0<N.length)throw new He("Error modifying one or more objects",N,F,K);return M.length})})})},Qe.prototype.delete=function(){var o=this._ctx,s=o.range;return ir(o)&&(o.isPrimKey||s.type===3)?this._write(function(f){var p=o.table.core.schema.primaryKey,b=s;return o.table.core.count({trans:f,query:{index:p,range:b}}).then(function(w){return o.table.core.mutate({trans:f,type:"deleteRange",range:b}).then(function(I){var T=I.failures;if(I.lastResult,I.results,I=I.numFailures,I)throw new He("Could not delete some values",Object.keys(T).map(function(R){return T[R]}),w-I);return w-I})})}):this.modify(Do)},Qe);function Qe(){}var Do=function(o,s){return s.value=null};function _f(o,s){return o<s?-1:o===s?0:1}function wf(o,s){return s<o?-1:o===s?0:1}function Tt(o,s,f){return o=o instanceof Ds?new o.Collection(o):o,o._ctx.error=new(f||TypeError)(s),o}function or(o){return new o.Collection(o,function(){return js("")}).limit(0)}function ki(o,s,f,p){var b,w,I,T,R,L,U,j=f.length;if(!f.every(function(F){return typeof F=="string"}))return Tt(o,xs);function z(F){b=F==="next"?function(M){return M.toUpperCase()}:function(M){return M.toLowerCase()},w=F==="next"?function(M){return M.toLowerCase()}:function(M){return M.toUpperCase()},I=F==="next"?_f:wf;var K=f.map(function(M){return{lower:w(M),upper:b(M)}}).sort(function(M,G){return I(M.lower,G.lower)});T=K.map(function(M){return M.upper}),R=K.map(function(M){return M.lower}),U=(L=F)==="next"?"":p}z("next"),o=new o.Collection(o,function(){return An(T[0],R[j-1]+p)}),o._ondirectionchange=function(F){z(F)};var N=0;return o._addAlgorithm(function(F,K,M){var G=F.key;if(typeof G!="string")return!1;var X=w(G);if(s(X,R,N))return!0;for(var $=null,ie=N;ie<j;++ie){var le=function(me,ue,ve,ge,ye,xe){for(var qe=Math.min(me.length,ge.length),Be=-1,Ke=0;Ke<qe;++Ke){var jt=ue[Ke];if(jt!==ge[Ke])return ye(me[Ke],ve[Ke])<0?me.substr(0,Ke)+ve[Ke]+ve.substr(Ke+1):ye(me[Ke],ge[Ke])<0?me.substr(0,Ke)+ge[Ke]+ve.substr(Ke+1):0<=Be?me.substr(0,Be)+ue[Be]+ve.substr(Be+1):null;ye(me[Ke],jt)<0&&(Be=Ke)}return qe<ge.length&&xe==="next"?me+ve.substr(me.length):qe<me.length&&xe==="prev"?me.substr(0,ve.length):Be<0?null:me.substr(0,Be)+ge[Be]+ve.substr(Be+1)}(G,X,T[ie],R[ie],I,L);le===null&&$===null?N=ie+1:($===null||0<I($,le))&&($=le)}return K($!==null?function(){F.continue($+U)}:M),!1}),o}function An(o,s,f,p){return{type:2,lower:o,upper:s,lowerOpen:f,upperOpen:p}}function js(o){return{type:1,lower:o,upper:o}}var Ds=(Object.defineProperty(yt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),yt.prototype.between=function(o,s,f,p){f=f!==!1,p=p===!0;try{return 0<this._cmp(o,s)||this._cmp(o,s)===0&&(f||p)&&(!f||!p)?or(this):new this.Collection(this,function(){return An(o,s,!f,!p)})}catch{return Tt(this,vn)}},yt.prototype.equals=function(o){return o==null?Tt(this,vn):new this.Collection(this,function(){return js(o)})},yt.prototype.above=function(o){return o==null?Tt(this,vn):new this.Collection(this,function(){return An(o,void 0,!0)})},yt.prototype.aboveOrEqual=function(o){return o==null?Tt(this,vn):new this.Collection(this,function(){return An(o,void 0,!1)})},yt.prototype.below=function(o){return o==null?Tt(this,vn):new this.Collection(this,function(){return An(void 0,o,!1,!0)})},yt.prototype.belowOrEqual=function(o){return o==null?Tt(this,vn):new this.Collection(this,function(){return An(void 0,o)})},yt.prototype.startsWith=function(o){return typeof o!="string"?Tt(this,xs):this.between(o,o+Bn,!0,!0)},yt.prototype.startsWithIgnoreCase=function(o){return o===""?this.startsWith(o):ki(this,function(s,f){return s.indexOf(f[0])===0},[o],Bn)},yt.prototype.equalsIgnoreCase=function(o){return ki(this,function(s,f){return s===f[0]},[o],"")},yt.prototype.anyOfIgnoreCase=function(){var o=B.apply(fe,arguments);return o.length===0?or(this):ki(this,function(s,f){return f.indexOf(s)!==-1},o,"")},yt.prototype.startsWithAnyOfIgnoreCase=function(){var o=B.apply(fe,arguments);return o.length===0?or(this):ki(this,function(s,f){return f.some(function(p){return s.indexOf(p)===0})},o,Bn)},yt.prototype.anyOf=function(){var o=this,s=B.apply(fe,arguments),f=this._cmp;try{s.sort(f)}catch{return Tt(this,vn)}if(s.length===0)return or(this);var p=new this.Collection(this,function(){return An(s[0],s[s.length-1])});p._ondirectionchange=function(w){f=w==="next"?o._ascending:o._descending,s.sort(f)};var b=0;return p._addAlgorithm(function(w,I,T){for(var R=w.key;0<f(R,s[b]);)if(++b===s.length)return I(T),!1;return f(R,s[b])===0||(I(function(){w.continue(s[b])}),!1)}),p},yt.prototype.notEqual=function(o){return this.inAnyRange([[-1/0,o],[o,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},yt.prototype.noneOf=function(){var o=B.apply(fe,arguments);if(o.length===0)return new this.Collection(this);try{o.sort(this._ascending)}catch{return Tt(this,vn)}var s=o.reduce(function(f,p){return f?f.concat([[f[f.length-1][1],p]]):[[-1/0,p]]},null);return s.push([o[o.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},yt.prototype.inAnyRange=function(G,s){var f=this,p=this._cmp,b=this._ascending,w=this._descending,I=this._min,T=this._max;if(G.length===0)return or(this);if(!G.every(function(X){return X[0]!==void 0&&X[1]!==void 0&&b(X[0],X[1])<=0}))return Tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Se.InvalidArgument);var R=!s||s.includeLowers!==!1,L=s&&s.includeUppers===!0,U,j=b;function z(X,$){return j(X[0],$[0])}try{(U=G.reduce(function(X,$){for(var ie=0,le=X.length;ie<le;++ie){var me=X[ie];if(p($[0],me[1])<0&&0<p($[1],me[0])){me[0]=I(me[0],$[0]),me[1]=T(me[1],$[1]);break}}return ie===le&&X.push($),X},[])).sort(z)}catch{return Tt(this,vn)}var N=0,F=L?function(X){return 0<b(X,U[N][1])}:function(X){return 0<=b(X,U[N][1])},K=R?function(X){return 0<w(X,U[N][0])}:function(X){return 0<=w(X,U[N][0])},M=F,G=new this.Collection(this,function(){return An(U[0][0],U[U.length-1][1],!R,!L)});return G._ondirectionchange=function(X){j=X==="next"?(M=F,b):(M=K,w),U.sort(z)},G._addAlgorithm(function(X,$,ie){for(var le,me=X.key;M(me);)if(++N===U.length)return $(ie),!1;return!F(le=me)&&!K(le)||(f._cmp(me,U[N][1])===0||f._cmp(me,U[N][0])===0||$(function(){j===b?X.continue(U[N][0]):X.continue(U[N][1])}),!1)}),G},yt.prototype.startsWithAnyOf=function(){var o=B.apply(fe,arguments);return o.every(function(s){return typeof s=="string"})?o.length===0?or(this):this.inAnyRange(o.map(function(s){return[s,s+Bn]})):Tt(this,"startsWithAnyOf() only works with strings")},yt);function yt(){}function on(o){return et(function(s){return qr(s),o(s.target.error),!1})}function qr(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var Fr="storagemutated",Ro="x-storagemutated-1",Pn=Nr(null,Fr),kf=(an.prototype._lock=function(){return A(!Ee.global),++this._reculock,this._reculock!==1||Ee.global||(Ee.lockOwnerFor=this),this},an.prototype._unlock=function(){if(A(!Ee.global),--this._reculock==0)for(Ee.global||(Ee.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var o=this._blockedFuncs.shift();try{Un(o[1],o[0])}catch{}}return this},an.prototype._locked=function(){return this._reculock&&Ee.lockOwnerFor!==this},an.prototype.create=function(o){var s=this;if(!this.mode)return this;var f=this.db.idbdb,p=this.db._state.dbOpenError;if(A(!this.idbtrans),!o&&!f)switch(p&&p.name){case"DatabaseClosedError":throw new Se.DatabaseClosed(p);case"MissingAPIError":throw new Se.MissingAPI(p.message,p);default:throw new Se.OpenFailed(p)}if(!this.active)throw new Se.TransactionInactive;return A(this._completion._state===null),(o=this.idbtrans=o||(this.db.core||f).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=et(function(b){qr(b),s._reject(o.error)}),o.onabort=et(function(b){qr(b),s.active&&s._reject(new Se.Abort(o.error)),s.active=!1,s.on("abort").fire(b)}),o.oncomplete=et(function(){s.active=!1,s._resolve(),"mutatedParts"in o&&Pn.storagemutated.fire(o.mutatedParts)}),this},an.prototype._promise=function(o,s,f){var p=this;if(o==="readwrite"&&this.mode!=="readwrite")return lt(new Se.ReadOnly("Transaction is readonly"));if(!this.active)return lt(new Se.TransactionInactive);if(this._locked())return new _e(function(w,I){p._blockedFuncs.push([function(){p._promise(o,s,f).then(w,I)},Ee])});if(f)return rn(function(){var w=new _e(function(I,T){p._lock();var R=s(I,T,p);R&&R.then&&R.then(I,T)});return w.finally(function(){return p._unlock()}),w._lib=!0,w});var b=new _e(function(w,I){var T=s(w,I,p);T&&T.then&&T.then(w,I)});return b._lib=!0,b},an.prototype._root=function(){return this.parent?this.parent._root():this},an.prototype.waitFor=function(o){var s,f=this._root(),p=_e.resolve(o);f._waitingFor?f._waitingFor=f._waitingFor.then(function(){return p}):(f._waitingFor=p,f._waitingQueue=[],s=f.idbtrans.objectStore(f.storeNames[0]),function w(){for(++f._spinCount;f._waitingQueue.length;)f._waitingQueue.shift()();f._waitingFor&&(s.get(-1/0).onsuccess=w)}());var b=f._waitingFor;return new _e(function(w,I){p.then(function(T){return f._waitingQueue.push(et(w.bind(null,T)))},function(T){return f._waitingQueue.push(et(I.bind(null,T)))}).finally(function(){f._waitingFor===b&&(f._waitingFor=null)})})},an.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Se.Abort))},an.prototype.table=function(o){var s=this._memoizedTables||(this._memoizedTables={});if(m(s,o))return s[o];var f=this.schema[o];if(!f)throw new Se.NotFound("Table "+o+" not part of transaction");return f=new this.db.Table(o,f,this),f.core=this.db.core.table(o),s[o]=f},an);function an(){}function No(o,s,f,p,b,w,I){return{name:o,keyPath:s,unique:f,multi:p,auto:b,compound:w,src:(f&&!I?"&":"")+(p?"*":"")+(b?"++":"")+Rs(s)}}function Rs(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Lo(o,s,f){return{name:o,primKey:s,indexes:f,mappedClass:null,idxByName:(p=function(b){return[b.name,b]},f.reduce(function(b,w,I){return I=p(w,I),I&&(b[I[0]]=I[1]),b},{}))};var p}var Ur=function(o){try{return o.only([[]]),Ur=function(){return[[]]},[[]]}catch{return Ur=function(){return Bn},Bn}};function Mo(o){return o==null?function(){}:typeof o=="string"?(s=o).split(".").length===1?function(f){return f[s]}:function(f){return D(f,s)}:function(f){return D(f,o)};var s}function Ns(o){return[].slice.call(o)}var xf=0;function Br(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function Sf(o,s,R){function p(M){if(M.type===3)return null;if(M.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var N=M.lower,F=M.upper,K=M.lowerOpen,M=M.upperOpen;return N===void 0?F===void 0?null:s.upperBound(F,!!M):F===void 0?s.lowerBound(N,!!K):s.bound(N,F,!!K,!!M)}function b(z){var N,F=z.name;return{name:F,schema:z,mutate:function(K){var M=K.trans,G=K.type,X=K.keys,$=K.values,ie=K.range;return new Promise(function(le,me){le=et(le);var ue=M.objectStore(F),ve=ue.keyPath==null,ge=G==="put"||G==="add";if(!ge&&G!=="delete"&&G!=="deleteRange")throw new Error("Invalid operation type: "+G);var ye,xe=(X||$||{length:1}).length;if(X&&$&&X.length!==$.length)throw new Error("Given keys array must have same length as given values array.");if(xe===0)return le({numFailures:0,failures:{},results:[],lastResult:void 0});function qe(Ot){++jt,qr(Ot)}var Be=[],Ke=[],jt=0;if(G==="deleteRange"){if(ie.type===4)return le({numFailures:jt,failures:Ke,results:[],lastResult:void 0});ie.type===3?Be.push(ye=ue.clear()):Be.push(ye=ue.delete(p(ie)))}else{var ve=ge?ve?[$,X]:[$,null]:[X,null],Me=ve[0],wt=ve[1];if(ge)for(var kt=0;kt<xe;++kt)Be.push(ye=wt&&wt[kt]!==void 0?ue[G](Me[kt],wt[kt]):ue[G](Me[kt])),ye.onerror=qe;else for(kt=0;kt<xe;++kt)Be.push(ye=ue[G](Me[kt])),ye.onerror=qe}function Ni(Ot){Ot=Ot.target.result,Be.forEach(function(Wn,ta){return Wn.error!=null&&(Ke[ta]=Wn.error)}),le({numFailures:jt,failures:Ke,results:G==="delete"?X:Be.map(function(Wn){return Wn.result}),lastResult:Ot})}ye.onerror=function(Ot){qe(Ot),Ni(Ot)},ye.onsuccess=Ni})},getMany:function(K){var M=K.trans,G=K.keys;return new Promise(function(X,$){X=et(X);for(var ie,le=M.objectStore(F),me=G.length,ue=new Array(me),ve=0,ge=0,ye=function(Be){Be=Be.target,ue[Be._pos]=Be.result,++ge===ve&&X(ue)},xe=on($),qe=0;qe<me;++qe)G[qe]!=null&&((ie=le.get(G[qe]))._pos=qe,ie.onsuccess=ye,ie.onerror=xe,++ve);ve===0&&X(ue)})},get:function(K){var M=K.trans,G=K.key;return new Promise(function(X,$){X=et(X);var ie=M.objectStore(F).get(G);ie.onsuccess=function(le){return X(le.target.result)},ie.onerror=on($)})},query:(N=L,function(K){return new Promise(function(M,G){M=et(M);var X,$,ie,ve=K.trans,le=K.values,me=K.limit,ye=K.query,ue=me===1/0?void 0:me,ge=ye.index,ye=ye.range,ve=ve.objectStore(F),ge=ge.isPrimaryKey?ve:ve.index(ge.name),ye=p(ye);if(me===0)return M({result:[]});N?((ue=le?ge.getAll(ye,ue):ge.getAllKeys(ye,ue)).onsuccess=function(xe){return M({result:xe.target.result})},ue.onerror=on(G)):(X=0,$=!le&&"openKeyCursor"in ge?ge.openKeyCursor(ye):ge.openCursor(ye),ie=[],$.onsuccess=function(xe){var qe=$.result;return qe?(ie.push(le?qe.value:qe.primaryKey),++X===me?M({result:ie}):void qe.continue()):M({result:ie})},$.onerror=on(G))})}),openCursor:function(K){var M=K.trans,G=K.values,X=K.query,$=K.reverse,ie=K.unique;return new Promise(function(le,me){le=et(le);var ge=X.index,ue=X.range,ve=M.objectStore(F),ve=ge.isPrimaryKey?ve:ve.index(ge.name),ge=$?ie?"prevunique":"prev":ie?"nextunique":"next",ye=!G&&"openKeyCursor"in ve?ve.openKeyCursor(p(ue),ge):ve.openCursor(p(ue),ge);ye.onerror=on(me),ye.onsuccess=et(function(xe){var qe,Be,Ke,jt,Me=ye.result;Me?(Me.___id=++xf,Me.done=!1,qe=Me.continue.bind(Me),Be=(Be=Me.continuePrimaryKey)&&Be.bind(Me),Ke=Me.advance.bind(Me),jt=function(){throw new Error("Cursor not stopped")},Me.trans=M,Me.stop=Me.continue=Me.continuePrimaryKey=Me.advance=function(){throw new Error("Cursor not started")},Me.fail=et(me),Me.next=function(){var wt=this,kt=1;return this.start(function(){return kt--?wt.continue():wt.stop()}).then(function(){return wt})},Me.start=function(wt){function kt(){if(ye.result)try{wt()}catch(Ot){Me.fail(Ot)}else Me.done=!0,Me.start=function(){throw new Error("Cursor behind last entry")},Me.stop()}var Ni=new Promise(function(Ot,Wn){Ot=et(Ot),ye.onerror=on(Wn),Me.fail=Wn,Me.stop=function(ta){Me.stop=Me.continue=Me.continuePrimaryKey=Me.advance=jt,Ot(ta)}});return ye.onsuccess=et(function(Ot){ye.onsuccess=kt,kt()}),Me.continue=qe,Me.continuePrimaryKey=Be,Me.advance=Ke,kt(),Ni},le(Me)):le(null)},me)})},count:function(K){var M=K.query,G=K.trans,X=M.index,$=M.range;return new Promise(function(ie,le){var me=G.objectStore(F),ue=X.isPrimaryKey?me:me.index(X.name),me=p($),ue=me?ue.count(me):ue.count();ue.onsuccess=et(function(ve){return ie(ve.target.result)}),ue.onerror=on(le)})}}}var w,I,T,U=(I=R,T=Ns((w=o).objectStoreNames),{schema:{name:w.name,tables:T.map(function(z){return I.objectStore(z)}).map(function(z){var N=z.keyPath,M=z.autoIncrement,F=c(N),K={},M={name:z.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:N==null,compound:F,keyPath:N,autoIncrement:M,unique:!0,extractKey:Mo(N)},indexes:Ns(z.indexNames).map(function(G){return z.index(G)}).map(function(ie){var X=ie.name,$=ie.unique,le=ie.multiEntry,ie=ie.keyPath,le={name:X,compound:c(ie),keyPath:ie,unique:$,multiEntry:le,extractKey:Mo(ie)};return K[Br(ie)]=le}),getIndexByKeyPath:function(G){return K[Br(G)]}};return K[":id"]=M.primaryKey,N!=null&&(K[Br(N)]=M.primaryKey),M})},hasGetAll:0<T.length&&"getAll"in I.objectStore(T[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),R=U.schema,L=U.hasGetAll,U=R.tables.map(b),j={};return U.forEach(function(z){return j[z.name]=z}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function(z){if(!j[z])throw new Error("Table '".concat(z,"' not found"));return j[z]},MIN_KEY:-1/0,MAX_KEY:Ur(s),schema:R}}function If(o,s,f,p){var b=f.IDBKeyRange;return f.indexedDB,{dbcore:(p=Sf(s,b,p),o.dbcore.reduce(function(w,I){return I=I.create,r(r({},w),I(w))},p))}}function xi(o,p){var f=p.db,p=If(o._middlewares,f,o._deps,p);o.core=p.dbcore,o.tables.forEach(function(b){var w=b.name;o.core.schema.tables.some(function(I){return I.name===w})&&(b.core=o.core.table(w),o[w]instanceof o.Table&&(o[w].core=b.core))})}function Si(o,s,f,p){f.forEach(function(b){var w=p[b];s.forEach(function(I){var T=function R(L,U){return O(L,U)||(L=v(L))&&R(L,U)}(I,b);(!T||"value"in T&&T.value===void 0)&&(I===o.Transaction.prototype||I instanceof o.Transaction?_(I,b,{get:function(){return this.table(b)},set:function(R){g(this,b,{value:R,writable:!0,configurable:!0,enumerable:!0})}}):I[b]=new o.Table(b,w))})})}function qo(o,s){s.forEach(function(f){for(var p in f)f[p]instanceof o.Table&&delete f[p]})}function Ef(o,s){return o._cfg.version-s._cfg.version}function Of(o,s,f,p){var b=o._dbSchema;f.objectStoreNames.contains("$meta")&&!b.$meta&&(b.$meta=Lo("$meta",Ms("")[0],[]),o._storeNames.push("$meta"));var w=o._createTransaction("readwrite",o._storeNames,b);w.create(f),w._completion.catch(p);var I=w._reject.bind(w),T=Ee.transless||Ee;rn(function(){return Ee.trans=w,Ee.transless=T,s!==0?(xi(o,f),L=s,((R=w).storeNames.includes("$meta")?R.table("$meta").get("version").then(function(U){return U??L}):_e.resolve(L)).then(function(U){return z=U,N=w,F=f,K=[],U=(j=o)._versions,M=j._dbSchema=Ei(0,j.idbdb,F),(U=U.filter(function(G){return G._cfg.version>=z})).length!==0?(U.forEach(function(G){K.push(function(){var X=M,$=G._cfg.dbschema;Oi(j,X,F),Oi(j,$,F),M=j._dbSchema=$;var ie=Fo(X,$);ie.add.forEach(function(ge){Uo(F,ge[0],ge[1].primKey,ge[1].indexes)}),ie.change.forEach(function(ge){if(ge.recreate)throw new Se.Upgrade("Not yet support for changing primary key");var ye=F.objectStore(ge.name);ge.add.forEach(function(xe){return Ii(ye,xe)}),ge.change.forEach(function(xe){ye.deleteIndex(xe.name),Ii(ye,xe)}),ge.del.forEach(function(xe){return ye.deleteIndex(xe)})});var le=G._cfg.contentUpgrade;if(le&&G._cfg.version>z){xi(j,F),N._memoizedTables={};var me=te($);ie.del.forEach(function(ge){me[ge]=X[ge]}),qo(j,[j.Transaction.prototype]),Si(j,[j.Transaction.prototype],l(me),me),N.schema=me;var ue,ve=Ne(le);return ve&&On(),ie=_e.follow(function(){var ge;(ue=le(N))&&ve&&(ge=Et.bind(null,null),ue.then(ge,ge))}),ue&&typeof ue.then=="function"?_e.resolve(ue):ie.then(function(){return ue})}}),K.push(function(X){var $,ie,le=G._cfg.dbschema;$=le,ie=X,[].slice.call(ie.db.objectStoreNames).forEach(function(me){return $[me]==null&&ie.db.deleteObjectStore(me)}),qo(j,[j.Transaction.prototype]),Si(j,[j.Transaction.prototype],j._storeNames,j._dbSchema),N.schema=j._dbSchema}),K.push(function(X){j.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(j.idbdb.version/10)===G._cfg.version?(j.idbdb.deleteObjectStore("$meta"),delete j._dbSchema.$meta,j._storeNames=j._storeNames.filter(function($){return $!=="$meta"})):X.objectStore("$meta").put(G._cfg.version,"version"))})}),function G(){return K.length?_e.resolve(K.shift()(N.idbtrans)).then(G):_e.resolve()}().then(function(){Ls(M,F)})):_e.resolve();var j,z,N,F,K,M}).catch(I)):(l(b).forEach(function(U){Uo(f,U,b[U].primKey,b[U].indexes)}),xi(o,f),void _e.follow(function(){return o.on.populate.fire(w)}).catch(I));var R,L})}function Cf(o,s){Ls(o._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var f=Ei(0,o.idbdb,s);Oi(o,o._dbSchema,s);for(var p=0,b=Fo(f,o._dbSchema).change;p<b.length;p++){var w=function(I){if(I.change.length||I.recreate)return console.warn("Unable to patch indexes of table ".concat(I.name," because it has changes on the type of index or primary key.")),{value:void 0};var T=s.objectStore(I.name);I.add.forEach(function(R){Xe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(I.name,".").concat(R.src)),Ii(T,R)})}(b[p]);if(typeof w=="object")return w.value}}function Fo(o,s){var f,p={del:[],add:[],change:[]};for(f in o)s[f]||p.del.push(f);for(f in s){var b=o[f],w=s[f];if(b){var I={name:f,def:w,recreate:!1,del:[],add:[],change:[]};if(""+(b.primKey.keyPath||"")!=""+(w.primKey.keyPath||"")||b.primKey.auto!==w.primKey.auto)I.recreate=!0,p.change.push(I);else{var T=b.idxByName,R=w.idxByName,L=void 0;for(L in T)R[L]||I.del.push(L);for(L in R){var U=T[L],j=R[L];U?U.src!==j.src&&I.change.push(j):I.add.push(j)}(0<I.del.length||0<I.add.length||0<I.change.length)&&p.change.push(I)}}else p.add.push([f,w])}return p}function Uo(o,s,f,p){var b=o.db.createObjectStore(s,f.keyPath?{keyPath:f.keyPath,autoIncrement:f.auto}:{autoIncrement:f.auto});return p.forEach(function(w){return Ii(b,w)}),b}function Ls(o,s){l(o).forEach(function(f){s.db.objectStoreNames.contains(f)||(Xe&&console.debug("Dexie: Creating missing table",f),Uo(s,f,o[f].primKey,o[f].indexes))})}function Ii(o,s){o.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Ei(o,s,f){var p={};return S(s.objectStoreNames,0).forEach(function(b){for(var w=f.objectStore(b),I=No(Rs(L=w.keyPath),L||"",!0,!1,!!w.autoIncrement,L&&typeof L!="string",!0),T=[],R=0;R<w.indexNames.length;++R){var U=w.index(w.indexNames[R]),L=U.keyPath,U=No(U.name,L,!!U.unique,!!U.multiEntry,!1,L&&typeof L!="string",!1);T.push(U)}p[b]=Lo(b,I,T)}),p}function Oi(o,s,f){for(var p=f.db.objectStoreNames,b=0;b<p.length;++b){var w=p[b],I=f.objectStore(w);o._hasGetAll="getAll"in I;for(var T=0;T<I.indexNames.length;++T){var R=I.indexNames[T],L=I.index(R).keyPath,U=typeof L=="string"?L:"["+S(L).join("+")+"]";!s[w]||(L=s[w].idxByName[U])&&(L.name=R,delete s[w].idxByName[U],s[w].idxByName[R]=L)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function Ms(o){return o.split(",").map(function(s,f){var p=(s=s.trim()).replace(/([&*]|\+\+)/g,""),b=/^\[/.test(p)?p.match(/^\[(.*)\]$/)[1].split("+"):p;return No(p,b||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),c(b),f===0)})}var Af=(Ci.prototype._parseStoresSpec=function(o,s){l(o).forEach(function(f){if(o[f]!==null){var p=Ms(o[f]),b=p.shift();if(b.unique=!0,b.multi)throw new Se.Schema("Primary key cannot be multi-valued");p.forEach(function(w){if(w.auto)throw new Se.Schema("Only primary key can be marked as autoIncrement (++)");if(!w.keyPath)throw new Se.Schema("Index must have a name and cannot be an empty string")}),s[f]=Lo(f,b,p)}})},Ci.prototype.stores=function(f){var s=this.db;this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,f):f;var f=s._versions,p={},b={};return f.forEach(function(w){d(p,w._cfg.storesSource),b=w._cfg.dbschema={},w._parseStoresSpec(p,b)}),s._dbSchema=b,qo(s,[s._allTables,s,s.Transaction.prototype]),Si(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],l(b),b),s._storeNames=l(b),this},Ci.prototype.upgrade=function(o){return this._cfg.contentUpgrade=qt(this._cfg.contentUpgrade||de,o),this},Ci);function Ci(){}function Bo(o,s){var f=o._dbNamesDB;return f||(f=o._dbNamesDB=new hn(gi,{addons:[],indexedDB:o,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),f.table("dbnames")}function Ko(o){return o&&typeof o.databases=="function"}function zo(o){return rn(function(){return Ee.letThrough=!0,o()})}function Vo(o){return!("from"in o)}var _t=function(o,s){if(!this){var f=new _t;return o&&"d"in o&&d(f,o),f}d(this,arguments.length?{d:1,from:o,to:1<arguments.length?s:o}:{d:0})};function Kr(o,s,f){var p=We(s,f);if(!isNaN(p)){if(0<p)throw RangeError();if(Vo(o))return d(o,{from:s,to:f,d:1});var b=o.l,p=o.r;if(We(f,o.from)<0)return b?Kr(b,s,f):o.l={from:s,to:f,d:1,l:null,r:null},Fs(o);if(0<We(s,o.to))return p?Kr(p,s,f):o.r={from:s,to:f,d:1,l:null,r:null},Fs(o);We(s,o.from)<0&&(o.from=s,o.l=null,o.d=p?p.d+1:1),0<We(f,o.to)&&(o.to=f,o.r=null,o.d=o.l?o.l.d+1:1),f=!o.r,b&&!o.l&&zr(o,b),p&&f&&zr(o,p)}}function zr(o,s){Vo(s)||function f(p,R){var w=R.from,I=R.to,T=R.l,R=R.r;Kr(p,w,I),T&&f(p,T),R&&f(p,R)}(o,s)}function qs(o,s){var f=Ai(s),p=f.next();if(p.done)return!1;for(var b=p.value,w=Ai(o),I=w.next(b.from),T=I.value;!p.done&&!I.done;){if(We(T.from,b.to)<=0&&0<=We(T.to,b.from))return!0;We(b.from,T.from)<0?b=(p=f.next(T.from)).value:T=(I=w.next(b.from)).value}return!1}function Ai(o){var s=Vo(o)?null:{s:0,n:o};return{next:function(f){for(var p=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,p)for(;s.n.l&&We(f,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!p||We(f,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function Fs(o){var s,f,p=(((s=o.r)===null||s===void 0?void 0:s.d)||0)-(((f=o.l)===null||f===void 0?void 0:f.d)||0),b=1<p?"r":p<-1?"l":"";b&&(s=b=="r"?"l":"r",f=r({},o),p=o[b],o.from=p.from,o.to=p.to,o[b]=p[b],f[b]=p[s],(o[s]=f).d=Us(f)),o.d=Us(o)}function Us(f){var s=f.r,f=f.l;return(s?f?Math.max(s.d,f.d):s.d:f?f.d:0)+1}function Pi(o,s){return l(s).forEach(function(f){o[f]?zr(o[f],s[f]):o[f]=function p(b){var w,I,T={};for(w in b)m(b,w)&&(I=b[w],T[w]=!I||typeof I!="object"||ne.has(I.constructor)?I:p(I));return T}(s[f])}),o}function Wo(o,s){return o.all||s.all||Object.keys(o).some(function(f){return s[f]&&qs(s[f],o[f])})}y(_t.prototype,((Vt={add:function(o){return zr(this,o),this},addKey:function(o){return Kr(this,o,o),this},addKeys:function(o){var s=this;return o.forEach(function(f){return Kr(s,f,f)}),this},hasKey:function(o){var s=Ai(this).next(o).value;return s&&We(s.from,o)<=0&&0<=We(s.to,o)}})[se]=function(){return Ai(this)},Vt));var zn={},Ho={},Yo=!1;function Ti(o){Pi(Ho,o),Yo||(Yo=!0,setTimeout(function(){Yo=!1,Go(Ho,!(Ho={}))},0))}function Go(o,s){s===void 0&&(s=!1);var f=new Set;if(o.all)for(var p=0,b=Object.values(zn);p<b.length;p++)Bs(I=b[p],o,f,s);else for(var w in o){var I,T=/^idb\:\/\/(.*)\/(.*)\//.exec(w);T&&(w=T[1],T=T[2],(I=zn["idb://".concat(w,"/").concat(T)])&&Bs(I,o,f,s))}f.forEach(function(R){return R()})}function Bs(o,s,f,p){for(var b=[],w=0,I=Object.entries(o.queries.query);w<I.length;w++){for(var T=I[w],R=T[0],L=[],U=0,j=T[1];U<j.length;U++){var z=j[U];Wo(s,z.obsSet)?z.subscribers.forEach(function(M){return f.add(M)}):p&&L.push(z)}p&&b.push([R,L])}if(p)for(var N=0,F=b;N<F.length;N++){var K=F[N],R=K[0],L=K[1];o.queries.query[R]=L}}function Pf(o){var s=o._state,f=o._deps.indexedDB;if(s.isBeingOpened||o.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?lt(s.dbOpenError):o});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var p=s.openCanceller,b=Math.round(10*o.verno),w=!1;function I(){if(s.openCanceller!==p)throw new Se.DatabaseClosed("db.open() was cancelled")}function T(){return new _e(function(z,N){if(I(),!f)throw new Se.MissingAPI;var F=o.name,K=s.autoSchema||!b?f.open(F):f.open(F,b);if(!K)throw new Se.MissingAPI;K.onerror=on(N),K.onblocked=et(o._fireOnBlocked),K.onupgradeneeded=et(function(M){var G;U=K.transaction,s.autoSchema&&!o._options.allowEmptyDB?(K.onerror=qr,U.abort(),K.result.close(),(G=f.deleteDatabase(F)).onsuccess=G.onerror=et(function(){N(new Se.NoSuchDatabase("Database ".concat(F," doesnt exist")))})):(U.onerror=on(N),M=M.oldVersion>Math.pow(2,62)?0:M.oldVersion,j=M<1,o.idbdb=K.result,w&&Cf(o,U),Of(o,M/10,U,N))},N),K.onsuccess=et(function(){U=null;var M,G,X,$,ie,le=o.idbdb=K.result,me=S(le.objectStoreNames);if(0<me.length)try{var ue=le.transaction(($=me).length===1?$[0]:$,"readonly");if(s.autoSchema)G=le,X=ue,(M=o).verno=G.version/10,X=M._dbSchema=Ei(0,G,X),M._storeNames=S(G.objectStoreNames,0),Si(M,[M._allTables],l(X),X);else if(Oi(o,o._dbSchema,ue),((ie=Fo(Ei(0,(ie=o).idbdb,ue),ie._dbSchema)).add.length||ie.change.some(function(ve){return ve.add.length||ve.change.length}))&&!w)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),le.close(),b=le.version+1,w=!0,z(T());xi(o,ue)}catch{}rr.push(o),le.onversionchange=et(function(ve){s.vcFired=!0,o.on("versionchange").fire(ve)}),le.onclose=et(function(ve){o.on("close").fire(ve)}),j&&(ie=o._deps,ue=F,le=ie.indexedDB,ie=ie.IDBKeyRange,Ko(le)||ue===gi||Bo(le,ie).put({name:ue}).catch(de)),z()},N)}).catch(function(z){switch(z==null?void 0:z.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),T();break;case"VersionError":if(0<b)return b=0,T()}return _e.reject(z)})}var R,L=s.dbReadyResolve,U=null,j=!1;return _e.race([p,(typeof navigator>"u"?_e.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(z){function N(){return indexedDB.databases().finally(z)}R=setInterval(N,100),N()}).finally(function(){return clearInterval(R)}):Promise.resolve()).then(T)]).then(function(){return I(),s.onReadyBeingFired=[],_e.resolve(zo(function(){return o.on.ready.fire(o.vip)})).then(function z(){if(0<s.onReadyBeingFired.length){var N=s.onReadyBeingFired.reduce(qt,de);return s.onReadyBeingFired=[],_e.resolve(zo(function(){return N(o.vip)})).then(z)}})}).finally(function(){s.openCanceller===p&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(z){s.dbOpenError=z;try{U&&U.abort()}catch{}return p===s.openCanceller&&o._close(),lt(z)}).finally(function(){s.openComplete=!0,L()}).then(function(){var z;return j&&(z={},o.tables.forEach(function(N){N.schema.indexes.forEach(function(F){F.name&&(z["idb://".concat(o.name,"/").concat(N.name,"/").concat(F.name)]=new _t(-1/0,[[[]]]))}),z["idb://".concat(o.name,"/").concat(N.name,"/")]=z["idb://".concat(o.name,"/").concat(N.name,"/:dels")]=new _t(-1/0,[[[]]])}),Pn(Fr).fire(z),Go(z,!0)),o})}function Jo(o){function s(w){return o.next(w)}var f=b(s),p=b(function(w){return o.throw(w)});function b(w){return function(R){var T=w(R),R=T.value;return T.done?R:R&&typeof R.then=="function"?R.then(f,p):c(R)?Promise.all(R).then(f,p):f(R)}}return b(s)()}function ji(o,s,f){for(var p=c(o)?o.slice():[o],b=0;b<f;++b)p.push(s);return p}var Tf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(o){return r(r({},o),{table:function(s){var f=o.table(s),p=f.schema,b={},w=[];function I(j,z,N){var F=Br(j),K=b[F]=b[F]||[],M=j==null?0:typeof j=="string"?1:j.length,G=0<z,G=r(r({},N),{name:G?"".concat(F,"(virtual-from:").concat(N.name,")"):N.name,lowLevelIndex:N,isVirtual:G,keyTail:z,keyLength:M,extractKey:Mo(j),unique:!G&&N.unique});return K.push(G),G.isPrimaryKey||w.push(G),1<M&&I(M===2?j[0]:j.slice(0,M-1),z+1,N),K.sort(function(X,$){return X.keyTail-$.keyTail}),G}s=I(p.primaryKey.keyPath,0,p.primaryKey),b[":id"]=[s];for(var T=0,R=p.indexes;T<R.length;T++){var L=R[T];I(L.keyPath,0,L)}function U(j){var z,N=j.query.index;return N.isVirtual?r(r({},j),{query:{index:N.lowLevelIndex,range:(z=j.query.range,N=N.keyTail,{type:z.type===1?2:z.type,lower:ji(z.lower,z.lowerOpen?o.MAX_KEY:o.MIN_KEY,N),lowerOpen:!0,upper:ji(z.upper,z.upperOpen?o.MIN_KEY:o.MAX_KEY,N),upperOpen:!0})}}):j}return r(r({},f),{schema:r(r({},p),{primaryKey:s,indexes:w,getIndexByKeyPath:function(j){return(j=b[Br(j)])&&j[0]}}),count:function(j){return f.count(U(j))},query:function(j){return f.query(U(j))},openCursor:function(j){var z=j.query.index,N=z.keyTail,F=z.isVirtual,K=z.keyLength;return F?f.openCursor(U(j)).then(function(G){return G&&M(G)}):f.openCursor(j);function M(G){return Object.create(G,{continue:{value:function(X){X!=null?G.continue(ji(X,j.reverse?o.MAX_KEY:o.MIN_KEY,N)):j.unique?G.continue(G.key.slice(0,K).concat(j.reverse?o.MIN_KEY:o.MAX_KEY,N)):G.continue()}},continuePrimaryKey:{value:function(X,$){G.continuePrimaryKey(ji(X,o.MAX_KEY,N),$)}},primaryKey:{get:function(){return G.primaryKey}},key:{get:function(){var X=G.key;return K===1?X[0]:X.slice(0,K)}},value:{get:function(){return G.value}}})}}})}})}};function Qo(o,s,f,p){return f=f||{},p=p||"",l(o).forEach(function(b){var w,I,T;m(s,b)?(w=o[b],I=s[b],typeof w=="object"&&typeof I=="object"&&w&&I?(T=oe(w))!==oe(I)?f[p+b]=s[b]:T==="Object"?Qo(w,I,f,p+b+"."):w!==I&&(f[p+b]=s[b]):w!==I&&(f[p+b]=s[b])):f[p+b]=void 0}),l(s).forEach(function(b){m(o,b)||(f[p+b]=s[b])}),f}function Zo(o,s){return s.type==="delete"?s.keys:s.keys||s.values.map(o.extractKey)}var jf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return r(r({},o),{table:function(s){var f=o.table(s),p=f.schema.primaryKey;return r(r({},f),{mutate:function(b){var w=Ee.trans,I=w.table(s).hook,T=I.deleting,R=I.creating,L=I.updating;switch(b.type){case"add":if(R.fire===de)break;return w._promise("readwrite",function(){return U(b)},!0);case"put":if(R.fire===de&&L.fire===de)break;return w._promise("readwrite",function(){return U(b)},!0);case"delete":if(T.fire===de)break;return w._promise("readwrite",function(){return U(b)},!0);case"deleteRange":if(T.fire===de)break;return w._promise("readwrite",function(){return function j(z,N,F){return f.query({trans:z,values:!1,query:{index:p,range:N},limit:F}).then(function(K){var M=K.result;return U({type:"delete",keys:M,trans:z}).then(function(G){return 0<G.numFailures?Promise.reject(G.failures[0]):M.length<F?{failures:[],numFailures:0,lastResult:void 0}:j(z,r(r({},N),{lower:M[M.length-1],lowerOpen:!0}),F)})})}(b.trans,b.range,1e4)},!0)}return f.mutate(b);function U(j){var z,N,F,K=Ee.trans,M=j.keys||Zo(p,j);if(!M)throw new Error("Keys missing");return(j=j.type==="add"||j.type==="put"?r(r({},j),{keys:M}):r({},j)).type!=="delete"&&(j.values=i([],j.values)),j.keys&&(j.keys=i([],j.keys)),z=f,F=M,((N=j).type==="add"?Promise.resolve([]):z.getMany({trans:N.trans,keys:F,cache:"immutable"})).then(function(G){var X=M.map(function($,ie){var le,me,ue,ve=G[ie],ge={onerror:null,onsuccess:null};return j.type==="delete"?T.fire.call(ge,$,ve,K):j.type==="add"||ve===void 0?(le=R.fire.call(ge,$,j.values[ie],K),$==null&&le!=null&&(j.keys[ie]=$=le,p.outbound||W(j.values[ie],p.keyPath,$))):(le=Qo(ve,j.values[ie]),(me=L.fire.call(ge,le,$,ve,K))&&(ue=j.values[ie],Object.keys(me).forEach(function(ye){m(ue,ye)?ue[ye]=me[ye]:W(ue,ye,me[ye])}))),ge});return f.mutate(j).then(function($){for(var ie=$.failures,le=$.results,me=$.numFailures,$=$.lastResult,ue=0;ue<M.length;++ue){var ve=(le||M)[ue],ge=X[ue];ve==null?ge.onerror&&ge.onerror(ie[ue]):ge.onsuccess&&ge.onsuccess(j.type==="put"&&G[ue]?j.values[ue]:ve)}return{failures:ie,results:le,numFailures:me,lastResult:$}}).catch(function($){return X.forEach(function(ie){return ie.onerror&&ie.onerror($)}),Promise.reject($)})})}}})}})}};function Ks(o,s,f){try{if(!s||s.keys.length<o.length)return null;for(var p=[],b=0,w=0;b<s.keys.length&&w<o.length;++b)We(s.keys[b],o[w])===0&&(p.push(f?V(s.values[b]):s.values[b]),++w);return p.length===o.length?p:null}catch{return null}}var Df={stack:"dbcore",level:-1,create:function(o){return{table:function(s){var f=o.table(s);return r(r({},f),{getMany:function(p){if(!p.cache)return f.getMany(p);var b=Ks(p.keys,p.trans._cache,p.cache==="clone");return b?_e.resolve(b):f.getMany(p).then(function(w){return p.trans._cache={keys:p.keys,values:p.cache==="clone"?V(w):w},w})},mutate:function(p){return p.type!=="add"&&(p.trans._cache=null),f.mutate(p)}})}}}};function zs(o,s){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function Vs(o,s){switch(o){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Rf={stack:"dbcore",level:0,name:"Observability",create:function(o){var s=o.schema.name,f=new _t(o.MIN_KEY,o.MAX_KEY);return r(r({},o),{transaction:function(p,b,w){if(Ee.subscr&&b!=="readonly")throw new Se.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ee.querier));return o.transaction(p,b,w)},table:function(p){var b=o.table(p),w=b.schema,I=w.primaryKey,j=w.indexes,T=I.extractKey,R=I.outbound,L=I.autoIncrement&&j.filter(function(N){return N.compound&&N.keyPath.includes(I.keyPath)}),U=r(r({},b),{mutate:function(N){function F(ye){return ye="idb://".concat(s,"/").concat(p,"/").concat(ye),$[ye]||($[ye]=new _t)}var K,M,G,X=N.trans,$=N.mutatedParts||(N.mutatedParts={}),ie=F(""),le=F(":dels"),me=N.type,ge=N.type==="deleteRange"?[N.range]:N.type==="delete"?[N.keys]:N.values.length<50?[Zo(I,N).filter(function(ye){return ye}),N.values]:[],ue=ge[0],ve=ge[1],ge=N.trans._cache;return c(ue)?(ie.addKeys(ue),(ge=me==="delete"||ue.length===ve.length?Ks(ue,ge):null)||le.addKeys(ue),(ge||ve)&&(K=F,M=ge,G=ve,w.indexes.forEach(function(ye){var xe=K(ye.name||"");function qe(Ke){return Ke!=null?ye.extractKey(Ke):null}function Be(Ke){return ye.multiEntry&&c(Ke)?Ke.forEach(function(jt){return xe.addKey(jt)}):xe.addKey(Ke)}(M||G).forEach(function(Ke,wt){var Me=M&&qe(M[wt]),wt=G&&qe(G[wt]);We(Me,wt)!==0&&(Me!=null&&Be(Me),wt!=null&&Be(wt))})}))):ue?(ve={from:(ve=ue.lower)!==null&&ve!==void 0?ve:o.MIN_KEY,to:(ve=ue.upper)!==null&&ve!==void 0?ve:o.MAX_KEY},le.add(ve),ie.add(ve)):(ie.add(f),le.add(f),w.indexes.forEach(function(ye){return F(ye.name).add(f)})),b.mutate(N).then(function(ye){return!ue||N.type!=="add"&&N.type!=="put"||(ie.addKeys(ye.results),L&&L.forEach(function(xe){for(var qe=N.values.map(function(Me){return xe.extractKey(Me)}),Be=xe.keyPath.findIndex(function(Me){return Me===I.keyPath}),Ke=0,jt=ye.results.length;Ke<jt;++Ke)qe[Ke][Be]=ye.results[Ke];F(xe.name).addKeys(qe)})),X.mutatedParts=Pi(X.mutatedParts||{},$),ye})}}),j=function(F){var K=F.query,F=K.index,K=K.range;return[F,new _t((F=K.lower)!==null&&F!==void 0?F:o.MIN_KEY,(K=K.upper)!==null&&K!==void 0?K:o.MAX_KEY)]},z={get:function(N){return[I,new _t(N.key)]},getMany:function(N){return[I,new _t().addKeys(N.keys)]},count:j,query:j,openCursor:j};return l(z).forEach(function(N){U[N]=function(F){var K=Ee.subscr,M=!!K,G=zs(Ee,b)&&Vs(N,F)?F.obsSet={}:K;if(M){var X=function(ve){return ve="idb://".concat(s,"/").concat(p,"/").concat(ve),G[ve]||(G[ve]=new _t)},$=X(""),ie=X(":dels"),K=z[N](F),M=K[0],K=K[1];if((N==="query"&&M.isPrimaryKey&&!F.values?ie:X(M.name||"")).add(K),!M.isPrimaryKey){if(N!=="count"){var le=N==="query"&&R&&F.values&&b.query(r(r({},F),{values:!1}));return b[N].apply(this,arguments).then(function(ve){if(N==="query"){if(R&&F.values)return le.then(function(qe){return qe=qe.result,$.addKeys(qe),ve});var ge=F.values?ve.result.map(T):ve.result;(F.values?$:ie).addKeys(ge)}else if(N==="openCursor"){var ye=ve,xe=F.values;return ye&&Object.create(ye,{key:{get:function(){return ie.addKey(ye.primaryKey),ye.key}},primaryKey:{get:function(){var qe=ye.primaryKey;return ie.addKey(qe),qe}},value:{get:function(){return xe&&$.addKey(ye.primaryKey),ye.value}}})}return ve})}ie.add(f)}}return b[N].apply(this,arguments)}}),U}})}};function Ws(o,s,f){if(f.numFailures===0)return s;if(s.type==="deleteRange")return null;var p=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1;return f.numFailures===p?null:(s=r({},s),c(s.keys)&&(s.keys=s.keys.filter(function(b,w){return!(w in f.failures)})),"values"in s&&c(s.values)&&(s.values=s.values.filter(function(b,w){return!(w in f.failures)})),s)}function Xo(o,s){return f=o,((p=s).lower===void 0||(p.lowerOpen?0<We(f,p.lower):0<=We(f,p.lower)))&&(o=o,(s=s).upper===void 0||(s.upperOpen?We(o,s.upper)<0:We(o,s.upper)<=0));var f,p}function Hs(o,s,z,p,b,w){if(!z||z.length===0)return o;var I=s.query.index,T=I.multiEntry,R=s.query.range,L=p.schema.primaryKey.extractKey,U=I.extractKey,j=(I.lowLevelIndex||I).extractKey,z=z.reduce(function(N,F){var K=N,M=[];if(F.type==="add"||F.type==="put")for(var G=new _t,X=F.values.length-1;0<=X;--X){var $,ie=F.values[X],le=L(ie);G.hasKey(le)||($=U(ie),(T&&c($)?$.some(function(ye){return Xo(ye,R)}):Xo($,R))&&(G.addKey(le),M.push(ie)))}switch(F.type){case"add":var me=new _t().addKeys(s.values?N.map(function(xe){return L(xe)}):N),K=N.concat(s.values?M.filter(function(xe){return xe=L(xe),!me.hasKey(xe)&&(me.addKey(xe),!0)}):M.map(function(xe){return L(xe)}).filter(function(xe){return!me.hasKey(xe)&&(me.addKey(xe),!0)}));break;case"put":var ue=new _t().addKeys(F.values.map(function(xe){return L(xe)}));K=N.filter(function(xe){return!ue.hasKey(s.values?L(xe):xe)}).concat(s.values?M:M.map(function(xe){return L(xe)}));break;case"delete":var ve=new _t().addKeys(F.keys);K=N.filter(function(xe){return!ve.hasKey(s.values?L(xe):xe)});break;case"deleteRange":var ge=F.range;K=N.filter(function(xe){return!Xo(L(xe),ge)})}return K},o);return z===o?o:(z.sort(function(N,F){return We(j(N),j(F))||We(L(N),L(F))}),s.limit&&s.limit<1/0&&(z.length>s.limit?z.length=s.limit:o.length===s.limit&&z.length<s.limit&&(b.dirty=!0)),w?Object.freeze(z):z)}function Ys(o,s){return We(o.lower,s.lower)===0&&We(o.upper,s.upper)===0&&!!o.lowerOpen==!!s.lowerOpen&&!!o.upperOpen==!!s.upperOpen}function Nf(o,s){return function(f,p,b,w){if(f===void 0)return p!==void 0?-1:0;if(p===void 0)return 1;if((p=We(f,p))===0){if(b&&w)return 0;if(b)return 1;if(w)return-1}return p}(o.lower,s.lower,o.lowerOpen,s.lowerOpen)<=0&&0<=function(f,p,b,w){if(f===void 0)return p!==void 0?1:0;if(p===void 0)return-1;if((p=We(f,p))===0){if(b&&w)return 0;if(b)return-1;if(w)return 1}return p}(o.upper,s.upper,o.upperOpen,s.upperOpen)}function Lf(o,s,f,p){o.subscribers.add(f),p.addEventListener("abort",function(){var b,w;o.subscribers.delete(f),o.subscribers.size===0&&(b=o,w=s,setTimeout(function(){b.subscribers.size===0&&Te(w,b)},3e3))})}var Mf={stack:"dbcore",level:0,name:"Cache",create:function(o){var s=o.schema.name;return r(r({},o),{transaction:function(f,p,b){var w,I,T=o.transaction(f,p,b);return p==="readwrite"&&(I=(w=new AbortController).signal,b=function(R){return function(){if(w.abort(),p==="readwrite"){for(var L=new Set,U=0,j=f;U<j.length;U++){var z=j[U],N=zn["idb://".concat(s,"/").concat(z)];if(N){var F=o.table(z),K=N.optimisticOps.filter(function(xe){return xe.trans===T});if(T._explicit&&R&&T.mutatedParts)for(var M=0,G=Object.values(N.queries.query);M<G.length;M++)for(var X=0,$=(me=G[M]).slice();X<$.length;X++)Wo((ue=$[X]).obsSet,T.mutatedParts)&&(Te(me,ue),ue.subscribers.forEach(function(xe){return L.add(xe)}));else if(0<K.length){N.optimisticOps=N.optimisticOps.filter(function(xe){return xe.trans!==T});for(var ie=0,le=Object.values(N.queries.query);ie<le.length;ie++)for(var me,ue,ve,ge=0,ye=(me=le[ie]).slice();ge<ye.length;ge++)(ue=ye[ge]).res!=null&&T.mutatedParts&&(R&&!ue.dirty?(ve=Object.isFrozen(ue.res),ve=Hs(ue.res,ue.req,K,F,ue,ve),ue.dirty?(Te(me,ue),ue.subscribers.forEach(function(xe){return L.add(xe)})):ve!==ue.res&&(ue.res=ve,ue.promise=_e.resolve({result:ve}))):(ue.dirty&&Te(me,ue),ue.subscribers.forEach(function(xe){return L.add(xe)})))}}}L.forEach(function(xe){return xe()})}}},T.addEventListener("abort",b(!1),{signal:I}),T.addEventListener("error",b(!1),{signal:I}),T.addEventListener("complete",b(!0),{signal:I})),T},table:function(f){var p=o.table(f),b=p.schema.primaryKey;return r(r({},p),{mutate:function(w){var I=Ee.trans;if(b.outbound||I.db._options.cache==="disabled"||I.explicit||I.idbtrans.mode!=="readwrite")return p.mutate(w);var T=zn["idb://".concat(s,"/").concat(f)];return T?(I=p.mutate(w),w.type!=="add"&&w.type!=="put"||!(50<=w.values.length||Zo(b,w).some(function(R){return R==null}))?(T.optimisticOps.push(w),w.mutatedParts&&Ti(w.mutatedParts),I.then(function(R){0<R.numFailures&&(Te(T.optimisticOps,w),(R=Ws(0,w,R))&&T.optimisticOps.push(R),w.mutatedParts&&Ti(w.mutatedParts))}),I.catch(function(){Te(T.optimisticOps,w),w.mutatedParts&&Ti(w.mutatedParts)})):I.then(function(R){var L=Ws(0,r(r({},w),{values:w.values.map(function(U,j){var z;return R.failures[j]?U:(U=(z=b.keyPath)!==null&&z!==void 0&&z.includes(".")?V(U):r({},U),W(U,b.keyPath,R.results[j]),U)})}),R);T.optimisticOps.push(L),queueMicrotask(function(){return w.mutatedParts&&Ti(w.mutatedParts)})}),I):p.mutate(w)},query:function(w){if(!zs(Ee,p)||!Vs("query",w))return p.query(w);var I=((L=Ee.trans)===null||L===void 0?void 0:L.db._options.cache)==="immutable",j=Ee,T=j.requery,R=j.signal,L=function(F,K,M,G){var X=zn["idb://".concat(F,"/").concat(K)];if(!X)return[];if(!(K=X.queries[M]))return[null,!1,X,null];var $=K[(G.query?G.query.index.name:null)||""];if(!$)return[null,!1,X,null];switch(M){case"query":var ie=$.find(function(le){return le.req.limit===G.limit&&le.req.values===G.values&&Ys(le.req.query.range,G.query.range)});return ie?[ie,!0,X,$]:[$.find(function(le){return("limit"in le.req?le.req.limit:1/0)>=G.limit&&(!G.values||le.req.values)&&Nf(le.req.query.range,G.query.range)}),!1,X,$];case"count":return ie=$.find(function(le){return Ys(le.req.query.range,G.query.range)}),[ie,!!ie,X,$]}}(s,f,"query",w),U=L[0],j=L[1],z=L[2],N=L[3];return U&&j?U.obsSet=w.obsSet:(j=p.query(w).then(function(F){var K=F.result;if(U&&(U.res=K),I){for(var M=0,G=K.length;M<G;++M)Object.freeze(K[M]);Object.freeze(K)}else F.result=V(K);return F}).catch(function(F){return N&&U&&Te(N,U),Promise.reject(F)}),U={obsSet:w.obsSet,promise:j,subscribers:new Set,type:"query",req:w,dirty:!1},N?N.push(U):(N=[U],(z=z||(zn["idb://".concat(s,"/").concat(f)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[w.query.index.name||""]=N)),Lf(U,N,T,R),U.promise.then(function(F){return{result:Hs(F.result,w,z==null?void 0:z.optimisticOps,p,U,I)}})}})}})}};function Di(o,s){return new Proxy(o,{get:function(f,p,b){return p==="db"?s:Reflect.get(f,p,b)}})}var hn=(ut.prototype.version=function(o){if(isNaN(o)||o<.1)throw new Se.Type("Given version is not a positive number");if(o=Math.round(10*o)/10,this.idbdb||this._state.isBeingOpened)throw new Se.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,o);var s=this._versions,f=s.filter(function(p){return p._cfg.version===o})[0];return f||(f=new this.Version(o),s.push(f),s.sort(Ef),f.stores({}),this._state.autoSchema=!1,f)},ut.prototype._whenReady=function(o){var s=this;return this.idbdb&&(this._state.openComplete||Ee.letThrough||this._vip)?o():new _e(function(f,p){if(s._state.openComplete)return p(new Se.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void p(new Se.DatabaseClosed);s.open().catch(de)}s._state.dbReadyPromise.then(f,p)}).then(o)},ut.prototype.use=function(o){var s=o.stack,f=o.create,p=o.level,b=o.name;return b&&this.unuse({stack:s,name:b}),o=this._middlewares[s]||(this._middlewares[s]=[]),o.push({stack:s,create:f,level:p??10,name:b}),o.sort(function(w,I){return w.level-I.level}),this},ut.prototype.unuse=function(o){var s=o.stack,f=o.name,p=o.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(b){return p?b.create!==p:!!f&&b.name!==f})),this},ut.prototype.open=function(){var o=this;return Un(Bt,function(){return Pf(o)})},ut.prototype._close=function(){var o=this._state,s=rr.indexOf(this);if(0<=s&&rr.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}o.isBeingOpened||(o.dbReadyPromise=new _e(function(f){o.dbReadyResolve=f}),o.openCanceller=new _e(function(f,p){o.cancelOpen=p}))},ut.prototype.close=function(f){var s=(f===void 0?{disableAutoOpen:!0}:f).disableAutoOpen,f=this._state;s?(f.isBeingOpened&&f.cancelOpen(new Se.DatabaseClosed),this._close(),f.autoOpen=!1,f.dbOpenError=new Se.DatabaseClosed):(this._close(),f.autoOpen=this._options.autoOpen||f.isBeingOpened,f.openComplete=!1,f.dbOpenError=null)},ut.prototype.delete=function(o){var s=this;o===void 0&&(o={disableAutoOpen:!0});var f=0<arguments.length&&typeof arguments[0]!="object",p=this._state;return new _e(function(b,w){function I(){s.close(o);var T=s._deps.indexedDB.deleteDatabase(s.name);T.onsuccess=et(function(){var R,L,U;R=s._deps,L=s.name,U=R.indexedDB,R=R.IDBKeyRange,Ko(U)||L===gi||Bo(U,R).delete(L).catch(de),b()}),T.onerror=on(w),T.onblocked=s._fireOnBlocked}if(f)throw new Se.InvalidArgument("Invalid closeOptions argument to db.delete()");p.isBeingOpened?p.dbReadyPromise.then(I):I()})},ut.prototype.backendDB=function(){return this.idbdb},ut.prototype.isOpen=function(){return this.idbdb!==null},ut.prototype.hasBeenClosed=function(){var o=this._state.dbOpenError;return o&&o.name==="DatabaseClosed"},ut.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ut.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ut.prototype,"tables",{get:function(){var o=this;return l(this._allTables).map(function(s){return o._allTables[s]})},enumerable:!1,configurable:!0}),ut.prototype.transaction=function(){var o=(function(s,f,p){var b=arguments.length;if(b<2)throw new Se.InvalidArgument("Too few arguments");for(var w=new Array(b-1);--b;)w[b-1]=arguments[b];return p=w.pop(),[s,Y(w),p]}).apply(this,arguments);return this._transaction.apply(this,o)},ut.prototype._transaction=function(o,s,f){var p=this,b=Ee.trans;b&&b.db===this&&o.indexOf("!")===-1||(b=null);var w,I,T=o.indexOf("?")!==-1;o=o.replace("!","").replace("?","");try{if(I=s.map(function(L){if(L=L instanceof p.Table?L.name:L,typeof L!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return L}),o=="r"||o===Ao)w=Ao;else{if(o!="rw"&&o!=Po)throw new Se.InvalidArgument("Invalid transaction mode: "+o);w=Po}if(b){if(b.mode===Ao&&w===Po){if(!T)throw new Se.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");b=null}b&&I.forEach(function(L){if(b&&b.storeNames.indexOf(L)===-1){if(!T)throw new Se.SubTransaction("Table "+L+" not included in parent transaction.");b=null}}),T&&b&&!b.active&&(b=null)}}catch(L){return b?b._promise(null,function(U,j){j(L)}):lt(L)}var R=(function L(U,j,z,N,F){return _e.resolve().then(function(){var K=Ee.transless||Ee,M=U._createTransaction(j,z,U._dbSchema,N);if(M.explicit=!0,K={trans:M,transless:K},N)M.idbtrans=N.idbtrans;else try{M.create(),M.idbtrans._explicit=!0,U._state.PR1398_maxLoop=3}catch($){return $.name===It.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return L(U,j,z,null,F)})):lt($)}var G,X=Ne(F);return X&&On(),K=_e.follow(function(){var $;(G=F.call(M,M))&&(X?($=Et.bind(null,null),G.then($,$)):typeof G.next=="function"&&typeof G.throw=="function"&&(G=Jo(G)))},K),(G&&typeof G.then=="function"?_e.resolve(G).then(function($){return M.active?$:lt(new Se.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):K.then(function(){return G})).then(function($){return N&&M._resolve(),M._completion.then(function(){return $})}).catch(function($){return M._reject($),lt($)})})}).bind(null,this,w,I,b,f);return b?b._promise(w,R,"lock"):Ee.trans?Un(Ee.transless,function(){return p._whenReady(R)}):this._whenReady(R)},ut.prototype.table=function(o){if(!m(this._allTables,o))throw new Se.InvalidTable("Table ".concat(o," does not exist"));return this._allTables[o]},ut);function ut(o,s){var f=this;this._middlewares={},this.verno=0;var p=ut.dependencies;this._options=s=r({addons:ut.addons,autoOpen:!0,indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},p=s.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var b,w,I,T,R,L={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:de,dbReadyPromise:null,cancelOpen:de,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen};L.dbReadyPromise=new _e(function(j){L.dbReadyResolve=j}),L.openCanceller=new _e(function(j,z){L.cancelOpen=z}),this._state=L,this.name=o,this.on=Nr(this,"populate","blocked","versionchange","close",{ready:[qt,de]}),this.on.ready.subscribe=x(this.on.ready.subscribe,function(j){return function(z,N){ut.vip(function(){var F,K=f._state;K.openComplete?(K.dbOpenError||_e.resolve().then(z),N&&j(z)):K.onReadyBeingFired?(K.onReadyBeingFired.push(z),N&&j(z)):(j(z),F=f,N||j(function M(){F.on.ready.unsubscribe(z),F.on.ready.unsubscribe(M)}))})}}),this.Collection=(b=this,Lr(bf.prototype,function(G,M){this.db=b;var N=Ss,F=null;if(M)try{N=M()}catch(X){F=X}var K=G._ctx,M=K.table,G=M.hook.reading.fire;this._ctx={table:M,index:K.index,isPrimKey:!K.index||M.schema.primKey.keyPath&&K.index===M.schema.primKey.name,range:N,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:F,or:K.or,valueMapper:G!==De?G:null}})),this.Table=(w=this,Lr(Cs.prototype,function(j,z,N){this.db=w,this._tx=N,this.name=j,this.schema=z,this.hook=w._allTables[j]?w._allTables[j].hook:Nr(null,{creating:[Sn,de],reading:[Ce,De],updating:[bt,de],deleting:[gt,de]})})),this.Transaction=(I=this,Lr(kf.prototype,function(j,z,N,F,K){var M=this;this.db=I,this.mode=j,this.storeNames=z,this.schema=N,this.chromeTransactionDurability=F,this.idbtrans=null,this.on=Nr(this,"complete","error","abort"),this.parent=K||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new _e(function(G,X){M._resolve=G,M._reject=X}),this._completion.then(function(){M.active=!1,M.on.complete.fire()},function(G){var X=M.active;return M.active=!1,M.on.error.fire(G),M.parent?M.parent._reject(G):X&&M.idbtrans&&M.idbtrans.abort(),lt(G)})})),this.Version=(T=this,Lr(Af.prototype,function(j){this.db=T,this._cfg={version:j,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(R=this,Lr(Ds.prototype,function(j,z,N){if(this.db=R,this._ctx={table:j,index:z===":id"?null:z,or:N},this._cmp=this._ascending=We,this._descending=function(F,K){return We(K,F)},this._max=function(F,K){return 0<We(F,K)?F:K},this._min=function(F,K){return We(F,K)<0?F:K},this._IDBKeyRange=R._deps.IDBKeyRange,!this._IDBKeyRange)throw new Se.MissingAPI})),this.on("versionchange",function(j){0<j.newVersion?console.warn("Another connection wants to upgrade database '".concat(f.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(f.name,"'. Closing db now to resume the delete request.")),f.close({disableAutoOpen:!1})}),this.on("blocked",function(j){!j.newVersion||j.newVersion<j.oldVersion?console.warn("Dexie.delete('".concat(f.name,"') was blocked")):console.warn("Upgrade '".concat(f.name,"' blocked by other connection holding version ").concat(j.oldVersion/10))}),this._maxKey=Ur(s.IDBKeyRange),this._createTransaction=function(j,z,N,F){return new f.Transaction(j,z,N,f._options.chromeTransactionDurability,F)},this._fireOnBlocked=function(j){f.on("blocked").fire(j),rr.filter(function(z){return z.name===f.name&&z!==f&&!z._state.vcFired}).map(function(z){return z.on("versionchange").fire(j)})},this.use(Df),this.use(Mf),this.use(Rf),this.use(Tf),this.use(jf);var U=new Proxy(this,{get:function(j,z,N){if(z==="_vip")return!0;if(z==="table")return function(K){return Di(f.table(K),U)};var F=Reflect.get(j,z,N);return F instanceof Cs?Di(F,U):z==="tables"?F.map(function(K){return Di(K,U)}):z==="_createTransaction"?function(){return Di(F.apply(this,arguments),U)}:F}});this.vip=U,p.forEach(function(j){return j(f)})}var Ri,Vt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",qf=($o.prototype.subscribe=function(o,s,f){return this._subscribe(o&&typeof o!="function"?o:{next:o,error:s,complete:f})},$o.prototype[Vt]=function(){return this},$o);function $o(o){this._subscribe=o}try{Ri={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Ri={indexedDB:null,IDBKeyRange:null}}function Gs(o){var s,f=!1,p=new qf(function(b){var w=Ne(o),I,T=!1,R={},L={},U={get closed(){return T},unsubscribe:function(){T||(T=!0,I&&I.abort(),j&&Pn.storagemutated.unsubscribe(N))}};b.start&&b.start(U);var j=!1,z=function(){return Co(F)},N=function(K){Pi(R,K),Wo(L,R)&&z()},F=function(){var K,M,G;!T&&Ri.indexedDB&&(R={},K={},I&&I.abort(),I=new AbortController,G=function(X){var $=En();try{w&&On();var ie=rn(o,X);return ie=w?ie.finally(Et):ie}finally{$&&Pt()}}(M={subscr:K,signal:I.signal,requery:z,querier:o,trans:null}),Promise.resolve(G).then(function(X){f=!0,s=X,T||M.signal.aborted||(R={},function($){for(var ie in $)if(m($,ie))return;return 1}(L=K)||j||(Pn(Fr,N),j=!0),Co(function(){return!T&&b.next&&b.next(X)}))},function(X){f=!1,["DatabaseClosedError","AbortError"].includes(X==null?void 0:X.name)||T||Co(function(){T||b.error&&b.error(X)})}))};return setTimeout(z,0),U});return p.hasValue=function(){return f},p.getValue=function(){return s},p}var Vn=hn;function ea(o){var s=Tn;try{Tn=!0,Pn.storagemutated.fire(o),Go(o,!0)}finally{Tn=s}}y(Vn,r(r({},ae),{delete:function(o){return new Vn(o,{addons:[]}).delete()},exists:function(o){return new Vn(o,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return s=Vn.dependencies,f=s.indexedDB,s=s.IDBKeyRange,(Ko(f)?Promise.resolve(f.databases()).then(function(p){return p.map(function(b){return b.name}).filter(function(b){return b!==gi})}):Bo(f,s).toCollection().primaryKeys()).then(o)}catch{return lt(new Se.MissingAPI)}var s,f},defineClass:function(){return function(o){d(this,o)}},ignoreTransaction:function(o){return Ee.trans?Un(Ee.transless,o):o()},vip:zo,async:function(o){return function(){try{var s=Jo(o.apply(this,arguments));return s&&typeof s.then=="function"?s:_e.resolve(s)}catch(f){return lt(f)}}},spawn:function(o,s,f){try{var p=Jo(o.apply(f,s||[]));return p&&typeof p.then=="function"?p:_e.resolve(p)}catch(b){return lt(b)}},currentTransaction:{get:function(){return Ee.trans||null}},waitFor:function(o,s){return s=_e.resolve(typeof o=="function"?Vn.ignoreTransaction(o):o).timeout(s||6e4),Ee.trans?Ee.trans.waitFor(s):s},Promise:_e,debug:{get:function(){return Xe},set:function(o){Wt(o)}},derive:k,extend:d,props:y,override:x,Events:Nr,on:Pn,liveQuery:Gs,extendObservabilitySet:Pi,getByKeyPath:D,setByKeyPath:W,delByKeyPath:function(o,s){typeof s=="string"?W(o,s,void 0):"length"in s&&[].map.call(s,function(f){W(o,f,void 0)})},shallowClone:te,deepClone:V,getObjectDiff:Qo,cmp:We,asap:q,minKey:-1/0,addons:[],connections:rr,errnames:It,dependencies:Ri,cache:zn,semVer:"4.0.11",version:"4.0.11".split(".").map(function(o){return parseInt(o)}).reduce(function(o,s,f){return o+s/Math.pow(10,2*f)})})),Vn.maxKey=Ur(Vn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Pn(Fr,function(o){Tn||(o=new CustomEvent(Ro,{detail:o}),Tn=!0,dispatchEvent(o),Tn=!1)}),addEventListener(Ro,function(o){o=o.detail,Tn||ea(o)}));var ar,Tn=!1,Js=function(){};return typeof BroadcastChannel<"u"&&((Js=function(){(ar=new BroadcastChannel(Ro)).onmessage=function(o){return o.data&&ea(o.data)}})(),typeof ar.unref=="function"&&ar.unref(),Pn(Fr,function(o){Tn||ar.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!hn.disableBfCache&&o.persisted){Xe&&console.debug("Dexie: handling persisted pagehide"),ar!=null&&ar.close();for(var s=0,f=rr;s<f.length;s++)f[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(o){!hn.disableBfCache&&o.persisted&&(Xe&&console.debug("Dexie: handling persisted pageshow"),Js(),ea({all:new _t(-1/0,[[]])}))})),_e.rejectionMapper=function(o,s){return!o||o instanceof Fe||o instanceof TypeError||o instanceof SyntaxError||!o.name||!re[o.name]?o:(s=new re[o.name](s||o.message,o),"stack"in o&&_(s,"stack",{get:function(){return this.inner.stack}}),s)},Wt(Xe),r(hn,Object.freeze({__proto__:null,Dexie:hn,liveQuery:Gs,Entity:Is,cmp:We,PropModification:Mr,replacePrefix:function(o,s){return new Mr({replacePrefix:[o,s]})},add:function(o){return new Mr({add:o})},remove:function(o){return new Mr({remove:o})},default:hn,RangeSet:_t,mergeRanges:zr,rangesOverlap:qs}),{default:hn}),hn})}(Ji)),Ji.exports}var eh=$v();const Ca=Zv(eh),bl=Symbol.for("Dexie"),at=globalThis[bl]||(globalThis[bl]=Ca);if(Ca.semVer!==at.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ca.semVer} and ${at.semVer}`);const{liveQuery:fr,mergeRanges:Nb,rangesOverlap:Lb,RangeSet:Mb,cmp:th,Entity:qb,PropModification:_l,replacePrefix:Fb,add:Ub,remove:Bb}=at;var Aa=function(e,t){return Aa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Aa(e,t)};function kn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Aa(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function nh(e,t,n,r){function i(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function c(u){try{v(r.next(u))}catch(m){l(m)}}function d(u){try{v(r.throw(u))}catch(m){l(m)}}function v(u){u.done?a(u.value):i(u.value).then(c,d)}v((r=r.apply(e,t||[])).next())})}function Ju(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(v){return function(u){return d([v,u])}}function d(v){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,v[0]&&(n=0)),n;)try{if(r=1,i&&(a=v[0]&2?i.return:v[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,v[1])).done)return a;switch(i=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return n.label++,{value:v[1],done:!1};case 5:n.label++,i=v[1],v=[0];continue;case 7:v=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){n=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){n.label=v[1];break}if(v[0]===6&&n.label<a[1]){n.label=a[1],a=v;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(v);break}a[2]&&n.ops.pop(),n.trys.pop();continue}v=t.call(e,n)}catch(u){v=[6,u],i=0}finally{r=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}function br(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qn(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],l;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){l={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(l)throw l.error}}return a}function _r(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function dr(e){return this instanceof dr?(this.v=e,this):new dr(e)}function rh(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(g){return function(_){return Promise.resolve(_).then(g,m)}}function c(g,_){r[g]&&(i[g]=function(k){return new Promise(function(O,C){a.push([g,k,O,C])>1||d(g,k)})},_&&(i[g]=_(i[g])))}function d(g,_){try{v(r[g](_))}catch(k){y(a[0][3],k)}}function v(g){g.value instanceof dr?Promise.resolve(g.value.v).then(u,m):y(a[0][2],g)}function u(g){d("next",g)}function m(g){d("throw",g)}function y(g,_){g(_),a.shift(),a.length&&d(a[0][0],a[0][1])}}function ih(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof br=="function"?br(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=e[a]&&function(l){return new Promise(function(c,d){l=e[a](l),i(c,d,l.done,l.value)})}}function i(a,l,c,d){Promise.resolve(d).then(function(v){a({value:v,done:c})},l)}}function $e(e){return typeof e=="function"}function rs(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var fa=rs(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function no(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Or=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,i,a;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var c=br(l),d=c.next();!d.done;d=c.next()){var v=d.value;v.remove(this)}}catch(k){t={error:k}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}else l.remove(this);var u=this.initialTeardown;if($e(u))try{u()}catch(k){a=k instanceof fa?k.errors:[k]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var y=br(m),g=y.next();!g.done;g=y.next()){var _=g.value;try{wl(_)}catch(k){a=a??[],k instanceof fa?a=_r(_r([],Qn(a)),Qn(k.errors)):a.push(k)}}}catch(k){r={error:k}}finally{try{g&&!g.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}}if(a)throw new fa(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)wl(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&no(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&no(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Qu=Or.EMPTY;function Zu(e){return e instanceof Or||e&&"closed"in e&&$e(e.remove)&&$e(e.add)&&$e(e.unsubscribe)}function wl(e){$e(e)?e():e.unsubscribe()}var oh={Promise:void 0},ah={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,_r([e,t],Qn(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Xu(e){ah.setTimeout(function(){throw e})}function kl(){}function Qi(e){e()}var is=function(e){kn(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Zu(n)&&n.add(r)):r.destination=uh,r}return t.create=function(n,r,i){return new wr(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Or),sh=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Mi(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Mi(r)}else Mi(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Mi(n)}},e}(),wr=function(e){kn(t,e);function t(n,r,i){var a=e.call(this)||this,l;return $e(n)||!n?l={next:n??void 0,error:r??void 0,complete:i??void 0}:l=n,a.destination=new sh(l),a}return t}(is);function Mi(e){Xu(e)}function lh(e){throw e}var uh={closed:!0,next:kl,error:lh,complete:kl},os=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function go(e){return e}function ch(e){return e.length===0?go:e.length===1?e[0]:function(n){return e.reduce(function(r,i){return i(r)},n)}}var pt=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i=this,a=dh(t)?t:new wr(t,n,r);return Qi(function(){var l=i,c=l.operator,d=l.source;a.add(c?c.call(a,d):d?i._subscribe(a):i._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=xl(n),new n(function(i,a){var l=new wr({next:function(c){try{t(c)}catch(d){a(d),l.unsubscribe()}},error:a,complete:i});r.subscribe(l)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[os]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return ch(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=xl(t),new t(function(r,i){var a;n.subscribe(function(l){return a=l},function(l){return i(l)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function xl(e){var t;return(t=e??oh.Promise)!==null&&t!==void 0?t:Promise}function fh(e){return e&&$e(e.next)&&$e(e.error)&&$e(e.complete)}function dh(e){return e&&e instanceof is||fh(e)&&Zu(e)}function vh(e){return $e(e==null?void 0:e.lift)}function Cr(e){return function(t){if(vh(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function kr(e,t,n,r,i){return new hh(e,t,n,r,i)}var hh=function(e){kn(t,e);function t(n,r,i,a,l,c){var d=e.call(this,n)||this;return d.onFinalize=l,d.shouldUnsubscribe=c,d._next=r?function(v){try{r(v)}catch(u){n.error(u)}}:e.prototype._next,d._error=a?function(v){try{a(v)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,d._complete=i?function(){try{i()}catch(v){n.error(v)}finally{this.unsubscribe()}}:e.prototype._complete,d}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(is),ph=rs(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),fi=function(e){kn(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new Sl(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new ph},t.prototype.next=function(n){var r=this;Qi(function(){var i,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var l=br(r.currentObservers),c=l.next();!c.done;c=l.next()){var d=c.value;d.next(n)}}catch(v){i={error:v}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}})},t.prototype.error=function(n){var r=this;Qi(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},t.prototype.complete=function(){var n=this;Qi(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,i=this,a=i.hasError,l=i.isStopped,c=i.observers;return a||l?Qu:(this.currentObservers=null,c.push(n),new Or(function(){r.currentObservers=null,no(c,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,a=r.thrownError,l=r.isStopped;i?n.error(a):l&&n.complete()},t.prototype.asObservable=function(){var n=new pt;return n.source=this,n},t.create=function(n,r){return new Sl(n,r)},t}(pt),Sl=function(e){kn(t,e);function t(n,r){var i=e.call(this)||this;return i.destination=n,i.source=r,i}return t.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},t.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:Qu},t}(fi),Xt=function(e){kn(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,a=n._value;if(r)throw i;return this._throwIfClosed(),a},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(fi),yh={now:function(){return Date.now()}},mh=function(e){kn(t,e);function t(n,r){return e.call(this)||this}return t.prototype.schedule=function(n,r){return this},t}(Or),Il={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,_r([e,t],Qn(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},gh=function(e){kn(t,e);function t(n,r){var i=e.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return t.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var a=this.id,l=this.scheduler;return a!=null&&(this.id=this.recycleAsyncId(l,a,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(l,this.id,r),this},t.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),Il.setInterval(n.flush.bind(n,this),i)},t.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&Il.clearInterval(r)},t.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(n,r){var i=!1,a;try{this.work(n)}catch(l){i=!0,a=l||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),a},t.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,a=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,no(a,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(mh),El=function(){function e(t,n){n===void 0&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(t,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,t).schedule(r,n)},e.now=yh.now,e}(),bh=function(e){kn(t,e);function t(n,r){r===void 0&&(r=El.now);var i=e.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return t.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},t}(El),_h=new bh(gh),wh=_h,kh=new pt(function(e){return e.complete()});function xh(e){return e&&$e(e.schedule)}function as(e){return e[e.length-1]}function Sh(e){return $e(as(e))?e.pop():void 0}function ss(e){return xh(as(e))?e.pop():void 0}function Ih(e,t){return typeof as(e)=="number"?e.pop():t}var ls=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function $u(e){return $e(e==null?void 0:e.then)}function ec(e){return $e(e[os])}function tc(e){return Symbol.asyncIterator&&$e(e==null?void 0:e[Symbol.asyncIterator])}function nc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Eh(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var rc=Eh();function ic(e){return $e(e==null?void 0:e[rc])}function oc(e){return rh(this,arguments,function(){var n,r,i,a;return Ju(this,function(l){switch(l.label){case 0:n=e.getReader(),l.label=1;case 1:l.trys.push([1,,9,10]),l.label=2;case 2:return[4,dr(n.read())];case 3:return r=l.sent(),i=r.value,a=r.done,a?[4,dr(void 0)]:[3,5];case 4:return[2,l.sent()];case 5:return[4,dr(i)];case 6:return[4,l.sent()];case 7:return l.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function ac(e){return $e(e==null?void 0:e.getReader)}function xn(e){if(e instanceof pt)return e;if(e!=null){if(ec(e))return Oh(e);if(ls(e))return Ch(e);if($u(e))return Ah(e);if(tc(e))return sc(e);if(ic(e))return Ph(e);if(ac(e))return Th(e)}throw nc(e)}function Oh(e){return new pt(function(t){var n=e[os]();if($e(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ch(e){return new pt(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Ah(e){return new pt(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Xu)})}function Ph(e){return new pt(function(t){var n,r;try{for(var i=br(e),a=i.next();!a.done;a=i.next()){var l=a.value;if(t.next(l),t.closed)return}}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()})}function sc(e){return new pt(function(t){jh(e,t).catch(function(n){return t.error(n)})})}function Th(e){return sc(oc(e))}function jh(e,t){var n,r,i,a;return nh(this,void 0,void 0,function(){var l,c;return Ju(this,function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),n=ih(e),d.label=1;case 1:return[4,n.next()];case 2:if(r=d.sent(),!!r.done)return[3,4];if(l=r.value,t.next(l),t.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=d.sent(),i={error:c},[3,11];case 6:return d.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Nn(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function lc(e,t){return t===void 0&&(t=0),Cr(function(n,r){n.subscribe(kr(r,function(i){return Nn(r,e,function(){return r.next(i)},t)},function(){return Nn(r,e,function(){return r.complete()},t)},function(i){return Nn(r,e,function(){return r.error(i)},t)}))})}function uc(e,t){return t===void 0&&(t=0),Cr(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Dh(e,t){return xn(e).pipe(uc(t),lc(t))}function Rh(e,t){return xn(e).pipe(uc(t),lc(t))}function Nh(e,t){return new pt(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function Lh(e,t){return new pt(function(n){var r;return Nn(n,t,function(){r=e[rc](),Nn(n,t,function(){var i,a,l;try{i=r.next(),a=i.value,l=i.done}catch(c){n.error(c);return}l?n.complete():n.next(a)},0,!0)}),function(){return $e(r==null?void 0:r.return)&&r.return()}})}function cc(e,t){if(!e)throw new Error("Iterable cannot be null");return new pt(function(n){Nn(n,t,function(){var r=e[Symbol.asyncIterator]();Nn(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function Mh(e,t){return cc(oc(e),t)}function qh(e,t){if(e!=null){if(ec(e))return Dh(e,t);if(ls(e))return Nh(e,t);if($u(e))return Rh(e,t);if(tc(e))return cc(e,t);if(ic(e))return Lh(e,t);if(ac(e))return Mh(e,t)}throw nc(e)}function fn(e,t){return t?qh(e,t):xn(e)}function _n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ss(e);return fn(e,n)}function Ol(e,t){var n=$e(e)?e:function(){return e},r=function(i){return i.error(n())};return new pt(r)}var Fh=rs(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function vr(e,t){return new Promise(function(n,r){var i=new wr({next:function(a){n(a),i.unsubscribe()},error:r,complete:function(){r(new Fh)}});e.subscribe(i)})}function Uh(e){return e instanceof Date&&!isNaN(e)}function bo(e,t){return Cr(function(n,r){var i=0;n.subscribe(kr(r,function(a){r.next(e.call(t,a,i++))}))})}var Bh=Array.isArray;function Kh(e,t){return Bh(t)?e.apply(void 0,_r([],Qn(t))):e(t)}function fc(e){return bo(function(t){return Kh(e,t)})}var zh=Array.isArray,Vh=Object.getPrototypeOf,Wh=Object.prototype,Hh=Object.keys;function Yh(e){if(e.length===1){var t=e[0];if(zh(t))return{args:t,keys:null};if(Gh(t)){var n=Hh(t);return{args:n.map(function(r){return t[r]}),keys:n}}}return{args:e,keys:null}}function Gh(e){return e&&typeof e=="object"&&Vh(e)===Wh}function Jh(e,t){return e.reduce(function(n,r,i){return n[r]=t[i],n},{})}function ro(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ss(e),r=Sh(e),i=Yh(e),a=i.args,l=i.keys;if(a.length===0)return fn([],n);var c=new pt(Qh(a,n,l?function(d){return Jh(l,d)}:go));return r?c.pipe(fc(r)):c}function Qh(e,t,n){return n===void 0&&(n=go),function(r){Cl(t,function(){for(var i=e.length,a=new Array(i),l=i,c=i,d=function(u){Cl(t,function(){var m=fn(e[u],t),y=!1;m.subscribe(kr(r,function(g){a[u]=g,y||(y=!0,c--),c||r.next(n(a.slice()))},function(){--l||r.complete()}))},r)},v=0;v<i;v++)d(v)},r)}}function Cl(e,t,n){e?Nn(n,e,t):t()}function Zh(e,t,n,r,i,a,l,c){var d=[],v=0,u=0,m=!1,y=function(){m&&!d.length&&!v&&t.complete()},g=function(k){return v<r?_(k):d.push(k)},_=function(k){v++;var O=!1;xn(n(k,u++)).subscribe(kr(t,function(C){t.next(C)},function(){O=!0},void 0,function(){if(O)try{v--;for(var C=function(){var S=d.shift();l||_(S)};d.length&&v<r;)C();y()}catch(S){t.error(S)}}))};return e.subscribe(kr(t,g,function(){m=!0,y()})),function(){}}function us(e,t,n){return n===void 0&&(n=1/0),$e(t)?us(function(r,i){return bo(function(a,l){return t(r,a,i,l)})(xn(e(r,i)))},n):(typeof t=="number"&&(n=t),Cr(function(r,i){return Zh(r,i,e,n)}))}function Xh(e){return e===void 0&&(e=1/0),us(go,e)}var $h=["addListener","removeListener"],ep=["addEventListener","removeEventListener"],tp=["on","off"];function un(e,t,n,r){if($e(n)&&(r=n,n=void 0),r)return un(e,t,n).pipe(fc(r));var i=Qn(ip(e)?ep.map(function(c){return function(d){return e[c](t,d,n)}}):np(e)?$h.map(Al(e,t)):rp(e)?tp.map(Al(e,t)):[],2),a=i[0],l=i[1];if(!a&&ls(e))return us(function(c){return un(c,t,n)})(xn(e));if(!a)throw new TypeError("Invalid event target");return new pt(function(c){var d=function(){for(var v=[],u=0;u<arguments.length;u++)v[u]=arguments[u];return c.next(1<v.length?v:v[0])};return a(d),function(){return l(d)}})}function Al(e,t){return function(n){return function(r){return e[n](t,r)}}}function np(e){return $e(e.addListener)&&$e(e.removeListener)}function rp(e){return $e(e.on)&&$e(e.off)}function ip(e){return $e(e.addEventListener)&&$e(e.removeEventListener)}function op(e,t,n){return n===void 0&&(n=wh),new pt(function(r){var i=Uh(e)?1e3-n.now():e;i<0&&(i=0);var a=0;return n.schedule(function(){r.closed||(r.next(a++),r.complete())},i)})}function dc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ss(e),r=Ih(e,1/0),i=e;return i.length?i.length===1?xn(i[0]):Xh(r)(fn(i,n)):kh}function ap(e,t){return Cr(function(n,r){var i=0;n.subscribe(kr(r,function(a){return e.call(t,a,i++)&&r.next(a)}))})}function sp(e){e===void 0&&(e={});var t=e.connector,n=t===void 0?function(){return new fi}:t,r=e.resetOnError,i=r===void 0?!0:r,a=e.resetOnComplete,l=a===void 0?!0:a,c=e.resetOnRefCountZero,d=c===void 0?!0:c;return function(v){var u,m,y,g=0,_=!1,k=!1,O=function(){m==null||m.unsubscribe(),m=void 0},C=function(){O(),u=y=void 0,_=k=!1},S=function(){var x=u;C(),x==null||x.unsubscribe()};return Cr(function(x,A){g++,!k&&!_&&O();var q=y=y??n();A.add(function(){g--,g===0&&!k&&!_&&(m=da(S,d))}),q.subscribe(A),!u&&g>0&&(u=new wr({next:function(D){return q.next(D)},error:function(D){k=!0,O(),m=da(C,i,D),q.error(D)},complete:function(){_=!0,O(),m=da(C,l),q.complete()}}),xn(x).subscribe(u))})(v)}}function da(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t===!0){e();return}if(t!==!1){var i=new wr({next:function(){i.unsubscribe(),e()}});return xn(t.apply(void 0,_r([],Qn(n)))).subscribe(i)}}var Pa=function(e,t){return Pa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Pa(e,t)};function Ar(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Pa(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Ae(e,t,n,r){return new(n||(n=Promise))(function(i,a){function l(v){try{d(r.next(v))}catch(u){a(u)}}function c(v){try{d(r.throw(v))}catch(u){a(u)}}function d(v){var u;v.done?i(v.value):(u=v.value,u instanceof n?u:new n(function(m){m(u)})).then(l,c)}d((r=r.apply(e,[])).next())})}function vc(e,t){var n,r,i,a,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(d){return function(v){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return l.label++,{value:u[1],done:!1};case 5:l.label++,r=u[1],u=[0];continue;case 7:u=l.ops.pop(),l.trys.pop();continue;default:if(i=l.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){l=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){l.label=u[1];break}if(u[0]===6&&l.label<i[1]){l.label=i[1],i=u;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(u);break}i[2]&&l.ops.pop(),l.trys.pop();continue}u=t.call(e,l)}catch(m){u=[6,m],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([d,v])}}}function io(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function si(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),l=[];try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(c){i={error:c}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return l}function li(e,t,n){if(arguments.length===2)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function hr(e){return this instanceof hr?(this.v=e,this):new hr(e)}function lp(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(m){i[m]&&(r[m]=function(y){return new Promise(function(g,_){a.push([m,y,g,_])>1||c(m,y)})})}function c(m,y){try{(function(g){g.value instanceof hr?Promise.resolve(g.value.v).then(d,v):u(a[0][2],g)})(i[m](y))}catch(g){u(a[0][3],g)}}function d(m){c("next",m)}function v(m){c("throw",m)}function u(m,y){m(y),a.shift(),a.length&&c(a[0][0],a[0][1])}}function up(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=io(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(a){return new Promise(function(l,c){(function(d,v,u,m){Promise.resolve(m).then(function(y){d({value:y,done:u})},v)})(l,c,(a=e[i](a)).done,a.value)})}}}function hc(e){if(!e)throw new Error("Assertion Failed")}const cp={}.hasOwnProperty;function oo(e,t,n){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){hc(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)oo(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var l=t.substr(0,a),c=t.substr(a+1);if(c==="")n===void 0?Array.isArray(e)?isNaN(parseInt(l))||e.splice(parseInt(l),1):delete e[l]:e[l]=n;else{var d=e[l];d&&function(v,u){return cp.call(v,u)}(e,l)||(d=e[l]={}),oo(d,c,n)}}else n===void 0?Array.isArray(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}const pc=typeof self<"u"&&typeof crypto<"u"?(e,t=crypto.getRandomValues.bind(crypto))=>{const n=new Uint8Array(e);return t(n),self.btoa(String.fromCharCode.apply(null,n))}:typeof Buffer<"u"?(e,t=fp)=>{const n=Buffer.alloc(e);return t(n),n.toString("base64")}:()=>{throw new Error("No implementation of randomString was found")};function fp(e){for(let t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}function cs(e){return typeof e=="string"||!!(Array.isArray(e)&&e.some(t=>cs(t))&&e.every(yc))}function yc(e){return typeof e=="string"||typeof e=="number"||Array.isArray(e)&&e.every(yc)}function dp(e,t,n){const r=e[t]||(e[t]={}),i=n.keys.map(a=>typeof a=="string"?a:JSON.stringify(a));switch(n.type){case"insert":case"upsert":i.forEach((a,l)=>{r[a]={type:"ups",val:n.values[l]}});break;case"update":case"modify":i.forEach((a,l)=>{const c=n.type==="update"?n.changeSpecs[l]:n.changeSpec,d=r[a];if(d)switch(d.type){case"ups":for(const[v,u]of Object.entries(c))oo(d.val,v,u);break;case"del":break;case"upd":Object.assign(d.mod,c)}else r[a]={type:"upd",mod:c}});break;case"delete":i.forEach(a=>{r[a]={type:"del"}})}return e}function Pl(e,t){for(const{table:n,muts:r}of t)for(const i of r)dp(e,n,i)}function dt(e){return typeof e=="function"}function Lt(e){return function(t){if(function(n){return dt(n==null?void 0:n.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var mc=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function gc(e){return dt(e==null?void 0:e.then)}var Tl,qi,va=(Tl=function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}},(qi=Tl(function(e){Error.call(e),e.stack=new Error().stack})).prototype=Object.create(Error.prototype),qi.prototype.constructor=qi,qi);function Ta(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var _o=function(){function e(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var n,r,i,a,l;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var d=io(c),v=d.next();!v.done;v=d.next())v.value.remove(this)}catch(k){n={error:k}}finally{try{v&&!v.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}else c.remove(this);var u=this.initialTeardown;if(dt(u))try{u()}catch(k){l=k instanceof va?k.errors:[k]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var y=io(m),g=y.next();!g.done;g=y.next()){var _=g.value;try{jl(_)}catch(k){l=l??[],k instanceof va?l=li(li([],si(l)),si(k.errors)):l.push(k)}}}catch(k){i={error:k}}finally{try{g&&!g.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}if(l)throw new va(l)}},e.prototype.add=function(n){var r;if(n&&n!==this)if(this.closed)jl(n);else{if(n instanceof e){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(n)}},e.prototype._hasParent=function(n){var r=this._parentage;return r===n||Array.isArray(r)&&r.includes(n)},e.prototype._addParent=function(n){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(n),r):r?[r,n]:n},e.prototype._removeParent=function(n){var r=this._parentage;r===n?this._parentage=null:Array.isArray(r)&&Ta(r,n)},e.prototype.remove=function(n){var r=this._finalizers;r&&Ta(r,n),n instanceof e&&n._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function bc(e){return e instanceof _o||e&&"closed"in e&&dt(e.remove)&&dt(e.add)&&dt(e.unsubscribe)}function jl(e){dt(e)?e():e.unsubscribe()}_o.EMPTY;var vp={Promise:void 0},hp={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,li([e,t],si(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function _c(e){hp.setTimeout(function(){throw e})}function ja(){}var fs=function(e){function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,bc(n)&&n.add(r)):r.destination=yp,r}return Ar(t,e),t.create=function(n,r,i){return new Da(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(_o),pp=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Fi(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Fi(r)}else Fi(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Fi(n)}},e}(),Da=function(e){function t(n,r,i){var a,l=e.call(this)||this;return dt(n)||!n?a={next:n??void 0,error:r??void 0,complete:i??void 0}:a=n,l.destination=new pp(a),l}return Ar(t,e),t}(fs);function Fi(e){_c(e)}var yp={closed:!0,next:ja,error:function(e){throw e},complete:ja},ds=typeof Symbol=="function"&&Symbol.observable||"@@observable";function wo(e){return e}var $t=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i,a=this,l=(i=t)&&i instanceof fs||function(c){return c&&dt(c.next)&&dt(c.error)&&dt(c.complete)}(i)&&bc(i)?t:new Da(t,n,r);return function(){var c=a,d=c.operator,v=c.source;l.add(d?d.call(l,v):v?a._subscribe(l):a._trySubscribe(l))}(),l},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return new(n=Dl(n))(function(i,a){var l=new Da({next:function(c){try{t(c)}catch(d){a(d),l.unsubscribe()}},error:a,complete:i});r.subscribe(l)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[ds]=function(){return this},e.prototype.pipe=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return((t=n).length===0?wo:t.length===1?t[0]:function(i){return t.reduce(function(a,l){return l(a)},i)})(this)},e.prototype.toPromise=function(t){var n=this;return new(t=Dl(t))(function(r,i){var a;n.subscribe(function(l){return a=l},function(l){return i(l)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function Dl(e){var t;return(t=e??vp.Promise)!==null&&t!==void 0?t:Promise}function wc(e){return dt(e[ds])}function kc(e){return Symbol.asyncIterator&&dt(e==null?void 0:e[Symbol.asyncIterator])}function xc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Sc=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ic(e){return dt(e==null?void 0:e[Sc])}function Ec(e){return lp(this,arguments,function(){var t,n,r;return vc(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,hr(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,hr(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,hr(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Oc(e){return dt(e==null?void 0:e.getReader)}function Zn(e){if(e instanceof $t)return e;if(e!=null){if(wc(e))return i=e,new $t(function(a){var l=i[ds]();if(dt(l.subscribe))return l.subscribe(a);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(mc(e))return r=e,new $t(function(a){for(var l=0;l<r.length&&!a.closed;l++)a.next(r[l]);a.complete()});if(gc(e))return n=e,new $t(function(a){n.then(function(l){a.closed||(a.next(l),a.complete())},function(l){return a.error(l)}).then(null,_c)});if(kc(e))return Rl(e);if(Ic(e))return t=e,new $t(function(a){var l,c;try{for(var d=io(t),v=d.next();!v.done;v=d.next()){var u=v.value;if(a.next(u),a.closed)return}}catch(m){l={error:m}}finally{try{v&&!v.done&&(c=d.return)&&c.call(d)}finally{if(l)throw l.error}}a.complete()});if(Oc(e))return Rl(Ec(e))}var t,n,r,i;throw xc(e)}function Rl(e){return new $t(function(t){(function(n,r){var i,a,l,c;return Ae(this,void 0,void 0,function(){var d,v;return vc(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),i=up(n),u.label=1;case 1:return[4,i.next()];case 2:if((a=u.sent()).done)return[3,4];if(d=a.value,r.next(d),r.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return v=u.sent(),l={error:v},[3,11];case 6:return u.trys.push([6,,9,10]),a&&!a.done&&(c=i.return)?[4,c.call(i)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(l)throw l.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})})(e,t).catch(function(n){return t.error(n)})})}function Nt(e,t,n,r,i){return new mp(e,t,n,r,i)}var mp=function(e){function t(n,r,i,a,l,c){var d=e.call(this,n)||this;return d.onFinalize=l,d.shouldUnsubscribe=c,d._next=r?function(v){try{r(v)}catch(u){n.error(u)}}:e.prototype._next,d._error=a?function(v){try{a(v)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,d._complete=i?function(){try{i()}catch(v){n.error(v)}finally{this.unsubscribe()}}:e.prototype._complete,d}return Ar(t,e),t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(fs),gp=function(e){function t(n,r){return e.call(this)||this}return Ar(t,e),t.prototype.schedule=function(n,r){return this},t}(_o),Ra={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Ra.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,li([e,t],si(n))):setInterval.apply(void 0,li([e,t],si(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},bp=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return Ar(t,e),t.prototype.schedule=function(n,r){if(r===void 0&&(r=0),this.closed)return this;this.state=n;var i=this.id,a=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(a,i,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(a,this.id,r),this},t.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),Ra.setInterval(n.flush.bind(n,this),i)},t.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;Ra.clearInterval(r)},t.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(n,r){var i,a=!1;try{this.work(n)}catch(l){a=!0,i=l||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),i},t.prototype.unsubscribe=function(){if(!this.closed){var n=this.id,r=this.scheduler,i=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ta(i,this),n!=null&&(this.id=this.recycleAsyncId(r,n,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(gp),_p={now:function(){return Date.now()}},Nl=function(){function e(t,n){n===void 0&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(t,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,t).schedule(r,n)},e.now=_p.now,e}(),vs=new(function(e){function t(n,r){r===void 0&&(r=Nl.now);var i=e.call(this,n,r)||this;return i.actions=[],i._active=!1,i._scheduled=void 0,i}return Ar(t,e),t.prototype.flush=function(n){var r=this.actions;if(this._active)r.push(n);else{var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}}},t}(Nl))(bp),wp=vs;function Cc(e){return e&&dt(e.schedule)}function kp(e,t,n){e===void 0&&(e=0),n===void 0&&(n=wp);var r=-1;return t!=null&&(Cc(t)?n=t:r=t),new $t(function(i){var a,l=(a=e)instanceof Date&&!isNaN(a)?+e-n.now():e;l<0&&(l=0);var c=0;return n.schedule(function(){i.closed||(i.next(c++),0<=r?this.schedule(void 0,r):i.complete())},l)})}function Ac(e){return Cc((t=e)[t.length-1])?e.pop():void 0;var t}function Ln(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Na(e){return Lt(function(t,n){var r,i=null,a=!1;i=t.subscribe(Nt(n,void 0,void 0,function(l){r=Zn(e(l,Na(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function Ll(e,t){return t===void 0&&(t=0),Lt(function(n,r){n.subscribe(Nt(r,function(i){return Ln(r,e,function(){return r.next(i)},t)},function(){return Ln(r,e,function(){return r.complete()},t)},function(i){return Ln(r,e,function(){return r.error(i)},t)}))})}function Ml(e,t){return t===void 0&&(t=0),Lt(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function ql(e,t){if(!e)throw new Error("Iterable cannot be null");return new $t(function(n){Ln(n,t,function(){var r=e[Symbol.asyncIterator]();Ln(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function xp(e,t){if(e!=null){if(wc(e))return function(n,r){return Zn(n).pipe(Ml(r),Ll(r))}(e,t);if(mc(e))return function(n,r){return new $t(function(i){var a=0;return r.schedule(function(){a===n.length?i.complete():(i.next(n[a++]),i.closed||this.schedule())})})}(e,t);if(gc(e))return function(n,r){return Zn(n).pipe(Ml(r),Ll(r))}(e,t);if(kc(e))return ql(e,t);if(Ic(e))return function(n,r){return new $t(function(i){var a;return Ln(i,r,function(){a=n[Sc](),Ln(i,r,function(){var l,c,d;try{c=(l=a.next()).value,d=l.done}catch(v){return void i.error(v)}d?i.complete():i.next(c)},0,!0)}),function(){return dt(a==null?void 0:a.return)&&a.return()}})}(e,t);if(Oc(e))return function(n,r){return ql(Ec(n),r)}(e,t)}throw xc(e)}function cn(e,t){return Lt(function(n,r){var i=0;n.subscribe(Nt(r,function(a){r.next(e.call(t,a,i++))}))})}function hs(e,t,n){return n===void 0&&(n=1/0),dt(t)?hs(function(r,i){return cn(function(a,l){return t(r,a,i,l)})(Zn(e(r,i)))},n):(typeof t=="number"&&(n=t),Lt(function(r,i){return function(a,l,c,d,v,u,m,y){var g=[],_=0,k=0,O=!1,C=function(){!O||g.length||_||l.complete()},S=function(A){return _<d?x(A):g.push(A)},x=function(A){u&&l.next(A),_++;var q=!1;Zn(c(A,k++)).subscribe(Nt(l,function(D){v==null||v(D),u?S(D):l.next(D)},function(){q=!0},void 0,function(){if(q)try{_--;for(var D=function(){var W=g.shift();m?Ln(l,m,function(){return x(W)}):x(W)};g.length&&_<d;)D();C()}catch(W){l.error(W)}}))};return a.subscribe(Nt(l,S,function(){O=!0,C()})),function(){y==null||y()}}(r,i,e,n)}))}function Sp(){return(e=1)===void 0&&(e=1/0),hs(wo,e);var e}function Fl(e,t){return t===void 0&&(t=vs),Lt(function(n,r){var i=null,a=null,l=null,c=function(){if(i){i.unsubscribe(),i=null;var v=a;a=null,r.next(v)}};function d(){var v=l+e,u=t.now();if(u<v)return i=this.schedule(void 0,v-u),void r.add(i);c()}n.subscribe(Nt(r,function(v){a=v,l=t.now(),i||(i=t.schedule(d,e),r.add(i))},function(){c(),r.complete()},void 0,function(){a=i=null}))})}function La(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Sp()((e=n,(t=Ac(n))?xp(e,t):Zn(e)))}var Ip=new $t(function(e){return e.complete()});function cr(e){return e<=0?function(){return Ip}:Lt(function(t,n){var r=0;t.subscribe(Nt(n,function(i){++r<=e&&(n.next(i),e<=r&&n.complete())}))})}function Pc(e,t){return t?function(n){return La(t.pipe(cr(1),Lt(function(r,i){r.subscribe(Nt(i,ja))})),n.pipe(Pc(e)))}:hs(function(n,r){return e(n,r).pipe(cr(1),function(i){return cn(function(){return i})}(n))})}function Tc(e,t){t===void 0&&(t=vs);var n=kp(e,t);return Pc(function(){return n})}function jc(e,t){return t===void 0&&(t=wo),e=e??Ep,Lt(function(n,r){var i,a=!0;n.subscribe(Nt(r,function(l){var c=t(l);!a&&e(i,c)||(a=!1,i=c,r.next(l))}))})}function Ep(e,t){return e===t}function ln(e,t){return Lt(function(n,r){var i=0;n.subscribe(Nt(r,function(a){return e.call(t,a,i++)&&r.next(a)}))})}function Ul(e){return ln(function(t,n){return e<=n})}function Op(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Ac(e);return Lt(function(r,i){(n?La(e,r,n):La(e,r)).subscribe(i)})}function Ct(e,t){return Lt(function(n,r){var i=null,a=0,l=!1,c=function(){return l&&!i&&r.complete()};n.subscribe(Nt(r,function(d){i==null||i.unsubscribe();var v=0,u=a++;Zn(e(d,u)).subscribe(i=Nt(r,function(m){return r.next(t?t(d,m,u,v++):m)},function(){i=null,c()}))},function(){l=!0,c()}))})}function Bl(e,t,n){var r=dt(e)||t||n?{next:e,error:t,complete:n}:e;return r?Lt(function(i,a){var l;(l=r.subscribe)===null||l===void 0||l.call(r);var c=!0;i.subscribe(Nt(a,function(d){var v;(v=r.next)===null||v===void 0||v.call(r,d),a.next(d)},function(){var d;c=!1,(d=r.complete)===null||d===void 0||d.call(r),a.complete()},function(d){var v;c=!1,(v=r.error)===null||v===void 0||v.call(r,d),a.error(d)},function(){var d,v;c&&((d=r.unsubscribe)===null||d===void 0||d.call(r)),(v=r.finalize)===null||v===void 0||v.call(r)}))}):wo}function Dc(e,t){return Ae(this,void 0,void 0,function*(){try{const n=yield navigator.serviceWorker.ready;if(t==="push"&&n.sync&&(yield n.sync.register(`dexie-cloud:${e.name}`)),!n.active)throw new Error("Failed to trigger sync - there's no active service worker");return void n.active.postMessage({type:"dexie-cloud-sync",dbName:e.name,purpose:t})}catch{}})}function bn(e,t){e.cloud.usingServiceWorker?Dc(e,t):e.localSyncEvent.next({purpose:t})}const Rc=typeof Buffer<"u"?e=>Buffer.from(e,"base64"):e=>{const t=atob(e),n=t.length,r=new Uint8Array(n);for(var i=0;i<n;i++)r[i]=t.charCodeAt(i);return r},di=typeof Buffer<"u"?e=>ArrayBuffer.isView(e)?Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"):Buffer.from(e).toString("base64"):e=>{const t=ArrayBuffer.isView(e)?e:new Uint8Array(e),n=[];for(let r=0,i=t.length;r<i;r+=4096){const a=t.subarray(r,r+4096);n.push(String.fromCharCode.apply(null,a))}return btoa(n.join(""))};class Ma extends Error{constructor({title:t,message:n,messageCode:r,messageParams:i}){super(n),this.name="TokenErrorResponseError",this.title=t,this.messageCode=r,this.messageParams=i}}function vi(e,t){return new Promise((n,r)=>{const i=Object.assign(Object.assign({submitLabel:"Submit",cancelLabel:"Cancel"},t),{onSubmit:a=>{e.next(void 0),n(a)},onCancel:()=>{e.next(void 0),r(new at.AbortError("User cancelled"))}});e.next(i)})}function qa(e,t,...n){return vi(e,{type:"message-alert",title:t,alerts:n,fields:{},submitLabel:"OK",cancelLabel:null})}function Kl(e,t,n){return Ae(this,void 0,void 0,function*(){let r=n||"";for(;!r||!/^[\w-+.]+@([\w-]+\.)+[\w-]{2,10}(\sas\s[\w-+.]+@([\w-]+\.)+[\w-]{2,10})?$/.test(r);)r=(yield vi(e,{type:"email",title:t,alerts:r?[{type:"error",messageCode:"INVALID_EMAIL",message:"Please enter a valid email address",messageParams:{}}]:[],fields:{email:{type:"email",placeholder:"you@somedomain.com"}}})).email;return r})}function zl(e,t,n){return Ae(this,void 0,void 0,function*(){const r=[{type:"info",messageCode:"OTP_SENT",message:"A One-Time password has been sent to {email}",messageParams:{email:t}}];n&&r.push(n);const{otp:i}=yield vi(e,{type:"otp",title:"Enter OTP",alerts:r,fields:{otp:{type:"otp",label:"OTP",placeholder:"Paste OTP here"}}});return i})}function ps(e){var t,n,r;return Ae(this,void 0,void 0,function*(){const i=yield e.getCurrentUser(),{accessToken:a,accessTokenExpiration:l,refreshToken:c,refreshTokenExpiration:d,claims:v}=i;if(!a)return null;if(((t=l==null?void 0:l.getTime())!==null&&t!==void 0?t:1/0)>Date.now()&&(((n=i.license)===null||n===void 0?void 0:n.status)||"ok")==="ok")return i;if(!c)throw new Error("Refresh token missing");if(((r=d==null?void 0:d.getTime())!==null&&r!==void 0?r:1/0)<=Date.now())throw new Error("Refresh token has expired");const u=yield ko(e.cloud.options.databaseUrl,i);return yield e.table("$logins").update(v.sub,{accessToken:u.accessToken,accessTokenExpiration:u.accessTokenExpiration,claims:u.claims,license:u.license}),u})}function Cp(e,t,n,r,i){return Ae(this,void 0,void 0,function*(){return t.accessToken&&t.accessTokenExpiration.getTime()>Date.now()?t:t.refreshToken&&(!t.refreshTokenExpiration||t.refreshTokenExpiration.getTime()>Date.now())?yield ko(e,t):yield function(a,l,c,d){return Ae(this,void 0,void 0,function*(){if(!crypto.subtle)throw typeof location<"u"&&location.protocol==="http:"?new Error("Dexie Cloud Addon needs to use WebCrypto, but your browser has disabled it due to being served from an insecure location. Please serve it from https or http://localhost:<port> (See https://stackoverflow.com/questions/46670556/how-to-enable-crypto-subtle-for-unsecure-origins-in-chrome/46671627#46671627)"):new Error("This browser does not support WebCrypto.");const{privateKey:v,publicKey:u}=yield crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!1,["sign","verify"]);if(!v||!u)throw new Error("Could not generate RSA keypair");a.nonExportablePrivateKey=v;const m=function(y){const g=di(y);return function(_){let k=`-----BEGIN PUBLIC KEY-----
`;for(;_.length>0;)k+=_.substring(0,64)+`
`,_=_.substring(64);return k+="-----END PUBLIC KEY-----",k}(g)}(yield crypto.subtle.exportKey("spki",u));a.publicKey=u;try{const y=yield l({public_key:m,hints:d});if(y.type==="error")throw new Ma(y);if(y.type!=="tokens")throw new Error(`Unexpected response type from token endpoint: ${y.type}`);return a.accessToken=y.accessToken,a.accessTokenExpiration=new Date(y.accessTokenExpiration),a.refreshToken=y.refreshToken,y.refreshTokenExpiration&&(a.refreshTokenExpiration=new Date(y.refreshTokenExpiration)),a.userId=y.claims.sub,a.email=y.claims.email,a.name=y.claims.name,a.claims=y.claims,a.license={type:y.userType,status:y.claims.license||"ok"},a.data=y.data,y.evalDaysLeft!=null&&(a.license.evalDaysLeft=y.evalDaysLeft),y.userValidUntil!=null&&(a.license.validUntil=new Date(y.userValidUntil)),y.alerts&&y.alerts.length>0&&(yield vi(c,{type:"message-alert",title:"Authentication Alert",fields:{},alerts:y.alerts})),a}catch(y){if(y instanceof Ma)throw yield qa(c,y.title,{type:"error",messageCode:y.messageCode,message:y.message,messageParams:{}}),y;let g="We're having a problem authenticating right now.";throw y instanceof TypeError&&(g=typeof navigator!==void 0&&!navigator.onLine?"You seem to be offline. Please connect to the internet and try again.":at.debug||typeof location<"u"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1")?`Could not connect to server. Please verify that your origin '${location.origin}' is whitelisted using \`npx dexie-cloud whitelist\``:"Could not connect to server. Please verify the connection.",yield qa(c,"Authentication Failed",{type:"error",messageCode:"GENERIC_ERROR",message:g,messageParams:{}}).catch(()=>{})),y}})}(t,n,r,i)})}function ko(e,t){return Ae(this,void 0,void 0,function*(){if(!t.refreshToken)throw new Error("Cannot refresh token - refresh token is missing.");if(!t.nonExportablePrivateKey)throw new Error("login.nonExportablePrivateKey is missing - cannot sign refresh token without a private key.");const n=Date.now(),r="RSASSA-PKCS1-v1_5",i=new TextEncoder().encode(t.refreshToken+n),a=yield crypto.subtle.sign(r,t.nonExportablePrivateKey,i),l=di(a),c={grant_type:"refresh_token",refresh_token:t.refreshToken,scopes:["ACCESS_DB"],signature:l,signing_algorithm:r,time_stamp:n},d=yield fetch(`${e}/token`,{body:JSON.stringify(c),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});if(d.status!==200)throw new Error(`RefreshToken: Status ${d.status} from ${e}/token`);const v=yield d.json();if(v.type==="error")throw new Ma(v);return t.accessToken=v.accessToken,t.accessTokenExpiration=v.accessTokenExpiration?new Date(v.accessTokenExpiration):void 0,t.claims=v.claims,t.license={type:v.userType,status:v.claims.license||"ok"},v.evalDaysLeft!=null&&(t.license.evalDaysLeft=v.evalDaysLeft),v.userValidUntil!=null&&(t.license.validUntil=new Date(v.userValidUntil)),v.data&&(t.data=v.data),t})}const Vl=new WeakMap;class ys{constructor(t,n){Vl.set(this,t),Object.assign(this,n)}static load(t,n){return t.table("$logins").get(n).then(r=>new ys(t,r||{userId:n,claims:{sub:n},lastLogin:new Date(0)}))}save(){return Ae(this,void 0,void 0,function*(){Vl.get(this).table("$logins").put(this)})}}const Rt={userId:"unauthorized",name:"Unauthorized",claims:{sub:"unauthorized"},lastLogin:new Date(0)};try{Object.freeze(Rt),Object.freeze(Rt.claims)}catch{}function Nc(e,t){return vr(fn(e).pipe(ap(t)))}function Lc(e){return Ae(this,void 0,void 0,function*(){const t=yield Fa(e);if(t){if(!(yield function(n,r,i){return Ae(this,void 0,void 0,function*(){const a=[{type:"warning",messageCode:"LOGOUT_CONFIRMATION",message:`{numUnsyncedChanges} unsynced changes will get lost!
                Logout anyway?`,messageParams:{currentUserId:r,numUnsyncedChanges:i.toString()}}];return yield vi(n,{type:"logout-confirmation",title:"Confirm Logout",alerts:a,fields:{},submitLabel:"Confirm logout",cancelLabel:"Cancel"}).then(()=>!0).catch(()=>!1)})}(e.cloud.userInteraction,e.cloud.currentUserId,t)))throw new Error("User cancelled logout due to unsynced changes");yield Fa(e,{deleteUnsyncedData:!0})}})}function Fa(e,{deleteUnsyncedData:t=!1}={}){return Ae(this,void 0,void 0,function*(){const[n,r]=yield e.dx.transaction("rw",e.dx.tables,i=>Ae(this,void 0,void 0,function*(){const a=i.idbtrans;a.disableChangeTracking=!0,a.disableAccessControl=!0;const l=i.storeNames.filter(d=>d.endsWith("_mutations")),c=(yield Promise.all(l.map(d=>i.table(d).count()))).reduce((d,v)=>d+v,0);if(c>0&&!t)return[c,!1];e.$syncState.delete("syncState");for(const d of e.dx.tables)d.name!=="$jobs"&&d.name!=="$syncState"&&d.clear();return[c,!0]}));return r&&(yield Nc(e.cloud.currentUser,i=>i.userId===Rt.userId),yield e.cloud.sync({purpose:"pull",wait:!0})),n})}class Ua extends Error{constructor(t,n){super(n||`${t.status} ${t.statusText}`),this.httpStatus=t.status}get name(){return"HttpError"}}function Ui(e,...t){globalThis.console[e](...t)}function ha(e,t){var n;return Ae(this,void 0,void 0,function*(){const r=yield e.getCurrentUser(),i=r.userId;if(r.isLoggedIn&&(!t||!t.email&&!t.userId)){if((((n=r.license)===null||n===void 0?void 0:n.status)||"ok")==="ok"&&r.accessToken&&(!r.accessTokenExpiration||r.accessTokenExpiration.getTime()>Date.now()))return!1;if(r.refreshToken&&(!r.refreshTokenExpiration||r.refreshTokenExpiration.getTime()>Date.now()))return yield ps(e),!1}const a=new ys(e,{claims:{},lastLogin:new Date(0)});return yield Cp(e.cloud.options.databaseUrl,a,e.cloud.options.fetchTokens||function(l){const{userInteraction:c}=l.cloud;return function({public_key:d,hints:v}){var u;return Ae(this,void 0,void 0,function*(){let m;const y=(u=l.cloud.options)===null||u===void 0?void 0:u.databaseUrl;if(!y)throw new Error("No database URL given.");if((v==null?void 0:v.grant_type)==="demo")m={demo_user:yield Kl(c,"Enter a demo user email",(v==null?void 0:v.email)||(v==null?void 0:v.userId)),grant_type:"demo",scopes:["ACCESS_DB"],public_key:d};else if(v!=null&&v.otpId&&v.otp)m={grant_type:"otp",otp_id:v.otpId,otp:v.otp,scopes:["ACCESS_DB"],public_key:d};else{const k=yield Kl(c,"Enter email address",v==null?void 0:v.email);m=/@demo.local$/.test(k)?{demo_user:k,grant_type:"demo",scopes:["ACCESS_DB"],public_key:d}:{email:k,grant_type:"otp",scopes:["ACCESS_DB"]}}const g=yield fetch(`${y}/token`,{body:JSON.stringify(m),method:"post",headers:{"Content-Type":"application/json",mode:"cors"}});if(g.status!==200){const k=yield g.text();throw yield qa(c,"Token request failed",{type:"error",messageCode:"GENERIC_ERROR",message:k,messageParams:{}}).catch(()=>{}),new Ua(g,k)}const _=yield g.json();if(_.type==="tokens"||_.type==="error")return _;if(m.grant_type==="otp"&&"email"in m){if(_.type!=="otp-sent")throw new Error(`Unexpected response from ${y}/token`);const k=yield zl(c,m.email),O=Object.assign(Object.assign({},m),{otp:k||"",otp_id:_.otp_id,public_key:d});let C=yield fetch(`${y}/token`,{body:JSON.stringify(O),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});for(;C.status===401;){const S=yield C.text();O.otp=yield zl(c,m.email,{type:"error",messageCode:"INVALID_OTP",message:S,messageParams:{}}),C=yield fetch(`${y}/token`,{body:JSON.stringify(O),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"})}if(C.status!==200){const S=yield C.text();throw new Ua(C,S)}return yield C.json()}throw new Error(`Unexpected response from ${y}/token`)})}}(e),e.cloud.userInteraction,t),i!==Rt.userId&&a.userId!==i&&(yield Lc(e)),yield function(l,c){return Ae(this,void 0,void 0,function*(){if(c.userId===l.cloud.currentUserId)return;const d=l.table("$logins");yield l.transaction("rw",d,v=>Ae(this,void 0,void 0,function*(){const u=yield d.toArray();yield Promise.all(u.filter(m=>m.userId!==c.userId&&m.isLoggedIn).map(m=>(m.isLoggedIn=!1,d.put(m)))),c.isLoggedIn=!0,c.lastLogin=new Date;try{yield c.save()}catch(m){try{m.name==="DataCloneError"&&(Ui("debug","Login context property names:",Object.keys(c)),Ui("debug","Login context property names:",Object.keys(c)),Ui("debug","Login context:",c),Ui("debug","Login context JSON:",JSON.stringify(c)))}catch{}throw m}})),yield Nc(l.cloud.currentUser,v=>v.userId===c.userId)})}(e,a),bn(e,"pull"),a.userId!==i})}const Ba={},ti=typeof self<"u"&&self.document&&typeof navigator<"u"&&navigator.serviceWorker;ti&&ti.ready.then(e=>Ba.registration=e),typeof self<"u"&&"clients"in self&&!self.document&&addEventListener("message",e=>{var t,n;!((n=(t=e.data)===null||t===void 0?void 0:t.type)===null||n===void 0)&&n.startsWith("sw-broadcast-")&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>{var i;return r.id!==((i=e.source)===null||i===void 0?void 0:i.id)&&r.postMessage(e.data)})});class pa{constructor(t){this.name=t}subscribe(t){if(!ti)return()=>{};const n=r=>{var i;((i=r.data)===null||i===void 0?void 0:i.type)===`sw-broadcast-${this.name}`&&t(r.data.message)};return ti.addEventListener("message",n),()=>ti.removeEventListener("message",n)}postMessage(t){var n;typeof self.clients=="object"?[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:`sw-broadcast-${this.name}`,message:t})):Ba.registration&&((n=Ba.registration.active)===null||n===void 0||n.postMessage({type:`sw-broadcast-${this.name}`,message:t}))}}const Jr=globalThis["lbc-events"]||(globalThis["lbc-events"]=new Map);class Bi extends pt{constructor(t){const n=typeof BroadcastChannel>"u"?new pa(t):new BroadcastChannel(t);super(r=>{function i(c){r.next(c.detail)}function a(c){r.next(c.data)}let l;(function(c,d){Jr.has(c)?Jr.get(c).push(d):Jr.set(c,[d])})(`lbc-${t}`,i);try{n instanceof pa?l=n.subscribe(c=>r.next(c)):n.addEventListener("message",a)}catch{}return()=>{(function(c,d){const v=Jr.get(c);if(v){const u=v.indexOf(d);u!==-1&&v.splice(u,1)}})(`lbc-${t}`,i),n instanceof pa?l():n.removeEventListener("message",a)}}),this.name=t,this.bc=n}next(t){this.bc.postMessage(t),function(n){const r=Jr.get(n.type);r&&r.forEach(i=>{try{i(n)}catch{}})}(new CustomEvent(`lbc-${this.name}`,{detail:t}))}}function Ka({realms:e,inviteRealms:t}){return Ae(this,void 0,void 0,function*(){const n=JSON.stringify([...e.map(a=>({realmId:a,accepted:!0})),...t.map(a=>({realmId:a,accepted:!1}))].sort((a,l)=>a.realmId<l.realmId?-1:a.realmId>l.realmId?1:0)),r=new TextEncoder().encode(n),i=yield crypto.subtle.digest("SHA-1",r);return di(i)})}function Zi(e){return Object.entries(e.cloud.schema||{}).filter(([,{markedForSync:t}])=>t).map(([t])=>e.tables.filter(({name:n})=>n===t)[0]).filter(t=>t)}function ms(e){return`$${e}_mutations`}function Mc(e){var t;const n=(t=/^\$(.*)_mutations$/.exec(e))===null||t===void 0?void 0:t[1];if(!n)throw new Error(`Given mutationTable ${e} is not correct`);return n}const Ap=[].concat;function qc(e){return Ap.apply([],e)}function za(e,t,{since:n={},limit:r=1/0}={}){return Ae(this,void 0,void 0,function*(){const i=qc(yield Promise.all(e.map(d=>Ae(this,void 0,void 0,function*(){const v=Mc(d.name),u=n[v];let m=u?d.where("rev").above(u):d;return r<1/0&&(m=m.limit(r)),(yield m.toArray()).map(y=>({table:v,mut:y}))})))).sort((d,v)=>d.mut.txid===v.mut.txid?d.mut.opNo-v.mut.opNo:d.mut.ts-v.mut.ts),a=[];let l=null,c=null;for(const{table:d,mut:v}of i)l&&l.table===d&&c===v.txid?l.muts.push(v):(l={table:d,muts:[v]},c=v.txid,a.push(l));return a})}function Fc(e){const t=new Uint8Array(e);if(typeof crypto<"u")crypto.getRandomValues(t);else for(let n=0;n<e;n++)t[n]=Math.floor(256*Math.random());if(typeof Buffer<"u"&&Buffer.from)return Buffer.from(t).toString("base64");if(typeof btoa<"u")return btoa(String.fromCharCode.apply(null,t));throw new Error("No btoa or Buffer available")}const{toString:Pp}={},Wl={replace:function(e){const t=Object.keys(e);let n=null;for(let i=0,a=t.length;i<a;++i)t[i][0]==="$"&&(n=n||[],n.push(t[i]));if(!n)return e;const r={...e};for(const i of n)delete r[i];for(const i of n)r["$"+i]=e[i];return r}};function Uc(...e){const t=e.reduce((r,i)=>({...r,...i}),e.reduce((r,i)=>({...i,...r}),{})),n=new WeakMap;return{stringify(r,i,a){return JSON.stringify(r,function(c){const d=this[c],v=function(u){const m=typeof u;switch(typeof u){case"object":case"function":{if(u===null)return null;const g=Object.getPrototypeOf(u);if(!g)return Wl;let _=n.get(g);if(_!==void 0)return _;const k=(y=u,Pp.call(y).slice(8,-1)),O=Object.entries(t).find(([C,S])=>{var x,A;return(A=(x=S==null?void 0:S.test)===null||x===void 0?void 0:x.call(S,u,k))!==null&&A!==void 0?A:C===k});return _=O==null?void 0:O[1],_||(_=Array.isArray(u)?null:typeof u=="function"?t.function||null:Wl),n.set(g,_),_}default:return t[m]}var y}(d);return v?v.replace(d,i,t):d},a)},parse(r,i){const a=[];return JSON.parse(r,function(l,c){const d=c==null?void 0:c.$t;if(d){const u=t[d];c=u?u.revive(c,i,t):c}let v=a[a.length-1];if(v&&v[0]===c){c={...c};for(const u of v[1])delete c[u];for(const[u,m]of Object.entries(v[2]))c[u]=m;a.pop()}if(c===void 0||l[0]==="$"&&l!=="$t"){let u,m;v=a[a.length-1],v&&v[0]===this?(u=v[1],m=v[2]):a.push([this,u=[],m={}]),l[0]==="$"&&l!=="$t"?(u.push(l),m[l.substr(1)]=c):m[l]=void 0}return c})}}}const Tp={Blob:{test:(e,t)=>t==="Blob",replace:(e,t)=>{const n=t.length;return t.push(e),{$t:"Blob",mimeType:e.type,i:n}},revive:({i:e,mimeType:t},n)=>new Blob([n[e]],{type:t})}};var jp={number:{replace:e=>{switch(!0){case isNaN(e):return{$t:"number",v:"NaN"};case e===1/0:return{$t:"number",v:"Infinity"};case e===-1/0:return{$t:"number",v:"-Infinity"};default:return e}},revive:({v:e})=>Number(e)}};const Dp={bigint:{replace:e=>({$t:"bigint",v:""+e}),revive:e=>BigInt(e.v)}};var Rp={Date:{replace:e=>({$t:"Date",v:isNaN(e.getTime())?"NaN":e.toISOString()}),revive:({v:e})=>new Date(e==="NaN"?NaN:Date.parse(e))}},Np={Set:{replace:e=>({$t:"Set",v:Array.from(e.entries())}),revive:({v:e})=>new Set(e)}},Lp={Map:{replace:e=>({$t:"Map",v:Array.from(e.entries())}),revive:({v:e})=>new Map(e)}};const Mp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0;var qp=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","DataView","BigInt64Array","BigUint64Array"].reduce((e,t)=>({...e,[t]:{replace:(n,r,i)=>({$t:t,v:i.ArrayBuffer.replace(n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength),r,i).v}),revive:({v:n},r,i)=>{const a=Mp[t];return a&&new a(i.ArrayBuffer.revive({v:n},r,i))}}}),{});function Bc(e){return function(t){for(var n="",r=0,i=t.length;r<i;r++)n+=Kc[t[r]];return n}(di(e))}function Fp(e){return Rc(function(t){if(typeof t!="string")throw new Error("invalid decoder input: "+t);for(var n="",r=0,i=t.length;r<i;r++)n+=Va[t[r]];return n}(e))}const Va={"-":"=",0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",A:"K",B:"L",C:"M",D:"N",E:"O",F:"P",G:"Q",H:"R",I:"S",J:"T",K:"U",L:"V",M:"W",N:"X",O:"Y",P:"Z",Q:"a",R:"b",S:"c",T:"d",U:"e",V:"f",W:"g",X:"h",Y:"i",Z:"j",_:"k",a:"l",b:"m",c:"n",d:"o",e:"p",f:"q",g:"r",h:"s",i:"t",j:"u",k:"v",l:"w",m:"x",n:"y",o:"z",p:"0",q:"1",r:"2",s:"3",t:"4",u:"5",v:"6",w:"7",x:"8",y:"9",z:"+","|":"/"},Kc={};for(const e of Object.keys(Va))Kc[Va[e]]=e;var Up={ArrayBuffer:{replace:e=>({$t:"ArrayBuffer",v:Bc(e)}),revive:({v:e})=>{const t=Fp(e);return t.buffer.byteLength===t.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}}};class ya{constructor(t,n){this.buf=t,this.type=n}}function Bp(e){const t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return t.responseText}function Kp(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}var zp={Blob:{test:(e,t)=>t==="Blob"||e instanceof ya,replace:e=>({$t:"Blob",v:di(e instanceof ya?e.buf:Kp(Bp(e))),type:e.type}),revive:({type:e,v:t})=>{const n=Rc(t);return typeof Blob!==void 0?new Blob([n]):new ya(n.buffer,e)}}};const zc={...jp,...Dp,...Rp,...Np,...Lp,...qp,...Up,...zp};function Hl(e){return new Promise((t,n)=>{const r=new FileReader;r.onabort=i=>n(new Error("file read aborted")),r.onerror=i=>n(i.target.error),r.onload=i=>t(i.target.result),r.readAsArrayBuffer(e)})}var Vp={undefined:{replace:()=>({$t:"undefined"}),revive:()=>{}}};const Wp=typeof BigInt=="function"&&typeof BigInt(0)=="bigint";class Yl{toString(){return this.v}constructor(t){this.v=t}}const Hp=Wp?{}:{bigint:{test:e=>e instanceof Yl,replace:e=>Object.assign({$t:"bigint"},e),revive:({v:e})=>new Yl(e)}},Vc=Object.assign(Object.assign(Object.assign({},Vp),Hp),{PropModification:{test:e=>e instanceof _l,replace:e=>Object.assign({$t:"PropModification"},e["@@propmod"]),revive:e=>{var t=function(n,r){var i={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&r.indexOf(a)<0&&(i[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(a=Object.getOwnPropertySymbols(n);l<a.length;l++)r.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(n,a[l])&&(i[a[l]]=n[a[l]])}return i}(e,["$t"]);return new _l(t)}}}),ao=Uc(zc,Vc),Yp=function(...e){const t=Uc(zc,Tp,...e);return{toBinary(n){const[r,i]=this.stringify(n),a=new ArrayBuffer(4);return new DataView(a).setUint32(0,r.size),new Blob([a,r,i])},stringify(n){const r=[],i=t.stringify(n,r);return[new Blob(r.map(l=>{const c=new ArrayBuffer(4);return new DataView(c).setUint32(0,"byteLength"in l?l.byteLength:l.size),new Blob([c,l])})),i]},async parse(n,r){let i=0;const a=[],l=await Hl(r),c=new DataView(l);for(;i<l.byteLength;){const d=c.getUint32(i);i+=4;const v=l.slice(i,i+d);i+=d,a.push(v)}return t.parse(n,a)},async fromBinary(n){const r=new DataView(await Hl(n.slice(0,4))).getUint32(0),i=n.slice(4,r+4),a=await function(l){return new Promise((c,d)=>{const v=new FileReader;v.onabort=u=>d(new Error("file read aborted")),v.onerror=u=>d(u.target.error),v.onload=u=>c(u.target.result),v.readAsText(l)})}(n.slice(r+4));return await this.parse(a,i)}}}(Vc);function Gp(e,t,n){const r=[];for(let i of n){const{table:a,muts:l}=i,c=e.tables.find(u=>u.name===a);if(!c)throw new Error(`Internal error: table ${a} not found in DBCore schema`);const{primaryKey:d}=c;let v=i;l.forEach((u,m)=>{const y=!d.outbound&&(u.type==="upsert"||u.type==="insert");u.keys.forEach((g,_)=>{if(Array.isArray(g)){v===i&&(v=Gl(i,y));const k=v.muts[m],O=JSON.stringify(g);k.keys[_]=O}else if(g[0]==="#"){v===i&&(v=Gl(i,y));const k=v.muts[m];if(!t.isLoggedIn)throw new Error("Internal error: Cannot sync private IDs before authenticated");const O=`${g}:${t.userId}`;k.keys[_]=O,y&&at.setByKeyPath(k.values[_],d.keyPath,O)}})}),r.push(v)}return r}function Gl(e,t){return Object.assign(Object.assign({},e),{muts:t?e.muts.map(n=>n.type!=="insert"&&n.type!=="upsert"||!n.values?Object.assign(Object.assign({},n),{keys:n.keys.slice()}):Object.assign(Object.assign({},n),{keys:n.keys.slice(),values:n.values.slice()})):e.muts.map(n=>Object.assign(Object.assign({},n),{keys:n.keys.slice()}))})}let Wa=new WeakMap;function Wc(e){var t,n;return Ae(this,void 0,void 0,function*(){const r=((n=(t=Wa.get(e))===null||t===void 0?void 0:t.getTime())!==null&&n!==void 0?n:0)-Date.now();r>0&&(yield new Promise(i=>setTimeout(i,r)))})}function Jp(e,t,n,r,i,a,l,c){return Ae(this,void 0,void 0,function*(){const d={Accept:"application/json, application/x-bison, application/x-bison-stream","Content-Type":"application/tson"},v=yield ps(r),u=v==null?void 0:v.accessToken;u&&(d.Authorization=`Bearer ${u}`);const m={v:2,dbID:t==null?void 0:t.remoteDbId,clientIdentity:l,schema:a||{},lastPull:t?{serverRevision:t.serverRevision,realms:t.realms,inviteRealms:t.inviteRealms}:void 0,baseRevs:n,changes:Gp(r.dx.core.schema,c,e)};r.syncStateChangedEvent.next({phase:"pushing"});const y=yield fetch(`${i}/sync`,{method:"post",headers:d,credentials:"include",body:ao.stringify(m)});if(r.syncStateChangedEvent.next({phase:"pulling"}),function(g,_){const k=_.headers.get("Ratelimit-Limit"),O=_.headers.get("Ratelimit-Remaining"),C=_.headers.get("Ratelimit-Reset");if(k&&O&&C){const S=Number(k),x=Math.max(0,Number(O)),A=Number(C);if(x<S/2){const q=Math.ceil(A/(x+1));Wa.set(g,new Date(Date.now()+1e3*q))}else Wa.delete(g)}}(r,y),!y.ok)throw new Ua(y);if(y.headers.get("content-type")==="application/x-bison")return Yp.fromBinary(yield y.blob());{const g=yield y.text();return ao.parse(g)}})}function Qr(e){if(e!=null&&e.cancelled)throw new at.AbortError("Operation was cancelled")}let pr=!1;function Hc(e,t,n,r){return Ae(this,void 0,void 0,function*(){yield e.$baseRevs.bulkPut(Object.keys(t).filter(i=>t[i].markedForSync).map(i=>({tableName:i,clientRev:(n[i]||0)+1,serverRev:r}))),yield e.$baseRevs.where("tableName").noneOf(Object.keys(t).filter(i=>t[i].markedForSync)).delete()})}function Ha(e,t={}){for(const{table:n,muts:r}of e){const i=r.length>0?r[r.length-1].rev:null;t[n]=i||t[n]||0}return t}function Qp(e,t,n){return Ae(this,void 0,void 0,function*(){const r=yield e.bulkGet(t),i=[],a=[];t.forEach((l,c)=>{const d=r[c];if(d){for(const[v,u]of Object.entries(n[c]))if(v===e.schema.primKey.keyPath){if(th(u,l)!==0)throw new Error("Cannot change primary key")}else at.setByKeyPath(d,v,u);i.push(l),a.push(d)}}),yield e.schema.primKey.keyPath==null?e.bulkPut(a,i):e.bulkPut(a)})}function Yc(e,t){return Ae(this,void 0,void 0,function*(){for(const{table:n,muts:r}of e){const i=t.table(n);if(!i)continue;const{primaryKey:a}=i.core.schema,l=c=>{switch(c[0]){case"[":if(c.endsWith("]"))try{return JSON.parse(c)}catch{}return c;case"#":return c.endsWith(":"+t.cloud.currentUserId)?c.substr(0,c.length-t.cloud.currentUserId.length-1):c;default:return c}};for(const c of r){const d=c.keys.map(l);switch(c.type){case"insert":a.outbound?yield i.bulkAdd(c.values,d):(d.forEach((v,u)=>{at.setByKeyPath(c.values[u],a.keyPath,v)}),yield i.bulkAdd(c.values));break;case"upsert":a.outbound?yield i.bulkPut(c.values,d):(d.forEach((v,u)=>{at.setByKeyPath(c.values[u],a.keyPath,v)}),yield i.bulkPut(c.values));break;case"modify":d.length===1?yield i.update(d[0],c.changeSpec):yield i.where(":id").anyOf(d).modify(c.changeSpec);break;case"update":yield Qp(i,d,c.changeSpecs);break;case"delete":yield i.bulkDelete(d)}}}})}typeof self<"u"&&typeof navigator<"u"&&(pr=navigator.onLine,self.addEventListener("online",()=>pr=!0),self.addEventListener("offline",()=>pr=!1));const Zp="currentSyncWorker";function ui(e,t,n,r){return Gc.apply(this,arguments).then(i=>(r!=null&&r.justCheckIfNeeded||e.syncStateChangedEvent.next({phase:"in-sync"}),i)).catch(i=>Ae(this,void 0,void 0,function*(){return r!=null&&r.justCheckIfNeeded?Promise.reject(i):pr&&(r!=null&&r.retryImmediatelyOnFetchError)&&(i==null?void 0:i.name)==="TypeError"&&/fetch/.test(i==null?void 0:i.message)?(e.syncStateChangedEvent.next({phase:"error",error:i}),yield new Promise(a=>setTimeout(a,500)),yield ui(e,t,n,Object.assign(Object.assign({},r),{retryImmediatelyOnFetchError:!1}))):(yield e.$syncState.update("syncState",{timestamp:new Date,error:""+i}),e.syncStateChangedEvent.next({phase:pr?"error":"offline",error:new Error(""+(i==null?void 0:i.message)||i)}),Promise.reject(i))}))}function Gc(e,t,n,{isInitialSync:r,cancelToken:i,justCheckIfNeeded:a,purpose:l}={isInitialSync:!1}){var c;return Ae(this,void 0,void 0,function*(){if(!(!((c=e.cloud.options)===null||c===void 0)&&c.databaseUrl))throw new Error("Internal error: sync must not be called when no databaseUrl is configured");const{databaseUrl:d}=t,v=yield e.getCurrentUser(),u=v.isLoggedIn?Zi(e):[],m=u.map(te=>e.table(ms(te.name))),y=yield e.getPersistedSyncState(),g=!r&&v.isLoggedIn,_=g?function(te,J){const Y=(J==null?void 0:J.syncedTables)||[];return Zi(te).filter(ne=>!Y.includes(ne.name))}(e,y):[];Qr(i);const k=_.length>0;if(k){if(a)return!0;yield e.transaction("rw",_,te=>Ae(this,void 0,void 0,function*(){te.idbtrans.disableChangeTracking=!0,te.idbtrans.disableAccessControl=!0,yield function(J,Y,ne){return Ae(this,void 0,void 0,function*(){const ee=new Set(ne||[]);for(const V of J)V.name==="members"?yield V.toCollection().modify(Z=>{ee.has(Z.realmId)||Z.userId&&Z.userId!==Rt.userId||(Z.userId=Y.userId)}):V.name==="roles"||(V.name==="realms"?yield V.toCollection().modify(Z=>{ee.has(Z.realmId)||Z.owner!==void 0&&Z.owner!==Rt.userId||(Z.owner=Y.userId)}):yield V.toCollection().modify(Z=>{Z.realmId&&ee.has(Z.realmId)||(Z.owner&&Z.owner!==Rt.userId||(Z.owner=Y.userId),Z.realmId&&Z.realmId!==Rt.userId||(Z.realmId=Y.userId))}))})}(_,v,y==null?void 0:y.realms)})),Qr(i)}const[O,C,S]=yield e.transaction("r",e.tables,()=>Ae(this,void 0,void 0,function*(){const te=yield e.getPersistedSyncState();let J=yield e.$baseRevs.toArray();J=J.filter(ne=>u.some(ee=>ee.name===ne.tableName));let Y=yield za(m);if(Qr(i),k){const ne=[...(y==null?void 0:y.realms)||[],...(y==null?void 0:y.inviteRealms)||[]],ee=yield function(V,Z,oe,se){return Ae(this,void 0,void 0,function*(){const je=`upload-${Fc(8)}`;if(Z.isLoggedIn&&V.length>0){const Te=new Set(se||[]);return(yield Promise.all(V.map(fe=>Ae(this,void 0,void 0,function*(){const{extractKey:B}=fe.core.schema.primaryKey;if(!B)return{table:fe.name,muts:[]};const Ne=oe[fe.name],Le=Ne!=null&&Ne.generatedGlobalId?fe.filter(Ze=>{return B(Ze),!Te.has(Ze.realmId||"")&&(He=B(Ze),!(Je=Ne==null?void 0:Ne.idPrefix)||typeof He=="string"&&He.startsWith(Je));var He,Je}):fe.filter(Ze=>{const He=B(Ze);return!Te.has(Ze.realmId||"")&&cs(He)}),Fe=yield Le.toArray();if(Fe.length>0){const Ze={type:"upsert",values:Fe,keys:Fe.map(B),userId:Z.userId,txid:je};return{table:fe.name,muts:[Ze]}}return{table:fe.name,muts:[]}})))).filter(fe=>fe.muts.length>0)}return[]})}(_,v,n,ne);return Qr(i),Y=Y.concat(ee),[Y,te,J]}return[Y,te,J]})),x=O.some(te=>te.muts.some(J=>J.keys.length>0));if(a)return x;if(l==="push"&&!x)return!1;const A=Ha(O,C==null?void 0:C.latestRevisions),q=(C==null?void 0:C.clientIdentity)||pc(16);Qr(i);const D=yield Jp(O,C,S,e,d,n,q,v);return(yield e.transaction("rw",e.tables,te=>Ae(this,void 0,void 0,function*(){te.idbtrans.disableChangeTracking=!0,te.idbtrans.disableAccessControl=!0;for(const V of Object.keys(n))D.schema[V]&&(n[V]=D.schema[V]);yield e.$syncState.put(n,"schema");const J=yield za(m,0,{since:A});for(const V of m){const Z=Mc(V.name);if(J.some(oe=>oe.table===Z&&oe.muts.length>0)){if(A[Z]){const oe=A[Z]||0;yield Promise.all([V.where("rev").belowOrEqual(oe).delete(),e.$baseRevs.where(":id").between([Z,-1/0],[Z,oe+1],!0,!0).reverse().offset(1).delete()])}}else yield Promise.all([V.clear(),e.$baseRevs.where({tableName:Z}).delete()])}Ha(J,A),yield Hc(e,n,A,D.serverRevision);const Y=yield e.getPersistedSyncState();yield function(V,Z,oe){return Ae(this,void 0,void 0,function*(){const se=new Set,je=new Set,Te=oe?oe.realms:[],fe=oe?oe.inviteRealms:[],B=new Set(Z.realms),Ne=new Set(Z.realms.concat(Z.inviteRealms));for(const Le of Te)B.has(Le)||(je.add(Le),Ne.has(Le)||se.add(Le));for(const Le of fe.concat(Te))Ne.has(Le)||se.add(Le);if(se.size>0||je.size>0){const Le=Zi(V);for(const Fe of Le){let Ze=["realms","members","roles"].includes(Fe.name)?se:je;Ze.size!==0&&(Fe.schema.indexes.some(He=>He.keyPath==="realmId"||Array.isArray(He.keyPath)&&He.keyPath[0]==="realmId")?yield Fe.where("realmId").anyOf([...Ze]).delete():yield Fe.filter(He=>!!(He!=null&&He.realmId)&&Ze.has(He.realmId)).delete())}}})}(e,D,Y);const ne=Y||{syncedTables:[],latestRevisions:{},realms:[],inviteRealms:[],clientIdentity:q};g&&(ne.syncedTables=u.map(V=>V.name).concat(_.map(V=>V.name))),ne.latestRevisions=A,ne.remoteDbId=D.dbId,ne.initiallySynced=!0,ne.realms=D.realms,ne.inviteRealms=D.inviteRealms,ne.serverRevision=D.serverRevision,ne.timestamp=new Date,delete ne.error;const ee=Jc(D.changes,J);return yield Yc(ee,e),e.$syncState.put(ne,"syncState"),J.length===0})))?(e.syncCompleteEvent.next(),!1):(yield Wc(e),yield Gc(e,t,n,{isInitialSync:r,cancelToken:i}))})}function Jc(e,t){const n={};Pl(n,e);const r={};return Pl(r,t),function(i,a){var l,c,d;for(const[v,u]of Object.entries(a))for(const[m,y]of Object.entries(u))switch(y.type){case"ups":{const g=(l=i[v])===null||l===void 0?void 0:l[m];if(g)switch(g.type){case"ups":case"upd":delete i[v][m]}}break;case"del":(c=i[v])===null||c===void 0||delete c[m];break;case"upd":{const g=(d=i[v])===null||d===void 0?void 0:d[m];if(g)switch(g.type){case"ups":for(const[_,k]of Object.entries(y.mod))oo(g.val,_,k);break;case"del":break;case"upd":for(const _ of Object.keys(y.mod))delete g.mod[_]}break}}}(n,r),function(i,a=""){a||(a=pc(16));const l={};for(const[d,v]of Object.entries(i))for(const[u,m]of Object.entries(v)){const y=l[d]||(l[d]={});(y[m.type]||(y[m.type]=[])).push(Object.assign({key:u},m))}const c=[];for(const[d,v]of Object.entries(l)){const u={table:d,muts:[]};for(const[m,y]of Object.entries(v))switch(m){case"ups":{const g={type:"upsert",keys:y.map(_=>_.key),values:y.map(_=>_.val),txid:a};u.muts.push(g);break}case"upd":{const g={type:"update",keys:y.map(_=>_.key),changeSpecs:y.map(_=>_.mod),txid:a};u.muts.push(g);break}case"del":{const g={type:"delete",keys:y.map(_=>_.key),txid:a};u.muts.push(g);break}}c.push(u)}return c}(n)}const Xp=10,$p=1e4,ey=1e3;function ty(e){const t=[],n=new Xt(!0),r=new Xt(null);let i=!1,a=new Array(Xp).fill(0);return r.subscribe(()=>Ae(this,void 0,void 0,function*(){if(!i&&t.length>0){i=!0,a.shift(),a.push(Date.now()),n.next(!1);try{yield function(){var l,c,d,v,u,m;return Ae(this,void 0,void 0,function*(){for(;t.length>0;){const y=t.shift();try{yield vr(e.cloud.syncState.pipe(ln(({phase:_})=>_==="in-sync"||_==="error")));const g=e.cloud.persistedSyncState.value;if(!y)continue;switch(y.type){case"token-expired":const _=e.cloud.currentUser.value,k=yield ko(e.cloud.options.databaseUrl,_);yield e.table("$logins").update(_.userId,{accessToken:k.accessToken,accessTokenExpiration:k.accessTokenExpiration,claims:k.claims,license:k.license,data:k.data});break;case"realm-added":!((l=g==null?void 0:g.realms)===null||l===void 0)&&l.includes(y.realm)||!((c=g==null?void 0:g.inviteRealms)===null||c===void 0)&&c.includes(y.realm)||(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-accepted":!((d=g==null?void 0:g.realms)===null||d===void 0)&&d.includes(y.realm)||(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-removed":(!((v=g==null?void 0:g.realms)===null||v===void 0)&&v.includes(y.realm)||!((u=g==null?void 0:g.inviteRealms)===null||u===void 0)&&u.includes(y.realm))&&(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realms-changed":yield e.cloud.sync({purpose:"pull",wait:!0});break;case"changes":if(((m=e.cloud.syncState.value)===null||m===void 0?void 0:m.phase)==="error"){bn(e,"pull");break}yield e.transaction("rw",e.dx.tables,O=>Ae(this,void 0,void 0,function*(){O.idbtrans.disableChangeTracking=!0,O.idbtrans.disableAccessControl=!0;const[C,S,x]=yield Promise.all([e.getSchema(),e.getPersistedSyncState(),e.getCurrentUser()]);if(!S||!C||!x)return;if(y.baseRev!==S.serverRevision)return void(typeof y.baseRev!="string"||typeof S.serverRevision!="bigint"&&typeof S.serverRevision!="object"||bn(e,"pull"));if((yield at.waitFor(Ka(S)))!==y.realmSetHash)return void bn(e,"pull");let A=[];if(x.isLoggedIn){const q=Zi(e).map(D=>e.table(ms(D.name)));A=yield za(q)}if(y.changes.length>0){const q=Jc(y.changes,A);yield Yc(q,e)}S.latestRevisions=Ha(A,S.latestRevisions),S.serverRevision=y.newRev,yield Hc(e,C,S.latestRevisions,y.newRev),yield e.$syncState.put(S,"syncState")}))}}catch{}}})}()}finally{a[a.length-1]-a[0]<$p&&(yield new Promise(l=>setTimeout(l,ey))),i=!1,n.next(!0)}}})),{enqueue:function(l){t.push(l),r.next(null)},readyToServe:n}}const Jl=new WeakMap,Ki={members:"@id, [userId+realmId], [email+realmId], realmId",roles:"[realmId+name]",realms:"@realmId",$jobs:"",$syncState:"",$baseRevs:"[tableName+clientRev]",$logins:"claims.sub, lastLogin"};let ny=0;function yn(e){"vip"in e&&(e=e.vip);let t=Jl.get(e.cloud);if(!t){const n=new fi;let r=new Bi(`syncstatechanged-${e.name}`),i=new Bi(`synccomplete-${e.name}`);n.id=++ny;let a=!1;t={get name(){return e.name},close:()=>e.close(),transaction:e.transaction.bind(e),table:e.table.bind(e),get tables(){return e.tables},cloud:e.cloud,get $jobs(){return e.table("$jobs")},get $syncState(){return e.table("$syncState")},get $baseRevs(){return e.table("$baseRevs")},get $logins(){return e.table("$logins")},get realms(){return e.realms},get members(){return e.members},get roles(){return e.roles},get initiallySynced(){return a},localSyncEvent:n,get syncStateChangedEvent(){return r},get syncCompleteEvent(){return i},dx:e},Object.assign(t,{getCurrentUser:()=>t.$logins.toArray().then(c=>c.find(d=>d.isLoggedIn)||Rt),getPersistedSyncState:()=>t.$syncState.get("syncState"),getSchema:()=>t.$syncState.get("schema").then(c=>{if(c)for(const v of t.tables)v.schema.primKey&&v.schema.primKey.keyPath&&c[v.name]&&(c[v.name].primaryKey=typeof(d=v.schema.primKey.keyPath)=="string"?d:d?"["+[].join.call(d,"+")+"]":"");var d;return c}),getOptions:()=>t.$syncState.get("options"),setInitiallySynced(c){a=c},reconfigure(){r=new Bi(`syncstatechanged-${e.name}`),i=new Bi(`synccomplete-${e.name}`)}}),t.messageConsumer=ty(t),Jl.set(e.cloud,t)}return t}const ry=typeof InstallTrigger<"u",Qc=typeof navigator<"u"&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\/|Edge\//.test(navigator.userAgent),iy=Qc?[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]:NaN,oy=Qc&&iy<=605||ry,ay=typeof self<"u"&&"clients"in self&&!self.document;function Zc(){throw new at.SchemaError("Version increment needed to allow dexie-cloud change tracking")}const{toString:sy}={};function Ql(e){return sy.call(e).slice(8,-1)}function ma(e,t){var n;return t.type==="delete"?t.keys:((n=t.keys)===null||n===void 0?void 0:n.slice())||t.values.map(e.extractKey)}const ly=/b|c|d|f|g|h|j|k|l|m|n|p|q|r|s|t|v|x|y|z/i;let mn=0;function Xc(e,t){const n=new Uint8Array(18),r=new Uint8Array(n.buffer,0,6),i=Date.now();mn>=i?++mn:mn=i,r[0]=mn/1099511627776,r[1]=mn/4294967296,r[2]=mn/16777216,r[3]=mn/65536,r[4]=mn/256,r[5]=mn;const a=new Uint8Array(n.buffer,6);return crypto.getRandomValues(a),e+Bc(new Uint8Array(n.buffer))+(t||"")}function uy(e){return{stack:"dbcore",name:"idGenerationMiddleware",level:1,create:t=>Object.assign(Object.assign({},t),{table:n=>{const r=t.table(n);return Object.assign(Object.assign({},r),{mutate:i=>{var a,l;if(i.trans.disableChangeTracking)return r.mutate(i);if(i.type==="add"||i.type==="put"){const c=(a=e.cloud.schema)===null||a===void 0?void 0:a[n];if(c!=null&&c.generatedGlobalId){if(!((l=e.cloud.options)===null||l===void 0)&&l.databaseUrl&&!e.initiallySynced){const d=ma(r.schema.primaryKey,i);return r.getMany({keys:d,trans:i.trans,cache:"immutable"}).then(v=>{if(v.length<d.length)throw new Error("Unable to create new objects without an initial sync having been performed.");return r.mutate(i)})}return function(d,v){let u=null;const m=ma(r.schema.primaryKey,d);return m.forEach((y,g)=>{if(y===void 0){const _=d.values[g].realmId||e.cloud.currentUserId,k=_.substr(_.length-3);m[g]=Xc(v,k),r.schema.primaryKey.outbound||(u||(u=d.values.slice()),u[g]=at.deepClone(u[g]),at.setByKeyPath(u[g],r.schema.primaryKey.keyPath,m[g]))}else if(typeof y!="string"||!y.startsWith(v)&&!y.startsWith("#"+v))throw new at.ConstraintError(`The ID "${y}" is not valid for table "${n}". Primary '@' keys requires the key to be prefixed with "${v}" (or "#${v}).
If you want to generate IDs programmatically, remove '@' from the schema to get rid of this constraint. Dexie Cloud supports custom IDs as long as they are random and globally unique.`)}),r.mutate(Object.assign(Object.assign({},d),{keys:m,values:u||d.values}))}(i,c.idPrefix)}c!=null&&c.markedForSync&&ma(r.schema.primaryKey,i).forEach((d,v)=>{if(!cs(d)){const u=Array.isArray(d)?d.map(Ql).join(","):Ql(d);throw new at.ConstraintError(`Invalid primary key type ${u} for table ${n}. Tables marked for sync has primary keys of type string or Array of string (and optional numbers)`)}})}return r.mutate(i)}})}})}}let cy=0;function Zr(e,t){return function(n){const{readers:r,writers:i}=n.trans[t]||(n.trans[t]={writers:[],readers:[]}),a=i.length,l=(a>0?i[a-1].then(()=>e(n),()=>e(n)):e(n)).finally(()=>{r.splice(r.indexOf(l))});return r.push(l),l}}function fy(e,t){return function(n){const{readers:r,writers:i}=n.trans[t]||(n.trans[t]={writers:[],readers:[]});let a=(i.length>0?i[i.length-1].then(()=>e(n),()=>e(n)):r.length>0?(l=r,new Promise(c=>{l.length===0&&c([]);let d=l.length;const v=new Array(d);l.forEach((u,m)=>Promise.resolve(u).then(y=>v[m]={status:"fulfilled",value:y},y=>v[m]={status:"rejected",reason:y}).then(()=>--d||c(v)))})).then(()=>e(n)):e(n)).finally(()=>{i.shift()});var l;return i.push(a),a}}const sr=new Xt(new Set);function $c(e){var t,n,r,i;return((t=e.cloud.options)===null||t===void 0?void 0:t.disableEagerSync)||((r=(n=e.cloud.currentUser.value)===null||n===void 0?void 0:n.license)===null||r===void 0?void 0:r.status)!=="ok"||!(!((i=e.cloud.options)===null||i===void 0)&&i.databaseUrl)}function dy({currentUserObservable:e,db:t}){return{stack:"dbcore",name:"MutationTrackingMiddleware",level:1,create:n=>{const r=n.schema.tables.filter(a=>!/^\$/.test(a.name));let i;try{i=new Map(r.map(a=>[a.name,n.table(`$${a.name}_mutations`)]))}catch{Zc()}return Object.assign(Object.assign({},n),{transaction:(a,l)=>{let c;if(l==="readwrite"){const d=a.filter(v=>{var u,m;return(m=(u=t.cloud.schema)===null||u===void 0?void 0:u[v])===null||m===void 0?void 0:m.markedForSync}).map(v=>ms(v));c=n.transaction([...a,...d],l)}else c=n.transaction(a,l);if(l==="readwrite"){c.txid=Fc(16),c.opCount=0,c.currentUser=e.value,sr.value.add(c),sr.next(sr.value);const d=()=>{c.removeEventListener("complete",v),c.removeEventListener("error",d),c.removeEventListener("abort",d),sr.value.delete(c),sr.next(sr.value)},v=()=>{c.mutationsAdded&&!$c(t)&&bn(t,"push"),d()};c.addEventListener("complete",v),c.addEventListener("error",d),c.addEventListener("abort",d)}return c},table:a=>{const l=n.table(a);if(/^\$/.test(a))return a.endsWith("_mutations")?Object.assign(Object.assign({},l),{mutate:u=>(u.type!=="add"&&u.type!=="put"||(u.trans.mutationsAdded=!0),l.mutate(u))}):a==="$logins"?Object.assign(Object.assign({},l),{mutate:u=>l.mutate(u).then(m=>(u.trans.mutationsAdded=!0,m)).catch(m=>Promise.reject(m))}):l;const{schema:c}=l,d=i.get(a);return function(u){const m="$lock"+ ++cy;return Object.assign(Object.assign({},u),{count:Zr(u.count,m),get:Zr(u.get,m),getMany:Zr(u.getMany,m),openCursor:Zr(u.openCursor,m),query:Zr(u.query,m),mutate:fy(u.mutate,m)})}(Object.assign(Object.assign({},l),{mutate:u=>{var m,y,g;const _=u.trans;return _.txid?_.disableChangeTracking?l.mutate(u):!((y=(m=t.cloud.schema)===null||m===void 0?void 0:m[a])===null||y===void 0)&&y.markedForSync&&(!((g=_.currentUser)===null||g===void 0)&&g.isLoggedIn)?u.type==="deleteRange"?l.query({query:{range:u.range,index:c.primaryKey},trans:u.trans,values:!1}).then(k=>v({type:"delete",keys:k.result,trans:u.trans,criteria:{index:null,range:u.range}})):v(u):l.mutate(u):l.mutate(u)}}));function v(u){const m=u.trans;m.mutationsAdded=!0;const{txid:y,currentUser:{userId:g}}=m,{type:_}=u,k=++m.opCount;return l.mutate(u).then(O=>{const{numFailures:C,failures:S}=O;let x=_==="delete"?u.keys:O.results,A="values"in u?u.values:[],q="updates"in u&&u.updates;C&&(x=x.filter((te,J)=>!S[J]),A=A.filter((te,J)=>!S[J]));const D=Date.now(),W=u.type==="delete"?{type:"delete",ts:D,opNo:k,keys:x,criteria:u.criteria,txid:y,userId:g}:u.type==="add"?{type:"insert",ts:D,opNo:k,keys:x,txid:y,userId:g,values:A}:u.criteria&&u.changeSpec?{type:"modify",ts:D,opNo:k,keys:x,criteria:u.criteria,changeSpec:u.changeSpec,txid:y,userId:g}:q?{type:"update",ts:D,opNo:k,keys:q.keys,changeSpecs:q.changeSpecs,txid:y,userId:g}:{type:"upsert",ts:D,opNo:k,keys:x,values:A,txid:y,userId:g};return"isAdditionalChunk"in u&&u.isAdditionalChunk&&(W.isAdditionalChunk=!0),x.length>0||"criteria"in u&&u.criteria?d.mutate({type:"add",trans:m,values:[W]}).then(()=>O):O})}}})}}}function vy(e,t){return function(n,r){const i=Object.assign(Object.assign({},Ki),n);Object.keys(Ki).forEach(c=>{const d=i[c];if(d==null)throw new Error(`Cannot delete table ${c} as it is needed for access control of Dexie Cloud`);if(!n[c])return;const v=d.split(",").map(y=>y.trim()),u=Ki[c].split(",").map(y=>y.trim()),m=new Set(v.map(y=>y.replace(/([&*]|\+\+)/g,"")));if(v[0]!==u[0])throw new Error(`Cannot override primary key of table ${c}. Please declare it as {${c}: ${JSON.stringify(Ki[c])}`);for(let y=1;y<u.length;++y){const g=u[y];m.has(g.replace(/([&*]|\+\+)/g,""))||(i[c]+=`,${g}`)}});const a=t.cloud.schema||(t.cloud.schema={}),l=new Set;return Object.keys(i).forEach(c=>{const d=i[c],v=a[c]||(a[c]={});d!=null?(/^\@/.test(d)&&(i[c]=i[c].substr(1),v.generatedGlobalId=!0,v.idPrefix=function(u,m){let y=u[0].toLocaleLowerCase();for(let O=1,C=u.length;O<C&&y.length<3;++O)(ly.test(u[O])||(g=u[O])>="A"&&g<="Z")&&(y+=u[O].toLowerCase());for(var g,_,k;m.has(y);){if(/\d/g.test(y)){if(y=y.substr(0,y.length-1)+(y[y.length-1]+1),!(y.length>3))continue;y=y.substr(0,3)}else if(y.length<3){y+="2";continue}let O=1,C=y;for(;m.has(C)&&O<8;)_=y,C=(1&(k=O)?_[0].toUpperCase():_[0].toLowerCase())+(2&k?_[1].toUpperCase():_[1].toLowerCase())+(4&k?_[2].toUpperCase():_[2].toLowerCase()),++O;if(O<8)y=C;else{let S=y.charCodeAt(2)+1&127;y=y.substr(0,2)+String.fromCharCode(S)}}return y}(c,l),l.add(v.idPrefix)),/^\$/.test(c)||(i[`$${c}_mutations`]="++rev",v.markedForSync=!0),v.deleted&&(v.deleted=!1)):(v.deleted=!0,v.markedForSync=!1,i[`$${c}_mutations`]=null)}),e.call(this,i,r)}}const ni=new Xt(!0),Ya=new Xt(!0);ni.pipe(Ct(e=>e?_n(!0):_n(!1).pipe(Tc(2e4))),jc()).subscribe(Ya);const ef=typeof document<"u"?un(document,"visibilitychange"):_n({}),hy=ef.pipe(ln(()=>document.visibilityState==="hidden")),py=ef.pipe(ln(()=>document.visibilityState==="visible")),tf=typeof window<"u"?dc(py,un(window,"mousedown"),un(window,"mousemove"),un(window,"keydown"),un(window,"wheel"),un(window,"touchmove")):_n({});typeof document<"u"&&dc(_n(!0),hy,tf).pipe(cn(()=>document.visibilityState==="visible"),Bl(e=>{ni.value!==e&&ni.next(e)}),Ct(e=>e?_n(0).pipe(Tc(16e4),Bl(()=>ni.next(!1))):_n(0))).subscribe(()=>{});class yy extends Error{constructor(){super(...arguments),this.name="TokenExpiredError"}}class my extends pt{constructor(t,n,r,i,a,l,c,d){super(v=>new by(t,n,r,i,c,d,v,a,l))}}let gy=0;class by extends Or{constructor(t,n,r,i,a,l,c,d,v){super(()=>this.teardown()),this.id=++gy,this.reconnecting=!1,this.databaseUrl=t,this.rev=n,this.realmSetHash=r,this.clientIdentity=i,this.token=a,this.tokenExpiration=l,this.subscriber=c,this.lastUserActivity=new Date,this.messageProducer=d,this.messageProducerSubscription=null,this.webSocketStatus=v,this.connect()}teardown(){this.disconnect()}disconnect(){if(this.webSocketStatus.next("disconnected"),this.pinger&&(clearInterval(this.pinger),this.pinger=null),this.ws)try{this.ws.close()}catch{}this.ws=null,this.messageProducerSubscription&&(this.messageProducerSubscription.unsubscribe(),this.messageProducerSubscription=null)}reconnect(){if(!this.reconnecting){this.reconnecting=!0;try{this.disconnect()}catch{}this.connect().catch(()=>{}).then(()=>this.reconnecting=!1)}}connect(){return Ae(this,void 0,void 0,function*(){if(this.lastServerActivity=new Date,this.pauseUntil&&this.pauseUntil>new Date)return;if(this.ws)throw new Error("Called connect() when a connection is already open");if(!this.databaseUrl)throw new Error("Cannot connect without a database URL");if(this.closed)return;if(this.tokenExpiration&&this.tokenExpiration<new Date)return void this.subscriber.error(new yy);this.webSocketStatus.next("connecting"),this.pinger=setInterval(()=>Ae(this,void 0,void 0,function*(){if(this.closed)this.teardown();else if(this.ws)try{this.ws.send(JSON.stringify({type:"ping"})),setTimeout(()=>{this.pinger&&(this.closed?this.teardown():this.lastServerActivity<new Date(Date.now()-2e4)&&this.reconnect())},2e4)}catch{this.reconnect()}else this.reconnect()}),3e4);const t=new URL(this.databaseUrl);t.protocol=t.protocol==="http:"?"ws":"wss";const n=new URLSearchParams;if(this.subscriber.closed)return;n.set("v","2"),n.set("rev",this.rev),n.set("realmsHash",this.realmSetHash),n.set("clientId",this.clientIdentity),this.token&&n.set("token",this.token);const r=this.ws=new WebSocket(`${t}/changes?${n}`);r.onclose=i=>{this.pinger&&this.reconnect()},r.onmessage=i=>{if(this.pinger){this.lastServerActivity=new Date;try{const a=ao.parse(i.data);if(a.type==="error")throw new Error(`Error message from dexie-cloud: ${a.error}`);a.type==="rev"&&(this.rev=a.rev),a.type!=="pong"&&this.subscriber.next(a)}catch(a){this.subscriber.error(a)}}};try{let i=!1;yield new Promise((a,l)=>{r.onopen=c=>{i=!0,a(null)},r.onerror=c=>{if(i)this.reconnect();else{const d=c.error||new Error("WebSocket Error");this.subscriber.error(d),this.webSocketStatus.next("error"),l(d)}}}),this.messageProducerSubscription=this.messageProducer.subscribe(a=>{var l;this.closed||(a.type==="ready"&&this.webSocketStatus.value!=="connected"&&this.webSocketStatus.next("connected"),(l=this.ws)===null||l===void 0||l.send(ao.stringify(a)))})}catch{this.pauseUntil=new Date(Date.now()+6e4)}})}}class _y extends Error{constructor(t){super(t==="expired"?"License expired":t==="deactivated"?"User deactivated":"Invalid license"),this.name="InvalidLicenseError",t&&(this.license=t)}}function wy(e){return Ae(this,void 0,void 0,function*(){var t;yield(t=3e3,new Promise(n=>setTimeout(n,t))),yield vr(tf)})}function Zl(e){var t;return Ae(this,void 0,void 0,function*(){return!(!(!((t=e.cloud.options)===null||t===void 0)&&t.databaseUrl)||!e.cloud.schema)&&(yield ui(e,e.cloud.options,e.cloud.schema,{justCheckIfNeeded:!0}))})}const zi=new WeakMap;function nf(e,t,n,r){const i=zi.get(e);if(i){if(i.pull||(r==null?void 0:r.purpose)==="push")return i.promise;{let l=!1;const c=e.cloud.syncState.subscribe(d=>{d.phase==="pulling"&&(l=!0)});return i.promise.then(()=>{c.unsubscribe()}).catch(d=>(c.unsubscribe(),Promise.reject(d))).then(()=>{if(!l)return nf(e,t,n,r)})}}const a=function(){return Ae(this,void 0,void 0,function*(){try{if(yield Wc(e),e.cloud.isServiceWorkerDB)yield ui(e,t,n,r);else{if(e.cloud.usingServiceWorker)throw hc(!1),new Error("Internal _syncIfPossible() - invalid precondition - should not have been called.");yield function(l,c,d){return typeof navigator<"u"&&navigator.locks?navigator.locks.request(l.name+"|"+c,()=>d()):d()}(e,Zp,()=>ui(e,t,n,r))}zi.delete(e)}catch(l){throw zi.delete(e),l}})}();return zi.set(e,{promise:a,pull:(r==null?void 0:r.purpose)!=="push"}),a}const ky=6e4;function xy(e,t,n){let r=null,i={cancelled:!1},a=null,l=null;function c(v,u=1){setTimeout(()=>{a&&clearTimeout(a);const m=l==="pull"?"pull":v;a=null,l=null,nf(e,t,n,{cancelToken:i,retryImmediatelyOnFetchError:!0,purpose:m}).catch(y=>{if(i.cancelled)d();else if(u<3){const g=l&&l==="pull"?"pull":v,_=setTimeout(()=>c(g,u+1),[0,5,15][u]*ky);a&&clearTimeout(a),a=_,l=g}})},0)}const d=()=>{i.cancelled=!0,r&&r.unsubscribe()};return{start:()=>{r=e.localSyncEvent.subscribe(({purpose:v})=>{try{c(v||"pull")}catch{}})},stop:d}}function ga(e,t){if(e&&t&&t.unsyncedTables)for(const n of t.unsyncedTables)e[n]&&(e[n].markedForSync=!1)}var xo,Ue,rf,ri,Xl,so={},of=[],Sy=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Rn(e,t){for(var n in t)e[n]=t[n];return e}function af(e){var t=e.parentNode;t&&t.removeChild(e)}function vt(e,t,n){var r,i,a,l={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?xo.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)l[a]===void 0&&(l[a]=e.defaultProps[a]);return Xi(e,l,r,i,null)}function Xi(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++rf};return i==null&&Ue.vnode!=null&&Ue.vnode(a),a}function xr(e){return e.children}function ii(e,t){this.props=e,this.context=t}function Sr(e,t){if(t==null)return e.__?Sr(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Sr(e):null}function sf(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return sf(e)}}function $l(e){(!e.__d&&(e.__d=!0)&&ri.push(e)&&!lo.__r++||Xl!==Ue.debounceRendering)&&((Xl=Ue.debounceRendering)||setTimeout)(lo)}function lo(){for(var e;lo.__r=ri.length;)e=ri.sort(function(t,n){return t.__v.__b-n.__v.__b}),ri=[],e.some(function(t){var n,r,i,a,l,c;t.__d&&(l=(a=(n=t).__v).__e,(c=n.__P)&&(r=[],(i=Rn({},a)).__v=a.__v+1,gs(c,a,i,n.__n,c.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Sr(a),a.__h),ff(r,a),a.__e!=l&&sf(a)))})}function lf(e,t,n,r,i,a,l,c,d,v){var u,m,y,g,_,k,O,C=r&&r.__k||of,S=C.length;for(n.__k=[],u=0;u<t.length;u++)if((g=n.__k[u]=(g=t[u])==null||typeof g=="boolean"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?Xi(null,g,null,null,g):Array.isArray(g)?Xi(xr,{children:g},null,null,null):g.__b>0?Xi(g.type,g.props,g.key,null,g.__v):g)!=null){if(g.__=n,g.__b=n.__b+1,(y=C[u])===null||y&&g.key==y.key&&g.type===y.type)C[u]=void 0;else for(m=0;m<S;m++){if((y=C[m])&&g.key==y.key&&g.type===y.type){C[m]=void 0;break}y=null}gs(e,g,y=y||so,i,a,l,c,d,v),_=g.__e,(m=g.ref)&&y.ref!=m&&(O||(O=[]),y.ref&&O.push(y.ref,null,g),O.push(m,g.__c||_,g)),_!=null?(k==null&&(k=_),typeof g.type=="function"&&g.__k===y.__k?g.__d=d=uf(g,d,e):d=cf(e,g,y,C,_,d),typeof n.type=="function"&&(n.__d=d)):d&&y.__e==d&&d.parentNode!=e&&(d=Sr(y))}for(n.__e=k,u=S;u--;)C[u]!=null&&(typeof n.type=="function"&&C[u].__e!=null&&C[u].__e==n.__d&&(n.__d=Sr(r,u+1)),vf(C[u],C[u]));if(O)for(u=0;u<O.length;u++)df(O[u],O[++u],O[++u])}function uf(e,t,n){for(var r,i=e.__k,a=0;i&&a<i.length;a++)(r=i[a])&&(r.__=e,t=typeof r.type=="function"?uf(r,t,n):cf(n,r,r,i,r.__e,t));return t}function cf(e,t,n,r,i,a){var l,c,d;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),l=null;else{for(c=a,d=0;(c=c.nextSibling)&&d<r.length;d+=2)if(c==i)break e;e.insertBefore(i,a),l=a}return l!==void 0?l:i.nextSibling}function eu(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||Sy.test(t)?n:n+"px"}function Vi(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||eu(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||eu(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?nu:tu,a):e.removeEventListener(t,a?nu:tu,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function tu(e){this.l[e.type+!1](Ue.event?Ue.event(e):e)}function nu(e){this.l[e.type+!0](Ue.event?Ue.event(e):e)}function gs(e,t,n,r,i,a,l,c,d){var v,u,m,y,g,_,k,O,C,S,x,A,q,D=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(d=n.__h,c=t.__e=n.__e,t.__h=null,a=[c]),(v=Ue.__b)&&v(t);try{e:if(typeof D=="function"){if(O=t.props,C=(v=D.contextType)&&r[v.__c],S=v?C?C.props.value:v.__:r,n.__c?k=(u=t.__c=n.__c).__=u.__E:("prototype"in D&&D.prototype.render?t.__c=u=new D(O,S):(t.__c=u=new ii(O,S),u.constructor=D,u.render=Ey),C&&C.sub(u),u.props=O,u.state||(u.state={}),u.context=S,u.__n=r,m=u.__d=!0,u.__h=[]),u.__s==null&&(u.__s=u.state),D.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Rn({},u.__s)),Rn(u.__s,D.getDerivedStateFromProps(O,u.__s))),y=u.props,g=u.state,m)D.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(D.getDerivedStateFromProps==null&&O!==y&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(O,S),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(O,u.__s,S)===!1||t.__v===n.__v){u.props=O,u.state=u.__s,t.__v!==n.__v&&(u.__d=!1),u.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(W){W&&(W.__=t)}),u.__h.length&&l.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(O,u.__s,S),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(y,g,_)})}if(u.context=S,u.props=O,u.__v=t,u.__P=e,x=Ue.__r,A=0,"prototype"in D&&D.prototype.render)u.state=u.__s,u.__d=!1,x&&x(t),v=u.render(u.props,u.state,u.context);else do u.__d=!1,x&&x(t),v=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++A<25);u.state=u.__s,u.getChildContext!=null&&(r=Rn(Rn({},r),u.getChildContext())),m||u.getSnapshotBeforeUpdate==null||(_=u.getSnapshotBeforeUpdate(y,g)),q=v!=null&&v.type===xr&&v.key==null?v.props.children:v,lf(e,Array.isArray(q)?q:[q],t,n,r,i,a,l,c,d),u.base=t.__e,t.__h=null,u.__h.length&&l.push(u),k&&(u.__E=u.__=null),u.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Iy(n.__e,t,n,r,i,a,l,d);(v=Ue.diffed)&&v(t)}catch(W){t.__v=null,(d||a!=null)&&(t.__e=c,t.__h=!!d,a[a.indexOf(c)]=null),Ue.__e(W,t,n)}}function ff(e,t){Ue.__c&&Ue.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){Ue.__e(r,n.__v)}})}function Iy(e,t,n,r,i,a,l,c){var d,v,u,m=n.props,y=t.props,g=t.type,_=0;if(g==="svg"&&(i=!0),a!=null){for(;_<a.length;_++)if((d=a[_])&&"setAttribute"in d==!!g&&(g?d.localName===g:d.nodeType===3)){e=d,a[_]=null;break}}if(e==null){if(g===null)return document.createTextNode(y);e=i?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,y.is&&y),a=null,c=!1}if(g===null)m===y||c&&e.data===y||(e.data=y);else{if(a=a&&xo.call(e.childNodes),v=(m=n.props||so).dangerouslySetInnerHTML,u=y.dangerouslySetInnerHTML,!c){if(a!=null)for(m={},_=0;_<e.attributes.length;_++)m[e.attributes[_].name]=e.attributes[_].value;(u||v)&&(u&&(v&&u.__html==v.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(k,O,C,S,x){var A;for(A in C)A==="children"||A==="key"||A in O||Vi(k,A,null,C[A],S);for(A in O)x&&typeof O[A]!="function"||A==="children"||A==="key"||A==="value"||A==="checked"||C[A]===O[A]||Vi(k,A,O[A],C[A],S)}(e,y,m,i,c),u)t.__k=[];else if(_=t.props.children,lf(e,Array.isArray(_)?_:[_],t,n,r,i&&g!=="foreignObject",a,l,a?a[0]:n.__k&&Sr(n,0),c),a!=null)for(_=a.length;_--;)a[_]!=null&&af(a[_]);c||("value"in y&&(_=y.value)!==void 0&&(_!==e.value||g==="progress"&&!_||g==="option"&&_!==m.value)&&Vi(e,"value",_,m.value,!1),"checked"in y&&(_=y.checked)!==void 0&&_!==e.checked&&Vi(e,"checked",_,m.checked,!1))}return e}function df(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){Ue.__e(r,n)}}function vf(e,t,n){var r,i;if(Ue.unmount&&Ue.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||df(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){Ue.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&vf(r[i],t,typeof e.type!="function");n||e.__e==null||af(e.__e),e.__e=e.__d=void 0}function Ey(e,t,n){return this.constructor(e,n)}function ru(e,t,n){var r,i,a;Ue.__&&Ue.__(e,t),i=(r=!1)?null:t.__k,a=[],gs(t,e=t.__k=vt(xr,null,[e]),i||so,so,t.ownerSVGElement!==void 0,i?null:t.firstChild?xo.call(t.childNodes):null,a,i?i.__e:t.firstChild,r),ff(a,e)}xo=of.slice,Ue={__e:function(e,t,n,r){for(var i,a,l;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&a.getDerivedStateFromError!=null&&(i.setState(a.getDerivedStateFromError(e)),l=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,r||{}),l=i.__d),l)return i.__E=i}catch(c){e=c}throw e}},rf=0,ii.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Rn({},this.state),typeof e=="function"&&(e=e(Rn({},n),this.props)),e&&Rn(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),$l(this))},ii.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),$l(this))},ii.prototype.render=xr,ri=[],lo.__r=0;const sn={Alert:{error:{color:"red",fontWeight:"bold"},warning:{color:"#f80",fontWeight:"bold"},info:{color:"black"}},Darken:{position:"fixed",top:0,left:0,opacity:.5,backgroundColor:"#000",width:"100vw",height:"100vh",zIndex:150,webkitBackdropFilter:"blur(2px)",backdropFilter:"blur(2px)"},DialogOuter:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:150,alignItems:"center",display:"flex",justifyContent:"center"},DialogInner:{position:"relative",color:"#222",backgroundColor:"#fff",padding:"30px",marginBottom:"2em",maxWidth:"90%",maxHeight:"90%",overflowY:"auto",border:"3px solid #3d3d5d",borderRadius:"8px",boxShadow:"0 0 80px 10px #666",width:"auto",fontFamily:"sans-serif"},Input:{height:"35px",width:"17em",borderColor:"#ccf4",outline:"none",fontSize:"17pt",padding:"8px"}};function Oy({children:e,className:t}){return vt("div",{className:t},vt("div",{style:sn.Darken}),vt("div",{style:sn.DialogOuter},vt("div",{style:sn.DialogInner},e)))}var So,ht,ba,iu,uo=0,hf=[],$i=[],ou=Ue.__b,au=Ue.__r,su=Ue.diffed,lu=Ue.__c,uu=Ue.unmount;function bs(e,t){Ue.__h&&Ue.__h(ht,e,uo||t),uo=0;var n=ht.__H||(ht.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:$i}),n.__[e]}function Cy(e){return uo=1,function(t,n,r){var i=bs(So++,2);if(i.t=t,!i.__c&&(i.__=[fu(void 0,n),function(l){var c=i.__N?i.__N[0]:i.__[0],d=i.t(c,l);c!==d&&(i.__N=[d,i.__[1]],i.__c.setState({}))}],i.__c=ht,!ht.u)){ht.u=!0;var a=ht.shouldComponentUpdate;ht.shouldComponentUpdate=function(l,c,d){if(!i.__c.__H)return!0;var v=i.__c.__H.__.filter(function(m){return m.__c});if(v.every(function(m){return!m.__N}))return!a||a.call(this,l,c,d);var u=!1;return v.forEach(function(m){if(m.__N){var y=m.__[0];m.__=m.__N,m.__N=void 0,y!==m.__[0]&&(u=!0)}}),!!u&&(!a||a.call(this,l,c,d))}}return i.__N||i.__}(fu,e)}function Ay(e){return uo=5,function(t,n){var r=bs(So++,7);return pf(r.__H,n)?(r.__V=t(),r.i=n,r.__h=t,r.__V):r.__}(function(){return{current:e}},[])}function Py(){for(var e;e=hf.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(eo),e.__H.__h.forEach(Ga),e.__H.__h=[]}catch(t){e.__H.__h=[],Ue.__e(t,e.__v)}}Ue.__b=function(e){ht=null,ou&&ou(e)},Ue.__r=function(e){au&&au(e),So=0;var t=(ht=e.__c).__H;t&&(ba===ht?(t.__h=[],ht.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=$i,n.__N=n.i=void 0})):(t.__h.forEach(eo),t.__h.forEach(Ga),t.__h=[])),ba=ht},Ue.diffed=function(e){su&&su(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(hf.push(t)!==1&&iu===Ue.requestAnimationFrame||((iu=Ue.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),cu&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);cu&&(r=requestAnimationFrame(i))})(Py)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==$i&&(n.__=n.__V),n.i=void 0,n.__V=$i})),ba=ht=null},Ue.__c=function(e,t){t.some(function(n){try{n.__h.forEach(eo),n.__h=n.__h.filter(function(r){return!r.__||Ga(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],Ue.__e(r,n.__v)}}),lu&&lu(e,t)},Ue.unmount=function(e){uu&&uu(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{eo(r)}catch(i){t=i}}),t&&Ue.__e(t,n.__v))};var cu=typeof requestAnimationFrame=="function";function eo(e){var t=ht,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),ht=t}function Ga(e){var t=ht;e.__c=e.__(),ht=t}function pf(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function fu(e,t){return typeof t=="function"?t(e):t}function Ty({message:e,messageCode:t,messageParams:n}){return e.replace(/\{\w+\}/gi,r=>n[r.substring(1,r.length-1)])}function jy({title:e,type:t,alerts:n,fields:r,submitLabel:i,cancelLabel:a,onCancel:l,onSubmit:c}){const[d,v]=Cy({}),u=Ay(null);return function(m,y){var g=bs(So++,4);!Ue.__s&&pf(g.__H,y)&&(g.__=m,g.i=y,ht.__h.push(g))}(()=>{var m;return(m=u.current)===null||m===void 0?void 0:m.focus()},[]),vt(Oy,{className:"dxc-login-dlg"},vt(xr,null,vt("h3",{style:sn.WindowHeader},e),n.map(m=>vt("p",{style:sn.Alert[m.type]},Ty(m))),vt("form",{onSubmit:m=>{m.preventDefault(),c(d)}},Object.entries(r).map(([m,{type:y,label:g,placeholder:_}],k)=>vt("label",{style:sn.Label,key:k},g?`${g}: `:"",vt("input",{ref:k===0?u:void 0,type:y,name:m,autoComplete:"on",style:sn.Input,autoFocus:!0,placeholder:_,value:d[m]||"",onInput:O=>{var C;const S=function(A,q){switch(A){case"email":return q.toLowerCase();case"otp":return q.toUpperCase();default:return q}}(y,(C=O.target)===null||C===void 0?void 0:C.value);let x=Object.assign(Object.assign({},d),{[m]:S});v(x),y==="otp"&&(S==null?void 0:S.trim().length)===8&&c(x)}}))))),vt("div",{style:sn.ButtonsDiv},vt(xr,null,vt("button",{type:"submit",style:sn.Button,onClick:()=>c(d)},i),a&&vt("button",{style:sn.Button,onClick:l},a))))}class du extends ii{constructor(t){super(t),this.observer=n=>this.setState({userInteraction:n}),this.state={userInteraction:void 0}}componentDidMount(){this.subscription=fn(this.props.db.cloud.userInteraction).subscribe(this.observer)}componentWillUnmount(){this.subscription&&(this.subscription.unsubscribe(),delete this.subscription)}render(t,{userInteraction:n}){return n?vt(jy,Object.assign({},n)):null}}function hi(e){const t=new WeakMap;return n=>{let r=t.get(n);return r||(r=e(n),t.set(n,r)),r}}const co=hi(e=>new Xt(Rt));function Io(e,t){let n=t,r=fn(e).pipe(bo(a=>n=a),sp({resetOnRefCountZero:()=>op(1e3)}));const i=new pt(a=>{let l=!1;const c=r.subscribe({next(d){l=!0,a.next(d)},error(d){a.error(d)},complete(){a.complete()}});return l||c.closed||a.next(n),c});return i.getValue=()=>n,i}const yf=hi(e=>Io(fr(()=>e.roles.where({realmId:"rlm-public"}).toArray().then(t=>{const n={};for(const r of t.slice().sort((i,a)=>(i.sortOrder||0)-(a.sortOrder||0)))n[r.name]=r;return n})),{})),mf=hi(e=>Io(co(e._novip).pipe(Ct(t=>fr(()=>e.transaction("r","realms","members",()=>Promise.all([e.members.where({userId:t.userId}).toArray(),e.realms.toArray(),t.userId]).then(([n,r,i])=>({selfMembers:n,realms:r,userId:i})))))),{selfMembers:[],realms:[],get userId(){return e.cloud.currentUserId}}));function Dy(...e){return e.length===0?{}:e.reduce((n,r)=>{const i=Object.assign({},n);for(const[a,l]of Object.entries(r))if(a in i&&i[a]){if(i[a]==="*")continue;if(l==="*")i[a]="*";else if(Array.isArray(l)&&Array.isArray(i[a])){const c=i,d=c[a];c[a]=[...new Set([...d,...l])]}else if(typeof l=="object"&&l&&typeof i[a]=="object"){const c=i[a];for(const[d,v]of Object.entries(l))c[d]!=="*"&&(v==="*"?c[d]="*":Array.isArray(c[d])&&Array.isArray(v)&&(c[d]=[...new Set([...c[d],...v])]))}}else i[a]=r[a];return i})}const gf=hi(e=>function(t,n){let r;const i=t.pipe(bo(a=>r=n(a)));return i.getValue=()=>r!==void 0?r:r=n(t.getValue()),i}(Io(ro([mf(e._novip),yf(e._novip)]).pipe(cn(([{selfMembers:t,realms:n,userId:r},i])=>({selfMembers:t,realms:n,userId:r,globalRoles:i}))),{selfMembers:[],realms:[],userId:Rt.userId,globalRoles:{}}),({selfMembers:t,realms:n,userId:r,globalRoles:i})=>n.map(l=>{const c=t.filter(u=>u.realmId===l.realmId),d=c.map(u=>u.permissions).filter(u=>u),v=qc(c.map(u=>u.roles).filter(u=>u)).map(u=>i[u]).filter(u=>u).map(u=>u.permissions);return Object.assign(Object.assign({},l),{permissions:l.owner===r?{manage:"*"}:Dy(...d,...v)})}).reduce((l,c)=>Object.assign(Object.assign({},l),{[c.realmId]:c}),{[r]:{realmId:r,owner:r,name:r,permissions:{manage:"*"}}})));class vu{constructor(t,n,r){this.permissions=t||{},this.tableName=n,this.isOwner=r}add(...t){var n;return this.permissions.manage==="*"||!!(!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))||this.permissions.add==="*"||!!t.every(r=>{var i;return(i=this.permissions.add)===null||i===void 0?void 0:i.includes(r)})}update(...t){var n,r;if(this.isOwner||this.permissions.manage==="*"||!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))return!0;if(this.permissions.update==="*")return t.every(a=>a!=="owner");const i=(r=this.permissions.update)===null||r===void 0?void 0:r[this.tableName];return i==="*"?t.every(a=>a!=="owner"):t.every(a=>i==null?void 0:i.some(l=>l===a||l==="*"&&a!=="owner"))}delete(){var t;return!(!this.isOwner&&this.permissions.manage!=="*")||!!(!((t=this.permissions.manage)===null||t===void 0)&&t.includes(this.tableName))}}const Ry=hi(e=>{const t=co(e._novip).pipe(Ct(i=>fr(()=>e.members.where({email:i.email||""}).toArray()))),n=gf(e._novip),r=mf(e._novip);return Io(ro([t,r,n]).pipe(cn(([i,a,l])=>{const c=(u,m)=>Object.assign(Object.assign({},u),{[m.id]:Object.assign(Object.assign({},m),{realm:l[m.realmId]})}),d=i.reduce(c,{}),v=a.selfMembers.reduce(c,d);return Object.values(v).filter(u=>!u.accepted).map(u=>Object.assign(Object.assign({},u),{accept(){return Ae(this,void 0,void 0,function*(){yield e.members.update(u.id,{accepted:new Date})})},reject(){return Ae(this,void 0,void 0,function*(){yield e.members.update(u.id,{rejected:new Date})})}}))})),[])}),Ny={nameSuffix:!0};function Ja(e){const t=e.name,n=co(e),r=[];let i=!1,a=null;e.on("ready",u=>Ae(this,void 0,void 0,function*(){try{yield function(m){var y,g,_,k,O,C,S;return Ae(this,void 0,void 0,function*(){l=!1;const x=yn(m);typeof window<"u"&&typeof document<"u"&&(!((y=x.cloud.options)===null||y===void 0)&&y.customLoginGui||r.push(function(Y){let ne=!1;const ee=document.createElement("div");return document.body?(document.body.appendChild(ee),ru(vt(du,{db:Y.vip}),ee)):addEventListener("DOMContentLoaded",()=>{ne||(document.body.appendChild(ee),ru(vt(du,{db:Y.vip}),ee))}),{unsubscribe(){try{ee.remove()}catch{}ne=!0},get closed(){return ne}}}(m))),x.cloud.isServiceWorkerDB||r.push(function(Y){let ne=Y.cloud.webSocketStatus.value;const ee=Y.cloud.webSocketStatus.pipe(Ct(V=>{const Z=ne;ne=V;const oe=_n(V);switch(V){case"disconnected":return ni.value?oe.pipe(Fl(500)):oe;case"connecting":return Z==="not-started"||Z==="error"?oe:oe.pipe(Fl(4e3));default:return oe}}));return ro([ee,Y.syncStateChangedEvent.pipe(Op({phase:"initial"})),co(Y.dx._novip),Ya]).pipe(cn(([V,Z,oe,se])=>{var je;if(!((je=oe.license)===null||je===void 0)&&je.status&&oe.license.status!=="ok")return{phase:"offline",status:"offline",license:oe.license.status};let{phase:Te,error:fe,progress:B}=Z,Ne=V;return Te==="error"&&(Ne="error"),V==="not-started"&&(Te!=="pushing"&&Te!=="pulling"||(Ne="connecting")),Y.cloud.syncState.value.phase!=="error"||Z.phase!=="pushing"&&Z.phase!=="pulling"||(Ne="connecting"),se||(Ne="disconnected"),{phase:Te,error:fe,progress:B,status:pr?Ne:"offline",license:"ok"}}))}(x).subscribe(m.cloud.syncState)),r.push(x.syncCompleteEvent.subscribe(d)),x.tables.every(Y=>Y.core)||Zc();const A="serviceWorker"in navigator?yield navigator.serviceWorker.getRegistrations():[],[q,D]=yield x.transaction("rw",x.$syncState,()=>Ae(this,void 0,void 0,function*(){var Y,ne;const{options:ee,schema:V}=x.cloud,[Z,oe,se]=yield Promise.all([x.getOptions(),x.getSchema(),x.getPersistedSyncState()]);if(i){if(!Z||JSON.stringify(Z)!==JSON.stringify(ee)){if(!ee)throw new Error("Internal error");const je=Object.assign({},ee);delete je.fetchTokens,yield x.$syncState.put(je,"options")}}else x.cloud.options=Z||null;if(!((Y=x.cloud.options)===null||Y===void 0)&&Y.tryUseServiceWorker&&"serviceWorker"in navigator&&A.length>0&&!oy?x.cloud.usingServiceWorker=!0:(!((ne=x.cloud.options)===null||ne===void 0)&&ne.tryUseServiceWorker&&x.cloud.isServiceWorkerDB,x.cloud.usingServiceWorker=!1),ga(V,x.cloud.options),ga(oe,x.cloud.options),V){if(!oe||JSON.stringify(oe)!==JSON.stringify(V)){const je=oe||{};for(const[Te,fe]of Object.entries(V)){const B=je[Te];B?(B.markedForSync=fe.markedForSync,fe.deleted=B.deleted,B.generatedGlobalId=fe.generatedGlobalId):je[Te]=Object.assign({},fe)}yield x.$syncState.put(je,"schema"),Object.assign(V,je)}}else x.cloud.schema=oe||null;return[se==null?void 0:se.initiallySynced,se==null?void 0:se.realms]}));q&&x.setInitiallySynced(!0),function(Y){var ne,ee;for(const V of Y.tables)if(!((ee=(ne=Y.cloud.schema)===null||ne===void 0?void 0:ne[V.name])===null||ee===void 0)&&ee.markedForSync){if(V.schema.primKey.auto)throw new at.SchemaError(`Table ${V.name} is both autoIncremented and synced. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(V.name)}]}) to blacklist it from sync`);if(!V.schema.primKey.keyPath)throw new at.SchemaError(`Table ${V.name} cannot be both synced and outbound. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(V.name)}]}) to blacklist it from sync`)}}(x),!((g=x.cloud.options)===null||g===void 0)&&g.databaseUrl&&!q&&(yield function(Y,ne,ee){return Ae(this,void 0,void 0,function*(){yield ui(Y,ne,ee,{isInitialSync:!0})})}(x,x.cloud.options,x.cloud.schema),x.setInitiallySynced(!0)),c(),x.cloud.isServiceWorkerDB||(r.push(fr(()=>x.getCurrentUser()).subscribe(n)),r.push(fr(()=>x.getPersistedSyncState()).subscribe(x.cloud.persistedSyncState)),yield vr(ro([n.pipe(Ul(1),cr(1)),x.cloud.persistedSyncState.pipe(Ul(1),cr(1))])));let W=!1;const te=yield x.getCurrentUser(),J=(_=x.cloud.options)===null||_===void 0?void 0:_.requireAuth;J&&(typeof J=="object"?(!te.isLoggedIn||J.userId&&te.userId!==J.userId||J.email&&te.email!==J.email)&&(W=yield ha(x,J)):te.isLoggedIn||(W=yield ha(x))),!te.isLoggedIn||D&&D.includes(te.userId)||(W=!0),a&&a.stop(),a=null,c(),x.cloud.usingServiceWorker&&(!((k=x.cloud.options)===null||k===void 0)&&k.databaseUrl)?(Dc(x,W?"pull":"push").catch(()=>{}),function(Y){var ne;return Ae(this,void 0,void 0,function*(){try{const{periodicSync:ee}=yield navigator.serviceWorker.ready;if(ee)try{yield ee.register(`dexie-cloud:${Y.name}`,(ne=Y.cloud.options)===null||ne===void 0?void 0:ne.periodicSync)}catch{}}catch{}})}(x).catch(()=>{})):!((O=x.cloud.options)===null||O===void 0)&&O.databaseUrl&&x.cloud.schema&&!x.cloud.isServiceWorkerDB&&(a=xy(x,x.cloud.options,x.cloud.schema),a.start(),bn(x,W?"pull":"push")),c(),x.cloud.isServiceWorkerDB||r.push(un(self,"online").subscribe(()=>{x.syncStateChangedEvent.next({phase:"not-in-sync"}),$c(x)||bn(x,"push")}),un(self,"offline").subscribe(()=>{x.syncStateChangedEvent.next({phase:"offline"})})),!(!((C=x.cloud.options)===null||C===void 0)&&C.databaseUrl)||!((S=x.cloud.options)===null||S===void 0)&&S.disableWebSocket||ay||r.push(function(Y){var ne;if(!(!((ne=Y.cloud.options)===null||ne===void 0)&&ne.databaseUrl))throw new Error("No database URL to connect WebSocket to");const ee=Y.messageConsumer.readyToServe.pipe(ln(V=>V),Ct(()=>Y.getPersistedSyncState()),ln(V=>V&&V.serverRevision),Ct(V=>Ae(this,void 0,void 0,function*(){return{type:"ready",rev:V.serverRevision,realmSetHash:yield Ka(V)}})));return function V(){return Y.cloud.persistedSyncState.pipe(ln(Z=>Z==null?void 0:Z.serverRevision),cr(1),Ct(Z=>Y.cloud.currentUser.pipe(cn(oe=>[oe,Z]))),Ct(([Z,oe])=>Ya.pipe(cn(se=>[se?Z:null,oe]))),Ct(([Z,oe])=>Z!=null&&Z.isLoggedIn&&!(oe!=null&&oe.realms.includes(Z.userId))?Y.cloud.persistedSyncState.pipe(ln(se=>(se==null?void 0:se.realms.includes(Z.userId))||!1),cr(1),cn(se=>[Z,se])):new Xt([Z,oe])),Ct(([Z,oe])=>Ae(this,void 0,void 0,function*(){return[Z,yield Ka(oe)]})),jc(([Z,oe],[se,je])=>Z===se&&oe===je),Ct(([Z,oe])=>{var se;return!((se=Y.cloud.persistedSyncState)===null||se===void 0)&&se.value?Z?new my(Y.cloud.options.databaseUrl,Y.cloud.persistedSyncState.value.serverRevision,oe,Y.cloud.persistedSyncState.value.clientIdentity,ee,Y.cloud.webSocketStatus,Z.accessToken,Z.accessTokenExpiration):fn([]):V()}),Na(Z=>(Z==null?void 0:Z.name)==="TokenExpiredError"?_n(!0).pipe(Ct(()=>Ae(this,void 0,void 0,function*(){const oe=yield Y.getCurrentUser(),se=yield ko(Y.cloud.options.databaseUrl,oe);yield Y.table("$logins").update(oe.userId,{accessToken:se.accessToken,accessTokenExpiration:se.accessTokenExpiration,claims:se.claims,license:se.license,data:se.data})})),Ct(()=>V())):Ol(()=>Z)),Na(Z=>(Y.cloud.webSocketStatus.next("error"),Z instanceof _y?Ol(()=>Z):fn(wy()).pipe(Ct(()=>V())))))}().subscribe({next:V=>{V&&Y.messageConsumer.enqueue(V)},error:V=>{},complete:()=>{}})}(x))})}(u)}catch{}}),!0);let l=!1;function c(){if(l)throw new at.DatabaseClosedError}(function(u,m){u.on.close.subscribe(m);const y=u._close;u._close=function(){y.call(this),m()}})(e,()=>{r.forEach(u=>u.unsubscribe()),l=!0,a&&a.stop(),a=null,n.next(Rt)});const d=new fi;var v;e.cloud={version:"4.0.12",options:Object.assign({},Ny),schema:null,get currentUserId(){return n.value.userId||Rt.userId},currentUser:n,syncState:new Xt({phase:"initial",status:"not-started"}),events:{syncComplete:d},persistedSyncState:new Xt(void 0),userInteraction:new Xt(void 0),webSocketStatus:new Xt("not-started"),login(u){return Ae(this,void 0,void 0,function*(){const m=yn(e);yield m.cloud.sync(),yield ha(m,u)})},invites:Ry(e),roles:yf(e),configure(u){u=e.cloud.options=Object.assign(Object.assign({},e.cloud.options),u),i=!0,u.databaseUrl&&u.nameSuffix&&(e.name=`${t}-${function(m){const y=new URL(m);return y.pathname==="/"?y.hostname.split(".")[0]:y.pathname.split("/")[1]}(u.databaseUrl)}`,yn(e).reconfigure()),ga(e.cloud.schema,e.cloud.options)},logout({force:u}={}){return Ae(this,void 0,void 0,function*(){u?yield Fa(yn(e),{deleteUnsyncedData:!0}):yield Lc(yn(e))})},sync({wait:u,purpose:m}={wait:!0,purpose:"push"}){var y;return Ae(this,void 0,void 0,function*(){u===void 0&&(u=!0);const g=yn(e);if((((y=g.cloud.currentUser.value.license)===null||y===void 0?void 0:y.status)||"ok")!=="ok"&&(yield ps(g)),m==="pull"){const _=g.cloud.persistedSyncState.value;if(bn(g,m),u){const k=yield vr(g.cloud.persistedSyncState.pipe(ln(O=>(O==null?void 0:O.timestamp)!=null&&(!_||O.timestamp>_.timestamp))));if(k!=null&&k.error)throw new Error("Sync error: "+k.error)}}else if(yield Zl(g)){const _=g.cloud.persistedSyncState.value;bn(g,m),u&&(yield vr(fn(fr(()=>Ae(this,void 0,void 0,function*(){const k=yield Zl(g),O=yield g.getPersistedSyncState();if((O==null?void 0:O.timestamp)!==(_==null?void 0:_.timestamp)&&(O!=null&&O.error))throw new Error("Sync error: "+O.error);return k}))).pipe(ln(k=>!k))))}})},permissions:(u,m)=>function(y,g,_){if(!g)throw new TypeError("Cannot check permissions of undefined or null. A Dexie Cloud object with realmId and owner expected.");const{owner:k,realmId:O}=g;if(!_){if(typeof g.table!="function")throw new TypeError("Missing 'table' argument to permissions and table could not be extracted from entity");_=g.table()}const C=gf(y),S=A=>{const q=A[O||y.cloud.currentUserId];return q?new vu(q.permissions,_,O===void 0||O===y.cloud.currentUserId||k===y.cloud.currentUserId):new vu({},_,!k||k===y.cloud.currentUserId)},x=C.pipe(cn(S));return x.getValue=()=>S(C.getValue()),x}(e._novip,u,m)},e.Version.prototype._parseStoresSpec=at.override(e.Version.prototype._parseStoresSpec,u=>vy(u,e)),e.Table.prototype.newId=function({colocateWith:u}={}){const m=u&&u.substr(u.length-3);return Xc(e.cloud.schema[this.name].idPrefix||"",m)},e.Table.prototype.idPrefix=function(){var u,m;return((m=(u=this.db.cloud.schema)===null||u===void 0?void 0:u[this.name])===null||m===void 0?void 0:m.idPrefix)||""},e.use(dy({currentUserObservable:e.cloud.currentUser,db:yn(e)})),e.use((v=yn(e),{stack:"dbcore",name:"implicitPropSetterMiddleware",level:1,create:u=>Object.assign(Object.assign({},u),{table:m=>{const y=u.table(m);return Object.assign(Object.assign({},y),{mutate:g=>{var _,k,O,C;if(g.trans.disableChangeTracking)return y.mutate(g);const S=g.trans;if(!((k=(_=v.cloud.schema)===null||_===void 0?void 0:_[m])===null||k===void 0)&&k.markedForSync){if(S.mode==="versionchange")return Promise.reject(new at.UpgradeError(`Dexie Cloud Addon: Cannot upgrade or populate synced table "${m}". See https://dexie.org/cloud/docs/best-practices`));if(g.type==="add"||g.type==="put"){if(m==="members")for(const x of g.values)typeof x.email=="string"&&(x.email=x.email.trim().toLowerCase());for(const x of g.values){x.owner||(x.owner=S.currentUser.userId),x.realmId||(x.realmId=S.currentUser.userId);const A=(C=(O=y.schema.primaryKey).extractKey)===null||C===void 0?void 0:C.call(O,x);typeof A=="string"&&A[0]==="#"&&g.type==="put"&&(delete g.criteria,delete g.changeSpec,delete g.updates,x.$ts=Date.now())}}}return y.mutate(g)}})}})})),e.use(uy(yn(e)))}Ja.version="4.0.12",at.Cloud=Ja;class _s{constructor(){this._db=new at("FlavorAwesome",{addons:[Ja]}),this._db.version(20).stores({review:"id, created_at, updated_at, type",settings:"id"}),this._db.cloud.configure({customLoginGui:!0,databaseUrl:"https://zwa7o6jty.dexie.cloud",requireAuth:!1})}_filter(t,n){return t.filter(r=>!!(r.name.toLowerCase().indexOf(n)>=0||r.notes&&r.notes.toLowerCase().indexOf(n)>=0))}browseReview(t=null,n=null){return t===null?n===null?this._db.review.orderBy("updated_at").reverse().toArray():this._db.review.orderBy("updated_at").reverse().toArray().then(r=>this._filter(r,n)):n===null?this._db.review.where("type").equals(t).reverse().sortBy("updated_at"):this._db.review.where("type").equals(t).reverse().sortBy("updated_at").then(r=>this._filter(r,n))}readReview(t){return this._db.review.where("id").equals(t).toArray().then(n=>n[0])}addReview(t,n){const r=Li(n);return r.id=crypto.randomUUID(),r.type=t,r.created_at=new Date,r.updated_at=new Date,r.favorite=!1,this._db.review.add(r)}editReview(t){const n=Li(t);return n.updated_at=new Date,this._db.review.put(n).then(()=>this._db.review.where("id").equals(t.id).toArray().then(r=>r[0]))}deleteReview(t){return this._db.review.delete(t)}countReview(){return this._db.review.toArray().then(t=>t.reduce((n,r)=>(n.hasOwnProperty(r.type)?n[r.type]=n[r.type]+1:n[r.type]=1,n),{All:t.length}))}favoriteReview(t,n){return this._db.review.update(t,{favorite:n,updated_at:new Date}).then(()=>this._db.review.where("id").equals(t).toArray().then(r=>r[0]))}countReviews(){return this._db.review.toArray().then(t=>t.length)}createSettings(t){const n=Li(value);return n.created_at=new Date,n.updated_at=new Date,this._db.settings.add(n)}readSettings(){return this._db.settings.toArray().then(t=>t.length===0?null:t[0])}updateSettings(t){const n=Li(t);return n.updated_at=new Date,this._db.settings.put(n).then(()=>this._db.settings.toArray()).then(r=>r[0])}deleteSettings(){return this._db.settings.clear()}login(t){console.log("LOGIN EMAIL: "+t),this._db.cloud.login({email:t,grant_type:"otp"})}logout(){this._db.cloud.logout()}sync(){return console.log("DC SYNC"),this._db.cloud.sync({purpose:"pull",wait:!0})}get ui(){return this._db.cloud.userInteraction}get user(){return this._db.cloud.currentUser}get userId(){return this._db.cloud.currentUserId}}class Ly{constructor(t){const n=new Intl.NumberFormat(t).formatToParts(12345.6),r=[...new Intl.NumberFormat(t,{useGrouping:!1}).format(9876543210)].reverse(),i=new Map(r.map((a,l)=>[a,l]));this.group=new RegExp(`[${n.find(a=>a.type==="group").value}]`,"g"),this.decimal=new RegExp(`[${n.find(a=>a.type==="decimal").value}]`),this.numeral=new RegExp(`[${r.join("")}]`,"g"),this.index=a=>i.get(a)}parse(t){return(t=t.trim().replace(this.group,"").replace(this.decimal,".").replace(this.numeral,this.index))?+t:NaN}}function My(e,t,n){t().trim().length===0&&t(null),n.onchange&&n.onchange({name:n.name,value:t()})}var qy=ce('<p class="svelte-mpcejc"> </p>'),Fy=ce('<button tabindex="-1" type="button" class="svelte-mpcejc"><!></button>'),Uy=ce('<label class="svelte-mpcejc"><div class="field svelte-mpcejc"><p class="svelte-mpcejc"> </p> <div class="parts svelte-mpcejc"><input type="text" class="svelte-mpcejc"> <!></div></div> <!></label> <!>',1);function wn(e,t){Ye(t,!0);let n=be(t,"mode",3,"text"),r=be(t,"value",7,null),i;function a(A){A.preventDefault(),r(null),i.focus(),t.onchange&&t.onchange({name:t.name,value:r()})}function l(){if(n()==="numeric"||n()==="decimal"){const A=n()==="numeric"?0:2;r()!==null&&r(new Number(r()).toLocaleString(navigator.language,{minimumFractionDigits:A,maximumFractionDigits:A}))}}function c(){if((n()==="numeric"||n()==="decimal")&&r()!==null){const A=new Ly(navigator.language);r(A.parse(r()).toString(10))}}var d=Uy(),v=Oe(d),u=P(v),m=P(u),y=P(m,!0);E(m);var g=H(m,2),_=P(g);Ru(_),_.__input=[My,r,t],st(_,A=>i=A,()=>i);var k=H(_,2);{var O=A=>{var q=qy(),D=P(q,!0);E(q),we(()=>Ie(D,t.suffix)),Q(A,q)};pe(k,A=>{t.suffix&&A(O)})}E(g),E(u);var C=H(u,2);{var S=A=>{var q=Fy();q.__click=a;var D=P(q);Pe(D,{height:"24",icon:"material-symbols:cancel-outline",width:"24"}),E(q),Q(A,q)};pe(C,A=>{r()!==null&&A(S)})}E(v);var x=H(v,2);gn(x,()=>t.children??Er),we(()=>{Ie(y,t.label),Re(_,"inputmode",n()),Re(_,"placeholder",t.placeholder)}),oi("blur",_,l),oi("focus",_,c),Xa(_,r),Q(e,d),Ge()}tt(["input","click"]);function By(e,t,n,r){if(h(t)===null){alert("Name is required.");return}if(h(n)===null){alert("Email address is required.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h(n))){alert("Email address is invalid.");return}console.log("SEND: "+h(n)),r.login(h(n))}function Ky(e,t){t.logout()}function zy(e,t,n){console.log("OTP: "+h(t)),h(n).onSubmit({otp:h(t)})}var Vy=ce('<form class="svelte-154zepi"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <button type="button" class="svelte-154zepi">Sign in</button></form>'),Wy=ce('<img alt="Feature details" class="svelte-154zepi"> <ul class="upsell svelte-154zepi"><li class="svelte-154zepi">✅ All features</li> <li class="svelte-154zepi">✅ All flavors</li> <li class="svelte-154zepi">✅ Unlimited reviews</li></ul> <ul class="steps svelte-154zepi"><li class="selected svelte-154zepi"><p class="svelte-154zepi"><span class="svelte-154zepi"><!></span> Create an<br>account</p></li> <li class="svelte-154zepi"><p class="svelte-154zepi"><span class="svelte-154zepi"><!></span> Select<br>a plan</p></li> <li class="svelte-154zepi"><p class="svelte-154zepi"><span class="svelte-154zepi"><!></span> Enjoy the<br>Awesome</p></li></ul> <form class="svelte-154zepi"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <button type="button" class="svelte-154zepi">Send verification</button> <button type="button" class="svelte-154zepi">Logout</button></form>',1),Hy=ce('<section class="svelte-154zepi"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <article class="svelte-154zepi"><!></article></section>');function Yy(e,t){Ye(t,!0);let n=new _s,r,i=Ve(null),a=Ve(null),l=Ve(null),c=Ve(null),d=he(()=>h(a)===null?"sign_in":h(a).type);function v(){return r.animate([{top:0},{top:"100vh"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished}function u(){r.animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"})}po(()=>{console.log("CURRENT"),console.log(n.userId),n.ui.subscribe(S=>{console.log("INTERACTION"),console.log(S),S===void 0?(console.log("INTERACTION:USER"),console.log(n.userId),n.userId!=="unauthorized"&&(console.log("INTERACTION: LOGGED IN"),n.sync().then(()=>{console.log("INTERACTION: INITIAL SYNC"),t.onchange&&t.onchange()})),ke(a,null)):(console.log("MESSAGE"),console.log(S.messageCode),ke(a,S,!0))})});function m(){v()}var y=Hy(),g=P(y);{const S=A=>{Dt(A,{name:"material-symbols:close",onclick:m})},x=A=>{Dt(A,{name:"material-symbols:done"})};ur(g,()=>({"--primary-accent-color":"#5fb2ff"})),ns(g.lastChild,{label:"Account",variation:"sm",left:S,right:x,$$slots:{left:!0,right:!0}}),E(g)}var _=H(g,2),k=P(_);{var O=S=>{var x=Vy(),A=P(x);ur(A,()=>({"--primary-accent-color":"#5fb2ff"})),wn(A.lastChild,{label:"OTP",onchange:D=>ke(c,D.value,!0),placeholder:"One-time password from email"}),E(A);var q=H(A,2);q.__click=[zy,c,a],E(x),Q(S,x)},C=S=>{var x=Wy(),A=H(Oe(x),4),q=P(A),D=P(q),W=P(D),te=P(W);Pe(te,{height:"24",icon:"mynaui:one-circle-solid",width:"24"}),E(W),xt(3),E(D),E(q);var J=H(q,2),Y=P(J),ne=P(Y),ee=P(ne);Pe(ee,{height:"24",icon:"mynaui:two-circle",width:"24"}),E(ne),xt(3),E(Y),E(J);var V=H(J,2),Z=P(V),oe=P(Z),se=P(oe);Pe(se,{height:"24",icon:"mynaui:three-circle",width:"24"}),E(oe),xt(3),E(Z),E(V),E(A);var je=H(A,2),Te=P(je);ur(Te,()=>({"--primary-accent-color":"#5fb2ff"})),wn(Te.lastChild,{label:"Name",placeholder:"How should I refer to you?",onchange:Le=>ke(l,Le.value,!0)}),E(Te);var fe=H(Te,2);ur(fe,()=>({"--primary-accent-color":"#5fb2ff"})),wn(fe.lastChild,{label:"Email address",placeholder:"Use email to login",onchange:Le=>ke(i,Le.value,!0)}),E(fe);var B=H(fe,2);B.__click=[By,l,i,n];var Ne=H(B,2);Ne.__click=[Ky,n],E(je),Q(S,x)};pe(k,S=>{h(d)==="otp"?S(O):S(C,!1)})}return E(_),E(y),st(y,S=>r=S,()=>r),Q(e,y),Ge({hide:v,show:u})}tt(["click"]);var Gy=St('<circle class="ring svelte-7yw9ie" cx="0" cy="0"></circle>'),Jy=St('<circle cx="0" r="2" class="svelte-7yw9ie"></circle>'),Qy=St('<g class="spoke"><rect width="1" x="-0.50" y="0" class="svelte-7yw9ie"></rect><!></g>'),Zy=St("<text> </text>"),Xy=St('<g class="labels"></g>'),$y=St('<svg class="svelte-7yw9ie"><g class="chart svelte-7yw9ie"><g class="wheel svelte-7yw9ie"></g><g class="spokes svelte-7yw9ie"></g><!><path class="svelte-7yw9ie"></path></g></svg>');function fo(e,t){Ye(t,!0);let n=be(t,"interactive",3,!1),r=be(t,"labels",3,!0),i=be(t,"maximum",3,5),a=be(t,"rotate",3,0),l=be(t,"spokes",19,()=>[]),c=be(t,"value",19,()=>[]),d=Ve(void 0),v=Ve(void 0),u=150;Ir(()=>{if(h(v))if(n())h(d).setAttributeNS(null,"viewBox","-70 -150 140 200");else{const q=h(v).getBoundingClientRect();h(d).setAttributeNS(null,"viewBox",`${0-q.width/2} ${0-q.height/2} ${q.width} ${q.height}`)}});let m=he(()=>{if(c().length===0)return"";const q=360/l().length*(Math.PI/180);let D=null;for(let W=0;W<c().length;W++){const te=c()[W]===0?.25:c()[W],J=(u-3)/i()*te,Y={x:J*Math.cos(q*W-1.5708),y:J*Math.sin(q*W-1.5708)};W===0?D=`M ${Y.x} ${Y.y} `:D=D+`L ${Y.x} ${Y.y} `}return D+"Z"});function y(q){let D="middle",W="auto";const J=360/l().length*(Math.PI/180)*q*(180/Math.PI);return J===0?(D="middle",W="auto"):J>0&&J<90?(D="start",W="auto"):J===90?(D="start",W="middle"):J>90&&J<180?(D="start",W="hanging"):J===180?(D="middle",W="hanging"):J>180&&J<270?(D="end",W="hanging"):J===270?(D="end",W="middle"):(D="end",W="auto"),{"dominant-baseline":W,"text-anchor":D}}var g=$y(),_=P(g);let k;var O=P(_);ft(O,21,()=>({length:i()}),ct,(q,D,W)=>{var te=Gy();Re(te,"stroke-width",W===0?3:1),Gn(te,"",{},{fill:W===0?"#ffffff":"none"}),we(()=>Re(te,"r",(u-3)/i()*(i()-W))),Q(q,te)}),E(O);var C=H(O);ft(C,21,l,ct,(q,D,W)=>{var te=Qy();let J;var Y=P(te);Re(Y,"height",u-3);var ne=H(Y);ft(ne,17,()=>({length:i()}),ct,(ee,V,Z)=>{var oe=Jy();we(()=>Re(oe,"cy",(u-3)/i()*(Z+1))),Q(ee,oe)}),E(te),we(()=>J=Gn(te,"",J,{rotate:`${360/l().length*W}deg`})),Q(q,te)}),E(C);var S=H(C);{var x=q=>{var D=Xy();ft(D,21,l,ct,(W,te,J)=>{var Y=Zy();const ne=he(()=>360/l().length*(Math.PI/180));let ee;var V=P(Y,!0);E(Y),we((Z,oe,se)=>{ee=ka(Y,ee,{...Z,x:oe,y:se},"svelte-7yw9ie"),Ie(V,h(te))},[()=>y(J),()=>(u+5)*Math.cos(h(ne)*J-1.5708),()=>(u+5)*Math.sin(h(ne)*J-1.5708)]),Q(W,Y)}),E(D),Q(q,D)};pe(S,q=>{r()&&q(x)})}var A=H(S);E(_),st(_,q=>ke(v,q),()=>h(v)),E(g),st(g,q=>ke(d,q),()=>h(d)),we(()=>{k=Gn(_,"",k,{rotate:`${a()??""}deg`}),Re(A,"d",h(m))}),Q(e,g),Ge()}var em=ce('<h3 class="svelte-1kvllfw">Profile</h3> <div class="wheel svelte-1kvllfw"><!></div> <h3 class="svelte-1kvllfw">Recommendations</h3>',1),tm=ce('<article><h3 class="svelte-1kvllfw">At a Glance</h3> <div class="stats svelte-1kvllfw"><div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Entries</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Photos</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Day of posts</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Time of posts</p></div></div> <h3 class="svelte-1kvllfw">Ratings</h3> <div class="stats svelte-1kvllfw"><div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Ratings</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Average</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Middle</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Most frequent</p></div></div> <!></article>');function nm(e,t){Ye(t,!0);let n=be(t,"flavor",3,null),r=be(t,"hidden",3,!1),i=be(t,"items",19,()=>[]);const a=he(()=>i().length),l=he(()=>i().reduce((re,ae)=>(re=re+(ae.photos===null?0:ae.photos.length),re),0)),c=he(()=>{if(i().length===0)return null;const re={};for(let Ce=0;Ce<i().length;Ce++)re.hasOwnProperty(i()[Ce].created_at.getDay())?re[i()[Ce].created_at.getDay()]=re[i()[Ce].created_at.getDay()]+1:re[i()[Ce].created_at.getDay()]=1;let ae=0,de=0;const De=Object.keys(re);for(let Ce=0;Ce<De.length;Ce++)re[De[Ce]]>ae&&(ae=re[De[Ce]],de=De[Ce]);return de}),d=he(()=>{if(i().length===0)return null;const re={};for(let Ce=0;Ce<i().length;Ce++)re.hasOwnProperty(i()[Ce].created_at.getHours())?re[i()[Ce].created_at.getHours()]=re[i()[Ce].created_at.getHours()]+1:re[i()[Ce].created_at.getHours()]=1;let ae=0,de=0;const De=Object.keys(re);for(let Ce=0;Ce<De.length;Ce++)re[De[Ce]]>ae&&(ae=re[De[Ce]],de=De[Ce]);return de}),v=he(()=>i().reduce((re,ae)=>(re=re+(ae.rating===null?0:1),re),0)),u=he(()=>{const re=i().reduce((ae,de)=>(ae=ae+(de.rating===null?0:de.rating),ae),0);return h(v)===0?0:re/h(v)}),m=he(()=>{const re=i().reduce((de,De)=>(De.rating!==null&&de.push(De.rating),de),[]);if(re.length===0)return 0;re.sort((de,De)=>de>De?1:de<De?-1:0);const ae=Math.floor(re.length/2);return re.length%2===0?(re[ae-1]+re[ae])/2:re[ae]}),y=he(()=>{const re=i().reduce((Ce,ot)=>(ot.rating!==null&&Ce.push(ot.rating),Ce),[]);if(re.length===0)return[];const ae={},de=[];let De=0;for(const Ce of re)ae[Ce]=(ae[Ce]||0)+1,ae[Ce]>De&&(De=ae[Ce]);for(const Ce in ae)ae[Ce]===De&&de.push(Number(Ce));return de.length===Object.keys(ae).length?[]:de});let g=he(()=>{if(n()){for(let re=0;re<n().fields.length;re++)if(n().fields[re].kind==="profile")return n().fields[re].options;return[]}return[]});function _(re){const ae=new Date,de=re-ae.getDay();return ae.setDate(ae.getDate()+de),new Intl.DateTimeFormat(navigator.language,{weekday:"long"}).format(ae)}function k(re){const ae=new Date;return ae.setHours(re),ae.toLocaleTimeString(navigator.language,{hour:"numeric",hour12:!0})}var O=tm();let C;var S=H(P(O),2),x=P(S),A=P(x),q=P(A,!0);E(A),xt(2),E(x);var D=H(x,2),W=P(D),te=P(W,!0);E(W),xt(2),E(D);var J=H(D,2),Y=P(J),ne=P(Y,!0);E(Y),xt(2),E(J);var ee=H(J,2),V=P(ee),Z=P(V,!0);E(V),xt(2),E(ee),E(S);var oe=H(S,4),se=P(oe),je=P(se),Te=P(je,!0);E(je),xt(2),E(se);var fe=H(se,2),B=P(fe),Ne=P(B,!0);E(B),xt(2),E(fe);var Le=H(fe,2),Fe=P(Le),Ze=P(Fe,!0);E(Fe),xt(2),E(Le);var He=H(Le,2),Je=P(He),It=P(Je,!0);E(Je),xt(2),E(He),E(oe);var Mt=H(oe,2);{var Se=re=>{var ae=em(),de=H(Oe(ae),2),De=P(de);fo(De,{get spokes(){return h(g)}}),E(de),xt(2),Q(re,ae)};pe(Mt,re=>{n()&&re(Se)})}E(O),we((re,ae,de,De,Ce,ot)=>{C=it(O,1,"svelte-1kvllfw",null,C,re),Ie(q,h(a)),Ie(te,h(l)),Ie(ne,ae),Ie(Z,de),Ie(Te,h(v)),Ie(Ne,De),Ie(Ze,Ce),Ie(It,ot)},[()=>({hidden:r()}),()=>h(c)===null?"TBD":_(h(c)),()=>h(d)===null?"TBD":k(h(d)),()=>h(u).toFixed(2),()=>h(m).toFixed(2),()=>h(y).length===0?"0":h(y).join(", ")]),Q(e,O),Ge()}function rm(e,t){window.open("https://flavorawesome.com","_blank"),t()}var im=(e,t)=>t(),om=(e,t)=>t(null),am=(e,t,n)=>t(h(n).id),sm=ce('<li><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i"> </span> <span class="svelte-84fq4i"> </span></button></li>'),lm=ce('<section class="svelte-84fq4i"><article class="scrim svelte-84fq4i"><button type="button" class="svelte-84fq4i"><!></button></article> <article class="drawer svelte-84fq4i"><h3 class="svelte-84fq4i">Flavors</h3> <ul class="svelte-84fq4i"><li><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">All</span> <span class="svelte-84fq4i"> </span></button></li> <!></ul> <ul class="svelte-84fq4i"><li class="svelte-84fq4i"><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">About Flavor Awesome</span> <span class="svelte-84fq4i"></span></button></li> <li class="svelte-84fq4i"><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">Help and Feedback</span> <span class="svelte-84fq4i"></span></button></li></ul></article></section>');function um(e,t){Ye(t,!0);let n=be(t,"selected",7,null),r,i,a;function l(se){n()!==se?(n(se),t.onchange&&(c(),t.onchange(n()))):c()}function c(){i.animate([{opacity:"1.0"},{opacity:"0"}],{duration:300,easing:"ease-in-out",fill:"forwards"}),r.animate([{left:"0"},{left:"-100vw"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{a.style.left="-100vw"})}function d(){a.style.left="0",i.animate([{opacity:"0"},{opacity:"1.0"}],{duration:300,easing:"ease-in-out",fill:"forwards"}),r.animate([{left:"-100vw"},{left:"0"}],{duration:300,easing:"ease-in-out",fill:"forwards"})}var v=lm(),u=P(v),m=P(u);m.__click=[im,c];var y=P(m);Pe(y,{color:"#ffffff",height:"24",icon:"material-symbols:cancel-rounded",width:"24"}),E(m),E(u),st(u,se=>i=se,()=>i);var g=H(u,2),_=H(P(g),2),k=P(_);let O;var C=P(k);C.__click=[om,l];var S=P(C),x=P(S);Pe(x,{color:"#5fb2ff",height:"24",icon:"material-symbols:circle",width:"24"}),E(S);var A=H(S,4),q=P(A,!0);E(A),E(C),E(k);var D=H(k,2);ft(D,17,()=>t.items,ct,(se,je)=>{var Te=sm();let fe;var B=P(Te);B.__click=[am,l,je];var Ne=P(B),Le=P(Ne);Pe(Le,{get color(){return h(je).primary},height:"24",icon:"material-symbols:circle",width:"24"}),E(Ne);var Fe=H(Ne,2),Ze=P(Fe,!0);E(Fe);var He=H(Fe,2),Je=P(He,!0);E(He),E(B),E(Te),we((It,Mt)=>{fe=it(Te,1,"svelte-84fq4i",null,fe,It),Ie(Ze,h(je).singular),Ie(Je,Mt)},[()=>({selected:h(je).id===n()}),()=>t.count.hasOwnProperty(h(je).singular)?t.count[h(je).singular]:0]),Q(se,Te)}),E(_);var W=H(_,2),te=P(W),J=P(te);J.__click=[rm,c];var Y=P(J),ne=P(Y);Pe(ne,{color:"#49454F",height:"24",icon:"material-symbols:info-rounded",width:"24"}),E(Y),xt(4),E(J),E(te);var ee=H(te,2),V=P(ee),Z=P(V),oe=P(Z);return Pe(oe,{color:"#49454F",height:"24",icon:"material-symbols:help-rounded",width:"24"}),E(Z),xt(4),E(V),E(ee),E(W),E(g),st(g,se=>r=se,()=>r),E(v),st(v,se=>a=se,()=>a),we(se=>{O=it(k,1,"svelte-84fq4i",null,O,se),Ie(q,t.count.All)},[()=>({selected:n()===null})]),Q(e,v),Ge({hide:c,show:d})}tt(["click"]);var cm=Kf(`<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""> <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="">
  <\/script>`,1),fm=ce('<article><div class="svelte-hy6652"></div></article>');function dm(e,t){Ye(t,!0);let n=be(t,"hidden",3,!1),r=be(t,"items",19,()=>[]),i,a,l,c=null;function d(){if(i){c.clearLayers();for(let g=0;g<r().length;g++){const _=`<svg width="32" height="32" viewBox="0 0 24 24"><path fill="${r()[g].color}" d="M12 12q.825 0 1.413-.587T14 10t-.587-1.412T12 8t-1.412.588T10 10t.588 1.413T12 12m0 10q-4.025-3.425-6.012-6.362T4 10.2q0-3.75 2.413-5.975T12 2t5.588 2.225T20 10.2q0 2.5-1.987 5.438T12 22"/></svg>`,k=i.divIcon({className:"pin",iconSize:[32,32],iconAnchor:[16,32],html:_}),O=i.marker([r()[g].latitude,r()[g].longitude],{icon:k});O.data=r()[g].id,O.addTo(c).on("click",C=>{t.onchange&&t.onchange(C.target.data)})}}}function v(){i=window.L,a=i.map(l,{preferCanvas:!0,zoomControl:!1}).setView([39.51,-104.84],10),i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(a),c=i.layerGroup(),c.addTo(a),d()}Ir(()=>{r(),d()});var u=fm();Ou(g=>{var _=cm(),k=H(Oe(_),2);oi("load",k,v),Cu(k),Q(g,_)});let m;var y=P(u);return st(y,g=>l=g,()=>l),E(u),we(g=>m=it(u,1,"svelte-hy6652",null,m,g),[()=>({hidden:n()})]),Q(e,u),Ge({update:d})}var vm=ce('<nav class="svelte-1h9b4b6"><ul class="svelte-1h9b4b6"><!></ul></nav>');function hm(e,t){var n=vm(),r=P(n),i=P(r);gn(i,()=>t.children),E(r),E(n),Q(e,n)}var pm=ce('<span class="icon svelte-wnxw5f"><!></span>'),ym=ce("<span> </span>"),mm=ce('<li class="svelte-wnxw5f"><button type="button"><!></button></li>');function Wi(e,t){var n=mm(),r=P(n);r.__click=function(...d){var v;(v=t.onclick)==null||v.apply(this,d)};let i;var a=P(r);{var l=d=>{var v=pm(),u=P(v);Pe(u,{height:"20",get icon(){return t.icon},width:"20"}),E(v),Q(d,v)},c=d=>{var v=ym(),u=P(v,!0);E(v),we(()=>Ie(u,t.label)),Q(d,v)};pe(a,d=>{t.icon?d(l):d(c,!1)})}E(r),E(n),we(d=>i=it(r,1,"svelte-wnxw5f",null,i,d),[()=>({active:t.active})]),Q(e,n)}tt(["click"]);var gm=(e,t,n)=>t(h(n).id),bm=ce('<span class="svelte-1leb39h"><!></span>'),_m=ce('<li class="svelte-1leb39h"><button type="button" class="svelte-1leb39h"><img alt="Thumbnail" class="svelte-1leb39h"> <p class="date svelte-1leb39h"> </p> <p class="month svelte-1leb39h"> </p> <!></button></li>'),wm=ce('<ul class="svelte-1leb39h"></ul>'),km=ce("<article><!></article>");function xm(e,t){Ye(t,!0);let n=be(t,"hidden",3,!1),r=be(t,"items",19,()=>[]);function i(m){return new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(m)}function a(m){t.onchange&&t.onchange(m)}var l=km();let c;var d=P(l);{var v=m=>{var y=ze(),g=Oe(y);gn(g,()=>t.children),Q(m,y)},u=m=>{var y=wm();ft(y,21,r,ct,(g,_)=>{var k=_m(),O=P(k);O.__click=[gm,a,_];var C=P(O),S=H(C,2),x=P(S,!0);E(S);var A=H(S,2),q=P(A,!0);E(A);var D=H(A,2);{var W=te=>{var J=bm(),Y=P(J);Pe(Y,{height:"24",icon:"material-symbols:favorite",width:"24"}),E(J),Q(te,J)};pe(D,te=>{h(_).favorite&&te(W)})}E(O),E(k),we((te,J)=>{Re(C,"src",h(_).data),Ie(x,te),Ie(q,J)},[()=>h(_).created_at.getDate(),()=>i(h(_).created_at)]),Q(g,k)}),E(y),Q(m,y)};pe(d,m=>{r().length===0?m(v):m(u,!1)})}E(l),we(m=>c=it(l,1,"svelte-1leb39h",null,c,m),[()=>({hidden:n()})]),Q(e,l),Ge()}tt(["click"]);function Sm(e,t,n){const r=new Date(parseInt(e.currentTarget.getAttribute("data-year")),parseInt(e.currentTarget.getAttribute("data-month")),parseInt(e.currentTarget.getAttribute("data-date")));t(new Date(r.getTime())),n.onchange&&n.onchange(t())}var Im=ce('<li class="svelte-hcex0j"><button type="button"> </button></li>'),Em=ce('<div class="svelte-hcex0j"><p class="svelte-hcex0j"> </p> <ul class="svelte-hcex0j"></ul></div>');function Om(e,t){Ye(t,!0);let n=be(t,"display",19,()=>new Date),r=be(t,"value",7,null),i=he(()=>new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(n())),a=he(()=>{const m=new Date(n().getFullYear(),n().getMonth(),1),y=[],g=new Date;m.setDate(m.getDate()-m.getDay());const _=l(n().getFullYear(),n().getMonth()+1,m.getDay());for(let k=0;k<7*_;k++){let O=!0,C=!1,S=!1;r()===null?C=!1:m.getFullYear()===r().getFullYear()&&m.getMonth()===r().getMonth()&&m.getDate()===r().getDate()&&(C=!0),m.getFullYear()===n().getFullYear()&&m.getMonth()===n().getMonth()&&(O=!1),m.getFullYear()===g.getFullYear()&&m.getMonth()===g.getMonth()&&m.getDate()===g.getDate()&&(S=!0),y.push({date:m.getDate(),month:m.getMonth(),year:m.getFullYear(),outside:O,selected:C,today:S}),m.setDate(m.getDate()+1)}return y});function l(m,y,g=0){const _=g||0,k=new Date(m,y-1,1),C=new Date(m,y,0).getDate(),x=(k.getDay()-_+7)%7+C;return Math.ceil(x/7)}var c=Em(),d=P(c),v=P(d,!0);E(d);var u=H(d,2);ft(u,21,()=>h(a),ct,(m,y)=>{var g=Im(),_=P(g);let k;_.__click=[Sm,r,t];var O=P(_,!0);E(_),E(g),we(C=>{k=it(_,1,"day svelte-hcex0j",null,k,C),Re(_,"data-date",h(y).date),Re(_,"data-month",h(y).month),Re(_,"data-year",h(y).year),Ie(O,h(y).date)},[()=>({outside:h(y).outside,selected:h(y).selected,today:h(y).today})]),Q(m,g)}),E(u),E(c),we(()=>Ie(v,h(i))),Q(e,c),Ge()}tt(["click"]);var Cm=ce('<li class="svelte-13buufu"> </li>'),Am=ce('<section class="svelte-13buufu"><p class="svelte-13buufu"> </p> <h3 class="svelte-13buufu"> </h3> <ul class="svelte-13buufu"></ul> <article class="svelte-13buufu"></article> <footer class="svelte-13buufu"><button type="button" class="svelte-13buufu">Cancel</button> <button type="button" class="svelte-13buufu">Ok</button></footer></section>');function Pm(e,t){Ye(t,!0);let n=be(t,"display",19,()=>new Date),r=be(t,"value",7),i=he(()=>{let S=new Date(n().getTime());return r()!==null&&(S=new Date(r().getTime())),new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"short",weekday:"short",year:"numeric"}).format(S)}),a=Yn([]),l=Yn([]);po(()=>{const S=new Intl.DateTimeFormat(navigator.language,{weekday:"narrow"});let x=new Date;x.setDate(1),x.setDate(x.getDate()-x.getDay());for(let A=0;A<7;A++)l.push(S.format(x)),x.setDate(x.getDate()+1);x=new Date,x.setDate(15);for(let A=0;A<6;A++)a.push(new Date(x.getTime())),x.setMonth(x.getMonth()-1)});function c(S){r(new Date(S.getTime())),t.onchange&&t.onchange({name:t.name,value:r()})}var d=Am(),v=P(d),u=P(v,!0);E(v);var m=H(v,2),y=P(m,!0);E(m);var g=H(m,2);ft(g,21,()=>l,ct,(S,x)=>{var A=Cm(),q=P(A,!0);E(A),we(()=>Ie(q,h(x))),Q(S,A)}),E(g);var _=H(g,2);ft(_,21,()=>a,ct,(S,x)=>{Om(S,{get display(){return h(x)},onchange:c})}),E(_);var k=H(_,2),O=P(k);O.__click=function(...S){var x;(x=t.onclose)==null||x.apply(this,S)};var C=H(O,2);C.__click=function(...S){var x;(x=t.onsave)==null||x.apply(this,S)},E(k),E(d),we(()=>{Ie(u,t.label),Ie(y,h(i))}),Q(e,d),Ge()}tt(["click"]);var Tm=ce('<dialog class="svelte-zsytrm"><header class="svelte-zsytrm"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <h3 class="svelte-zsytrm"> </h3> <button type="button" class="svelte-zsytrm">Save</button></header> <!></dialog>');function ws(e,t){Ye(t,!0);let n=Ve(void 0);function r(){h(n).close()}function i(){h(n).showModal()}var a=Tm(),l=P(a),c=P(l);ur(c,()=>({"--icon-button-color":"var( --primary-accent-color )"})),Dt(c.lastChild,{name:"material-symbols:close",get onclick(){return t.onclose}}),E(c);var d=H(c,2),v=P(d,!0);E(d);var u=H(d,2);u.__click=function(...y){var g;(g=t.onsave)==null||g.apply(this,y)},E(l);var m=H(l,2);return gn(m,()=>t.children??Er),E(a),st(a,y=>ke(n,y),()=>h(n)),we(()=>Ie(v,t.label)),Q(e,a),Ge({close:r,showModal:i})}tt(["click"]);var jm=ce('<div><span><!></span> <div class="svelte-1wl9158"><p class="svelte-1wl9158"> </p> <p class="svelte-1wl9158"> </p></div></div>');function en(e,t){let n=be(t,"bottom",3,!0),r=be(t,"gap",3,!0),i=be(t,"top",3,!1);var a=jm();let l;var c=P(a);let d;var v=P(c);Pe(v,{height:"24",get icon(){return t.icon},width:"24"}),E(c);var u=H(c,2),m=P(u),y=P(m);E(m);var g=H(m,2),_=P(g,!0);E(g),E(u),E(a),we((k,O)=>{l=it(a,1,"svelte-1wl9158",null,l,k),d=it(c,1,"svelte-1wl9158",null,d,O),Ie(y,`${t.value??""}${r()?" ":""}${t.suffix??""}`),Ie(_,t.label)},[()=>({bottom:n(),top:i()}),()=>({noicon:!t.icon})]),Q(e,a)}var Dm=(e,t)=>h(t).showModal(),Rm=ce('<div class="svelte-1govqhv"><span class="svelte-1govqhv"><!></span> <button type="button" class="svelte-1govqhv"><p class="svelte-1govqhv"><span class="svelte-1govqhv"> </span> <span><!></span></p></button></div> <!>',1);function Nm(e,t){Ye(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null),i=Ve(void 0),a=he(()=>r()!==null?new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"short",weekday:"short",year:"numeric"}).format(r()):"");function l(g){console.log(g),r(new Date(g.value.getTime())),t.onchange&&t.onchange({name:t.name,value:r()})}function c(){h(i).close()}function d(){h(i).close()}var v=ze(),u=Oe(v);{var m=g=>{var _=ze(),k=Oe(_);{var O=C=>{en(C,{icon:"material-symbols:calendar-month-outline",get label(){return t.label},get value(){return h(a)}})};pe(k,C=>{r()&&C(O)})}Q(g,_)},y=g=>{var _=Rm(),k=Oe(_),O=P(k),C=P(O);Pe(C,{height:"24",icon:"material-symbols:calendar-month-outline",width:"24"}),E(O);var S=H(O,2);S.__click=[Dm,i];var x=P(S),A=P(x),q=P(A,!0);E(A);var D=H(A,2);let W;var te=P(D);{var J=ee=>{var V=el();we(()=>Ie(V,h(a))),Q(ee,V)},Y=ee=>{var V=el();we(()=>Ie(V,t.placeholder?t.placeholder:"")),Q(ee,V)};pe(te,ee=>{r()?ee(J):ee(Y,!1)})}E(D),E(x),E(S),E(k);var ne=H(k,2);st(ws(ne,{onclose:c,onsave:d,children:(ee,V)=>{Pm(ee,{onchange:l,onclose:c,onsave:d,name:"date",get label(){return t.label},get value(){return r()}})},$$slots:{default:!0}}),ee=>ke(i,ee,!0),()=>h(i)),we(ee=>{Ie(q,t.label),W=it(D,1,"svelte-1govqhv",null,W,ee)},[()=>({placeholder:!r()&&t.placeholder})]),Q(g,_)};pe(u,g=>{n()?g(m):g(y,!1)})}Q(e,v),Ge()}tt(["click"]);var Lm=ce('<div class="svelte-hm3w6m"><span><!></span> <!></div>');function Mm(e,t){Ye(t,!0);let n=be(t,"gap",3,!0),r=be(t,"readonly",3,!1),i=be(t,"value",7,null),a=he(()=>{if(i()!==null)return i().toLocaleString(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})});function l(m){i(m.value),t.onchange&&t.onchange({name:t.name,value:i()===null?null:parseFloat(i())})}var c=ze(),d=Oe(c);{var v=m=>{var y=ze(),g=Oe(y);{var _=k=>{en(k,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get format(){return h(a)},get value(){return i()}})};pe(g,k=>{i()!==null&&k(_)})}Q(m,y)},u=m=>{var y=Lm(),g=P(y);let _;var k=P(g);Pe(k,{height:"24",get icon(){return t.icon},width:"24"}),E(g);var O=H(g,2);wn(O,{get label(){return t.label},mode:"decimal",name:"decimal",onchange:l,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),E(y),we(C=>_=it(g,1,"svelte-hm3w6m",null,_,C),[()=>({noicon:!t.icon})]),Q(m,y)};pe(d,m=>{r()?m(v):m(u,!1)})}Q(e,c),Ge()}const qm=(e,t=Er)=>{var n=Bm(),r=H(P(n));let i;E(n),we(a=>i=it(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)},Fm=(e,t=Er)=>{var n=Km(),r=H(P(n));let i;E(n),we(a=>i=it(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)},Um=(e,t=Er)=>{var n=zm(),r=H(P(n));let i;E(n),we(a=>i=it(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)};var Bm=St('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 20, -1 L 20, 36 A 8.5 8.5 0 0 1 3 36 L 3, -1 Z"></path><path d="M 7, -1 L 7, 36 A 3 3 0 0 0 16 36 L 16, -1 Z"></path></svg>'),Km=St('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 3, -1 L 3, 48 L 20, 48 L 20, -1 Z"></path><path d="M 7, -1 L 7, 48 L 16, 48 L 16 -1 Z"></path></svg>'),zm=St('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 3, 48 L 3, 12 A 8.5 8.5 0 0 1 20 12 L 20, 48 Z"></path><path d="M 7, 48 L 7, 12 A 3 3 0 0 1 16 12 L 16, 48 Z"></path></svg>'),Vm=ce('<li class="svelte-ibqihf"><button type="button" class="svelte-ibqihf"><span class="svelte-ibqihf"> </span> <!></button></li>'),Wm=ce('<div class="svelte-ibqihf"><div class="svelte-ibqihf"><span class="svelte-ibqihf"><!></span> <p class="svelte-ibqihf"> </p></div> <ul class="svelte-ibqihf"></ul></div>');function Hm(e,t){Ye(t,!0);let n=be(t,"items",19,()=>[]),r=be(t,"readonly",3,!1),i=be(t,"value",7,null),a=he(()=>n().findIndex(y=>y===i()));function l(y){return i()===null?!0:!(y>=h(a))}function c(y){const g=y.currentTarget.getAttribute("data-value");i(i()===g?null:g),t.onchange&&t.onchange({name:t.name,value:i()})}var d=ze(),v=Oe(d);{var u=y=>{var g=ze(),_=Oe(g);{var k=O=>{en(O,{get icon(){return t.icon},get label(){return t.label},get value(){return i()}})};pe(_,O=>{i()!==null&&O(k)})}Q(y,g)},m=y=>{var g=Wm(),_=P(g),k=P(_),O=P(k);Pe(O,{height:"24",get icon(){return t.icon},width:"24"}),E(k);var C=H(k,2),S=P(C,!0);E(C),E(_);var x=H(_,2);ft(x,21,n,ct,(A,q,D)=>{var W=Vm();const te=he(()=>l(D));var J=P(W);J.__click=c;var Y=P(J),ne=P(Y,!0);E(Y);var ee=H(Y,2);{var V=oe=>{Um(oe,()=>h(te))},Z=(oe,se)=>{{var je=fe=>{Fm(fe,()=>h(te))},Te=fe=>{qm(fe,()=>h(te))};pe(oe,fe=>{D>0&&D<n().length-1?fe(je):fe(Te,!1)},se)}};pe(ee,oe=>{D===0?oe(V):oe(Z,!1)})}E(J),E(W),we(()=>{Re(J,"data-value",h(q)),Ie(ne,h(q))}),Q(A,W)}),E(x),E(g),we(()=>Ie(S,t.label)),Q(y,g)};pe(v,y=>{r()?y(u):y(m,!1)})}Q(e,d),Ge()}tt(["click"]);var Ym=ce('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Gm=ce('<div class="svelte-1bz35xs"><span class="svelte-1bz35xs"><!></span> <!></div>');function Jm(e,t){Ye(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null);function i(v){r(v.value),t.onchange&&t.onchange({name:t.name,value:r()})}var a=ze(),l=Oe(a);{var c=v=>{var u=ze(),m=Oe(u);{var y=g=>{var _=Ym(),k=Oe(_);ur(k,()=>({"--label-field-font-size":"22px","--label-field-line-height":"28px"})),en(k.lastChild,{icon:"material-symbols:label-outline",get label(){return t.label},get value(){return r()}}),E(k),Q(g,_)};pe(m,g=>{r()!==null&&g(y)})}Q(v,u)},d=v=>{var u=Gm(),m=P(u),y=P(m);Pe(y,{height:"24",icon:"material-symbols:label-outline",width:"24"}),E(m);var g=H(m,2);wn(g,{get label(){return t.label},name:"name",onchange:i,get placeholder(){return t.placeholder},get value(){return r()}}),E(u),Q(v,u)};pe(l,v=>{n()?v(c):v(d,!1)})}Q(e,a),Ge()}function Qm(e,t,n){t().trim().length===0&&t(null),n.onchange&&n.onchange({name:n.name,value:t()})}var Zm=ce('<div class="label svelte-lsm8ct"><span class="svelte-lsm8ct"><!></span> <div class="svelte-lsm8ct"><p class="svelte-lsm8ct">Notes</p> <p class="svelte-lsm8ct"> </p></div></div>'),Xm=ce('<div class="field svelte-lsm8ct"><div class="svelte-lsm8ct"><span class="svelte-lsm8ct"><!></span> <p class="svelte-lsm8ct">Notes</p></div> <label class="svelte-lsm8ct"><textarea class="svelte-lsm8ct"></textarea></label></div>');function $m(e,t){Ye(t,!0);let n=be(t,"placeholder",3,"Notes"),r=be(t,"value",7,null),i=Ve(void 0);Ir(()=>{t.readonly||r()!==null&&(h(i).style.height=h(i).scrollHeight+"px")});var a=ze(),l=Oe(a);{var c=v=>{var u=ze(),m=Oe(u);{var y=g=>{var _=Zm(),k=P(_),O=P(k);Pe(O,{height:"24",icon:"material-symbols:text-snippet-outline",width:"24"}),E(k);var C=H(k,2),S=H(P(C),2),x=P(S,!0);E(S),E(C),E(_),we(()=>Ie(x,r())),Q(g,_)};pe(m,g=>{r()!==null&&g(y)})}Q(v,u)},d=v=>{var u=Xm(),m=P(u),y=P(m),g=P(y);Pe(g,{height:"24",icon:"material-symbols:text-snippet-outline",width:"24"}),E(y),xt(2),E(m);var _=H(m,2),k=P(_);wd(k),k.__input=[Qm,r,t],st(k,O=>ke(i,O),()=>h(i)),E(_),E(u),we(()=>Re(k,"placeholder",n())),Xa(k,r),Q(v,u)};pe(l,v=>{t.readonly?v(c):v(d,!1)})}Q(e,a),Ge()}tt(["input"]);var eg=ce('<div class="svelte-hm3w6m"><span><!></span> <!></div>');function tg(e,t){Ye(t,!0);let n=be(t,"gap",3,!0),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()===null?null:parseInt(i())})}var l=ze(),c=Oe(l);{var d=u=>{var m=ze(),y=Oe(m);{var g=_=>{en(_,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get value(){return i()}})};pe(y,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=eg(),y=P(m);let g;var _=P(y);Pe(_,{height:"24",get icon(){return t.icon},width:"24"}),E(y);var k=H(y,2);wn(k,{get label(){return t.label},mode:"numeric",name:"number",onchange:a,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),E(m),we(O=>g=it(y,1,"svelte-hm3w6m",null,g,O),[()=>({noicon:!t.icon})]),Q(u,m)};pe(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ge()}function ng(e,t){h(t).click()}function rg(e,t,n,r){t().splice(h(n),1),t(t().length===0?null:[...t()]),ke(n,h(n)===0?0:h(n)-1,!0),r.onchange&&r.onchange({name:r.name,value:t()})}function ig(e,t,n){h(t).files.length>0&&(ke(n,[...h(t).files],!0),h(t).value="")}function hu(e,t,n){ke(t,h(t)===n().length-1?0:h(t)+1,!0)}function pu(e,t,n){ke(t,h(t)===0?n().length-1:h(t)-1,!0)}var og=ce('<button aria-label="Previous photo" class="left svelte-1kbyvvc" type="button"><!></button> <button aria-label="Next photo" class="right svelte-1kbyvvc" type="button"><!></button>',1),ag=ce('<figure class="svelte-1kbyvvc"><img alt="Cigar" class="svelte-1kbyvvc"> <!></figure>'),sg=ce('<p class="svelte-1kbyvvc"> </p>'),lg=ce('<button aria-label="Previous photo" class="left svelte-1kbyvvc" type="button"><!></button> <button aria-label="Next photo" class="right svelte-1kbyvvc" type="button"><!></button>',1),ug=ce('<img class="svelte-1kbyvvc"> <!> <button aria-label="Delete photo" class="delete svelte-1kbyvvc" type="button"><!></button>',1),cg=ce('<img alt="Loader. Not seen." class="loader svelte-1kbyvvc">'),fg=ce('<figure class="svelte-1kbyvvc"><!> <button aria-label="Add photo" class="add svelte-1kbyvvc" type="button"><!></button> <!> <canvas class="svelte-1kbyvvc"></canvas> <input accept="image/*" type="file" class="svelte-1kbyvvc"></figure>');function dg(e,t){Ye(t,!0);let n=be(t,"placeholder",3,"Add photos"),r=be(t,"readonly",3,!1),i=be(t,"value",7,null),a=Ve(Yn([])),l=Ve(0),c=!0;const d=.8,v=1800;let u=Ve(void 0),m=Ve(void 0);Ir(()=>{i()===null&&(ke(a,[],!0),ke(l,0))});async function y(C){const S=C.currentTarget,x=S.getAttribute("data-type"),A=S.getAttribute("data-name"),q=A.lastIndexOf(".")+1;let D=S.width,W=S.height;const te=Math.max(D,W);if(te>v){const ne=v/te;D=D*ne,W=W*ne}h(u).width=D,h(u).height=W,h(u).getContext("2d").drawImage(S,0,0,D,W);const Y={id:crypto.randomUUID(),created_at:new Date,updated_at:new Date,data:h(u).toDataURL(x,d),format:x,name:A,extension:A.substring(q),width:D,height:W};i()===null?i([Y]):i([...i(),Y]),ke(l,i().length-1),C.target.remove(),t.onchange&&t.onchange({name:t.name,value:i()})}var g=ze(),_=Oe(g);{var k=C=>{var S=ze(),x=Oe(S);{var A=q=>{var D=ag(),W=P(D),te=H(W,2);{var J=Y=>{var ne=og(),ee=Oe(ne);ee.__click=[pu,l,i];var V=P(ee);Pe(V,{width:"24",height:"24",icon:"material-symbols:chevron-left"}),E(ee);var Z=H(ee,2);Z.__click=[hu,l,i];var oe=P(Z);Pe(oe,{width:"24",height:"24",icon:"material-symbols:chevron-right"}),E(Z),Q(Y,ne)};pe(te,Y=>{i().length>1&&Y(J)})}E(D),we(()=>Re(W,"src",i()[h(l)].data?i()[h(l)].data:i()[h(l)].storage_url)),Q(q,D)};pe(x,q=>{i()!==null&&q(A)})}Q(C,S)},O=C=>{var S=fg(),x=P(S);{var A=ne=>{var ee=sg(),V=P(ee,!0);E(ee),we(()=>Ie(V,n())),Q(ne,ee)},q=ne=>{var ee=ug(),V=Oe(ee),Z=H(V,2);{var oe=Te=>{var fe=lg(),B=Oe(fe);B.__click=[pu,l,i];var Ne=P(B);Pe(Ne,{width:"24",height:"24",icon:"material-symbols:chevron-left"}),E(B);var Le=H(B,2);Le.__click=[hu,l,i];var Fe=P(Le);Pe(Fe,{width:"24",height:"24",icon:"material-symbols:chevron-right"}),E(Le),Q(Te,fe)};pe(Z,Te=>{i().length>1&&Te(oe)})}var se=H(Z,2);se.__click=[rg,i,l,t];var je=P(se);Pe(je,{width:"24",height:"24",icon:"material-symbols:delete-outline"}),E(se),we(()=>{Re(V,"alt",t.label),Re(V,"src",i()[h(l)].data?i()[h(l)].data:i()[h(l)].storage_url)}),Q(ne,ee)};pe(x,ne=>{i()===null||i().length===0?ne(A):ne(q,!1)})}var D=H(x,2);D.__click=[ng,m];var W=P(D);Pe(W,{width:"24",height:"24",icon:"material-symbols:add-a-photo-outline"}),E(D);var te=H(D,2);ft(te,17,()=>h(a),ct,(ne,ee)=>{var V=cg();we(Z=>{Re(V,"data-name",h(ee).name),Re(V,"data-type",h(ee).type),Re(V,"src",Z)},[()=>URL.createObjectURL(h(ee))]),oi("load",V,y),Cu(V),Q(ne,V)});var J=H(te,2);st(J,ne=>ke(u,ne),()=>h(u));var Y=H(J,2);Y.__change=[ig,m,a],st(Y,ne=>ke(m,ne),()=>h(m)),E(S),we(()=>Y.multiple=c),Q(C,S)};pe(_,C=>{r()?C(k):C(O,!1)})}Q(e,g),Ge()}tt(["click","change"]);function vg(e,t,n,r,i,a,l,c){if(t())return;e.preventDefault();const d=h(n).getBoundingClientRect(),v=r(e.offsetX,0,d.width,-1,1),u=r(e.offsetY,0,d.height,1,-1);i({x:v,y:u}),document.addEventListener("pointermove",a),document.addEventListener("pointerup",l),c.onchange&&c.onchange({name:c.name,value:i()})}var hg=St('<g><circle class="dot svelte-1p2qqpi" cx="0" cy="0" r="5.5"></circle><circle class="ring svelte-1p2qqpi" cx="0" cy="0" r="10"></circle></g>'),pg=St('<svg tabindex="-1" class="svelte-1p2qqpi"><rect y="-0.50" height="1" class="svelte-1p2qqpi"></rect><rect x="-0.50" width="1" class="svelte-1p2qqpi"></rect><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><text x="0" dominant-baseline="middle" text-anchor="middle" class="svelte-1p2qqpi"> </text><text x="0" dominant-baseline="middle" text-anchor="middle" class="svelte-1p2qqpi"> </text><text class="left svelte-1p2qqpi" x="0" dominant-baseline="middle" text-anchor="middle"> </text><text class="right svelte-1p2qqpi" x="0" dominant-baseline="middle" text-anchor="middle"> </text><!></svg>');function yu(e,t){Ye(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"size",3,300),i=be(t,"value",7,null),a=he(()=>i()===null?null:{x:c(i().x,-1,1,0-r()/2,r()/2),y:c(i().y,1,-1,0-r()/2,r()/2)}),l=Ve(void 0);function c(ee,V,Z,oe,se){return(ee-V)*(se-oe)/(Z-V)+oe}function d(ee){if(ee.target===h(l)){ee.preventDefault();const V=h(l).getBoundingClientRect(),Z=c(ee.offsetX,0,V.width,-1,1),oe=c(ee.offsetY,0,V.height,1,-1);i({x:Z,y:oe}),t.onchange&&t.onchange({name:t.name,value:i()})}}function v(){document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",v)}var u=pg();u.__pointerdown=[vg,n,l,c,i,d,v,t];let m;var y=P(u),g=H(y),_=H(g),k=H(_),O=H(k),C=H(O),S=H(C),x=P(S,!0);E(S);var A=H(S),q=P(A,!0);E(A);var D=H(A),W=P(D,!0);E(D);var te=H(D),J=P(te,!0);E(te);var Y=H(te);{var ne=ee=>{var V=hg();let Z;we(()=>Z=Gn(V,"",Z,{translate:`${h(a).x??""}px ${h(a).y??""}px`})),Q(ee,V)};pe(Y,ee=>{i()!==null&&ee(ne)})}E(u),st(u,ee=>ke(l,ee),()=>h(l)),we(()=>{Re(u,"role",n()?"none":"button"),Re(u,"viewBox",`${0-r()/2} ${0-r()/2} ${r()??""} ${r()??""}`),m=Gn(u,"",m,{cursor:n()?"default":"crosshair"}),Re(y,"x",0-r()/2),Re(y,"width",r()),Re(g,"y",0-r()/2),Re(g,"height",r()),Re(_,"d",`M ${0-r()/4} ${0-r()/2} L ${0-r()/4} ${r()??""}`),Re(k,"d",`M ${r()/4} ${0-(r()-2)} L ${r()/4} ${r()??""}`),Re(O,"d",`M ${0-r()/2} ${0-r()/4} L ${r()/2} ${0-r()/4}`),Re(C,"d",`M ${0-r()/2} ${r()/4} L ${r()/2} ${r()/4}`),Re(S,"y",(0-r()/8)*3),Ie(x,t.yhigh),Re(A,"y",r()/8*3),Ie(q,t.ylow),Re(D,"y",(0-r()/8)*3),Ie(W,t.xlow),Re(te,"y",(0-r()/8)*3),Ie(J,t.xhigh)}),Q(e,u),Ge()}tt(["pointerdown"]);var yg=ce('<div class="label svelte-1i5ik4b"><div class="svelte-1i5ik4b"><span class="svelte-1i5ik4b"><!></span> <p class="svelte-1i5ik4b"> </p></div> <div class="chart svelte-1i5ik4b"><!></div></div>'),mg=ce('<div class="field svelte-1i5ik4b"><div class="svelte-1i5ik4b"><span class="svelte-1i5ik4b"><!></span> <p class="svelte-1i5ik4b"> </p></div> <div class="chart svelte-1i5ik4b"><!></div></div>');function gg(e,t){Ye(t,!0);let n=be(t,"icon",3,"material-symbols:texture"),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()})}var l=ze(),c=Oe(l);{var d=u=>{var m=ze(),y=Oe(m);{var g=_=>{var k=yg(),O=P(k),C=P(O),S=P(C);Pe(S,{height:"24",get icon(){return n()},width:"24"}),E(C);var x=H(C,2),A=P(x,!0);E(x),E(O);var q=H(O,2),D=P(q);yu(D,{get label(){return t.label},name:"plot",get readonly(){return r()},get value(){return i()},get xhigh(){return t.xhigh},get xlow(){return t.xlow},get yhigh(){return t.yhigh},get ylow(){return t.ylow}}),E(q),E(k),we(()=>Ie(A,t.label)),Q(_,k)};pe(y,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=mg(),y=P(m),g=P(y),_=P(g);Pe(_,{height:"24",get icon(){return n()},width:"24"}),E(g);var k=H(g,2),O=P(k,!0);E(k),E(y);var C=H(y,2),S=P(C);yu(S,{get label(){return t.label},name:"plot",onchange:a,get readonly(){return r()},get value(){return i()},get xhigh(){return t.xhigh},get xlow(){return t.xlow},get yhigh(){return t.yhigh},get ylow(){return t.ylow}}),E(C),E(m),we(()=>Ie(O,t.label)),Q(u,m)};pe(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ge()}function bg(e,t,n){t(e.currentTarget.getAttribute("data-value")),n.onchange&&n.onchange(t())}var _g=ce('<li class="svelte-1ry2dq3"><button type="button" class="svelte-1ry2dq3"><!> <span class="svelte-1ry2dq3"> </span> <!></button></li>'),wg=ce('<ul class="svelte-1ry2dq3"></ul>');function kg(e,t){Ye(t,!0);let n=be(t,"items",19,()=>[]),r=be(t,"value",7,"USD");var i=wg();ft(i,21,n,ct,(a,l)=>{var c=_g(),d=P(c);d.__click=[bg,r,t];var v=P(d);Pe(v,{height:"20",get icon(){return h(l).icon},width:"20"});var u=H(v,2),m=P(u,!0);E(u);var y=H(u,2);const g=he(()=>h(l).value===r()?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");Pe(y,{height:"20",get icon(){return h(g)},width:"20"}),E(d),E(c),we(()=>{Re(d,"data-value",h(l).value),Ie(m,h(l).label)}),Q(a,c)}),E(i),Q(e,i),Ge()}tt(["click"]);function xg(e,t){h(t).showModal()}var Sg=ce('<div class="svelte-cc835x"><span class="svelte-cc835x"><!></span> <!> <button type="button" class="svelte-cc835x"><p class="svelte-cc835x"><span class="label svelte-cc835x">Currency</span> <span class="value svelte-cc835x"> </span></p> <span class="svelte-cc835x"><!></span></button></div> <!>',1);function Ig(e,t){Ye(t,!0);let n=be(t,"currency",7,"USD"),r=be(t,"placeholder",3,"0.00"),i=be(t,"readonly",3,!1),a=be(t,"value",7,null);const l=[{value:"USD",label:"US Dollar",icon:"material-symbols:attach-money"},{value:"EUR",label:"Euro",icon:"material-symbols:euro"},{value:"JPY",label:"Japanese Yen",icon:"material-symbols:currency-yen"},{value:"GBP",label:"Great Britain Pound",icon:"material-symbols:currency-pound"},{value:"AUD",label:"Australian Dollar",icon:"material-symbols:attach-money"},{value:"CAD",label:"Canadian Dollar",icon:"material-symbols:attach-money"},{value:"CHF",label:"Swiss Franc",icon:"material-symbols:currency-franc"},{value:"CNY",label:"Chinese Yuan",icon:"material-symbols:currency-yuan"},{value:"HKD",label:"Hong Kong Dollar",icon:"material-symbols:attach-money"},{value:"NZD",label:"New Zealand Dollar",icon:"material-symbols:attach-money"}];let c=Ve(void 0),d=he(()=>l.find(S=>S.value===n()).icon),v=null;function u(S){n(S),t.onchange&&t.onchange({name:t.name,value:n()})}function m(){h(c).close()}function y(S){n(v),h(c).close()}function g(S){a(S.value),t.onchange&&t.onchange({name:t.name,value:a()===null?null:parseFloat(a())})}var _=ze(),k=Oe(_);{var O=S=>{var x=ze(),A=Oe(x);{var q=D=>{en(D,{get icon(){return h(d)},label:"Price",get suffix(){return n()},get value(){return a()}})};pe(A,D=>{a()!==null&&D(q)})}Q(S,x)},C=S=>{var x=Sg(),A=Oe(x),q=P(A),D=P(q);Pe(D,{height:"24",get icon(){return h(d)},width:"24"}),E(q);var W=H(q,2);const te=he(()=>typeof a()=="number"?a().toString(10):a());wn(W,{label:"Price",mode:"decimal",name:"price",onchange:g,get placeholder(){return r()},get value(){return h(te)}});var J=H(W,2);J.__click=[xg,c];var Y=P(J),ne=H(P(Y),2),ee=P(ne,!0);E(ne),E(Y);var V=H(Y,2),Z=P(V);Pe(Z,{height:"24",icon:"material-symbols:arrow-drop-down",width:"24"}),E(V),E(J),E(A);var oe=H(A,2);st(ws(oe,{label:"Currency",onclose:m,onsave:y,children:(se,je)=>{kg(se,{items:l,onchange:u,get value(){return n()}})},$$slots:{default:!0}}),se=>ke(c,se,!0),()=>h(c)),we(()=>Ie(ee,n())),Q(S,x)};pe(k,S=>{i()?S(O):S(C,!1)})}Q(e,_),Ge()}tt(["click"]);function Eg(e,t,n,r){ke(t,h(t)+1),h(n)===0?ke(n,r.spokes.length-1):ke(n,h(n)-1)}function Xr(e,t,n,r,i){t()===null&&t(new Array(n.spokes.length));const a=parseInt(e.currentTarget.getAttribute("data-value"));t()[h(r)]===a?t()[h(r)]=0:t()[h(r)]=a,t([...t()]),n.onchange&&n.onchange({name:n.name,value:t()}),i()}var Og=ce('<div class="profile svelte-ylrvbk"><div class="controls svelte-ylrvbk"><button type="button" class="svelte-ylrvbk"><!></button> <p class="svelte-ylrvbk"> </p> <button type="button" class="svelte-ylrvbk"><!></button></div> <!> <div class="value svelte-ylrvbk"><button data-value="5" type="button" class="svelte-ylrvbk">5</button> <button data-value="4" type="button" class="svelte-ylrvbk">4</button> <button data-value="3" type="button" class="svelte-ylrvbk">3</button> <button data-value="2" type="button" class="svelte-ylrvbk">2</button> <button data-value="1" type="button" class="svelte-ylrvbk">1</button></div></div>');function Cg(e,t){Ye(t,!0);let n=be(t,"value",7,null),r=Ve(0),i=Ve(0);function a(){ke(i,h(i)-1),h(r)===t.spokes.length-1?ke(r,0):ke(r,h(r)+1)}var l=Og(),c=P(l),d=P(c);d.__click=[Eg,i,r,t];var v=P(d);Pe(v,{height:"24",icon:"material-symbols:chevron-left",width:"24"}),E(d);var u=H(d,2),m=P(u,!0);E(u);var y=H(u,2);y.__click=a;var g=P(y);Pe(g,{height:"24",icon:"material-symbols:chevron-right",width:"24"}),E(y),E(c);var _=H(c,2);const k=he(()=>n()===null?[]:n()),O=he(()=>360/t.spokes.length*h(i));fo(_,{interactive:!0,labels:!1,get spokes(){return t.spokes},get value(){return h(k)},get rotate(){return h(O)}});var C=H(_,2),S=P(C);S.__click=[Xr,n,t,r,a];var x=H(S,2);x.__click=[Xr,n,t,r,a];var A=H(x,2);A.__click=[Xr,n,t,r,a];var q=H(A,2);q.__click=[Xr,n,t,r,a];var D=H(q,2);D.__click=[Xr,n,t,r,a],E(C),E(l),we(()=>Ie(m,t.spokes[h(r)])),Q(e,l),Ge()}tt(["click"]);function Ag(e,t){h(t).showModal()}var Pg=ce('<div class="label svelte-a3m5ng"><div class="svelte-a3m5ng"><span class="svelte-a3m5ng"><!></span> <p class="svelte-a3m5ng"> </p></div> <div class="chart svelte-a3m5ng"><!></div></div>'),Tg=ce('<div class="field svelte-a3m5ng"><div class="svelte-a3m5ng"><span class="svelte-a3m5ng"><!></span> <p class="svelte-a3m5ng"> </p></div> <button type="button" class="svelte-a3m5ng"><!></button></div> <!>',1);function jg(e,t){Ye(t,!0);let n=be(t,"icon",3,"material-symbols:social-leaderboard-outline"),r=be(t,"readonly",3,!1),i=be(t,"spokes",19,()=>[]),a=be(t,"value",7,null),l=Ve(void 0),c=Ve(void 0);function d(){h(l).close()}function v(){h(l).close()}function u(k){a([...k.value]),t.onchange&&t.onchange({name:t.name,value:k.value})}var m=ze(),y=Oe(m);{var g=k=>{var O=ze(),C=Oe(O);{var S=x=>{var A=Pg(),q=P(A),D=P(q),W=P(D);Pe(W,{height:"24",get icon(){return n()},width:"24"}),E(D);var te=H(D,2),J=P(te,!0);E(te),E(q);var Y=H(q,2),ne=P(Y);const ee=he(()=>h(c)/2),V=he(()=>a()===null?[]:a());fo(ne,{get radius(){return h(ee)},get spokes(){return i()},get value(){return h(V)}}),E(Y),E(A),we(()=>Ie(J,t.label)),Q(x,A)};pe(C,x=>{a()!==null&&x(S)})}Q(k,O)},_=k=>{var O=Tg(),C=Oe(O),S=P(C),x=P(S),A=P(x);Pe(A,{height:"24",get icon(){return n()},width:"24"}),E(x);var q=H(x,2),D=P(q,!0);E(q),E(S);var W=H(S,2);W.__click=[Ag,l];var te=P(W);const J=he(()=>h(c)/2),Y=he(()=>a()===null?[]:a());fo(te,{get radius(){return h(J)},get spokes(){return i()},get value(){return h(Y)}}),E(W),E(C);var ne=H(C,2);st(ws(ne,{onclose:d,onsave:v,get label(){return t.label},children:(ee,V)=>{Cg(ee,{name:"profile",onchange:u,get spokes(){return i()},get value(){return a()}})},$$slots:{default:!0}}),ee=>ke(l,ee,!0),()=>h(l)),we(()=>Ie(D,t.label)),Nd(W,"clientWidth",ee=>ke(c,ee)),Q(k,O)};pe(y,k=>{r()?k(g):k(_,!1)})}Q(e,m),Ge()}tt(["click"]);var Dg=ce('<li class="svelte-1fz3u9v"><!></li>'),Rg=ce('<div class="label svelte-1fz3u9v"><span class="svelte-1fz3u9v"><!></span> <div class="svelte-1fz3u9v"><ul class="svelte-1fz3u9v"></ul> <p class="svelte-1fz3u9v"> </p></div></div>'),Ng=ce('<li><button type="button" class="svelte-1fz3u9v"><!></button></li>'),Lg=ce('<div class="field svelte-1fz3u9v"><div class="svelte-1fz3u9v"><span class="svelte-1fz3u9v"><!></span> <p class="svelte-1fz3u9v"> </p></div> <ul class="svelte-1fz3u9v"></ul></div>');function Mg(e,t){Ye(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null);function i(v){const u=parseInt(v.currentTarget.getAttribute("data-index"));u===r()?r(null):r(u),t.onchange&&t.onchange({name:t.name,value:r()})}var a=ze(),l=Oe(a);{var c=v=>{var u=ze(),m=Oe(u);{var y=g=>{var _=Rg(),k=P(_),O=P(k);Pe(O,{height:"24",icon:"material-symbols:stars-outline",width:"24"}),E(k);var C=H(k,2),S=P(C);ft(S,20,()=>({length:5}),ct,(q,D,W)=>{var te=Dg();const J=he(()=>W<r()?"material-symbols:star":"material-symbols:star-outline");var Y=P(te);Pe(Y,{height:"24",get icon(){return h(J)},width:"24"}),E(te),Q(q,te)}),E(S);var x=H(S,2),A=P(x,!0);E(x),E(C),E(_),we(()=>Ie(A,t.label)),Q(g,_)};pe(m,g=>{r()!==null&&g(y)})}Q(v,u)},d=v=>{var u=Lg(),m=P(u),y=P(m),g=P(y);Pe(g,{height:"24",icon:"material-symbols:stars-outline",width:"24"}),E(y);var _=H(y,2),k=P(_,!0);E(_),E(m);var O=H(m,2);ft(O,20,()=>({length:5}),ct,(C,S,x)=>{var A=Ng();const q=he(()=>r()===null?0:r()),D=he(()=>x<h(q)?"material-symbols:star":"material-symbols:star-outline");var W=P(A);Re(W,"aria-label",`Rating of ${x+1}`),Re(W,"data-index",x+1),W.__click=i;var te=P(W);Pe(te,{height:"48",get icon(){return h(D)},width:"48"}),E(W),E(A),Q(C,A)}),E(O),E(u),we(()=>Ie(k,t.label)),Q(v,u)};pe(l,v=>{n()?v(c):v(d,!1)})}Q(e,a),Ge()}tt(["click"]);function qg(e,t){e.preventDefault(),h(t).focus()}function Fg(){}var Ug=ce('<li class="svelte-24e094"><button type="button" class="svelte-24e094"><span class="svelte-24e094"> </span> <!></button></li>'),Bg=ce('<li class="other svelte-24e094"><label class="svelte-24e094"><input placeholder="Other" text="text" class="svelte-24e094"> <button type="button" class="svelte-24e094"><!></button></label></li>'),Kg=ce('<div class="svelte-24e094"><div class="svelte-24e094"><span class="svelte-24e094"><!></span> <p class="svelte-24e094"> </p></div> <ul class="svelte-24e094"><!> <!></ul></div>');function zg(e,t){Ye(t,!0);let n=be(t,"items",19,()=>[]),r=be(t,"other",3,!1),i=be(t,"readonly",3,!1),a=be(t,"value",7,null),l=Ve(void 0);function c(g){const _=g.currentTarget.getAttribute("data-value");a(a()===_?null:_),t.onchange&&t.onchange({name:t.name,value:a()})}function d(){}var v=ze(),u=Oe(v);{var m=g=>{var _=ze(),k=Oe(_);{var O=C=>{en(C,{get icon(){return t.icon},get label(){return t.label},get value(){return a()}})};pe(k,C=>{a()!==null&&C(O)})}Q(g,_)},y=g=>{var _=Kg(),k=P(_),O=P(k),C=P(O);Pe(C,{height:"24",get icon(){return t.icon},width:"24"}),E(O);var S=H(O,2),x=P(S,!0);E(S),E(k);var A=H(k,2),q=P(A);ft(q,17,n,ct,(te,J)=>{var Y=Ug();const ne=he(()=>a()===h(J)?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");var ee=P(Y);ee.__click=c;var V=P(ee),Z=P(V,!0);E(V);var oe=H(V,2);Pe(oe,{height:"24",get icon(){return h(ne)},width:"24"}),E(ee),E(Y),we(()=>{Re(ee,"data-value",h(J)),Ie(Z,h(J))}),Q(te,Y)});var D=H(q,2);{var W=te=>{var J=Bg(),Y=P(J),ne=P(Y);ne.__input=[Fg],st(ne,Z=>ke(l,Z),()=>h(l));var ee=H(ne,2);ee.__click=[qg,l];var V=P(ee);Pe(V,{height:"24",icon:"material-symbols:circle-outline",width:"24"}),E(ee),E(Y),E(J),oi("focus",ne,d),Q(te,J)};pe(D,te=>{r()&&te(W)})}E(A),E(_),we(()=>Ie(x,t.label)),Q(g,_)};pe(u,g=>{i()?g(m):g(y,!1)})}Q(e,v),Ge()}tt(["click","input"]);const Vg=(e,t,n)=>{let r=Jn(()=>mr(t==null?void 0:t(),!1)),i=Jn(()=>mr(n==null?void 0:n(),!1));var a=Yg();let l;we(c=>l=it(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:h(r),selected:h(i)})]),Q(e,a)},Wg=(e,t,n)=>{let r=Jn(()=>mr(t==null?void 0:t(),!1)),i=Jn(()=>mr(n==null?void 0:n(),!1));var a=Gg();let l;we(c=>l=it(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:h(r),selected:h(i)})]),Q(e,a)},Hg=(e,t,n)=>{let r=Jn(()=>mr(t==null?void 0:t(),!1)),i=Jn(()=>mr(n==null?void 0:n(),!1));var a=Jg();let l;we(c=>l=it(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:h(r),selected:h(i)})]),Q(e,a)};var Yg=St('<svg><rect x="50%" y="50%" width="48" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),Gg=St('<svg><rect x="0" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><rect x="50%" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),Jg=St('<svg><rect x="0" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),Qg=St('<circle cy="12" r="8"></circle>'),Zg=ce('<div class="label svelte-jfhagg"><span class="svelte-jfhagg"><!></span> <div class="svelte-jfhagg"><p class="svelte-jfhagg"> </p> <svg class="svelte-jfhagg"><path class="svelte-jfhagg"></path><path class="filled svelte-jfhagg"></path><!><text dominant-baseline="hanging" x="0" y="28" class="svelte-jfhagg"> </text><text dominant-baseline="hanging" text-anchor="end" y="28" class="svelte-jfhagg"> </text></svg></div></div>'),Xg=ce('<button type="button" class="svelte-jfhagg"><!></button>'),$g=ce('<div class="field svelte-jfhagg"><div class="svelte-jfhagg"><span class="svelte-jfhagg"><!></span> <p class="svelte-jfhagg"> </p></div> <div class="slider svelte-jfhagg"></div> <div class="range svelte-jfhagg"><p class="svelte-jfhagg"> </p> <p class="svelte-jfhagg"> </p></div></div>');function eb(e,t){Ye(t,!0);let n=be(t,"maximum",3,7),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){const m=parseInt(u.currentTarget.getAttribute("data-index"));m===i()?i(null):i(m),t.onchange&&t.onchange({name:t.name,value:i()})}var l=ze(),c=Oe(l);{var d=u=>{var m=ze(),y=Oe(m);{var g=_=>{var k=Zg(),O=P(k),C=P(O);Pe(C,{height:"24",get icon(){return t.icon},width:"24"}),E(O);var S=H(O,2),x=P(S),A=P(x,!0);E(x);var q=H(x,2),D=P(q),W=H(D),te=H(W);ft(te,17,()=>({length:n()}),ct,(V,Z,oe)=>{var se=Qg();const je=he(()=>i()>oe);Re(se,"cx",10+oe*30);let Te;we(fe=>Te=it(se,0,"svelte-jfhagg",null,Te,fe),[()=>({filled:h(je)})]),Q(V,se)});var J=H(te),Y=P(J,!0);E(J);var ne=H(J),ee=P(ne,!0);E(ne),E(q),E(S),E(k),we(()=>{Ie(A,t.label),Re(D,"d",`M 10 12 L ${10+(n()-1)*30} 12`),Re(W,"d",`M 10 12 L ${10+(i()-1)*30} 12`),Ie(Y,t.low),Re(ne,"x",(n()-2)*40),Ie(ee,t.high)}),Q(_,k)};pe(y,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=$g(),y=P(m),g=P(y),_=P(g);Pe(_,{height:"24",get icon(){return t.icon},width:"24"}),E(g);var k=H(g,2),O=P(k,!0);E(k),E(y);var C=H(y,2);ft(C,21,()=>({length:n()}),ct,(W,te,J)=>{var Y=Xg();const ne=he(()=>i()>J+1),ee=he(()=>i()===J+1);Re(Y,"aria-label",J),Re(Y,"data-index",J+1),Y.__click=a;var V=P(Y);{var Z=se=>{Vg(se,()=>h(ne),()=>h(ee))},oe=(se,je)=>{{var Te=B=>{Wg(B,()=>h(ne),()=>h(ee))},fe=(B,Ne)=>{{var Le=Fe=>{Hg(Fe,()=>h(ne),()=>h(ee))};pe(B,Fe=>{J===n()-1&&Fe(Le)},Ne)}};pe(se,B=>{J<n()-1?B(Te):B(fe,!1)},je)}};pe(V,se=>{J===0?se(Z):se(oe,!1)})}E(Y),Q(W,Y)}),E(C);var S=H(C,2),x=P(S),A=P(x,!0);E(x);var q=H(x,2),D=P(q,!0);E(q),E(S),E(m),we(()=>{Ie(O,t.label),Ie(A,t.low),Ie(D,t.high)}),Q(u,m)};pe(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ge()}tt(["click"]);var tb=ce('<div class="svelte-11ggxxf"><span><!></span> <!></div>');function nb(e,t){Ye(t,!0);let n=be(t,"gap",3,!0),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()})}var l=ze(),c=Oe(l);{var d=u=>{var m=ze(),y=Oe(m);{var g=_=>{en(_,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get value(){return i()}})};pe(y,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=tb(),y=P(m);let g;var _=P(y);Pe(_,{height:"24",get icon(){return t.icon},width:"24"}),E(y);var k=H(y,2);wn(k,{get label(){return t.label},onchange:a,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),E(m),we(O=>g=it(y,1,"svelte-11ggxxf",null,g,O),[()=>({noicon:!t.icon})]),Q(u,m)};pe(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ge()}var rb=ce('<button tabindex="-1" type="button" class="svelte-ng495u"><!></button>'),ib=ce('<div class="svelte-ng495u"><span><!></span> <!></div>');function ob(e,t){Ye(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null),i=Ve(Yn(r()===null?t.suffix[0]:r().units)),a=he(()=>r()===null?null:r().measure.toLocaleString(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2}));function l(y){y.value===null?r(null):r({measure:y.value,units:h(i)}),t.onchange&&t.onchange({name:t.name,value:{measure:parseFloat(r().measure),units:h(i)}})}function c(){let y=t.suffix.indexOf(h(i));y===t.suffix.length-1?y=0:y=y+1,ke(i,t.suffix[y],!0),r()!==null&&t.onchange&&t.onchange({name:t.name,value:{measure:parseFloat(r().measure),units:h(i)}})}var d=ze(),v=Oe(d);{var u=y=>{var g=ze(),_=Oe(g);{var k=O=>{en(O,{get icon(){return t.icon},get label(){return t.label},get suffix(){return r().units},get value(){return h(a)}})};pe(_,O=>{r()!==null&&O(k)})}Q(y,g)},m=y=>{var g=ib(),_=P(g);let k;var O=P(_);Pe(O,{height:"24",get icon(){return t.icon},width:"24"}),E(_);var C=H(_,2);wn(C,{get label(){return t.label},mode:"decimal",name:"units",onchange:l,get placeholder(){return t.placeholder},get suffix(){return h(i)},get value(){return h(a)},children:(S,x)=>{var A=rb();A.__click=c;var q=P(A);Pe(q,{height:"24",icon:"material-symbols:conversion-path",width:"24"}),E(A),Q(S,A)},$$slots:{default:!0}}),E(g),we(S=>k=it(_,1,"svelte-ng495u",null,k,S),[()=>({noicon:!t.icon})]),Q(y,g)};pe(v,y=>{n()?y(u):y(m,!1)})}Q(e,d),Ge()}tt(["click"]);var ab=ce("<!> <!> <!>",1),sb=ce('<div class="extra"><!></div>'),lb=ce('<div class="extra"><!></div>'),ub=ce('<section class="svelte-wtn90l"><!> <form><!> <!> <!></form></section>');function cb(e,t){Ye(t,!0);let n=be(t,"flavor",3,null),r=Ve(void 0),i=Ve(!1),a=Ve(void 0),l=Ve(null),c=he(()=>n()===null?null:n().fields),d=he(()=>h(l)===null||h(l).id===null?`New ${n()===null?"":n().singular}`:h(i)?"":`Edit ${n()===null?"":n().singular}`),v=he(()=>h(l)!==null&&h(l).name!==null);const u=new _s;let m=null,y=null,g=null,_=null,k=null,O=null;function C(){const fe={id:null,photos:null};for(let B=0;B<h(c).length;B++)fe[h(c)[B].name]=null;ke(l,fe,!0)}function S(){return h(a).animate([{top:0},{top:"100vh"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{ke(i,!0),h(r).scrollTo({top:0}),C()})}function x(fe=null){fe===null?(C(),ke(i,!1),h(a).animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{m=navigator.geolocation.watchPosition(B=>{y=B.coords.latitude,g=B.coords.longitude,navigator.geolocation.clearWatch(m),m=null,fetch(`/api/weather?location=${y},${g}`).then(Ne=>Ne.json()).then(Ne=>{O=Ne.icon,_=Ne.temperature,k=Ne.condition})})})):u.readReview(fe).then(B=>{ke(l,B,!0),ke(i,!0),h(a).animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"})})}async function A(){h(l)===null||h(l).id===null?S():u.readReview(h(l).id).then(fe=>{ke(l,fe,!0),ke(i,!0)})}function q(){confirm("Are you sure you want to delete this review?")&&u.deleteReview(h(l).id).then(()=>{t.onchange(),S()})}function D(){if(h(v))h(l).id===null?(h(l).latitude=y,h(l).longitude=g,h(l).temperature=_,h(l).condition=k,h(l).weather=O,u.addReview(n().singular,h(l)).then(()=>{t.onchange(),S()})):(ke(i,!0),u.editReview(h(l)).then(fe=>{ke(l,fe,!0),t.onchange()}));else{const fe=h(c).find(B=>B.name==="name");alert(`${fe.label} is required.`)}}function W(){ke(i,!1)}function te(){h(l).favorite=!h(l).favorite,u.favoriteReview(h(l).id,h(l).favorite).then(fe=>{ke(l,fe,!0),t.onchange&&t.onchange()})}function J(fe){h(l)!==null&&(h(l)[fe.name]=fe.value)}var Y=ub(),ne=P(Y);ns(ne,{get label(){return h(d)},variation:"sm",left:Ne=>{var Le=ze(),Fe=Oe(Le);{var Ze=Je=>{Dt(Je,{name:"material-symbols:close",onclick:A})},He=Je=>{Dt(Je,{name:"material-symbols:arrow-back",onclick:()=>S()})};pe(Fe,Je=>{h(i)?Je(He,!1):Je(Ze)})}Q(Ne,Le)},right:Ne=>{var Le=ze(),Fe=Oe(Le);{var Ze=Je=>{var It=ab(),Mt=Oe(It);const Se=he(()=>h(l).favorite?"material-symbols:favorite":"material-symbols:favorite-outline");Dt(Mt,{get name(){return h(Se)},onclick:te});var re=H(Mt,2);Dt(re,{name:"material-symbols:delete-outline-rounded",onclick:q});var ae=H(re,2);Dt(ae,{name:"material-symbols:edit-outline-rounded",onclick:W}),Q(Je,It)},He=Je=>{Dt(Je,{onclick:D,name:"material-symbols:done"})};pe(Fe,Je=>{h(l)&&h(l).id!==null&&h(i)?Je(Ze):Je(He,!1)})}Q(Ne,Le)},$$slots:{left:!0,right:!0}});var ee=H(ne,2);let V;var Z=P(ee);ft(Z,17,()=>h(c),ct,(fe,B)=>{var Ne=ze(),Le=Oe(Ne);{var Fe=Ze=>{var He=ze(),Je=Oe(He);{var It=Se=>{const re=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);dg(Se,{get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get value(){return h(re)}})},Mt=(Se,re)=>{{var ae=De=>{const Ce=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);Jm(De,{get label(){return h(B).label},get name(){return h(B).name},onchange:J,get placeholder(){return h(B).label},get readonly(){return h(i)},get value(){return h(Ce)}})},de=(De,Ce)=>{{var ot=gt=>{const bt=he(()=>h(B).hint===null?h(B).label:h(B).hint),At=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);nb(gt,{get icon(){return h(B).icon},get label(){return h(B).label},get name(){return h(B).name},onchange:J,get placeholder(){return h(bt)},get readonly(){return h(i)},get value(){return h(At)}})},Sn=(gt,bt)=>{{var At=Xe=>{const Wt=he(()=>h(B).hint===null?h(B).label:h(B).hint),Ht=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);Mm(Xe,{get icon(){return h(B).icon},get label(){return h(B).label},get name(){return h(B).name},onchange:J,get placeholder(){return h(Wt)},get readonly(){return h(i)},get suffix(){return h(B).suffix},get value(){return h(Ht)}})},qt=(Xe,Wt)=>{{var Ht=Ft=>{const Yt=he(()=>h(B).hint===null?h(B).label:h(B).hint),Gt=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);tg(Ft,{get icon(){return h(B).icon},get label(){return h(B).label},get name(){return h(B).name},onchange:J,get placeholder(){return h(Yt)},get readonly(){return h(i)},get suffix(){return h(B).suffix},get value(){return h(Gt)}})},pi=(Ft,Yt)=>{{var Gt=Ut=>{const Mn=he(()=>h(B).hint===null?h(B).label:h(B).hint),In=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);ob(Ut,{get icon(){return h(B).icon},get label(){return h(B).label},get name(){return h(B).name},onchange:J,get placeholder(){return h(Mn)},get readonly(){return h(i)},get suffix(){return h(B).options},get value(){return h(In)}})},Pr=(Ut,Mn)=>{{var In=Jt=>{const qn=he(()=>h(l)&&h(l).currency?h(l).currency:"USD"),Bt=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);Ig(Jt,{get currency(){return h(qn)},get label(){return h(B).label},get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get value(){return h(Bt)}})},dn=(Jt,qn)=>{{var Bt=Kt=>{const Qt=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);Nm(Kt,{get label(){return h(B).label},get name(){return h(B).name},onchange:J,get placeholder(){return h(B).label},get readonly(){return h(i)},get value(){return h(Qt)}})},Ee=(Kt,Qt)=>{{var Xn=tn=>{const $n=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);Mg(tn,{get label(){return h(B).label},get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get value(){return h($n)}})},_e=(tn,$n)=>{{var Tr=nn=>{const jr=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);Hm(nn,{get icon(){return h(B).icon},get items(){return h(B).options},get label(){return h(B).label},get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get value(){return h(jr)}})},yi=(nn,jr)=>{{var Eo=Pt=>{const Fn=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);zg(Pt,{get icon(){return h(B).icon},get items(){return h(B).options},get label(){return h(B).label},get name(){return h(B).name},onchange:J,get other(){return h(B).other},get readonly(){return h(i)},get value(){return h(Fn)}})},En=(Pt,Fn)=>{{var er=nt=>{const Dr=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);jg(nt,{get label(){return h(B).label},get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get spokes(){return h(B).options},get value(){return h(Dr)}})},et=(nt,Dr)=>{{var tr=Zt=>{const Rr=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);eb(Zt,{get icon(){return h(B).icon},get high(){return h(B).high},get label(){return h(B).label},get low(){return h(B).low},get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get value(){return h(Rr)}})},nr=(Zt,Rr)=>{{var rn=Et=>{const Cn=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);gg(Et,{get label(){return h(B).label},get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get value(){return h(Cn)},get xhigh(){return h(B).xhigh},get xlow(){return h(B).xlow},get yhigh(){return h(B).yhigh},get ylow(){return h(B).ylow}})},On=(Et,Cn)=>{{var Oo=zt=>{const mi=he(()=>h(l)&&h(l)[h(B).name]?h(l)[h(B).name]:null);$m(zt,{get name(){return h(B).name},onchange:J,get readonly(){return h(i)},get value(){return h(mi)}})};pe(Et,zt=>{h(B).kind==="notes"&&zt(Oo)},Cn)}};pe(Zt,Et=>{h(B).kind==="plot"?Et(rn):Et(On,!1)},Rr)}};pe(nt,Zt=>{h(B).kind==="slider"?Zt(tr):Zt(nr,!1)},Dr)}};pe(Pt,nt=>{h(B).kind==="profile"?nt(er):nt(et,!1)},Fn)}};pe(nn,Pt=>{h(B).kind==="radio"?Pt(Eo):Pt(En,!1)},jr)}};pe(tn,nn=>{h(B).kind==="meter"?nn(Tr):nn(yi,!1)},$n)}};pe(Kt,tn=>{h(B).kind==="rating"?tn(Xn):tn(_e,!1)},Qt)}};pe(Jt,Kt=>{h(B).kind==="date"?Kt(Bt):Kt(Ee,!1)},qn)}};pe(Ut,Jt=>{h(B).kind==="price"?Jt(In):Jt(dn,!1)},Mn)}};pe(Ft,Ut=>{h(B).kind==="units"?Ut(Gt):Ut(Pr,!1)},Yt)}};pe(Xe,Ft=>{h(B).kind==="number"?Ft(Ht):Ft(pi,!1)},Wt)}};pe(gt,Xe=>{h(B).kind==="decimal"?Xe(At):Xe(qt,!1)},bt)}};pe(De,gt=>{h(B).kind==="text"?gt(ot):gt(Sn,!1)},Ce)}};pe(Se,De=>{h(B).kind==="name"?De(ae):De(de,!1)},re)}};pe(Je,Se=>{h(B).kind==="photo"?Se(It):Se(Mt,!1)})}Q(Ze,He)};pe(Le,Ze=>{h(B).hidden||Ze(Fe)})}Q(fe,Ne)});var oe=H(Z,2);{var se=fe=>{var B=sb(),Ne=P(B);const Le=he(()=>h(l).latitude.toFixed(5)),Fe=he(()=>h(l).longitude.toFixed(5));en(Ne,{bottom:!1,icon:"material-symbols:my-location-outline-rounded",label:"Coordinates",top:!0,get value(){return`${h(Le)??""}, ${h(Fe)??""}`}}),E(B),Q(fe,B)};pe(oe,fe=>{h(i)&&h(l)&&h(l).latitude&&fe(se)})}var je=H(oe,2);{var Te=fe=>{var B=lb(),Ne=P(B);const Le=he(()=>h(l).condition),Fe=he(()=>h(l).temperature.toFixed(0));en(Ne,{bottom:!1,get icon(){return h(l).weather},label:"Weather",top:!0,get value(){return`${h(Le)??""}, ${h(Fe)??""}°F`}}),E(B),Q(fe,B)};pe(je,fe=>{h(i)&&h(l)&&h(l).weather&&fe(Te)})}return E(ee),st(ee,fe=>ke(r,fe),()=>h(r)),E(Y),st(Y,fe=>ke(a,fe),()=>h(a)),we(fe=>V=it(ee,1,"svelte-wtn90l",null,V,fe),[()=>({readonly:h(i)})]),Q(e,Y),Ge({hide:S,show:x})}var fb=(e,t,n)=>t.onchange(h(n).id),db=ce('<figcaption class="svelte-9ufrua"> </figcaption>'),vb=ce('<img alt="Thumbnail" height="64" width="100" class="svelte-9ufrua">'),hb=ce('<span class="svelte-9ufrua"><!></span>'),pb=ce('<li class="svelte-9ufrua"><button type="button" class="svelte-9ufrua"><figure class="svelte-9ufrua"><!> <!></figure> <div class="item svelte-9ufrua"><p class="created svelte-9ufrua"> </p> <div class="rating svelte-9ufrua"></div> <p class="name svelte-9ufrua"> </p></div></button></li>'),yb=ce('<ul class="svelte-9ufrua"></ul>'),mb=ce("<article><!></article>");function gb(e,t){Ye(t,!0);let n=be(t,"hidden",3,!1),r=be(t,"items",19,()=>[]);function i(m){return new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"numeric",year:"numeric"}).format(m)}function a(m){const g=m.replace(/\([^()]*\)/g,"").split(" ");let _="";for(let k=0;k<g.length;k++){const O=g[k].trim();if(O.length===0)continue;let C=O.charAt(0);if(O.indexOf("-")>-1){const S=O.split("-");for(let x=1;x<S.length;x++)C=C+S[x].charAt(0)}_=_+C}return _.toUpperCase()}var l=mb();let c;var d=P(l);{var v=m=>{var y=ze(),g=Oe(y);gn(g,()=>t.children),Q(m,y)},u=m=>{var y=yb();ft(y,21,r,ct,(g,_)=>{var k=pb(),O=P(k);O.__click=[fb,t,_];var C=P(O),S=P(C);{var x=V=>{var Z=db(),oe=P(Z,!0);E(Z),we(se=>Ie(oe,se),[()=>a(h(_).name)]),Q(V,Z)},A=V=>{var Z=vb();we(()=>Re(Z,"src",h(_).photos[0].data)),Q(V,Z)};pe(S,V=>{h(_).photos===null?V(x):V(A,!1)})}var q=H(S,2);{var D=V=>{var Z=hb(),oe=P(Z);Pe(oe,{height:"14",icon:"material-symbols:favorite",width:"14"}),E(Z),Q(V,Z)};pe(q,V=>{h(_).favorite&&V(D)})}E(C);var W=H(C,2),te=P(W),J=P(te,!0);E(te);var Y=H(te,2);ft(Y,20,()=>({length:5}),ct,(V,Z,oe)=>{const se=he(()=>oe<h(_).rating?"material-symbols:star":"material-symbols:star-outline");Pe(V,{color:"#161616",height:"16",get icon(){return h(se)},width:"16"})}),E(Y);var ne=H(Y,2),ee=P(ne,!0);E(ne),E(W),E(O),E(k),we(V=>{Ie(J,V),Ie(ee,h(_).name)},[()=>i(h(_).updated_at)]),Q(g,k)}),E(y),Q(m,y)};pe(d,m=>{r().length===0?m(v):m(u,!1)})}E(l),we(m=>c=it(l,1,"svelte-9ufrua",null,c,m),[()=>({hidden:n()})]),Q(e,l),Ge()}tt(["click"]);var bb=ce('<link rel="manifest" href="./manifest.json"> <meta name="theme-color">',1),_b=ce("<!> <!>",1),wb=ce("<!> <!> <!> <!>",1),kb=ce('<p class="svelte-cbft3s">Empty Timeline</p> <p class="svelte-cbft3s">Add a review to get started!</p>',1),xb=ce('<p class="svelte-cbft3s">Select a flavor to get started!</p> <button class="m3 svelte-cbft3s" type="button">Select a flavor</button>',1),Sb=ce('<div class="empty svelte-cbft3s"><!></div>'),Ib=ce('<div class="empty svelte-cbft3s"><p class="photos svelte-cbft3s">Empty Photos</p> <p class="photos svelte-cbft3s">There are no reviews with photos.</p></div>'),Eb=ce('<button class="fab svelte-cbft3s" type="button"><span class="svelte-cbft3s"><!></span></button>'),Ob=ce('<section class="svelte-cbft3s"><!> <!> <!> <!></section> <!> <!> <!>',1);function Kb(e,t){Ye(t,!0);let n,r,i,a=Ve(Yn({})),l=Ve(void 0),c=Ve(Yn([])),d=Ve(!1),v=Ve(Yn({id:crypto.randomUUID(),book:null})),u=Ve(1),m=he(()=>h(v).book),y=he(()=>{var re;return(re=h(l))==null?void 0:re.tastes.reduce((ae,de)=>(ae[de.singular]=de.primary,ae),{})}),g=he(()=>h(m)===null?null:h(l).tastes[h(m)]),_=he(()=>h(c).reduce((re,ae)=>{if(ae.photos!==null)for(let de=0;de<ae.photos.length;de++)re.push({id:ae.id,created_at:new Date(ae.created_at.getTime()),data:ae.photos[de].data,favorite:ae.favorite});return re},[])),k=he(()=>h(c).reduce((re,ae)=>(ae.latitude!==null&&re.push({id:ae.id,color:h(y)[ae.type],latitude:ae.latitude,longitude:ae.longitude}),re),[])),O=he(()=>h(d)?h(c).length===0?"There are no matching reviews":h(c).length===1?`There is ${h(c).length} matching review`:`There are ${h(c).length} matching reviews`:h(m)===null?`You have made ${h(c).length} ${h(c).length===1?"review":"reviews"}`:h(c).length===0?"There are no reviews for this flavor":`You have made ${h(c).length} ${h(g).singular.toLowerCase()} ${h(c).length===1?"review":"reviews"}`),C=he(()=>h(g)===null?"#5fb2ff":h(g).primary);const S=new _s;po(()=>{fetch("/flavors.json").then(re=>re.json()).then(re=>{const ae=re.tastes.filter(de=>de.active);ae.sort((de,De)=>de.singular>De.singular?1:de.singular<De.singular?-1:0),re.tastes=[...ae],ke(l,re,!0),S.readSettings().then(de=>de!==null?(ke(v,de,!0),h(g)===null?S.browseReview():S.browseReview(h(g).singular)):S.browseReview()).then(de=>(ke(c,[...de],!0),S.countReview())).then(de=>{ke(a,de,!0)})})}),Ir(()=>{h(g)?(document.documentElement.style.setProperty("--primary-accent-color",h(g).primary),document.documentElement.style.setProperty("--secondary-accent-color",h(g).secondary)):(document.documentElement.style.setProperty("--primary-accent-color","#5fb2ff"),document.documentElement.style.setProperty("--secondary-accent-color","#003f7f"))});function x(){console.log("SHOW ACCOUNT: "+S.userId),n.show()}function A(){S.userId==="unauthorized"?S.countReviews().then(re=>{re>=3?confirm("Create an account to continue?")&&n.show():r.show()}):r.show()}function q(re){ke(c,[],!0),re===null?(h(v).book=null,S.updateSettings(h(v)),S.browseReview().then(ae=>ke(c,[...ae],!0))):(h(v).book=h(l).tastes.findIndex(ae=>ae.id===re),S.updateSettings(h(v)),S.browseReview(h(g).singular).then(ae=>ke(c,[...ae],!0))),i.hide()}function D(re){r.show(re)}function W(re){r.show(re)}function te(){S.browseReview(h(g).singular).then(re=>ke(c,[...re],!0)),S.countReview().then(re=>ke(a,re,!0))}function J(){ke(d,!1),S.browseReview(h(g)?h(g).singular:null).then(re=>ke(c,[...re],!0))}function Y(re){re===null?S.browseReview(h(g)?h(g).singular:null).then(ae=>ke(c,[...ae],!0)):S.browseReview(h(g)?h(g).singular:null,re).then(ae=>ke(c,[...ae],!0))}function ne(re){re.preventDefault(),ke(d,!0)}function ee(re){r.show(re)}var V=Ob();Ou(re=>{var ae=bb(),de=H(Oe(ae),2);we(()=>Re(de,"content",h(C))),Q(re,ae)});var Z=Oe(V),oe=P(Z);const se=he(()=>h(g)?h(g).phrase:"Flavor Awesome"),je=he(()=>h(d)?"search":null);ns(oe,{get label(){return h(se)},oncancel:J,onchange:Y,get subtitle(){return h(O)},get variation(){return h(je)},left:de=>{Dt(de,{name:"material-symbols:menu",onclick:()=>i.show()})},right:de=>{var De=_b(),Ce=Oe(De);Dt(Ce,{name:"material-symbols:search",onclick:ne});var ot=H(Ce,2);Dt(ot,{name:"material-symbols:account-circle",onclick:x}),Q(de,De)},$$slots:{left:!0,right:!0}});var Te=H(oe,2);hm(Te,{children:(re,ae)=>{var de=wb(),De=Oe(de);const Ce=he(()=>h(u)===0);Wi(De,{get active(){return h(Ce)},icon:"material-symbols:book-ribbon-outline-rounded",onclick:()=>ke(u,0)});var ot=H(De,2);const Sn=he(()=>h(u)===1);Wi(ot,{get active(){return h(Sn)},onclick:()=>ke(u,1),label:"Timeline"});var gt=H(ot,2);const bt=he(()=>h(u)===2);Wi(gt,{get active(){return h(bt)},label:"Photos",onclick:()=>ke(u,2)});var At=H(gt,2);const qt=he(()=>h(u)===3);Wi(At,{get active(){return h(qt)},label:"Map",onclick:()=>ke(u,3)}),Q(re,de)}});var fe=H(Te,2);{var B=re=>{const ae=he(()=>h(u)!==0);nm(re,{get flavor(){return h(g)},get hidden(){return h(ae)},get items(){return h(c)}})},Ne=(re,ae)=>{{var de=Ce=>{gb(Ce,{get items(){return h(c)},onchange:ee,children:(ot,Sn)=>{var gt=Sb(),bt=P(gt);{var At=Xe=>{var Wt=kb();xt(2),Q(Xe,Wt)},qt=Xe=>{var Wt=xb(),Ht=H(Oe(Wt),2);Ht.__click=()=>i.show(),Q(Xe,Wt)};pe(bt,Xe=>{h(g)?Xe(At):Xe(qt,!1)})}E(gt),Q(ot,gt)},$$slots:{default:!0}})},De=(Ce,ot)=>{{var Sn=bt=>{xm(bt,{get items(){return h(_)},onchange:W,children:(At,qt)=>{var Xe=Ib();Q(At,Xe)},$$slots:{default:!0}})},gt=(bt,At)=>{{var qt=Xe=>{dm(Xe,{get items(){return h(k)},onchange:D})};pe(bt,Xe=>{h(u)===3&&Xe(qt)},At)}};pe(Ce,bt=>{h(u)===2?bt(Sn):bt(gt,!1)},ot)}};pe(re,Ce=>{h(u)===1?Ce(de):Ce(De,!1)},ae)}};pe(fe,re=>{h(u)===0?re(B):re(Ne,!1)})}var Le=H(fe,2);{var Fe=re=>{var ae=Eb();ae.__click=A;var de=P(ae),De=P(de);Pe(De,{height:"24",icon:"material-symbols:add",width:"24"}),E(de),E(ae),Q(re,ae)};pe(Le,re=>{h(g)&&re(Fe)})}E(Z);var Ze=H(Z,2);const He=he(()=>h(l)&&h(l).tastes?h(l).tastes:null),Je=he(()=>h(g)?h(g).id:null);st(um(Ze,{get count(){return h(a)},get items(){return h(He)},onchange:q,get selected(){return h(Je)}}),re=>i=re,()=>i);var It=H(Ze,2);const Mt=he(()=>h(g)?h(g):null);st(cb(It,{get flavor(){return h(Mt)},onchange:te}),re=>r=re,()=>r);var Se=H(It,2);st(Yy(Se,{onchange:te}),re=>n=re,()=>n),Q(e,V),Ge()}tt(["click"]);export{Kb as component};
