var Uf=Object.defineProperty;var Zs=e=>{throw TypeError(e)};var Bf=(e,t,n)=>t in e?Uf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Xs=(e,t,n)=>Bf(e,typeof t!="symbol"?t+"":t,n),na=(e,t,n)=>t.has(e)||Zs("Cannot "+n);var yn=(e,t,n)=>(na(e,t,"read from private field"),n?n.call(e):t.get(e)),Hr=(e,t,n)=>t.has(e)?Zs("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ra=(e,t,n,r)=>(na(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),$s=(e,t,n)=>(na(e,t,"access private method"),n);import{b as el,e as Kf,c as Ve,a as Q,n as xt,t as se,f as zf,d as tl}from"../chunks/cdGFuxSi.js";import{aa as gu,ao as bu,ap as Vf,q as _u,a8 as Wf,h as gt,s as ti,N as ur,M as Hf,b as Yf,aq as wu,i as wa,z as v,y as Jn,j as Gf,r as nl,k as ni,c as Hn,af as Jf,m as ku,a as xu,p as Qf,ar as ia,ai as Su,t as Zf,Q as ka,as as Za,at as rl,au as Xa,J as Xf,av as il,aw as $f,ax as ed,a4 as td,ay as nd,d as rd,az as id,ac as Iu,$ as me,aA as od,ag as ad,ae as sd,o as Eu,aB as ld,aC as ud,aD as cd,aE as fd,aF as dd,aG as vd,g as Ou,_ as He,u as Or,f as Ce,a0 as Ye,al as ze,C as ke,aH as hd,a1 as P,a2 as O,an as fe,n as Cr,a3 as V,aI as Pt,B as mr,aJ as gr}from"../chunks/CQLj4S8w.js";import{a as pd,i as yd,c as md,d as $e,b as gd,n as bd,e as _d,l as wd,s as Ee,f as br,r as $a,g as Cu,j as kd}from"../chunks/B-1q1L0N.js";import{i as ve,r as xd,p as be,b as it}from"../chunks/Bk-iJvHD.js";import{o as di,a as Sd}from"../chunks/DCszb5e3.js";import{s as bn}from"../chunks/DYqKEzBy.js";const Id=[];function oa(e,t=!1){return Hi(e,new Map,"",Id)}function Hi(e,t,n,r,i=null){if(typeof e=="object"&&e!==null){var a=t.get(e);if(a!==void 0)return a;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(gu(e)){var l=Array(e.length);t.set(e,l),i!==null&&t.set(i,l);for(var c=0;c<e.length;c+=1){var d=e[c];c in e&&(l[c]=Hi(d,t,n,r))}return l}if(bu(e)===Vf){l={},t.set(e,l),i!==null&&t.set(i,l);for(var h in e)l[h]=Hi(e[h],t,n,r);return l}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return Hi(e.toJSON(),t,n,r,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function Yn(e,t){gt&&ti(ur(e)),_u(()=>{var n=t();for(var r in n){var i=n[r];i?e.style.setProperty(r,i):e.style.removeProperty(r)}}),Wf(()=>{e.remove()})}function ct(e,t){return t}function Ed(e,t,n,r){for(var i=[],a=t.length,l=0;l<a;l++)ed(t[l].e,i,!0);var c=a>0&&i.length===0&&n!==null;if(c){var d=n.parentNode;td(d),d.append(n),r.clear(),jn(e,t[0].prev,t[a-1].next)}nd(i,()=>{for(var h=0;h<a;h++){var u=t[h];c||(r.delete(u.k),jn(e,u.prev,u.next)),rd(u.e,!c)}})}function ft(e,t,n,r,i,a=null){var l=e,c={flags:t,items:new Map,first:null},d=(t&wu)!==0;if(d){var h=e;l=gt?ti(ur(h)):h.appendChild(Hf())}gt&&wa();var u=null,m=!1,y=Jn(()=>{var g=n();return gu(g)?g:g==null?[]:Su(g)});Yf(()=>{var g=v(y),_=g.length;if(m&&_===0)return;m=_===0;let k=!1;if(gt){var E=l.data===Gf;E!==(_===0)&&(l=nl(),ti(l),ni(!1),k=!0)}if(gt){for(var A=null,S,x=0;x<_;x++){if(Hn.nodeType===8&&Hn.data===Jf){l=Hn,k=!0,ni(!1);break}var C=g[x],D=r(C,x);S=Au(Hn,c,A,null,C,D,x,i,t,n),c.items.set(D,S),A=S}_>0&&ti(nl())}gt||Od(g,c,l,i,t,r,n),a!==null&&(_===0?u?ku(u):u=xu(()=>a(l)):u!==null&&Qf(u,()=>{u=null})),k&&ni(!0),v(y)}),gt&&(l=Hn)}function Od(e,t,n,r,i,a,l){var $,oe,ce,De;var c=(i&$f)!==0,d=(i&(Za|Xa))!==0,h=e.length,u=t.items,m=t.first,y=m,g,_=null,k,E=[],A=[],S,x,C,D;if(c)for(D=0;D<h;D+=1)S=e[D],x=a(S,D),C=u.get(x),C!==void 0&&(($=C.a)==null||$.measure(),(k??(k=new Set)).add(C));for(D=0;D<h;D+=1){if(S=e[D],x=a(S,D),C=u.get(x),C===void 0){var R=y?y.e.nodes_start:n;_=Au(R,t,_,_===null?t.first:_.next,S,x,D,r,i,l),u.set(x,_),E=[],A=[],y=_.next;continue}if(d&&Cd(C,S,D,i),(C.e.f&ia)!==0&&(ku(C.e),c&&((oe=C.a)==null||oe.unfix(),(k??(k=new Set)).delete(C))),C!==y){if(g!==void 0&&g.has(C)){if(E.length<A.length){var W=A[0],Z;_=W.prev;var G=E[0],Y=E[E.length-1];for(Z=0;Z<E.length;Z+=1)ol(E[Z],W,n);for(Z=0;Z<A.length;Z+=1)g.delete(A[Z]);jn(t,G.prev,Y.next),jn(t,_,G),jn(t,Y,W),y=W,_=Y,D-=1,E=[],A=[]}else g.delete(C),ol(C,y,n),jn(t,C.prev,C.next),jn(t,C,_===null?t.first:_.next),jn(t,_,C),_=C;continue}for(E=[],A=[];y!==null&&y.k!==x;)(y.e.f&ia)===0&&(g??(g=new Set)).add(y),A.push(y),y=y.next;if(y===null)continue;C=y}E.push(C),_=C,y=C.next}if(y!==null||g!==void 0){for(var ne=g===void 0?[]:Su(g);y!==null;)(y.e.f&ia)===0&&ne.push(y),y=y.next;var te=ne.length;if(te>0){var H=(i&wu)!==0&&h===0?n:null;if(c){for(D=0;D<te;D+=1)(ce=ne[D].a)==null||ce.measure();for(D=0;D<te;D+=1)(De=ne[D].a)==null||De.fix()}Ed(t,ne,H,u)}}c&&Zf(()=>{var Re;if(k!==void 0)for(C of k)(Re=C.a)==null||Re.apply()}),ka.first=t.first&&t.first.e,ka.last=_&&_.e}function Cd(e,t,n,r){(r&Za)!==0&&rl(e.v,t),(r&Xa)!==0?rl(e.i,n):e.i=n}function Au(e,t,n,r,i,a,l,c,d,h){var u=(d&Za)!==0,m=(d&id)===0,y=u?m?Xf(i):il(i):i,g=(d&Xa)===0?l:il(l),_={i:g,v:y,k:a,a:null,e:null,prev:n,next:r};try{return _.e=xu(()=>c(e,y,g,h),gt),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function ol(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==r;){var l=Iu(a);i.before(a),a=l}}function jn(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Ad(e,t,n=!1,r=!1,i=!1){var a=e,l="";me(()=>{var c=ka;if(l===(l=t()??"")){gt&&wa();return}if(c.nodes_start!==null&&(od(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),l!==""){if(gt){Hn.data;for(var d=wa(),h=d;d!==null&&(d.nodeType!==8||d.data!=="");)h=d,d=Iu(d);if(d===null)throw ad(),sd;el(Hn,h),a=ti(d);return}var u=l+"";n?u=`<svg>${u}</svg>`:r&&(u=`<math>${u}</math>`);var m=Kf(u);if((n||r)&&(m=ur(m)),el(ur(m),m.lastChild),n||r)for(;ur(m);)a.before(ur(m));else a.before(m)}})}function Pu(e,t){Eu(()=>{const n=t();return n&&n(e)})}function Tu(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Tu(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Pd(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Tu(e))&&(r&&(r+=" "),r+=t);return r}function Td(e){return typeof e=="object"?Pd(e):e??""}const al=[...` 	
\r\f \v\uFEFF`];function jd(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var a=i.length,l=0;(l=r.indexOf(i,l))>=0;){var c=l+a;(l===0||al.includes(r[l-1]))&&(c===r.length||al.includes(r[c]))?r=(l===0?"":r.substring(0,l))+r.substring(c+1):l=c}}return r===""?null:r}function sl(e,t=!1){var n=t?" !important;":";",r="";for(var i in e){var a=e[i];a!=null&&a!==""&&(r+=" "+i+": "+a+n)}return r}function aa(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function Dd(e,t){if(t){var n="",r,i;if(Array.isArray(t)?(r=t[0],i=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,l=0,c=!1,d=[];r&&d.push(...Object.keys(r).map(aa)),i&&d.push(...Object.keys(i).map(aa));var h=0,u=-1;const k=e.length;for(var m=0;m<k;m++){var y=e[m];if(c?y==="/"&&e[m-1]==="*"&&(c=!1):a?a===y&&(a=!1):y==="/"&&e[m+1]==="*"?c=!0:y==='"'||y==="'"?a=y:y==="("?l++:y===")"&&l--,!c&&a===!1&&l===0){if(y===":"&&u===-1)u=m;else if(y===";"||m===k-1){if(u!==-1){var g=aa(e.substring(h,u).trim());if(!d.includes(g)){y!==";"&&m++;var _=e.substring(h,m).trim();n+=" "+_+";"}}h=m+1,u=-1}}}}return r&&(n+=sl(r)),i&&(n+=sl(i,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function ot(e,t,n,r,i,a){var l=e.__className;if(gt||l!==n||l===void 0){var c=jd(n,r,a);(!gt||c!==e.getAttribute("class"))&&(c==null?e.removeAttribute("class"):t?e.className=c:e.setAttribute("class",c)),e.__className=n}else if(a&&i!==a)for(var d in a){var h=!!a[d];(i==null||h!==!!i[d])&&e.classList.toggle(d,h)}return a}function sa(e,t={},n,r){for(var i in n){var a=n[i];t[i]!==a&&(n[i]==null?e.style.removeProperty(i):e.style.setProperty(i,a,r))}}function Gn(e,t,n,r){var i=e.__style;if(gt||i!==t){var a=Dd(t,r);(!gt||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}else r&&(Array.isArray(r)?(sa(e,n==null?void 0:n[0],r[0]),sa(e,n==null?void 0:n[1],r[1],"important")):sa(e,n,r));return r}const Yr=Symbol("class"),Gr=Symbol("style"),ju=Symbol("is custom element"),Du=Symbol("is html");function Ru(e){if(gt){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var r=e.value;je(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var i=e.checked;je(e,"checked",null),e.checked=i}}};e.__on_r=n,ld(n),pd()}}function Rd(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function je(e,t,n,r){var i=Nu(e);gt&&(i[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||i[t]!==(i[t]=n)&&(t==="loading"&&(e[ud]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Lu(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function xa(e,t,n,r,i=!1){var a=Nu(e),l=a[ju],c=!a[Du];let d=gt&&l;d&&ni(!1);var h=t||{},u=e.tagName==="OPTION";for(var m in t)m in n||(n[m]=null);n.class?n.class=Td(n.class):(r||n[Yr])&&(n.class=null),n[Gr]&&(n.style??(n.style=null));var y=Lu(e);for(const x in n){let C=n[x];if(u&&x==="value"&&C==null){e.value=e.__value="",h[x]=C;continue}if(x==="class"){var g=e.namespaceURI==="http://www.w3.org/1999/xhtml";ot(e,g,C,r,t==null?void 0:t[Yr],n[Yr]),h[x]=C,h[Yr]=n[Yr];continue}if(x==="style"){Gn(e,C,t==null?void 0:t[Gr],n[Gr]),h[x]=C,h[Gr]=n[Gr];continue}var _=h[x];if(C!==_){h[x]=C;var k=x[0]+x[1];if(k!=="$$")if(k==="on"){const D={},R="$$"+x;let W=x.slice(2);var E=_d(W);if(yd(W)&&(W=W.slice(0,-7),D.capture=!0),!E&&_){if(C!=null)continue;e.removeEventListener(W,h[R],D),h[R]=null}if(C!=null)if(E)e[`__${W}`]=C,$e([W]);else{let Z=function(G){h[x].call(this,G)};h[R]=md(W,e,Z,D)}else E&&(e[`__${W}`]=void 0)}else if(x==="style")je(e,x,C);else if(x==="autofocus")gd(e,!!C);else if(!l&&(x==="__value"||x==="value"&&C!=null))e.value=e.__value=C;else if(x==="selected"&&u)Rd(e,C);else{var A=x;c||(A=bd(A));var S=A==="defaultValue"||A==="defaultChecked";if(C==null&&!l&&!S)if(a[x]=null,A==="value"||A==="checked"){let D=e;const R=t===void 0;if(A==="value"){let W=D.defaultValue;D.removeAttribute(A),D.defaultValue=W,D.value=D.__value=R?W:null}else{let W=D.defaultChecked;D.removeAttribute(A),D.defaultChecked=W,D.checked=R?W:!1}}else e.removeAttribute(x);else S||y.includes(A)&&(l||typeof C!="string")?e[A]=C:typeof C!="function"&&je(e,A,C)}}}d&&ni(!0);for(let x of Object.getOwnPropertySymbols(n))x.description===dd&&Pu(e,()=>n[x]);return h}function Nu(e){return e.__attributes??(e.__attributes={[ju]:e.nodeName.includes("-"),[Du]:e.namespaceURI===cd})}var ll=new Map;function Lu(e){var t=ll.get(e.nodeName);if(t)return t;ll.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=fd(r);for(var a in n)n[a].set&&t.push(a);r=bu(r)}return t}function es(e,t,n=t){var r=vd();wd(e,"input",i=>{var a=i?e.defaultValue:e.value;if(a=la(e)?ua(a):a,n(a),r&&a!==(a=t())){var l=e.selectionStart,c=e.selectionEnd;e.value=a??"",c!==null&&(e.selectionStart=l,e.selectionEnd=Math.min(c,e.value.length))}}),(gt&&e.defaultValue!==e.value||Ou(t)==null&&e.value)&&n(la(e)?ua(e.value):e.value),_u(()=>{var i=t();la(e)&&i===ua(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function la(e){var t=e.type;return t==="number"||t==="range"}function ua(e){return e===""?null:+e}var Dn,yr,fi,vo,Mu;const ho=class ho{constructor(t){Hr(this,vo);Hr(this,Dn,new WeakMap);Hr(this,yr);Hr(this,fi);ra(this,fi,t)}observe(t,n){var r=yn(this,Dn).get(t)||new Set;return r.add(n),yn(this,Dn).set(t,r),$s(this,vo,Mu).call(this).observe(t,yn(this,fi)),()=>{var i=yn(this,Dn).get(t);i.delete(n),i.size===0&&(yn(this,Dn).delete(t),yn(this,yr).unobserve(t))}}};Dn=new WeakMap,yr=new WeakMap,fi=new WeakMap,vo=new WeakSet,Mu=function(){return yn(this,yr)??ra(this,yr,new ResizeObserver(t=>{for(var n of t){ho.entries.set(n.target,n);for(var r of yn(this,Dn).get(n.target)||[])r(n)}}))},Xs(ho,"entries",new WeakMap);let Sa=ho;var Nd=new Sa({box:"border-box"});function Ld(e,t,n){var r=Nd.observe(e,()=>n(e[t]));Eu(()=>(Ou(()=>n(e[t])),r))}const qu=/^[a-z0-9]+(-[a-z0-9]+)*$/,po=(e,t,n,r="")=>{const i=e.split(":");if(e.slice(0,1)==="@"){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const c=i.pop(),d=i.pop(),h={provider:i.length>0?i[0]:r,prefix:d,name:c};return t&&!Yi(h)?null:h}const a=i[0],l=a.split("-");if(l.length>1){const c={provider:r,prefix:l.shift(),name:l.join("-")};return t&&!Yi(c)?null:c}if(n&&r===""){const c={provider:r,prefix:"",name:a};return t&&!Yi(c,n)?null:c}return null},Yi=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1,Fu=Object.freeze({left:0,top:0,width:16,height:16}),to=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),yo=Object.freeze({...Fu,...to}),Ia=Object.freeze({...yo,body:"",hidden:!1});function Md(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function ul(e,t){const n=Md(e,t);for(const r in Ia)r in to?r in e&&!(r in n)&&(n[r]=to[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function qd(e,t){const n=e.icons,r=e.aliases||Object.create(null),i=Object.create(null);function a(l){if(n[l])return i[l]=[];if(!(l in i)){i[l]=null;const c=r[l]&&r[l].parent,d=c&&a(c);d&&(i[l]=[c].concat(d))}return i[l]}return Object.keys(n).concat(Object.keys(r)).forEach(a),i}function Fd(e,t,n){const r=e.icons,i=e.aliases||Object.create(null);let a={};function l(c){a=ul(r[c]||i[c],a)}return l(t),n.forEach(l),ul(e,a)}function Uu(e,t){const n=[];if(typeof e!="object"||typeof e.icons!="object")return n;e.not_found instanceof Array&&e.not_found.forEach(i=>{t(i,null),n.push(i)});const r=qd(e);for(const i in r){const a=r[i];a&&(t(i,Fd(e,i,a)),n.push(i))}return n}const Ud={provider:"",aliases:{},not_found:{},...Fu};function ca(e,t){for(const n in t)if(n in e&&typeof e[n]!=typeof t[n])return!1;return!0}function Bu(e){if(typeof e!="object"||e===null)return null;const t=e;if(typeof t.prefix!="string"||!e.icons||typeof e.icons!="object"||!ca(e,Ud))return null;const n=t.icons;for(const i in n){const a=n[i];if(!i||typeof a.body!="string"||!ca(a,Ia))return null}const r=t.aliases||Object.create(null);for(const i in r){const a=r[i],l=a.parent;if(!i||typeof l!="string"||!n[l]&&!r[l]||!ca(a,Ia))return null}return t}const cl=Object.create(null);function Bd(e,t){return{provider:e,prefix:t,icons:Object.create(null),missing:new Set}}function _r(e,t){const n=cl[e]||(cl[e]=Object.create(null));return n[t]||(n[t]=Bd(e,t))}function Ku(e,t){return Bu(t)?Uu(t,(n,r)=>{r?e.icons[n]=r:e.missing.add(n)}):[]}function Kd(e,t,n){try{if(typeof n.body=="string")return e.icons[t]={...n},!0}catch{}return!1}let si=!1;function zu(e){return typeof e=="boolean"&&(si=e),si}function zd(e){const t=typeof e=="string"?po(e,!0,si):e;if(t){const n=_r(t.provider,t.prefix),r=t.name;return n.icons[r]||(n.missing.has(r)?null:void 0)}}function Vd(e,t){const n=po(e,!0,si);if(!n)return!1;const r=_r(n.provider,n.prefix);return t?Kd(r,n.name,t):(r.missing.add(n.name),!0)}function Wd(e,t){if(typeof e!="object")return!1;if(typeof t!="string"&&(t=e.provider||""),si&&!t&&!e.prefix){let i=!1;return Bu(e)&&(e.prefix="",Uu(e,(a,l)=>{Vd(a,l)&&(i=!0)})),i}const n=e.prefix;if(!Yi({prefix:n,name:"a"}))return!1;const r=_r(t,n);return!!Ku(r,e)}const Vu=Object.freeze({width:null,height:null}),Wu=Object.freeze({...Vu,...to}),Hd=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Yd=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function fl(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(Hd);if(r===null||!r.length)return e;const i=[];let a=r.shift(),l=Yd.test(a);for(;;){if(l){const c=parseFloat(a);isNaN(c)?i.push(a):i.push(Math.ceil(c*t*n)/n)}else i.push(a);if(a=r.shift(),a===void 0)return i.join("");l=!l}}function Gd(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const i=e.indexOf(">",r),a=e.indexOf("</"+t);if(i===-1||a===-1)break;const l=e.indexOf(">",a);if(l===-1)break;n+=e.slice(i+1,a).trim(),e=e.slice(0,r).trim()+e.slice(l+1)}return{defs:n,content:e}}function Jd(e,t){return e?"<defs>"+e+"</defs>"+t:t}function Qd(e,t,n){const r=Gd(e);return Jd(r.defs,t+r.content+n)}const Zd=e=>e==="unset"||e==="undefined"||e==="none";function Xd(e,t){const n={...yo,...e},r={...Wu,...t},i={left:n.left,top:n.top,width:n.width,height:n.height};let a=n.body;[n,r].forEach(k=>{const E=[],A=k.hFlip,S=k.vFlip;let x=k.rotate;A?S?x+=2:(E.push("translate("+(i.width+i.left).toString()+" "+(0-i.top).toString()+")"),E.push("scale(-1 1)"),i.top=i.left=0):S&&(E.push("translate("+(0-i.left).toString()+" "+(i.height+i.top).toString()+")"),E.push("scale(1 -1)"),i.top=i.left=0);let C;switch(x<0&&(x-=Math.floor(x/4)*4),x=x%4,x){case 1:C=i.height/2+i.top,E.unshift("rotate(90 "+C.toString()+" "+C.toString()+")");break;case 2:E.unshift("rotate(180 "+(i.width/2+i.left).toString()+" "+(i.height/2+i.top).toString()+")");break;case 3:C=i.width/2+i.left,E.unshift("rotate(-90 "+C.toString()+" "+C.toString()+")");break}x%2===1&&(i.left!==i.top&&(C=i.left,i.left=i.top,i.top=C),i.width!==i.height&&(C=i.width,i.width=i.height,i.height=C)),E.length&&(a=Qd(a,'<g transform="'+E.join(" ")+'">',"</g>"))});const l=r.width,c=r.height,d=i.width,h=i.height;let u,m;l===null?(m=c===null?"1em":c==="auto"?h:c,u=fl(m,d/h)):(u=l==="auto"?d:l,m=c===null?fl(u,h/d):c==="auto"?h:c);const y={},g=(k,E)=>{Zd(E)||(y[k]=E.toString())};g("width",u),g("height",m);const _=[i.left,i.top,d,h];return y.viewBox=_.join(" "),{attributes:y,viewBox:_,body:a}}const $d=/\sid="(\S+)"/g,ev="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let tv=0;function nv(e,t=ev){const n=[];let r;for(;r=$d.exec(e);)n.push(r[1]);if(!n.length)return e;const i="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(a=>{const l=typeof t=="function"?t(a):t+(tv++).toString(),c=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+c+')([")]|\\.[a-z])',"g"),"$1"+l+i+"$3")}),e=e.replace(new RegExp(i,"g"),""),e}const Ea=Object.create(null);function rv(e,t){Ea[e]=t}function Oa(e){return Ea[e]||Ea[""]}function ts(e){let t;if(typeof e.resources=="string")t=[e.resources];else if(t=e.resources,!(t instanceof Array)||!t.length)return null;return{resources:t,path:e.path||"/",maxURL:e.maxURL||500,rotate:e.rotate||750,timeout:e.timeout||5e3,random:e.random===!0,index:e.index||0,dataAfterTimeout:e.dataAfterTimeout!==!1}}const ns=Object.create(null),Jr=["https://api.simplesvg.com","https://api.unisvg.com"],Gi=[];for(;Jr.length>0;)Jr.length===1||Math.random()>.5?Gi.push(Jr.shift()):Gi.push(Jr.pop());ns[""]=ts({resources:["https://api.iconify.design"].concat(Gi)});function iv(e,t){const n=ts(t);return n===null?!1:(ns[e]=n,!0)}function rs(e){return ns[e]}const ov=()=>{let e;try{if(e=fetch,typeof e=="function")return e}catch{}};let dl=ov();function av(e,t){const n=rs(e);if(!n)return 0;let r;if(!n.maxURL)r=0;else{let i=0;n.resources.forEach(l=>{i=Math.max(i,l.length)});const a=t+".json?icons=";r=n.maxURL-i-n.path.length-a.length}return r}function sv(e){return e===404}const lv=(e,t,n)=>{const r=[],i=av(e,t),a="icons";let l={type:a,provider:e,prefix:t,icons:[]},c=0;return n.forEach((d,h)=>{c+=d.length+1,c>=i&&h>0&&(r.push(l),l={type:a,provider:e,prefix:t,icons:[]},c=d.length),l.icons.push(d)}),r.push(l),r};function uv(e){if(typeof e=="string"){const t=rs(e);if(t)return t.path}return"/"}const cv=(e,t,n)=>{if(!dl){n("abort",424);return}let r=uv(t.provider);switch(t.type){case"icons":{const a=t.prefix,c=t.icons.join(","),d=new URLSearchParams({icons:c});r+=a+".json?"+d.toString();break}case"custom":{const a=t.uri;r+=a.slice(0,1)==="/"?a.slice(1):a;break}default:n("abort",400);return}let i=503;dl(e+r).then(a=>{const l=a.status;if(l!==200){setTimeout(()=>{n(sv(l)?"abort":"next",l)});return}return i=501,a.json()}).then(a=>{if(typeof a!="object"||a===null){setTimeout(()=>{a===404?n("abort",a):n("next",i)});return}setTimeout(()=>{n("success",a)})}).catch(()=>{n("next",i)})},fv={prepare:lv,send:cv};function dv(e){const t={loaded:[],missing:[],pending:[]},n=Object.create(null);e.sort((i,a)=>i.provider!==a.provider?i.provider.localeCompare(a.provider):i.prefix!==a.prefix?i.prefix.localeCompare(a.prefix):i.name.localeCompare(a.name));let r={provider:"",prefix:"",name:""};return e.forEach(i=>{if(r.name===i.name&&r.prefix===i.prefix&&r.provider===i.provider)return;r=i;const a=i.provider,l=i.prefix,c=i.name,d=n[a]||(n[a]=Object.create(null)),h=d[l]||(d[l]=_r(a,l));let u;c in h.icons?u=t.loaded:l===""||h.missing.has(c)?u=t.missing:u=t.pending;const m={provider:a,prefix:l,name:c};u.push(m)}),t}function Hu(e,t){e.forEach(n=>{const r=n.loaderCallbacks;r&&(n.loaderCallbacks=r.filter(i=>i.id!==t))})}function vv(e){e.pendingCallbacksFlag||(e.pendingCallbacksFlag=!0,setTimeout(()=>{e.pendingCallbacksFlag=!1;const t=e.loaderCallbacks?e.loaderCallbacks.slice(0):[];if(!t.length)return;let n=!1;const r=e.provider,i=e.prefix;t.forEach(a=>{const l=a.icons,c=l.pending.length;l.pending=l.pending.filter(d=>{if(d.prefix!==i)return!0;const h=d.name;if(e.icons[h])l.loaded.push({provider:r,prefix:i,name:h});else if(e.missing.has(h))l.missing.push({provider:r,prefix:i,name:h});else return n=!0,!0;return!1}),l.pending.length!==c&&(n||Hu([e],a.id),a.callback(l.loaded.slice(0),l.missing.slice(0),l.pending.slice(0),a.abort))})}))}let hv=0;function pv(e,t,n){const r=hv++,i=Hu.bind(null,n,r);if(!t.pending.length)return i;const a={id:r,icons:t,callback:e,abort:i};return n.forEach(l=>{(l.loaderCallbacks||(l.loaderCallbacks=[])).push(a)}),i}function yv(e,t=!0,n=!1){const r=[];return e.forEach(i=>{const a=typeof i=="string"?po(i,t,n):i;a&&r.push(a)}),r}var mv={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function gv(e,t,n,r){const i=e.resources.length,a=e.random?Math.floor(Math.random()*i):e.index;let l;if(e.random){let R=e.resources.slice(0);for(l=[];R.length>1;){const W=Math.floor(Math.random()*R.length);l.push(R[W]),R=R.slice(0,W).concat(R.slice(W+1))}l=l.concat(R)}else l=e.resources.slice(a).concat(e.resources.slice(0,a));const c=Date.now();let d="pending",h=0,u,m=null,y=[],g=[];typeof r=="function"&&g.push(r);function _(){m&&(clearTimeout(m),m=null)}function k(){d==="pending"&&(d="aborted"),_(),y.forEach(R=>{R.status==="pending"&&(R.status="aborted")}),y=[]}function E(R,W){W&&(g=[]),typeof R=="function"&&g.push(R)}function A(){return{startTime:c,payload:t,status:d,queriesSent:h,queriesPending:y.length,subscribe:E,abort:k}}function S(){d="failed",g.forEach(R=>{R(void 0,u)})}function x(){y.forEach(R=>{R.status==="pending"&&(R.status="aborted")}),y=[]}function C(R,W,Z){const G=W!=="success";switch(y=y.filter(Y=>Y!==R),d){case"pending":break;case"failed":if(G||!e.dataAfterTimeout)return;break;default:return}if(W==="abort"){u=Z,S();return}if(G){u=Z,y.length||(l.length?D():S());return}if(_(),x(),!e.random){const Y=e.resources.indexOf(R.resource);Y!==-1&&Y!==e.index&&(e.index=Y)}d="completed",g.forEach(Y=>{Y(Z)})}function D(){if(d!=="pending")return;_();const R=l.shift();if(R===void 0){if(y.length){m=setTimeout(()=>{_(),d==="pending"&&(x(),S())},e.timeout);return}S();return}const W={status:"pending",resource:R,callback:(Z,G)=>{C(W,Z,G)}};y.push(W),h++,m=setTimeout(D,e.rotate),n(R,t,W.callback)}return setTimeout(D),A}function Yu(e){const t={...mv,...e};let n=[];function r(){n=n.filter(c=>c().status==="pending")}function i(c,d,h){const u=gv(t,c,d,(m,y)=>{r(),h&&h(m,y)});return n.push(u),u}function a(c){return n.find(d=>c(d))||null}return{query:i,find:a,setIndex:c=>{t.index=c},getIndex:()=>t.index,cleanup:r}}function vl(){}const fa=Object.create(null);function bv(e){if(!fa[e]){const t=rs(e);if(!t)return;const n=Yu(t),r={config:t,redundancy:n};fa[e]=r}return fa[e]}function _v(e,t,n){let r,i;if(typeof e=="string"){const a=Oa(e);if(!a)return n(void 0,424),vl;i=a.send;const l=bv(e);l&&(r=l.redundancy)}else{const a=ts(e);if(a){r=Yu(a);const l=e.resources?e.resources[0]:"",c=Oa(l);c&&(i=c.send)}}return!r||!i?(n(void 0,424),vl):r.query(t,i,n)().abort}function hl(){}function wv(e){e.iconsLoaderFlag||(e.iconsLoaderFlag=!0,setTimeout(()=>{e.iconsLoaderFlag=!1,vv(e)}))}function kv(e){const t=[],n=[];return e.forEach(r=>{(r.match(qu)?t:n).push(r)}),{valid:t,invalid:n}}function Qr(e,t,n){function r(){const i=e.pendingIcons;t.forEach(a=>{i&&i.delete(a),e.icons[a]||e.missing.add(a)})}if(n&&typeof n=="object")try{if(!Ku(e,n).length){r();return}}catch(i){console.error(i)}r(),wv(e)}function pl(e,t){e instanceof Promise?e.then(n=>{t(n)}).catch(()=>{t(null)}):t(e)}function xv(e,t){e.iconsToLoad?e.iconsToLoad=e.iconsToLoad.concat(t).sort():e.iconsToLoad=t,e.iconsQueueFlag||(e.iconsQueueFlag=!0,setTimeout(()=>{e.iconsQueueFlag=!1;const{provider:n,prefix:r}=e,i=e.iconsToLoad;if(delete e.iconsToLoad,!i||!i.length)return;const a=e.loadIcon;if(e.loadIcons&&(i.length>1||!a)){pl(e.loadIcons(i,r,n),u=>{Qr(e,i,u)});return}if(a){i.forEach(u=>{const m=a(u,r,n);pl(m,y=>{const g=y?{prefix:r,icons:{[u]:y}}:null;Qr(e,[u],g)})});return}const{valid:l,invalid:c}=kv(i);if(c.length&&Qr(e,c,null),!l.length)return;const d=r.match(qu)?Oa(n):null;if(!d){Qr(e,l,null);return}d.prepare(n,r,l).forEach(u=>{_v(n,u,m=>{Qr(e,u.icons,m)})})}))}const Sv=(e,t)=>{const n=yv(e,!0,zu()),r=dv(n);if(!r.pending.length){let d=!0;return t&&setTimeout(()=>{d&&t(r.loaded,r.missing,r.pending,hl)}),()=>{d=!1}}const i=Object.create(null),a=[];let l,c;return r.pending.forEach(d=>{const{provider:h,prefix:u}=d;if(u===c&&h===l)return;l=h,c=u,a.push(_r(h,u));const m=i[h]||(i[h]=Object.create(null));m[u]||(m[u]=[])}),r.pending.forEach(d=>{const{provider:h,prefix:u,name:m}=d,y=_r(h,u),g=y.pendingIcons||(y.pendingIcons=new Set);g.has(m)||(g.add(m),i[h][u].push(m))}),a.forEach(d=>{const h=i[d.provider][d.prefix];h.length&&xv(d,h)}),t?pv(t,r,a):hl};function Iv(e,t){const n={...e};for(const r in t){const i=t[r],a=typeof i;r in Vu?(i===null||i&&(a==="string"||a==="number"))&&(n[r]=i):a===typeof n[r]&&(n[r]=r==="rotate"?i%4:i)}return n}const Ev=/[\s,]+/;function Ov(e,t){t.split(Ev).forEach(n=>{switch(n.trim()){case"horizontal":e.hFlip=!0;break;case"vertical":e.vFlip=!0;break}})}function Cv(e,t=0){const n=e.replace(/^-?[0-9.]*/,"");function r(i){for(;i<0;)i+=4;return i%4}if(n===""){const i=parseInt(e);return isNaN(i)?0:r(i)}else if(n!==e){let i=0;switch(n){case"%":i=25;break;case"deg":i=90}if(i){let a=parseFloat(e.slice(0,e.length-n.length));return isNaN(a)?0:(a=a/i,a%1===0?r(a):0)}}return t}function Av(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}function Pv(e){return e.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function Tv(e){return"data:image/svg+xml,"+Pv(e)}function jv(e){return'url("'+Tv(e)+'")'}const yl={...Wu,inline:!1},Dv={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Rv={display:"inline-block"},Ca={"background-color":"currentColor"},Gu={"background-color":"transparent"},ml={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},gl={"-webkit-mask":Ca,mask:Ca,background:Gu};for(const e in gl){const t=gl[e];for(const n in ml)t[e+"-"+n]=ml[n]}function Nv(e){return e+(e.match(/^[-0-9.]+$/)?"px":"")}function Lv(e,t){const n=Iv(yl,t),r=t.mode||"svg",i=r==="svg"?{...Dv}:{};e.body.indexOf("xlink:")===-1&&delete i["xmlns:xlink"];let a=typeof t.style=="string"?t.style:"";for(let A in t){const S=t[A];if(S!==void 0)switch(A){case"icon":case"style":case"onLoad":case"mode":case"ssr":break;case"inline":case"hFlip":case"vFlip":n[A]=S===!0||S==="true"||S===1;break;case"flip":typeof S=="string"&&Ov(n,S);break;case"color":a=a+(a.length>0&&a.trim().slice(-1)!==";"?";":"")+"color: "+S+"; ";break;case"rotate":typeof S=="string"?n[A]=Cv(S):typeof S=="number"&&(n[A]=S);break;case"ariaHidden":case"aria-hidden":S!==!0&&S!=="true"&&delete i["aria-hidden"];break;default:if(A.slice(0,3)==="on:")break;yl[A]===void 0&&(i[A]=S)}}const l=Xd(e,n),c=l.attributes;if(n.inline&&(a="vertical-align: -0.125em; "+a),r==="svg"){Object.assign(i,c),a!==""&&(i.style=a);let A=0,S=t.id;return typeof S=="string"&&(S=S.replace(/-/g,"_")),{svg:!0,attributes:i,body:nv(l.body,S?()=>S+"ID"+A++:"iconifySvelte")}}const{body:d,width:h,height:u}=e,m=r==="mask"||(r==="bg"?!1:d.indexOf("currentColor")!==-1),y=Av(d,{...c,width:h+"",height:u+""}),_={"--svg":jv(y)},k=A=>{const S=c[A];S&&(_[A]=Nv(S))};k("width"),k("height"),Object.assign(_,Rv,m?Ca:Gu);let E="";for(const A in _)E+=A+": "+_[A]+";";return i.style=E+a,{svg:!1,attributes:i}}zu(!0);rv("",fv);if(typeof document<"u"&&typeof window<"u"){const e=window;if(e.IconifyPreload!==void 0){const t=e.IconifyPreload,n="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!Wd(r))&&console.error(n)}catch{console.error(n)}})}if(e.IconifyProviders!==void 0){const t=e.IconifyProviders;if(typeof t=="object"&&t!==null)for(let n in t){const r="IconifyProviders["+n+"] is invalid.";try{const i=t[n];if(typeof i!="object"||!i||i.resources===void 0)continue;iv(n,i)||console.error(r)}catch{console.error(r)}}}}function Mv(e,t,n,r,i){function a(){t.loading&&(t.loading.abort(),t.loading=null)}if(typeof e=="object"&&e!==null&&typeof e.body=="string")return t.name="",a(),{data:{...yo,...e}};let l;if(typeof e!="string"||(l=po(e,!1,!0))===null)return a(),null;const c=zd(l);if(!c)return n&&(!t.loading||t.loading.name!==e)&&(a(),t.name="",t.loading={name:e,abort:Sv([l],r)}),null;a(),t.name!==e&&(t.name=e,i&&!t.destroyed&&i(e));const d=["iconify"];return l.prefix!==""&&d.push("iconify--"+l.prefix),l.provider!==""&&d.push("iconify--"+l.provider),{data:c,classes:d}}function qv(e,t){return e?Lv({...yo,...e},t):null}var Fv=xt("<svg><!></svg>"),Uv=se("<span></span>");function Te(e,t){He(t,!0);const n={name:"",loading:null,destroyed:!1},r=xd(t,["$$slots","$$events","$$legacy"]);let i=ze(!1),a=ze(0),l=ze(null);Or(()=>{v(a);const m=!!t.ssr||v(i),y=Mv(t.icon,n,m,c,t.onload),g=y?qv(y.data,r):null;g&&y.classes&&(g.attributes.class=(typeof r.class=="string"?r.class+" ":"")+y.classes.join(" ")),ke(l,g,!0)});function c(){hd(a)}di(()=>{ke(i,!0)}),Sd(()=>{n.destroyed=!0,n.loading&&(n.loading.abort(),n.loading=null)});var d=Ve(),h=Ce(d);{var u=m=>{var y=Ve(),g=Ce(y);{var _=E=>{var A=Fv();let S;var x=P(A);Ad(x,()=>v(l).body,!0),O(A),me(()=>S=xa(A,S,{...v(l).attributes})),Q(E,A)},k=E=>{var A=Uv();let S;me(()=>S=xa(A,S,{...v(l).attributes})),Q(E,A)};ve(g,E=>{v(l).svg?E(_):E(k,!1)})}Q(m,y)};ve(h,m=>{v(l)&&m(u)})}Q(e,d),Ye()}var Bv=se('<button type="button" class="svelte-ltxfh7"><!></button>');function Lt(e,t){let n=be(t,"size",3,"md"),r=fe(()=>{let d=40;switch(n()){case"sm":d=32;break;case"xl":d=56;break;case"2xl":d=96;break;default:d=136;break}return d}),i=fe(()=>{let d=24;switch(n()){case"sm":d=20;break;case"xl":d=32;break;case"2xl":d=40;break;default:d=24;break}return d});var a=Bv();a.__click=function(...d){var h;(h=t.onclick)==null||h.apply(this,d)};let l;var c=P(a);Te(c,{get height(){return v(i)},get icon(){return t.name},get width(){return v(i)}}),O(a),me(()=>l=Gn(a,"",l,{height:v(r),width:v(r)})),Q(e,a)}$e(["click"]);function Kv(e,t,n,r){e.preventDefault(),ke(t,null),v(n).focus(),r.onchange&&r.onchange(v(t))}function zv(e,t,n){const r=v(t).trim().length===0?null:v(t).trim().toLowerCase();n.onchange&&n.onchange(r)}var Vv=se('<!> <h3 class="svelte-1ereg2t"> </h3> <!>',1),Wv=se('<button tabindex="-1" type="button" class="svelte-1ereg2t"><!></button>'),Hv=se('<p class="svelte-1ereg2t"> </p>'),Yv=se('<div class="search svelte-1ereg2t"><!> <label class="svelte-1ereg2t"><span class="svelte-1ereg2t"><!></span> <input type="text" class="svelte-1ereg2t"> <!></label></div> <h3 class="svelte-1ereg2t"> </h3> <!>',1),Gv=se('<p class="svelte-1ereg2t"> </p>'),Jv=se('<div class="svelte-1ereg2t"><div class="svelte-1ereg2t"><!></div> <div class="svelte-1ereg2t"><!></div></div> <h3 class="svelte-1ereg2t"> </h3> <!>',1),Qv=se("<header><!></header>");function is(e,t){He(t,!0);let n=ze(void 0),r=ze(null);function i(m){ke(r,null),m.focus()}function a(){t.oncancel&&t.oncancel()}var l=Qv();let c;var d=P(l);{var h=m=>{var y=Vv(),g=Ce(y);bn(g,()=>t.left??Cr);var _=V(g,2),k=P(_,!0);O(_);var E=V(_,2);bn(E,()=>t.right),me(()=>Ee(k,t.label)),Q(m,y)},u=(m,y)=>{{var g=k=>{var E=Yv(),A=Ce(E),S=P(A);Lt(S,{name:"material-symbols:arrow-back-rounded",onclick:a});var x=V(S,2),C=P(x),D=P(C);Te(D,{height:"24",icon:"material-symbols:search-rounded",width:"24"}),O(C);var R=V(C,2);Ru(R),R.__input=[zv,r,t],Pu(R,()=>i),it(R,H=>ke(n,H),()=>v(n));var W=V(R,2);{var Z=H=>{var $=Wv();$.__click=[Kv,r,n,t];var oe=P($);Te(oe,{height:"24",icon:"material-symbols:cancel-outline",width:"24"}),O($),Q(H,$)};ve(W,H=>{v(r)!==null&&H(Z)})}O(x),O(A);var G=V(A,2),Y=P(G,!0);O(G);var ne=V(G,2);{var te=H=>{var $=Hv(),oe=P($,!0);O($),me(()=>Ee(oe,t.subtitle)),Q(H,$)};ve(ne,H=>{t.subtitle&&H(te)})}me(()=>Ee(Y,t.label)),es(R,()=>v(r),H=>ke(r,H)),Q(k,E)},_=k=>{var E=Jv(),A=Ce(E),S=P(A),x=P(S);bn(x,()=>t.left),O(S);var C=V(S,2),D=P(C);bn(D,()=>t.right),O(C),O(A);var R=V(A,2),W=P(R,!0);O(R);var Z=V(R,2);{var G=Y=>{var ne=Gv(),te=P(ne,!0);O(ne),me(()=>Ee(te,t.subtitle)),Q(Y,ne)};ve(Z,Y=>{t.subtitle&&Y(G)})}me(()=>Ee(W,t.label)),Q(k,E)};ve(m,k=>{t.variation==="search"?k(g):k(_,!1)},y)}};ve(d,m=>{t.variation==="sm"?m(h):m(u,!1)})}O(l),me(m=>c=ot(l,1,"svelte-1ereg2t",null,c,m),[()=>({small:t.variation==="sm"})]),Q(e,l),Ye()}$e(["input","click"]);var Zv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ji={exports:{}},$v=Ji.exports,bl;function eh(){return bl||(bl=1,function(e,t){(function(n,r){e.exports=r()})($v,function(){var n=function(o,s){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var b in p)Object.prototype.hasOwnProperty.call(p,b)&&(f[b]=p[b])})(o,s)},r=function(){return(r=Object.assign||function(o){for(var s,f=1,p=arguments.length;f<p;f++)for(var b in s=arguments[f])Object.prototype.hasOwnProperty.call(s,b)&&(o[b]=s[b]);return o}).apply(this,arguments)};function i(o,s,f){for(var p,b=0,w=s.length;b<w;b++)!p&&b in s||((p=p||Array.prototype.slice.call(s,0,b))[b]=s[b]);return o.concat(p||Array.prototype.slice.call(s))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Zv,l=Object.keys,c=Array.isArray;function d(o,s){return typeof s!="object"||l(s).forEach(function(f){o[f]=s[f]}),o}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var h=Object.getPrototypeOf,u={}.hasOwnProperty;function m(o,s){return u.call(o,s)}function y(o,s){typeof s=="function"&&(s=s(h(o))),(typeof Reflect>"u"?l:Reflect.ownKeys)(s).forEach(function(f){_(o,f,s[f])})}var g=Object.defineProperty;function _(o,s,f,p){g(o,s,d(f&&m(f,"get")&&typeof f.get=="function"?{get:f.get,set:f.set,configurable:!0}:{value:f,configurable:!0,writable:!0},p))}function k(o){return{from:function(s){return o.prototype=Object.create(s.prototype),_(o.prototype,"constructor",o),{extend:y.bind(null,o.prototype)}}}}var E=Object.getOwnPropertyDescriptor,A=[].slice;function S(o,s,f){return A.call(o,s,f)}function x(o,s){return s(o)}function C(o){if(!o)throw new Error("Assertion Failed")}function D(o){a.setImmediate?setImmediate(o):setTimeout(o,0)}function R(o,s){if(typeof s=="string"&&m(o,s))return o[s];if(!s)return o;if(typeof s!="string"){for(var f=[],p=0,b=s.length;p<b;++p){var w=R(o,s[p]);f.push(w)}return f}var I=s.indexOf(".");if(I!==-1){var T=o[s.substr(0,I)];return T==null?void 0:R(T,s.substr(I+1))}}function W(o,s,f){if(o&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof s!="string"&&"length"in s){C(typeof f!="string"&&"length"in f);for(var p=0,b=s.length;p<b;++p)W(o,s[p],f[p])}else{var w,I,T=s.indexOf(".");T!==-1?(w=s.substr(0,T),(I=s.substr(T+1))===""?f===void 0?c(o)&&!isNaN(parseInt(w))?o.splice(w,1):delete o[w]:o[w]=f:W(T=!(T=o[w])||!m(o,w)?o[w]={}:T,I,f)):f===void 0?c(o)&&!isNaN(parseInt(s))?o.splice(s,1):delete o[s]:o[s]=f}}function Z(o){var s,f={};for(s in o)m(o,s)&&(f[s]=o[s]);return f}var G=[].concat;function Y(o){return G.apply([],o)}var Gt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Y([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(s){return s+o+"Array"})}))).filter(function(o){return a[o]}),ne=new Set(Gt.map(function(o){return a[o]})),te=null;function H(o){return te=new WeakMap,o=function s(f){if(!f||typeof f!="object")return f;var p=te.get(f);if(p)return p;if(c(f)){p=[],te.set(f,p);for(var b=0,w=f.length;b<w;++b)p.push(s(f[b]))}else if(ne.has(f.constructor))p=f;else{var I,T=h(f);for(I in p=T===Object.prototype?{}:Object.create(T),te.set(f,p),f)m(f,I)&&(p[I]=s(f[I]))}return p}(o),te=null,o}var $={}.toString;function oe(o){return $.call(o).slice(8,-1)}var ce=typeof Symbol<"u"?Symbol.iterator:"@@iterator",De=typeof ce=="symbol"?function(o){var s;return o!=null&&(s=o[ce])&&s.apply(o)}:function(){return null};function Re(o,s){return s=o.indexOf(s),0<=s&&o.splice(s,1),0<=s}var he={};function B(o){var s,f,p,b;if(arguments.length===1){if(c(o))return o.slice();if(this===he&&typeof o=="string")return[o];if(b=De(o)){for(f=[];!(p=b.next()).done;)f.push(p.value);return f}if(o==null)return[o];if(typeof(s=o.length)!="number")return[o];for(f=new Array(s);s--;)f[s]=o[s];return f}for(s=arguments.length,f=new Array(s);s--;)f[s]=arguments[s];return f}var Ne=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Kt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Yt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Kt),Ue={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function qe(o,s){this.name=o,this.message=s}function Ze(o,s){return o+". Errors: "+Object.keys(s).map(function(f){return s[f].toString()}).filter(function(f,p,b){return b.indexOf(f)===p}).join(`
`)}function Ge(o,s,f,p){this.failures=s,this.failedKeys=p,this.successCount=f,this.message=Ze(o,s)}function Je(o,s){this.name="BulkError",this.failures=Object.keys(s).map(function(f){return s[f]}),this.failuresByPos=s,this.message=Ze(o,this.failures)}k(qe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),k(Ge).from(qe),k(Je).from(qe);var St=Yt.reduce(function(o,s){return o[s]=s+"Error",o},{}),Ut=qe,Se=Yt.reduce(function(o,s){var f=s+"Error";function p(b,w){this.name=f,b?typeof b=="string"?(this.message="".concat(b).concat(w?`
 `+w:""),this.inner=w||null):typeof b=="object"&&(this.message="".concat(b.name," ").concat(b.message),this.inner=b):(this.message=Ue[s]||f,this.inner=null)}return k(p).from(Ut),o[s]=p,o},{});Se.Syntax=SyntaxError,Se.Type=TypeError,Se.Range=RangeError;var Ie=Kt.reduce(function(o,s){return o[s+"Error"]=Se[s],o},{}),ie=Yt.reduce(function(o,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(o[s+"Error"]=Se[s]),o},{});function ae(){}function we(o){return o}function Ae(o,s){return o==null||o===we?s:function(f){return s(o(f))}}function et(o,s){return function(){o.apply(this,arguments),s.apply(this,arguments)}}function Bt(o,s){return o===ae?s:function(){var f=o.apply(this,arguments);f!==void 0&&(arguments[0]=f);var p=this.onsuccess,b=this.onerror;this.onsuccess=null,this.onerror=null;var w=s.apply(this,arguments);return p&&(this.onsuccess=this.onsuccess?et(p,this.onsuccess):p),b&&(this.onerror=this.onerror?et(b,this.onerror):b),w!==void 0?w:f}}function Tt(o,s){return o===ae?s:function(){o.apply(this,arguments);var f=this.onsuccess,p=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),f&&(this.onsuccess=this.onsuccess?et(f,this.onsuccess):f),p&&(this.onerror=this.onerror?et(p,this.onerror):p)}}function Ct(o,s){return o===ae?s:function(f){var p=o.apply(this,arguments);d(f,p);var b=this.onsuccess,w=this.onerror;return this.onsuccess=null,this.onerror=null,f=s.apply(this,arguments),b&&(this.onsuccess=this.onsuccess?et(b,this.onsuccess):b),w&&(this.onerror=this.onerror?et(w,this.onerror):w),p===void 0?f===void 0?void 0:f:d(p,f)}}function bt(o,s){return o===ae?s:function(){return s.apply(this,arguments)!==!1&&o.apply(this,arguments)}}function jt(o,s){return o===ae?s:function(){var f=o.apply(this,arguments);if(f&&typeof f.then=="function"){for(var p=this,b=arguments.length,w=new Array(b);b--;)w[b]=arguments[b];return f.then(function(){return s.apply(p,w)})}return s.apply(this,arguments)}}ie.ModifyError=Ge,ie.DexieError=qe,ie.BulkError=Je;var at=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function vt(o){at=o}var At={},Xn=100,Gt=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,h(o),o];var s=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[s,h(s),o]}(),Kt=Gt[0],Yt=Gt[1],Gt=Gt[2],Yt=Yt&&Yt.then,Jt=Kt&&Kt.constructor,jr=!!Gt,zt=function(o,s){Wt.push([o,s]),In&&(queueMicrotask(Eo),In=!1)},Mn=!0,In=!0,vn=[],Qt=[],qn=we,Vt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ae,pgp:!1,env:{},finalize:ae},Oe=Vt,Wt=[],Zt=0,$n=[];function _e(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Oe;if(typeof o!="function"){if(o!==At)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Dr(this,this._value))}this._state=null,this._value=null,++s.ref,function f(p,b){try{b(function(w){if(p._state===null){if(w===p)throw new TypeError("A promise cannot be resolved with itself.");var I=p._lib&&En();w&&typeof w.then=="function"?f(p,function(T,N){w instanceof _e?w._then(T,N):w.then(T,N)}):(p._state=!0,p._value=w,mi(p)),I&&Dt()}},Dr.bind(null,p))}catch(w){Dr(p,w)}}(this,o)}var nn={get:function(){var o=Oe,s=Xt;function f(p,b){var w=this,I=!o.global&&(o!==Oe||s!==Xt),T=I&&!It(),N=new _e(function(M,U){rn(w,new er(xs(p,o,I,T),xs(b,o,I,T),M,U,o))});return this._consoleTask&&(N._consoleTask=this._consoleTask),N}return f.prototype=At,f},set:function(o){_(this,"then",o&&o.prototype===At?nn:{get:function(){return o},set:nn.set})}};function er(o,s,f,p,b){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof s=="function"?s:null,this.resolve=f,this.reject=p,this.psd=b}function Dr(o,s){var f,p;Qt.push(s),o._state===null&&(f=o._lib&&En(),s=qn(s),o._state=!1,o._value=s,p=o,vn.some(function(b){return b._value===p._value})||vn.push(p),mi(o),f&&Dt())}function mi(o){var s=o._listeners;o._listeners=[];for(var f=0,p=s.length;f<p;++f)rn(o,s[f]);var b=o._PSD;--b.ref||b.finalize(),Zt===0&&(++Zt,zt(function(){--Zt==0&&Fn()},[]))}function rn(o,s){if(o._state!==null){var f=o._state?s.onFulfilled:s.onRejected;if(f===null)return(o._state?s.resolve:s.reject)(o._value);++s.psd.ref,++Zt,zt(Rr,[f,o,s])}else o._listeners.push(s)}function Rr(o,s,f){try{var p,b=s._value;!s._state&&Qt.length&&(Qt=[]),p=at&&s._consoleTask?s._consoleTask.run(function(){return o(b)}):o(b),s._state||Qt.indexOf(b)!==-1||function(w){for(var I=vn.length;I;)if(vn[--I]._value===w._value)return vn.splice(I,1)}(s),f.resolve(p)}catch(w){f.reject(w)}finally{--Zt==0&&Fn(),--f.psd.ref||f.psd.finalize()}}function Eo(){Un(Vt,function(){En()&&Dt()})}function En(){var o=Mn;return In=Mn=!1,o}function Dt(){var o,s,f;do for(;0<Wt.length;)for(o=Wt,Wt=[],f=o.length,s=0;s<f;++s){var p=o[s];p[0].apply(null,p[1])}while(0<Wt.length);In=Mn=!0}function Fn(){var o=vn;vn=[],o.forEach(function(p){p._PSD.onunhandled.call(null,p._value,p)});for(var s=$n.slice(0),f=s.length;f;)s[--f]()}function tr(o){return new _e(At,!1,o)}function tt(o,s){var f=Oe;return function(){var p=En(),b=Oe;try{return Ht(f,!0),o.apply(this,arguments)}catch(w){s&&s(w)}finally{Ht(b,!1),p&&Dt()}}}y(_e.prototype,{then:nn,_then:function(o,s){rn(this,new er(null,null,o,s,Oe))},catch:function(o){if(arguments.length===1)return this.then(null,o);var s=o,f=arguments[1];return typeof s=="function"?this.then(null,function(p){return(p instanceof s?f:tr)(p)}):this.then(null,function(p){return(p&&p.name===s?f:tr)(p)})},finally:function(o){return this.then(function(s){return _e.resolve(o()).then(function(){return s})},function(s){return _e.resolve(o()).then(function(){return tr(s)})})},timeout:function(o,s){var f=this;return o<1/0?new _e(function(p,b){var w=setTimeout(function(){return b(new Se.Timeout(s))},o);f.then(p,b).finally(clearTimeout.bind(null,w))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&_(_e.prototype,Symbol.toStringTag,"Dexie.Promise"),Vt.env=gi(),y(_e,{all:function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s,f){o.length===0&&s([]);var p=o.length;o.forEach(function(b,w){return _e.resolve(b).then(function(I){o[w]=I,--p||s(o)},f)})})},resolve:function(o){return o instanceof _e?o:o&&typeof o.then=="function"?new _e(function(s,f){o.then(s,f)}):new _e(At,!0,o)},reject:tr,race:function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s,f){o.map(function(p){return _e.resolve(p).then(s,f)})})},PSD:{get:function(){return Oe},set:function(o){return Oe=o}},totalEchoes:{get:function(){return Xt}},newPSD:on,usePSD:Un,scheduler:{get:function(){return zt},set:function(o){zt=o}},rejectionMapper:{get:function(){return qn},set:function(o){qn=o}},follow:function(o,s){return new _e(function(f,p){return on(function(b,w){var I=Oe;I.unhandleds=[],I.onunhandled=w,I.finalize=et(function(){var T,N=this;T=function(){N.unhandleds.length===0?b():w(N.unhandleds[0])},$n.push(function M(){T(),$n.splice($n.indexOf(M),1)}),++Zt,zt(function(){--Zt==0&&Fn()},[])},I.finalize),o()},s,f,p)})}}),Jt&&(Jt.allSettled&&_(_e,"allSettled",function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s){o.length===0&&s([]);var f=o.length,p=new Array(f);o.forEach(function(b,w){return _e.resolve(b).then(function(I){return p[w]={status:"fulfilled",value:I}},function(I){return p[w]={status:"rejected",reason:I}}).then(function(){return--f||s(p)})})})}),Jt.any&&typeof AggregateError<"u"&&_(_e,"any",function(){var o=B.apply(null,arguments).map(Cn);return new _e(function(s,f){o.length===0&&f(new AggregateError([]));var p=o.length,b=new Array(p);o.forEach(function(w,I){return _e.resolve(w).then(function(T){return s(T)},function(T){b[I]=T,--p||f(new AggregateError(b))})})})}),Jt.withResolvers&&(_e.withResolvers=Jt.withResolvers));var nt={awaits:0,echoes:0,id:0},Nr=0,nr=[],rr=0,Xt=0,Lr=0;function on(o,s,f,p){var b=Oe,w=Object.create(b);return w.parent=b,w.ref=0,w.global=!1,w.id=++Lr,Vt.env,w.env=jr?{Promise:_e,PromiseProp:{value:_e,configurable:!0,writable:!0},all:_e.all,race:_e.race,allSettled:_e.allSettled,any:_e.any,resolve:_e.resolve,reject:_e.reject}:{},s&&d(w,s),++b.ref,w.finalize=function(){--this.parent.ref||this.parent.finalize()},p=Un(w,o,f,p),w.ref===0&&w.finalize(),p}function On(){return nt.id||(nt.id=++Nr),++nt.awaits,nt.echoes+=Xn,nt.id}function It(){return!!nt.awaits&&(--nt.awaits==0&&(nt.id=0),nt.echoes=nt.awaits*Xn,!0)}function Cn(o){return nt.echoes&&o&&o.constructor===Jt?(On(),o.then(function(s){return It(),s},function(s){return It(),lt(s)})):o}function Oo(){var o=nr[nr.length-1];nr.pop(),Ht(o,!1)}function Ht(o,s){var f,p=Oe;(s?!nt.echoes||rr++&&o===Oe:!rr||--rr&&o===Oe)||queueMicrotask(s?(function(b){++Xt,nt.echoes&&--nt.echoes!=0||(nt.echoes=nt.awaits=nt.id=0),nr.push(Oe),Ht(b,!0)}).bind(null,o):Oo),o!==Oe&&(Oe=o,p===Vt&&(Vt.env=gi()),jr&&(f=Vt.env.Promise,s=o.env,(p.global||o.global)&&(Object.defineProperty(a,"Promise",s.PromiseProp),f.all=s.all,f.race=s.race,f.resolve=s.resolve,f.reject=s.reject,s.allSettled&&(f.allSettled=s.allSettled),s.any&&(f.any=s.any))))}function gi(){var o=a.Promise;return jr?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function Un(o,s,f,p,b){var w=Oe;try{return Ht(o,!0),s(f,p,b)}finally{Ht(w,!1)}}function xs(o,s,f,p){return typeof o!="function"?o:function(){var b=Oe;f&&On(),Ht(s,!0);try{return o.apply(this,arguments)}finally{Ht(b,!1),p&&queueMicrotask(It)}}}function Co(o){Promise===Jt&&nt.echoes===0?rr===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}(""+Yt).indexOf("[native code]")===-1&&(On=It=ae);var lt=_e.reject,Bn="￿",hn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ss="String expected.",ir=[],bi="__dbnames",Ao="readonly",Po="readwrite";function Kn(o,s){return o?s?function(){return o.apply(this,arguments)&&s.apply(this,arguments)}:o:s}var Is={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function _i(o){return typeof o!="string"||/\./.test(o)?function(s){return s}:function(s){return s[o]===void 0&&o in s&&delete(s=H(s))[o],s}}function Es(){throw Se.Type()}function We(o,s){try{var f=Os(o),p=Os(s);if(f!==p)return f==="Array"?1:p==="Array"?-1:f==="binary"?1:p==="binary"?-1:f==="string"?1:p==="string"?-1:f==="Date"?1:p!=="Date"?NaN:-1;switch(f){case"number":case"Date":case"string":return s<o?1:o<s?-1:0;case"binary":return function(b,w){for(var I=b.length,T=w.length,N=I<T?I:T,M=0;M<N;++M)if(b[M]!==w[M])return b[M]<w[M]?-1:1;return I===T?0:I<T?-1:1}(Cs(o),Cs(s));case"Array":return function(b,w){for(var I=b.length,T=w.length,N=I<T?I:T,M=0;M<N;++M){var U=We(b[M],w[M]);if(U!==0)return U}return I===T?0:I<T?-1:1}(o,s)}}catch{}return NaN}function Os(o){var s=typeof o;return s!="object"?s:ArrayBuffer.isView(o)?"binary":(o=oe(o),o==="ArrayBuffer"?"binary":o)}function Cs(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var As=(rt.prototype._trans=function(o,s,f){var p=this._tx||Oe.trans,b=this.name,w=at&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(o==="readonly"?"read":"write"," ").concat(this.name));function I(M,U,j){if(!j.schema[b])throw new Se.NotFound("Table "+b+" not part of transaction");return s(j.idbtrans,j)}var T=En();try{var N=p&&p.db._novip===this.db._novip?p===Oe.trans?p._promise(o,I,f):on(function(){return p._promise(o,I,f)},{trans:p,transless:Oe.transless||Oe}):function M(U,j,z,L){if(U.idbdb&&(U._state.openComplete||Oe.letThrough||U._vip)){var F=U._createTransaction(j,z,U._dbSchema);try{F.create(),U._state.PR1398_maxLoop=3}catch(K){return K.name===St.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return M(U,j,z,L)})):lt(K)}return F._promise(j,function(K,q){return on(function(){return Oe.trans=F,L(K,q,F)})}).then(function(K){if(j==="readwrite")try{F.idbtrans.commit()}catch{}return j==="readonly"?K:F._completion.then(function(){return K})})}if(U._state.openComplete)return lt(new Se.DatabaseClosed(U._state.dbOpenError));if(!U._state.isBeingOpened){if(!U._state.autoOpen)return lt(new Se.DatabaseClosed);U.open().catch(ae)}return U._state.dbReadyPromise.then(function(){return M(U,j,z,L)})}(this.db,o,[this.name],I);return w&&(N._consoleTask=w,N=N.catch(function(M){return console.trace(M),lt(M)})),N}finally{T&&Dt()}},rt.prototype.get=function(o,s){var f=this;return o&&o.constructor===Object?this.where(o).first(s):o==null?lt(new Se.Type("Invalid argument to Table.get()")):this._trans("readonly",function(p){return f.core.get({trans:p,key:o}).then(function(b){return f.hook.reading.fire(b)})}).then(s)},rt.prototype.where=function(o){if(typeof o=="string")return new this.db.WhereClause(this,o);if(c(o))return new this.db.WhereClause(this,"[".concat(o.join("+"),"]"));var s=l(o);if(s.length===1)return this.where(s[0]).equals(o[s[0]]);var f=this.schema.indexes.concat(this.schema.primKey).filter(function(T){if(T.compound&&s.every(function(M){return 0<=T.keyPath.indexOf(M)})){for(var N=0;N<s.length;++N)if(s.indexOf(T.keyPath[N])===-1)return!1;return!0}return!1}).sort(function(T,N){return T.keyPath.length-N.keyPath.length})[0];if(f&&this.db._maxKey!==Bn){var w=f.keyPath.slice(0,s.length);return this.where(w).equals(w.map(function(N){return o[N]}))}!f&&at&&console.warn("The query ".concat(JSON.stringify(o)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var p=this.schema.idxByName;function b(T,N){return We(T,N)===0}var I=s.reduce(function(j,N){var M=j[0],U=j[1],j=p[N],z=o[N];return[M||j,M||!j?Kn(U,j&&j.multi?function(L){return L=R(L,N),c(L)&&L.some(function(F){return b(z,F)})}:function(L){return b(z,R(L,N))}):U]},[null,null]),w=I[0],I=I[1];return w?this.where(w.name).equals(o[w.keyPath]).filter(I):f?this.filter(I):this.where(s).equals("")},rt.prototype.filter=function(o){return this.toCollection().and(o)},rt.prototype.count=function(o){return this.toCollection().count(o)},rt.prototype.offset=function(o){return this.toCollection().offset(o)},rt.prototype.limit=function(o){return this.toCollection().limit(o)},rt.prototype.each=function(o){return this.toCollection().each(o)},rt.prototype.toArray=function(o){return this.toCollection().toArray(o)},rt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},rt.prototype.orderBy=function(o){return new this.db.Collection(new this.db.WhereClause(this,c(o)?"[".concat(o.join("+"),"]"):o))},rt.prototype.reverse=function(){return this.toCollection().reverse()},rt.prototype.mapToClass=function(o){var s,f=this.db,p=this.name;function b(){return s!==null&&s.apply(this,arguments)||this}(this.schema.mappedClass=o).prototype instanceof Es&&(function(N,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function U(){this.constructor=N}n(N,M),N.prototype=M===null?Object.create(M):(U.prototype=M.prototype,new U)}(b,s=o),Object.defineProperty(b.prototype,"db",{get:function(){return f},enumerable:!1,configurable:!0}),b.prototype.table=function(){return p},o=b);for(var w=new Set,I=o.prototype;I;I=h(I))Object.getOwnPropertyNames(I).forEach(function(N){return w.add(N)});function T(N){if(!N)return N;var M,U=Object.create(o.prototype);for(M in N)if(!w.has(M))try{U[M]=N[M]}catch{}return U}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=T,this.hook("reading",T),o},rt.prototype.defineClass=function(){return this.mapToClass(function(o){d(this,o)})},rt.prototype.add=function(o,s){var f=this,p=this.schema.primKey,b=p.auto,w=p.keyPath,I=o;return w&&b&&(I=_i(w)(o)),this._trans("readwrite",function(T){return f.core.mutate({trans:T,type:"add",keys:s!=null?[s]:null,values:[I]})}).then(function(T){return T.numFailures?_e.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{W(o,w,T)}catch{}return T})},rt.prototype.update=function(o,s){return typeof o!="object"||c(o)?this.where(":id").equals(o).modify(s):(o=R(o,this.schema.primKey.keyPath),o===void 0?lt(new Se.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(s))},rt.prototype.put=function(o,s){var f=this,p=this.schema.primKey,b=p.auto,w=p.keyPath,I=o;return w&&b&&(I=_i(w)(o)),this._trans("readwrite",function(T){return f.core.mutate({trans:T,type:"put",values:[I],keys:s!=null?[s]:null})}).then(function(T){return T.numFailures?_e.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{W(o,w,T)}catch{}return T})},rt.prototype.delete=function(o){var s=this;return this._trans("readwrite",function(f){return s.core.mutate({trans:f,type:"delete",keys:[o]})}).then(function(f){return f.numFailures?_e.reject(f.failures[0]):void 0})},rt.prototype.clear=function(){var o=this;return this._trans("readwrite",function(s){return o.core.mutate({trans:s,type:"deleteRange",range:Is})}).then(function(s){return s.numFailures?_e.reject(s.failures[0]):void 0})},rt.prototype.bulkGet=function(o){var s=this;return this._trans("readonly",function(f){return s.core.getMany({keys:o,trans:f}).then(function(p){return p.map(function(b){return s.hook.reading.fire(b)})})})},rt.prototype.bulkAdd=function(o,s,f){var p=this,b=Array.isArray(s)?s:void 0,w=(f=f||(b?void 0:s))?f.allKeys:void 0;return this._trans("readwrite",function(I){var M=p.schema.primKey,T=M.auto,M=M.keyPath;if(M&&b)throw new Se.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(b&&b.length!==o.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");var N=o.length,M=M&&T?o.map(_i(M)):o;return p.core.mutate({trans:I,type:"add",keys:b,values:M,wantResults:w}).then(function(F){var j=F.numFailures,z=F.results,L=F.lastResult,F=F.failures;if(j===0)return w?z:L;throw new Je("".concat(p.name,".bulkAdd(): ").concat(j," of ").concat(N," operations failed"),F)})})},rt.prototype.bulkPut=function(o,s,f){var p=this,b=Array.isArray(s)?s:void 0,w=(f=f||(b?void 0:s))?f.allKeys:void 0;return this._trans("readwrite",function(I){var M=p.schema.primKey,T=M.auto,M=M.keyPath;if(M&&b)throw new Se.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(b&&b.length!==o.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");var N=o.length,M=M&&T?o.map(_i(M)):o;return p.core.mutate({trans:I,type:"put",keys:b,values:M,wantResults:w}).then(function(F){var j=F.numFailures,z=F.results,L=F.lastResult,F=F.failures;if(j===0)return w?z:L;throw new Je("".concat(p.name,".bulkPut(): ").concat(j," of ").concat(N," operations failed"),F)})})},rt.prototype.bulkUpdate=function(o){var s=this,f=this.core,p=o.map(function(I){return I.key}),b=o.map(function(I){return I.changes}),w=[];return this._trans("readwrite",function(I){return f.getMany({trans:I,keys:p,cache:"clone"}).then(function(T){var N=[],M=[];o.forEach(function(j,z){var L=j.key,F=j.changes,K=T[z];if(K){for(var q=0,J=Object.keys(F);q<J.length;q++){var X=J[q],ee=F[X];if(X===s.schema.primKey.keyPath){if(We(ee,L)!==0)throw new Se.Constraint("Cannot update primary key in bulkUpdate()")}else W(K,X,ee)}w.push(z),N.push(L),M.push(K)}});var U=N.length;return f.mutate({trans:I,type:"put",keys:N,values:M,updates:{keys:p,changeSpecs:b}}).then(function(j){var z=j.numFailures,L=j.failures;if(z===0)return U;for(var F=0,K=Object.keys(L);F<K.length;F++){var q,J=K[F],X=w[Number(J)];X!=null&&(q=L[J],delete L[J],L[X]=q)}throw new Je("".concat(s.name,".bulkUpdate(): ").concat(z," of ").concat(U," operations failed"),L)})})})},rt.prototype.bulkDelete=function(o){var s=this,f=o.length;return this._trans("readwrite",function(p){return s.core.mutate({trans:p,type:"delete",keys:o})}).then(function(I){var b=I.numFailures,w=I.lastResult,I=I.failures;if(b===0)return w;throw new Je("".concat(s.name,".bulkDelete(): ").concat(b," of ").concat(f," operations failed"),I)})},rt);function rt(){}function Mr(o){function s(I,T){if(T){for(var N=arguments.length,M=new Array(N-1);--N;)M[N-1]=arguments[N];return f[I].subscribe.apply(null,M),o}if(typeof I=="string")return f[I]}var f={};s.addEventType=w;for(var p=1,b=arguments.length;p<b;++p)w(arguments[p]);return s;function w(I,T,N){if(typeof I!="object"){var M;T=T||bt;var U={subscribers:[],fire:N=N||ae,subscribe:function(j){U.subscribers.indexOf(j)===-1&&(U.subscribers.push(j),U.fire=T(U.fire,j))},unsubscribe:function(j){U.subscribers=U.subscribers.filter(function(z){return z!==j}),U.fire=U.subscribers.reduce(T,N)}};return f[I]=s[I]=U}l(M=I).forEach(function(j){var z=M[j];if(c(z))w(j,M[j][0],M[j][1]);else{if(z!=="asap")throw new Se.InvalidArgument("Invalid event config");var L=w(j,we,function(){for(var F=arguments.length,K=new Array(F);F--;)K[F]=arguments[F];L.subscribers.forEach(function(q){D(function(){q.apply(null,K)})})})}})}}function qr(o,s){return k(s).from({prototype:o}),s}function or(o,s){return!(o.filter||o.algorithm||o.or)&&(s?o.justLimit:!o.replayFilter)}function To(o,s){o.filter=Kn(o.filter,s)}function jo(o,s,f){var p=o.replayFilter;o.replayFilter=p?function(){return Kn(p(),s())}:s,o.justLimit=f&&!p}function wi(o,s){if(o.isPrimKey)return s.primaryKey;var f=s.getIndexByKeyPath(o.index);if(!f)throw new Se.Schema("KeyPath "+o.index+" on object store "+s.name+" is not indexed");return f}function Ps(o,s,f){var p=wi(o,s.schema);return s.openCursor({trans:f,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:p,range:o.range}})}function ki(o,s,f,p){var b=o.replayFilter?Kn(o.filter,o.replayFilter()):o.filter;if(o.or){var w={},I=function(T,N,M){var U,j;b&&!b(N,M,function(z){return N.stop(z)},function(z){return N.fail(z)})||((j=""+(U=N.primaryKey))=="[object ArrayBuffer]"&&(j=""+new Uint8Array(U)),m(w,j)||(w[j]=!0,s(T,N,M)))};return Promise.all([o.or._iterate(I,f),Ts(Ps(o,p,f),o.algorithm,I,!o.keysOnly&&o.valueMapper)])}return Ts(Ps(o,p,f),Kn(o.algorithm,b),s,!o.keysOnly&&o.valueMapper)}function Ts(o,s,f,p){var b=tt(p?function(w,I,T){return f(p(w),I,T)}:f);return o.then(function(w){if(w)return w.start(function(){var I=function(){return w.continue()};s&&!s(w,function(T){return I=T},function(T){w.stop(T),I=ae},function(T){w.fail(T),I=ae})||b(w.value,w,function(T){return I=T}),I()})})}var Fr=(js.prototype.execute=function(o){var s=this["@@propmod"];if(s.add!==void 0){var f=s.add;if(c(f))return i(i([],c(o)?o:[],!0),f).sort();if(typeof f=="number")return(Number(o)||0)+f;if(typeof f=="bigint")try{return BigInt(o)+f}catch{return BigInt(0)+f}throw new TypeError("Invalid term ".concat(f))}if(s.remove!==void 0){var p=s.remove;if(c(p))return c(o)?o.filter(function(b){return!p.includes(b)}).sort():[];if(typeof p=="number")return Number(o)-p;if(typeof p=="bigint")try{return BigInt(o)-p}catch{return BigInt(0)-p}throw new TypeError("Invalid subtrahend ".concat(p))}return f=(f=s.replacePrefix)===null||f===void 0?void 0:f[0],f&&typeof o=="string"&&o.startsWith(f)?s.replacePrefix[1]+o.substring(f.length):o},js);function js(o){this["@@propmod"]=o}var _f=(Qe.prototype._read=function(o,s){var f=this._ctx;return f.error?f.table._trans(null,lt.bind(null,f.error)):f.table._trans("readonly",o).then(s)},Qe.prototype._write=function(o){var s=this._ctx;return s.error?s.table._trans(null,lt.bind(null,s.error)):s.table._trans("readwrite",o,"locked")},Qe.prototype._addAlgorithm=function(o){var s=this._ctx;s.algorithm=Kn(s.algorithm,o)},Qe.prototype._iterate=function(o,s){return ki(this._ctx,o,s,this._ctx.table.core)},Qe.prototype.clone=function(o){var s=Object.create(this.constructor.prototype),f=Object.create(this._ctx);return o&&d(f,o),s._ctx=f,s},Qe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Qe.prototype.each=function(o){var s=this._ctx;return this._read(function(f){return ki(s,o,f,s.table.core)})},Qe.prototype.count=function(o){var s=this;return this._read(function(f){var p=s._ctx,b=p.table.core;if(or(p,!0))return b.count({trans:f,query:{index:wi(p,b.schema),range:p.range}}).then(function(I){return Math.min(I,p.limit)});var w=0;return ki(p,function(){return++w,!1},f,b).then(function(){return w})}).then(o)},Qe.prototype.sortBy=function(o,s){var f=o.split(".").reverse(),p=f[0],b=f.length-1;function w(N,M){return M?w(N[f[M]],M-1):N[p]}var I=this._ctx.dir==="next"?1:-1;function T(N,M){return We(w(N,b),w(M,b))*I}return this.toArray(function(N){return N.sort(T)}).then(s)},Qe.prototype.toArray=function(o){var s=this;return this._read(function(f){var p=s._ctx;if(p.dir==="next"&&or(p,!0)&&0<p.limit){var b=p.valueMapper,w=wi(p,p.table.core.schema);return p.table.core.query({trans:f,limit:p.limit,values:!0,query:{index:w,range:p.range}}).then(function(T){return T=T.result,b?T.map(b):T})}var I=[];return ki(p,function(T){return I.push(T)},f,p.table.core).then(function(){return I})},o)},Qe.prototype.offset=function(o){var s=this._ctx;return o<=0||(s.offset+=o,or(s)?jo(s,function(){var f=o;return function(p,b){return f===0||(f===1?--f:b(function(){p.advance(f),f=0}),!1)}}):jo(s,function(){var f=o;return function(){return--f<0}})),this},Qe.prototype.limit=function(o){return this._ctx.limit=Math.min(this._ctx.limit,o),jo(this._ctx,function(){var s=o;return function(f,p,b){return--s<=0&&p(b),0<=s}},!0),this},Qe.prototype.until=function(o,s){return To(this._ctx,function(f,p,b){return!o(f.value)||(p(b),s)}),this},Qe.prototype.first=function(o){return this.limit(1).toArray(function(s){return s[0]}).then(o)},Qe.prototype.last=function(o){return this.reverse().first(o)},Qe.prototype.filter=function(o){var s;return To(this._ctx,function(f){return o(f.value)}),(s=this._ctx).isMatch=Kn(s.isMatch,o),this},Qe.prototype.and=function(o){return this.filter(o)},Qe.prototype.or=function(o){return new this.db.WhereClause(this._ctx.table,o,this)},Qe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Qe.prototype.desc=function(){return this.reverse()},Qe.prototype.eachKey=function(o){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(f,p){o(p.key,p)})},Qe.prototype.eachUniqueKey=function(o){return this._ctx.unique="unique",this.eachKey(o)},Qe.prototype.eachPrimaryKey=function(o){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(f,p){o(p.primaryKey,p)})},Qe.prototype.keys=function(o){var s=this._ctx;s.keysOnly=!s.isMatch;var f=[];return this.each(function(p,b){f.push(b.key)}).then(function(){return f}).then(o)},Qe.prototype.primaryKeys=function(o){var s=this._ctx;if(s.dir==="next"&&or(s,!0)&&0<s.limit)return this._read(function(p){var b=wi(s,s.table.core.schema);return s.table.core.query({trans:p,values:!1,limit:s.limit,query:{index:b,range:s.range}})}).then(function(p){return p.result}).then(o);s.keysOnly=!s.isMatch;var f=[];return this.each(function(p,b){f.push(b.primaryKey)}).then(function(){return f}).then(o)},Qe.prototype.uniqueKeys=function(o){return this._ctx.unique="unique",this.keys(o)},Qe.prototype.firstKey=function(o){return this.limit(1).keys(function(s){return s[0]}).then(o)},Qe.prototype.lastKey=function(o){return this.reverse().firstKey(o)},Qe.prototype.distinct=function(){var o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];if(!o||!o.multi)return this;var s={};return To(this._ctx,function(b){var p=b.primaryKey.toString(),b=m(s,p);return s[p]=!0,!b}),this},Qe.prototype.modify=function(o){var s=this,f=this._ctx;return this._write(function(p){var b,w,I;I=typeof o=="function"?o:(b=l(o),w=b.length,function(q){for(var J=!1,X=0;X<w;++X){var ee=b[X],re=o[ee],le=R(q,ee);re instanceof Fr?(W(q,ee,re.execute(le)),J=!0):le!==re&&(W(q,ee,re),J=!0)}return J});var T=f.table.core,j=T.schema.primaryKey,N=j.outbound,M=j.extractKey,U=200,j=s.db._options.modifyChunkSize;j&&(U=typeof j=="object"?j[T.name]||j["*"]||200:j);function z(q,ee){var X=ee.failures,ee=ee.numFailures;F+=q-ee;for(var re=0,le=l(X);re<le.length;re++){var ye=le[re];L.push(X[ye])}}var L=[],F=0,K=[];return s.clone().primaryKeys().then(function(q){function J(ee){var re=Math.min(U,q.length-ee);return T.getMany({trans:p,keys:q.slice(ee,ee+re),cache:"immutable"}).then(function(le){for(var ye=[],ue=[],de=N?[]:null,ge=[],pe=0;pe<re;++pe){var xe=le[pe],Me={value:H(xe),primKey:q[ee+pe]};I.call(Me,Me.value,Me)!==!1&&(Me.value==null?ge.push(q[ee+pe]):N||We(M(xe),M(Me.value))===0?(ue.push(Me.value),N&&de.push(q[ee+pe])):(ge.push(q[ee+pe]),ye.push(Me.value)))}return Promise.resolve(0<ye.length&&T.mutate({trans:p,type:"add",values:ye}).then(function(Be){for(var Ke in Be.failures)ge.splice(parseInt(Ke),1);z(ye.length,Be)})).then(function(){return(0<ue.length||X&&typeof o=="object")&&T.mutate({trans:p,type:"put",keys:de,values:ue,criteria:X,changeSpec:typeof o!="function"&&o,isAdditionalChunk:0<ee}).then(function(Be){return z(ue.length,Be)})}).then(function(){return(0<ge.length||X&&o===Do)&&T.mutate({trans:p,type:"delete",keys:ge,criteria:X,isAdditionalChunk:0<ee}).then(function(Be){return z(ge.length,Be)})}).then(function(){return q.length>ee+re&&J(ee+U)})})}var X=or(f)&&f.limit===1/0&&(typeof o!="function"||o===Do)&&{index:f.index,range:f.range};return J(0).then(function(){if(0<L.length)throw new Ge("Error modifying one or more objects",L,F,K);return q.length})})})},Qe.prototype.delete=function(){var o=this._ctx,s=o.range;return or(o)&&(o.isPrimKey||s.type===3)?this._write(function(f){var p=o.table.core.schema.primaryKey,b=s;return o.table.core.count({trans:f,query:{index:p,range:b}}).then(function(w){return o.table.core.mutate({trans:f,type:"deleteRange",range:b}).then(function(I){var T=I.failures;if(I.lastResult,I.results,I=I.numFailures,I)throw new Ge("Could not delete some values",Object.keys(T).map(function(N){return T[N]}),w-I);return w-I})})}):this.modify(Do)},Qe);function Qe(){}var Do=function(o,s){return s.value=null};function wf(o,s){return o<s?-1:o===s?0:1}function kf(o,s){return s<o?-1:o===s?0:1}function Rt(o,s,f){return o=o instanceof Rs?new o.Collection(o):o,o._ctx.error=new(f||TypeError)(s),o}function ar(o){return new o.Collection(o,function(){return Ds("")}).limit(0)}function xi(o,s,f,p){var b,w,I,T,N,M,U,j=f.length;if(!f.every(function(F){return typeof F=="string"}))return Rt(o,Ss);function z(F){b=F==="next"?function(q){return q.toUpperCase()}:function(q){return q.toLowerCase()},w=F==="next"?function(q){return q.toLowerCase()}:function(q){return q.toUpperCase()},I=F==="next"?wf:kf;var K=f.map(function(q){return{lower:w(q),upper:b(q)}}).sort(function(q,J){return I(q.lower,J.lower)});T=K.map(function(q){return q.upper}),N=K.map(function(q){return q.lower}),U=(M=F)==="next"?"":p}z("next"),o=new o.Collection(o,function(){return An(T[0],N[j-1]+p)}),o._ondirectionchange=function(F){z(F)};var L=0;return o._addAlgorithm(function(F,K,q){var J=F.key;if(typeof J!="string")return!1;var X=w(J);if(s(X,N,L))return!0;for(var ee=null,re=L;re<j;++re){var le=function(ye,ue,de,ge,pe,xe){for(var Me=Math.min(ye.length,ge.length),Be=-1,Ke=0;Ke<Me;++Ke){var Nt=ue[Ke];if(Nt!==ge[Ke])return pe(ye[Ke],de[Ke])<0?ye.substr(0,Ke)+de[Ke]+de.substr(Ke+1):pe(ye[Ke],ge[Ke])<0?ye.substr(0,Ke)+ge[Ke]+de.substr(Ke+1):0<=Be?ye.substr(0,Be)+ue[Be]+de.substr(Be+1):null;pe(ye[Ke],Nt)<0&&(Be=Ke)}return Me<ge.length&&xe==="next"?ye+de.substr(ye.length):Me<ye.length&&xe==="prev"?ye.substr(0,de.length):Be<0?null:ye.substr(0,Be)+ge[Be]+de.substr(Be+1)}(J,X,T[re],N[re],I,M);le===null&&ee===null?L=re+1:(ee===null||0<I(ee,le))&&(ee=le)}return K(ee!==null?function(){F.continue(ee+U)}:q),!1}),o}function An(o,s,f,p){return{type:2,lower:o,upper:s,lowerOpen:f,upperOpen:p}}function Ds(o){return{type:1,lower:o,upper:o}}var Rs=(Object.defineProperty(mt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),mt.prototype.between=function(o,s,f,p){f=f!==!1,p=p===!0;try{return 0<this._cmp(o,s)||this._cmp(o,s)===0&&(f||p)&&(!f||!p)?ar(this):new this.Collection(this,function(){return An(o,s,!f,!p)})}catch{return Rt(this,hn)}},mt.prototype.equals=function(o){return o==null?Rt(this,hn):new this.Collection(this,function(){return Ds(o)})},mt.prototype.above=function(o){return o==null?Rt(this,hn):new this.Collection(this,function(){return An(o,void 0,!0)})},mt.prototype.aboveOrEqual=function(o){return o==null?Rt(this,hn):new this.Collection(this,function(){return An(o,void 0,!1)})},mt.prototype.below=function(o){return o==null?Rt(this,hn):new this.Collection(this,function(){return An(void 0,o,!1,!0)})},mt.prototype.belowOrEqual=function(o){return o==null?Rt(this,hn):new this.Collection(this,function(){return An(void 0,o)})},mt.prototype.startsWith=function(o){return typeof o!="string"?Rt(this,Ss):this.between(o,o+Bn,!0,!0)},mt.prototype.startsWithIgnoreCase=function(o){return o===""?this.startsWith(o):xi(this,function(s,f){return s.indexOf(f[0])===0},[o],Bn)},mt.prototype.equalsIgnoreCase=function(o){return xi(this,function(s,f){return s===f[0]},[o],"")},mt.prototype.anyOfIgnoreCase=function(){var o=B.apply(he,arguments);return o.length===0?ar(this):xi(this,function(s,f){return f.indexOf(s)!==-1},o,"")},mt.prototype.startsWithAnyOfIgnoreCase=function(){var o=B.apply(he,arguments);return o.length===0?ar(this):xi(this,function(s,f){return f.some(function(p){return s.indexOf(p)===0})},o,Bn)},mt.prototype.anyOf=function(){var o=this,s=B.apply(he,arguments),f=this._cmp;try{s.sort(f)}catch{return Rt(this,hn)}if(s.length===0)return ar(this);var p=new this.Collection(this,function(){return An(s[0],s[s.length-1])});p._ondirectionchange=function(w){f=w==="next"?o._ascending:o._descending,s.sort(f)};var b=0;return p._addAlgorithm(function(w,I,T){for(var N=w.key;0<f(N,s[b]);)if(++b===s.length)return I(T),!1;return f(N,s[b])===0||(I(function(){w.continue(s[b])}),!1)}),p},mt.prototype.notEqual=function(o){return this.inAnyRange([[-1/0,o],[o,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},mt.prototype.noneOf=function(){var o=B.apply(he,arguments);if(o.length===0)return new this.Collection(this);try{o.sort(this._ascending)}catch{return Rt(this,hn)}var s=o.reduce(function(f,p){return f?f.concat([[f[f.length-1][1],p]]):[[-1/0,p]]},null);return s.push([o[o.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},mt.prototype.inAnyRange=function(J,s){var f=this,p=this._cmp,b=this._ascending,w=this._descending,I=this._min,T=this._max;if(J.length===0)return ar(this);if(!J.every(function(X){return X[0]!==void 0&&X[1]!==void 0&&b(X[0],X[1])<=0}))return Rt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Se.InvalidArgument);var N=!s||s.includeLowers!==!1,M=s&&s.includeUppers===!0,U,j=b;function z(X,ee){return j(X[0],ee[0])}try{(U=J.reduce(function(X,ee){for(var re=0,le=X.length;re<le;++re){var ye=X[re];if(p(ee[0],ye[1])<0&&0<p(ee[1],ye[0])){ye[0]=I(ye[0],ee[0]),ye[1]=T(ye[1],ee[1]);break}}return re===le&&X.push(ee),X},[])).sort(z)}catch{return Rt(this,hn)}var L=0,F=M?function(X){return 0<b(X,U[L][1])}:function(X){return 0<=b(X,U[L][1])},K=N?function(X){return 0<w(X,U[L][0])}:function(X){return 0<=w(X,U[L][0])},q=F,J=new this.Collection(this,function(){return An(U[0][0],U[U.length-1][1],!N,!M)});return J._ondirectionchange=function(X){j=X==="next"?(q=F,b):(q=K,w),U.sort(z)},J._addAlgorithm(function(X,ee,re){for(var le,ye=X.key;q(ye);)if(++L===U.length)return ee(re),!1;return!F(le=ye)&&!K(le)||(f._cmp(ye,U[L][1])===0||f._cmp(ye,U[L][0])===0||ee(function(){j===b?X.continue(U[L][0]):X.continue(U[L][1])}),!1)}),J},mt.prototype.startsWithAnyOf=function(){var o=B.apply(he,arguments);return o.every(function(s){return typeof s=="string"})?o.length===0?ar(this):this.inAnyRange(o.map(function(s){return[s,s+Bn]})):Rt(this,"startsWithAnyOf() only works with strings")},mt);function mt(){}function an(o){return tt(function(s){return Ur(s),o(s.target.error),!1})}function Ur(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var Br="storagemutated",Ro="x-storagemutated-1",Pn=Mr(null,Br),xf=(sn.prototype._lock=function(){return C(!Oe.global),++this._reculock,this._reculock!==1||Oe.global||(Oe.lockOwnerFor=this),this},sn.prototype._unlock=function(){if(C(!Oe.global),--this._reculock==0)for(Oe.global||(Oe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var o=this._blockedFuncs.shift();try{Un(o[1],o[0])}catch{}}return this},sn.prototype._locked=function(){return this._reculock&&Oe.lockOwnerFor!==this},sn.prototype.create=function(o){var s=this;if(!this.mode)return this;var f=this.db.idbdb,p=this.db._state.dbOpenError;if(C(!this.idbtrans),!o&&!f)switch(p&&p.name){case"DatabaseClosedError":throw new Se.DatabaseClosed(p);case"MissingAPIError":throw new Se.MissingAPI(p.message,p);default:throw new Se.OpenFailed(p)}if(!this.active)throw new Se.TransactionInactive;return C(this._completion._state===null),(o=this.idbtrans=o||(this.db.core||f).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=tt(function(b){Ur(b),s._reject(o.error)}),o.onabort=tt(function(b){Ur(b),s.active&&s._reject(new Se.Abort(o.error)),s.active=!1,s.on("abort").fire(b)}),o.oncomplete=tt(function(){s.active=!1,s._resolve(),"mutatedParts"in o&&Pn.storagemutated.fire(o.mutatedParts)}),this},sn.prototype._promise=function(o,s,f){var p=this;if(o==="readwrite"&&this.mode!=="readwrite")return lt(new Se.ReadOnly("Transaction is readonly"));if(!this.active)return lt(new Se.TransactionInactive);if(this._locked())return new _e(function(w,I){p._blockedFuncs.push([function(){p._promise(o,s,f).then(w,I)},Oe])});if(f)return on(function(){var w=new _e(function(I,T){p._lock();var N=s(I,T,p);N&&N.then&&N.then(I,T)});return w.finally(function(){return p._unlock()}),w._lib=!0,w});var b=new _e(function(w,I){var T=s(w,I,p);T&&T.then&&T.then(w,I)});return b._lib=!0,b},sn.prototype._root=function(){return this.parent?this.parent._root():this},sn.prototype.waitFor=function(o){var s,f=this._root(),p=_e.resolve(o);f._waitingFor?f._waitingFor=f._waitingFor.then(function(){return p}):(f._waitingFor=p,f._waitingQueue=[],s=f.idbtrans.objectStore(f.storeNames[0]),function w(){for(++f._spinCount;f._waitingQueue.length;)f._waitingQueue.shift()();f._waitingFor&&(s.get(-1/0).onsuccess=w)}());var b=f._waitingFor;return new _e(function(w,I){p.then(function(T){return f._waitingQueue.push(tt(w.bind(null,T)))},function(T){return f._waitingQueue.push(tt(I.bind(null,T)))}).finally(function(){f._waitingFor===b&&(f._waitingFor=null)})})},sn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Se.Abort))},sn.prototype.table=function(o){var s=this._memoizedTables||(this._memoizedTables={});if(m(s,o))return s[o];var f=this.schema[o];if(!f)throw new Se.NotFound("Table "+o+" not part of transaction");return f=new this.db.Table(o,f,this),f.core=this.db.core.table(o),s[o]=f},sn);function sn(){}function No(o,s,f,p,b,w,I){return{name:o,keyPath:s,unique:f,multi:p,auto:b,compound:w,src:(f&&!I?"&":"")+(p?"*":"")+(b?"++":"")+Ns(s)}}function Ns(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Lo(o,s,f){return{name:o,primKey:s,indexes:f,mappedClass:null,idxByName:(p=function(b){return[b.name,b]},f.reduce(function(b,w,I){return I=p(w,I),I&&(b[I[0]]=I[1]),b},{}))};var p}var Kr=function(o){try{return o.only([[]]),Kr=function(){return[[]]},[[]]}catch{return Kr=function(){return Bn},Bn}};function Mo(o){return o==null?function(){}:typeof o=="string"?(s=o).split(".").length===1?function(f){return f[s]}:function(f){return R(f,s)}:function(f){return R(f,o)};var s}function Ls(o){return[].slice.call(o)}var Sf=0;function zr(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function If(o,s,N){function p(q){if(q.type===3)return null;if(q.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var L=q.lower,F=q.upper,K=q.lowerOpen,q=q.upperOpen;return L===void 0?F===void 0?null:s.upperBound(F,!!q):F===void 0?s.lowerBound(L,!!K):s.bound(L,F,!!K,!!q)}function b(z){var L,F=z.name;return{name:F,schema:z,mutate:function(K){var q=K.trans,J=K.type,X=K.keys,ee=K.values,re=K.range;return new Promise(function(le,ye){le=tt(le);var ue=q.objectStore(F),de=ue.keyPath==null,ge=J==="put"||J==="add";if(!ge&&J!=="delete"&&J!=="deleteRange")throw new Error("Invalid operation type: "+J);var pe,xe=(X||ee||{length:1}).length;if(X&&ee&&X.length!==ee.length)throw new Error("Given keys array must have same length as given values array.");if(xe===0)return le({numFailures:0,failures:{},results:[],lastResult:void 0});function Me(Et){++Nt,Ur(Et)}var Be=[],Ke=[],Nt=0;if(J==="deleteRange"){if(re.type===4)return le({numFailures:Nt,failures:Ke,results:[],lastResult:void 0});re.type===3?Be.push(pe=ue.clear()):Be.push(pe=ue.delete(p(re)))}else{var de=ge?de?[ee,X]:[ee,null]:[X,null],Le=de[0],wt=de[1];if(ge)for(var kt=0;kt<xe;++kt)Be.push(pe=wt&&wt[kt]!==void 0?ue[J](Le[kt],wt[kt]):ue[J](Le[kt])),pe.onerror=Me;else for(kt=0;kt<xe;++kt)Be.push(pe=ue[J](Le[kt])),pe.onerror=Me}function Li(Et){Et=Et.target.result,Be.forEach(function(Wn,ta){return Wn.error!=null&&(Ke[ta]=Wn.error)}),le({numFailures:Nt,failures:Ke,results:J==="delete"?X:Be.map(function(Wn){return Wn.result}),lastResult:Et})}pe.onerror=function(Et){Me(Et),Li(Et)},pe.onsuccess=Li})},getMany:function(K){var q=K.trans,J=K.keys;return new Promise(function(X,ee){X=tt(X);for(var re,le=q.objectStore(F),ye=J.length,ue=new Array(ye),de=0,ge=0,pe=function(Be){Be=Be.target,ue[Be._pos]=Be.result,++ge===de&&X(ue)},xe=an(ee),Me=0;Me<ye;++Me)J[Me]!=null&&((re=le.get(J[Me]))._pos=Me,re.onsuccess=pe,re.onerror=xe,++de);de===0&&X(ue)})},get:function(K){var q=K.trans,J=K.key;return new Promise(function(X,ee){X=tt(X);var re=q.objectStore(F).get(J);re.onsuccess=function(le){return X(le.target.result)},re.onerror=an(ee)})},query:(L=M,function(K){return new Promise(function(q,J){q=tt(q);var X,ee,re,de=K.trans,le=K.values,ye=K.limit,pe=K.query,ue=ye===1/0?void 0:ye,ge=pe.index,pe=pe.range,de=de.objectStore(F),ge=ge.isPrimaryKey?de:de.index(ge.name),pe=p(pe);if(ye===0)return q({result:[]});L?((ue=le?ge.getAll(pe,ue):ge.getAllKeys(pe,ue)).onsuccess=function(xe){return q({result:xe.target.result})},ue.onerror=an(J)):(X=0,ee=!le&&"openKeyCursor"in ge?ge.openKeyCursor(pe):ge.openCursor(pe),re=[],ee.onsuccess=function(xe){var Me=ee.result;return Me?(re.push(le?Me.value:Me.primaryKey),++X===ye?q({result:re}):void Me.continue()):q({result:re})},ee.onerror=an(J))})}),openCursor:function(K){var q=K.trans,J=K.values,X=K.query,ee=K.reverse,re=K.unique;return new Promise(function(le,ye){le=tt(le);var ge=X.index,ue=X.range,de=q.objectStore(F),de=ge.isPrimaryKey?de:de.index(ge.name),ge=ee?re?"prevunique":"prev":re?"nextunique":"next",pe=!J&&"openKeyCursor"in de?de.openKeyCursor(p(ue),ge):de.openCursor(p(ue),ge);pe.onerror=an(ye),pe.onsuccess=tt(function(xe){var Me,Be,Ke,Nt,Le=pe.result;Le?(Le.___id=++Sf,Le.done=!1,Me=Le.continue.bind(Le),Be=(Be=Le.continuePrimaryKey)&&Be.bind(Le),Ke=Le.advance.bind(Le),Nt=function(){throw new Error("Cursor not stopped")},Le.trans=q,Le.stop=Le.continue=Le.continuePrimaryKey=Le.advance=function(){throw new Error("Cursor not started")},Le.fail=tt(ye),Le.next=function(){var wt=this,kt=1;return this.start(function(){return kt--?wt.continue():wt.stop()}).then(function(){return wt})},Le.start=function(wt){function kt(){if(pe.result)try{wt()}catch(Et){Le.fail(Et)}else Le.done=!0,Le.start=function(){throw new Error("Cursor behind last entry")},Le.stop()}var Li=new Promise(function(Et,Wn){Et=tt(Et),pe.onerror=an(Wn),Le.fail=Wn,Le.stop=function(ta){Le.stop=Le.continue=Le.continuePrimaryKey=Le.advance=Nt,Et(ta)}});return pe.onsuccess=tt(function(Et){pe.onsuccess=kt,kt()}),Le.continue=Me,Le.continuePrimaryKey=Be,Le.advance=Ke,kt(),Li},le(Le)):le(null)},ye)})},count:function(K){var q=K.query,J=K.trans,X=q.index,ee=q.range;return new Promise(function(re,le){var ye=J.objectStore(F),ue=X.isPrimaryKey?ye:ye.index(X.name),ye=p(ee),ue=ye?ue.count(ye):ue.count();ue.onsuccess=tt(function(de){return re(de.target.result)}),ue.onerror=an(le)})}}}var w,I,T,U=(I=N,T=Ls((w=o).objectStoreNames),{schema:{name:w.name,tables:T.map(function(z){return I.objectStore(z)}).map(function(z){var L=z.keyPath,q=z.autoIncrement,F=c(L),K={},q={name:z.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:L==null,compound:F,keyPath:L,autoIncrement:q,unique:!0,extractKey:Mo(L)},indexes:Ls(z.indexNames).map(function(J){return z.index(J)}).map(function(re){var X=re.name,ee=re.unique,le=re.multiEntry,re=re.keyPath,le={name:X,compound:c(re),keyPath:re,unique:ee,multiEntry:le,extractKey:Mo(re)};return K[zr(re)]=le}),getIndexByKeyPath:function(J){return K[zr(J)]}};return K[":id"]=q.primaryKey,L!=null&&(K[zr(L)]=q.primaryKey),q})},hasGetAll:0<T.length&&"getAll"in I.objectStore(T[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),N=U.schema,M=U.hasGetAll,U=N.tables.map(b),j={};return U.forEach(function(z){return j[z.name]=z}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function(z){if(!j[z])throw new Error("Table '".concat(z,"' not found"));return j[z]},MIN_KEY:-1/0,MAX_KEY:Kr(s),schema:N}}function Ef(o,s,f,p){var b=f.IDBKeyRange;return f.indexedDB,{dbcore:(p=If(s,b,p),o.dbcore.reduce(function(w,I){return I=I.create,r(r({},w),I(w))},p))}}function Si(o,p){var f=p.db,p=Ef(o._middlewares,f,o._deps,p);o.core=p.dbcore,o.tables.forEach(function(b){var w=b.name;o.core.schema.tables.some(function(I){return I.name===w})&&(b.core=o.core.table(w),o[w]instanceof o.Table&&(o[w].core=b.core))})}function Ii(o,s,f,p){f.forEach(function(b){var w=p[b];s.forEach(function(I){var T=function N(M,U){return E(M,U)||(M=h(M))&&N(M,U)}(I,b);(!T||"value"in T&&T.value===void 0)&&(I===o.Transaction.prototype||I instanceof o.Transaction?_(I,b,{get:function(){return this.table(b)},set:function(N){g(this,b,{value:N,writable:!0,configurable:!0,enumerable:!0})}}):I[b]=new o.Table(b,w))})})}function qo(o,s){s.forEach(function(f){for(var p in f)f[p]instanceof o.Table&&delete f[p]})}function Of(o,s){return o._cfg.version-s._cfg.version}function Cf(o,s,f,p){var b=o._dbSchema;f.objectStoreNames.contains("$meta")&&!b.$meta&&(b.$meta=Lo("$meta",qs("")[0],[]),o._storeNames.push("$meta"));var w=o._createTransaction("readwrite",o._storeNames,b);w.create(f),w._completion.catch(p);var I=w._reject.bind(w),T=Oe.transless||Oe;on(function(){return Oe.trans=w,Oe.transless=T,s!==0?(Si(o,f),M=s,((N=w).storeNames.includes("$meta")?N.table("$meta").get("version").then(function(U){return U??M}):_e.resolve(M)).then(function(U){return z=U,L=w,F=f,K=[],U=(j=o)._versions,q=j._dbSchema=Oi(0,j.idbdb,F),(U=U.filter(function(J){return J._cfg.version>=z})).length!==0?(U.forEach(function(J){K.push(function(){var X=q,ee=J._cfg.dbschema;Ci(j,X,F),Ci(j,ee,F),q=j._dbSchema=ee;var re=Fo(X,ee);re.add.forEach(function(ge){Uo(F,ge[0],ge[1].primKey,ge[1].indexes)}),re.change.forEach(function(ge){if(ge.recreate)throw new Se.Upgrade("Not yet support for changing primary key");var pe=F.objectStore(ge.name);ge.add.forEach(function(xe){return Ei(pe,xe)}),ge.change.forEach(function(xe){pe.deleteIndex(xe.name),Ei(pe,xe)}),ge.del.forEach(function(xe){return pe.deleteIndex(xe)})});var le=J._cfg.contentUpgrade;if(le&&J._cfg.version>z){Si(j,F),L._memoizedTables={};var ye=Z(ee);re.del.forEach(function(ge){ye[ge]=X[ge]}),qo(j,[j.Transaction.prototype]),Ii(j,[j.Transaction.prototype],l(ye),ye),L.schema=ye;var ue,de=Ne(le);return de&&On(),re=_e.follow(function(){var ge;(ue=le(L))&&de&&(ge=It.bind(null,null),ue.then(ge,ge))}),ue&&typeof ue.then=="function"?_e.resolve(ue):re.then(function(){return ue})}}),K.push(function(X){var ee,re,le=J._cfg.dbschema;ee=le,re=X,[].slice.call(re.db.objectStoreNames).forEach(function(ye){return ee[ye]==null&&re.db.deleteObjectStore(ye)}),qo(j,[j.Transaction.prototype]),Ii(j,[j.Transaction.prototype],j._storeNames,j._dbSchema),L.schema=j._dbSchema}),K.push(function(X){j.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(j.idbdb.version/10)===J._cfg.version?(j.idbdb.deleteObjectStore("$meta"),delete j._dbSchema.$meta,j._storeNames=j._storeNames.filter(function(ee){return ee!=="$meta"})):X.objectStore("$meta").put(J._cfg.version,"version"))})}),function J(){return K.length?_e.resolve(K.shift()(L.idbtrans)).then(J):_e.resolve()}().then(function(){Ms(q,F)})):_e.resolve();var j,z,L,F,K,q}).catch(I)):(l(b).forEach(function(U){Uo(f,U,b[U].primKey,b[U].indexes)}),Si(o,f),void _e.follow(function(){return o.on.populate.fire(w)}).catch(I));var N,M})}function Af(o,s){Ms(o._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var f=Oi(0,o.idbdb,s);Ci(o,o._dbSchema,s);for(var p=0,b=Fo(f,o._dbSchema).change;p<b.length;p++){var w=function(I){if(I.change.length||I.recreate)return console.warn("Unable to patch indexes of table ".concat(I.name," because it has changes on the type of index or primary key.")),{value:void 0};var T=s.objectStore(I.name);I.add.forEach(function(N){at&&console.debug("Dexie upgrade patch: Creating missing index ".concat(I.name,".").concat(N.src)),Ei(T,N)})}(b[p]);if(typeof w=="object")return w.value}}function Fo(o,s){var f,p={del:[],add:[],change:[]};for(f in o)s[f]||p.del.push(f);for(f in s){var b=o[f],w=s[f];if(b){var I={name:f,def:w,recreate:!1,del:[],add:[],change:[]};if(""+(b.primKey.keyPath||"")!=""+(w.primKey.keyPath||"")||b.primKey.auto!==w.primKey.auto)I.recreate=!0,p.change.push(I);else{var T=b.idxByName,N=w.idxByName,M=void 0;for(M in T)N[M]||I.del.push(M);for(M in N){var U=T[M],j=N[M];U?U.src!==j.src&&I.change.push(j):I.add.push(j)}(0<I.del.length||0<I.add.length||0<I.change.length)&&p.change.push(I)}}else p.add.push([f,w])}return p}function Uo(o,s,f,p){var b=o.db.createObjectStore(s,f.keyPath?{keyPath:f.keyPath,autoIncrement:f.auto}:{autoIncrement:f.auto});return p.forEach(function(w){return Ei(b,w)}),b}function Ms(o,s){l(o).forEach(function(f){s.db.objectStoreNames.contains(f)||(at&&console.debug("Dexie: Creating missing table",f),Uo(s,f,o[f].primKey,o[f].indexes))})}function Ei(o,s){o.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Oi(o,s,f){var p={};return S(s.objectStoreNames,0).forEach(function(b){for(var w=f.objectStore(b),I=No(Ns(M=w.keyPath),M||"",!0,!1,!!w.autoIncrement,M&&typeof M!="string",!0),T=[],N=0;N<w.indexNames.length;++N){var U=w.index(w.indexNames[N]),M=U.keyPath,U=No(U.name,M,!!U.unique,!!U.multiEntry,!1,M&&typeof M!="string",!1);T.push(U)}p[b]=Lo(b,I,T)}),p}function Ci(o,s,f){for(var p=f.db.objectStoreNames,b=0;b<p.length;++b){var w=p[b],I=f.objectStore(w);o._hasGetAll="getAll"in I;for(var T=0;T<I.indexNames.length;++T){var N=I.indexNames[T],M=I.index(N).keyPath,U=typeof M=="string"?M:"["+S(M).join("+")+"]";!s[w]||(M=s[w].idxByName[U])&&(M.name=N,delete s[w].idxByName[U],s[w].idxByName[N]=M)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function qs(o){return o.split(",").map(function(s,f){var p=(s=s.trim()).replace(/([&*]|\+\+)/g,""),b=/^\[/.test(p)?p.match(/^\[(.*)\]$/)[1].split("+"):p;return No(p,b||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),c(b),f===0)})}var Pf=(Ai.prototype._parseStoresSpec=function(o,s){l(o).forEach(function(f){if(o[f]!==null){var p=qs(o[f]),b=p.shift();if(b.unique=!0,b.multi)throw new Se.Schema("Primary key cannot be multi-valued");p.forEach(function(w){if(w.auto)throw new Se.Schema("Only primary key can be marked as autoIncrement (++)");if(!w.keyPath)throw new Se.Schema("Index must have a name and cannot be an empty string")}),s[f]=Lo(f,b,p)}})},Ai.prototype.stores=function(f){var s=this.db;this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,f):f;var f=s._versions,p={},b={};return f.forEach(function(w){d(p,w._cfg.storesSource),b=w._cfg.dbschema={},w._parseStoresSpec(p,b)}),s._dbSchema=b,qo(s,[s._allTables,s,s.Transaction.prototype]),Ii(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],l(b),b),s._storeNames=l(b),this},Ai.prototype.upgrade=function(o){return this._cfg.contentUpgrade=jt(this._cfg.contentUpgrade||ae,o),this},Ai);function Ai(){}function Bo(o,s){var f=o._dbNamesDB;return f||(f=o._dbNamesDB=new pn(bi,{addons:[],indexedDB:o,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),f.table("dbnames")}function Ko(o){return o&&typeof o.databases=="function"}function zo(o){return on(function(){return Oe.letThrough=!0,o()})}function Vo(o){return!("from"in o)}var _t=function(o,s){if(!this){var f=new _t;return o&&"d"in o&&d(f,o),f}d(this,arguments.length?{d:1,from:o,to:1<arguments.length?s:o}:{d:0})};function Vr(o,s,f){var p=We(s,f);if(!isNaN(p)){if(0<p)throw RangeError();if(Vo(o))return d(o,{from:s,to:f,d:1});var b=o.l,p=o.r;if(We(f,o.from)<0)return b?Vr(b,s,f):o.l={from:s,to:f,d:1,l:null,r:null},Us(o);if(0<We(s,o.to))return p?Vr(p,s,f):o.r={from:s,to:f,d:1,l:null,r:null},Us(o);We(s,o.from)<0&&(o.from=s,o.l=null,o.d=p?p.d+1:1),0<We(f,o.to)&&(o.to=f,o.r=null,o.d=o.l?o.l.d+1:1),f=!o.r,b&&!o.l&&Wr(o,b),p&&f&&Wr(o,p)}}function Wr(o,s){Vo(s)||function f(p,N){var w=N.from,I=N.to,T=N.l,N=N.r;Vr(p,w,I),T&&f(p,T),N&&f(p,N)}(o,s)}function Fs(o,s){var f=Pi(s),p=f.next();if(p.done)return!1;for(var b=p.value,w=Pi(o),I=w.next(b.from),T=I.value;!p.done&&!I.done;){if(We(T.from,b.to)<=0&&0<=We(T.to,b.from))return!0;We(b.from,T.from)<0?b=(p=f.next(T.from)).value:T=(I=w.next(b.from)).value}return!1}function Pi(o){var s=Vo(o)?null:{s:0,n:o};return{next:function(f){for(var p=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,p)for(;s.n.l&&We(f,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!p||We(f,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function Us(o){var s,f,p=(((s=o.r)===null||s===void 0?void 0:s.d)||0)-(((f=o.l)===null||f===void 0?void 0:f.d)||0),b=1<p?"r":p<-1?"l":"";b&&(s=b=="r"?"l":"r",f=r({},o),p=o[b],o.from=p.from,o.to=p.to,o[b]=p[b],f[b]=p[s],(o[s]=f).d=Bs(f)),o.d=Bs(o)}function Bs(f){var s=f.r,f=f.l;return(s?f?Math.max(s.d,f.d):s.d:f?f.d:0)+1}function Ti(o,s){return l(s).forEach(function(f){o[f]?Wr(o[f],s[f]):o[f]=function p(b){var w,I,T={};for(w in b)m(b,w)&&(I=b[w],T[w]=!I||typeof I!="object"||ne.has(I.constructor)?I:p(I));return T}(s[f])}),o}function Wo(o,s){return o.all||s.all||Object.keys(o).some(function(f){return s[f]&&Fs(s[f],o[f])})}y(_t.prototype,((Yt={add:function(o){return Wr(this,o),this},addKey:function(o){return Vr(this,o,o),this},addKeys:function(o){var s=this;return o.forEach(function(f){return Vr(s,f,f)}),this},hasKey:function(o){var s=Pi(this).next(o).value;return s&&We(s.from,o)<=0&&0<=We(s.to,o)}})[ce]=function(){return Pi(this)},Yt));var zn={},Ho={},Yo=!1;function ji(o){Ti(Ho,o),Yo||(Yo=!0,setTimeout(function(){Yo=!1,Go(Ho,!(Ho={}))},0))}function Go(o,s){s===void 0&&(s=!1);var f=new Set;if(o.all)for(var p=0,b=Object.values(zn);p<b.length;p++)Ks(I=b[p],o,f,s);else for(var w in o){var I,T=/^idb\:\/\/(.*)\/(.*)\//.exec(w);T&&(w=T[1],T=T[2],(I=zn["idb://".concat(w,"/").concat(T)])&&Ks(I,o,f,s))}f.forEach(function(N){return N()})}function Ks(o,s,f,p){for(var b=[],w=0,I=Object.entries(o.queries.query);w<I.length;w++){for(var T=I[w],N=T[0],M=[],U=0,j=T[1];U<j.length;U++){var z=j[U];Wo(s,z.obsSet)?z.subscribers.forEach(function(q){return f.add(q)}):p&&M.push(z)}p&&b.push([N,M])}if(p)for(var L=0,F=b;L<F.length;L++){var K=F[L],N=K[0],M=K[1];o.queries.query[N]=M}}function Tf(o){var s=o._state,f=o._deps.indexedDB;if(s.isBeingOpened||o.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?lt(s.dbOpenError):o});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var p=s.openCanceller,b=Math.round(10*o.verno),w=!1;function I(){if(s.openCanceller!==p)throw new Se.DatabaseClosed("db.open() was cancelled")}function T(){return new _e(function(z,L){if(I(),!f)throw new Se.MissingAPI;var F=o.name,K=s.autoSchema||!b?f.open(F):f.open(F,b);if(!K)throw new Se.MissingAPI;K.onerror=an(L),K.onblocked=tt(o._fireOnBlocked),K.onupgradeneeded=tt(function(q){var J;U=K.transaction,s.autoSchema&&!o._options.allowEmptyDB?(K.onerror=Ur,U.abort(),K.result.close(),(J=f.deleteDatabase(F)).onsuccess=J.onerror=tt(function(){L(new Se.NoSuchDatabase("Database ".concat(F," doesnt exist")))})):(U.onerror=an(L),q=q.oldVersion>Math.pow(2,62)?0:q.oldVersion,j=q<1,o.idbdb=K.result,w&&Af(o,U),Cf(o,q/10,U,L))},L),K.onsuccess=tt(function(){U=null;var q,J,X,ee,re,le=o.idbdb=K.result,ye=S(le.objectStoreNames);if(0<ye.length)try{var ue=le.transaction((ee=ye).length===1?ee[0]:ee,"readonly");if(s.autoSchema)J=le,X=ue,(q=o).verno=J.version/10,X=q._dbSchema=Oi(0,J,X),q._storeNames=S(J.objectStoreNames,0),Ii(q,[q._allTables],l(X),X);else if(Ci(o,o._dbSchema,ue),((re=Fo(Oi(0,(re=o).idbdb,ue),re._dbSchema)).add.length||re.change.some(function(de){return de.add.length||de.change.length}))&&!w)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),le.close(),b=le.version+1,w=!0,z(T());Si(o,ue)}catch{}ir.push(o),le.onversionchange=tt(function(de){s.vcFired=!0,o.on("versionchange").fire(de)}),le.onclose=tt(function(de){o.on("close").fire(de)}),j&&(re=o._deps,ue=F,le=re.indexedDB,re=re.IDBKeyRange,Ko(le)||ue===bi||Bo(le,re).put({name:ue}).catch(ae)),z()},L)}).catch(function(z){switch(z==null?void 0:z.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),T();break;case"VersionError":if(0<b)return b=0,T()}return _e.reject(z)})}var N,M=s.dbReadyResolve,U=null,j=!1;return _e.race([p,(typeof navigator>"u"?_e.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(z){function L(){return indexedDB.databases().finally(z)}N=setInterval(L,100),L()}).finally(function(){return clearInterval(N)}):Promise.resolve()).then(T)]).then(function(){return I(),s.onReadyBeingFired=[],_e.resolve(zo(function(){return o.on.ready.fire(o.vip)})).then(function z(){if(0<s.onReadyBeingFired.length){var L=s.onReadyBeingFired.reduce(jt,ae);return s.onReadyBeingFired=[],_e.resolve(zo(function(){return L(o.vip)})).then(z)}})}).finally(function(){s.openCanceller===p&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(z){s.dbOpenError=z;try{U&&U.abort()}catch{}return p===s.openCanceller&&o._close(),lt(z)}).finally(function(){s.openComplete=!0,M()}).then(function(){var z;return j&&(z={},o.tables.forEach(function(L){L.schema.indexes.forEach(function(F){F.name&&(z["idb://".concat(o.name,"/").concat(L.name,"/").concat(F.name)]=new _t(-1/0,[[[]]]))}),z["idb://".concat(o.name,"/").concat(L.name,"/")]=z["idb://".concat(o.name,"/").concat(L.name,"/:dels")]=new _t(-1/0,[[[]]])}),Pn(Br).fire(z),Go(z,!0)),o})}function Jo(o){function s(w){return o.next(w)}var f=b(s),p=b(function(w){return o.throw(w)});function b(w){return function(N){var T=w(N),N=T.value;return T.done?N:N&&typeof N.then=="function"?N.then(f,p):c(N)?Promise.all(N).then(f,p):f(N)}}return b(s)()}function Di(o,s,f){for(var p=c(o)?o.slice():[o],b=0;b<f;++b)p.push(s);return p}var jf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(o){return r(r({},o),{table:function(s){var f=o.table(s),p=f.schema,b={},w=[];function I(j,z,L){var F=zr(j),K=b[F]=b[F]||[],q=j==null?0:typeof j=="string"?1:j.length,J=0<z,J=r(r({},L),{name:J?"".concat(F,"(virtual-from:").concat(L.name,")"):L.name,lowLevelIndex:L,isVirtual:J,keyTail:z,keyLength:q,extractKey:Mo(j),unique:!J&&L.unique});return K.push(J),J.isPrimaryKey||w.push(J),1<q&&I(q===2?j[0]:j.slice(0,q-1),z+1,L),K.sort(function(X,ee){return X.keyTail-ee.keyTail}),J}s=I(p.primaryKey.keyPath,0,p.primaryKey),b[":id"]=[s];for(var T=0,N=p.indexes;T<N.length;T++){var M=N[T];I(M.keyPath,0,M)}function U(j){var z,L=j.query.index;return L.isVirtual?r(r({},j),{query:{index:L.lowLevelIndex,range:(z=j.query.range,L=L.keyTail,{type:z.type===1?2:z.type,lower:Di(z.lower,z.lowerOpen?o.MAX_KEY:o.MIN_KEY,L),lowerOpen:!0,upper:Di(z.upper,z.upperOpen?o.MIN_KEY:o.MAX_KEY,L),upperOpen:!0})}}):j}return r(r({},f),{schema:r(r({},p),{primaryKey:s,indexes:w,getIndexByKeyPath:function(j){return(j=b[zr(j)])&&j[0]}}),count:function(j){return f.count(U(j))},query:function(j){return f.query(U(j))},openCursor:function(j){var z=j.query.index,L=z.keyTail,F=z.isVirtual,K=z.keyLength;return F?f.openCursor(U(j)).then(function(J){return J&&q(J)}):f.openCursor(j);function q(J){return Object.create(J,{continue:{value:function(X){X!=null?J.continue(Di(X,j.reverse?o.MAX_KEY:o.MIN_KEY,L)):j.unique?J.continue(J.key.slice(0,K).concat(j.reverse?o.MIN_KEY:o.MAX_KEY,L)):J.continue()}},continuePrimaryKey:{value:function(X,ee){J.continuePrimaryKey(Di(X,o.MAX_KEY,L),ee)}},primaryKey:{get:function(){return J.primaryKey}},key:{get:function(){var X=J.key;return K===1?X[0]:X.slice(0,K)}},value:{get:function(){return J.value}}})}}})}})}};function Qo(o,s,f,p){return f=f||{},p=p||"",l(o).forEach(function(b){var w,I,T;m(s,b)?(w=o[b],I=s[b],typeof w=="object"&&typeof I=="object"&&w&&I?(T=oe(w))!==oe(I)?f[p+b]=s[b]:T==="Object"?Qo(w,I,f,p+b+"."):w!==I&&(f[p+b]=s[b]):w!==I&&(f[p+b]=s[b])):f[p+b]=void 0}),l(s).forEach(function(b){m(o,b)||(f[p+b]=s[b])}),f}function Zo(o,s){return s.type==="delete"?s.keys:s.keys||s.values.map(o.extractKey)}var Df={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return r(r({},o),{table:function(s){var f=o.table(s),p=f.schema.primaryKey;return r(r({},f),{mutate:function(b){var w=Oe.trans,I=w.table(s).hook,T=I.deleting,N=I.creating,M=I.updating;switch(b.type){case"add":if(N.fire===ae)break;return w._promise("readwrite",function(){return U(b)},!0);case"put":if(N.fire===ae&&M.fire===ae)break;return w._promise("readwrite",function(){return U(b)},!0);case"delete":if(T.fire===ae)break;return w._promise("readwrite",function(){return U(b)},!0);case"deleteRange":if(T.fire===ae)break;return w._promise("readwrite",function(){return function j(z,L,F){return f.query({trans:z,values:!1,query:{index:p,range:L},limit:F}).then(function(K){var q=K.result;return U({type:"delete",keys:q,trans:z}).then(function(J){return 0<J.numFailures?Promise.reject(J.failures[0]):q.length<F?{failures:[],numFailures:0,lastResult:void 0}:j(z,r(r({},L),{lower:q[q.length-1],lowerOpen:!0}),F)})})}(b.trans,b.range,1e4)},!0)}return f.mutate(b);function U(j){var z,L,F,K=Oe.trans,q=j.keys||Zo(p,j);if(!q)throw new Error("Keys missing");return(j=j.type==="add"||j.type==="put"?r(r({},j),{keys:q}):r({},j)).type!=="delete"&&(j.values=i([],j.values)),j.keys&&(j.keys=i([],j.keys)),z=f,F=q,((L=j).type==="add"?Promise.resolve([]):z.getMany({trans:L.trans,keys:F,cache:"immutable"})).then(function(J){var X=q.map(function(ee,re){var le,ye,ue,de=J[re],ge={onerror:null,onsuccess:null};return j.type==="delete"?T.fire.call(ge,ee,de,K):j.type==="add"||de===void 0?(le=N.fire.call(ge,ee,j.values[re],K),ee==null&&le!=null&&(j.keys[re]=ee=le,p.outbound||W(j.values[re],p.keyPath,ee))):(le=Qo(de,j.values[re]),(ye=M.fire.call(ge,le,ee,de,K))&&(ue=j.values[re],Object.keys(ye).forEach(function(pe){m(ue,pe)?ue[pe]=ye[pe]:W(ue,pe,ye[pe])}))),ge});return f.mutate(j).then(function(ee){for(var re=ee.failures,le=ee.results,ye=ee.numFailures,ee=ee.lastResult,ue=0;ue<q.length;++ue){var de=(le||q)[ue],ge=X[ue];de==null?ge.onerror&&ge.onerror(re[ue]):ge.onsuccess&&ge.onsuccess(j.type==="put"&&J[ue]?j.values[ue]:de)}return{failures:re,results:le,numFailures:ye,lastResult:ee}}).catch(function(ee){return X.forEach(function(re){return re.onerror&&re.onerror(ee)}),Promise.reject(ee)})})}}})}})}};function zs(o,s,f){try{if(!s||s.keys.length<o.length)return null;for(var p=[],b=0,w=0;b<s.keys.length&&w<o.length;++b)We(s.keys[b],o[w])===0&&(p.push(f?H(s.values[b]):s.values[b]),++w);return p.length===o.length?p:null}catch{return null}}var Rf={stack:"dbcore",level:-1,create:function(o){return{table:function(s){var f=o.table(s);return r(r({},f),{getMany:function(p){if(!p.cache)return f.getMany(p);var b=zs(p.keys,p.trans._cache,p.cache==="clone");return b?_e.resolve(b):f.getMany(p).then(function(w){return p.trans._cache={keys:p.keys,values:p.cache==="clone"?H(w):w},w})},mutate:function(p){return p.type!=="add"&&(p.trans._cache=null),f.mutate(p)}})}}}};function Vs(o,s){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function Ws(o,s){switch(o){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Nf={stack:"dbcore",level:0,name:"Observability",create:function(o){var s=o.schema.name,f=new _t(o.MIN_KEY,o.MAX_KEY);return r(r({},o),{transaction:function(p,b,w){if(Oe.subscr&&b!=="readonly")throw new Se.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Oe.querier));return o.transaction(p,b,w)},table:function(p){var b=o.table(p),w=b.schema,I=w.primaryKey,j=w.indexes,T=I.extractKey,N=I.outbound,M=I.autoIncrement&&j.filter(function(L){return L.compound&&L.keyPath.includes(I.keyPath)}),U=r(r({},b),{mutate:function(L){function F(pe){return pe="idb://".concat(s,"/").concat(p,"/").concat(pe),ee[pe]||(ee[pe]=new _t)}var K,q,J,X=L.trans,ee=L.mutatedParts||(L.mutatedParts={}),re=F(""),le=F(":dels"),ye=L.type,ge=L.type==="deleteRange"?[L.range]:L.type==="delete"?[L.keys]:L.values.length<50?[Zo(I,L).filter(function(pe){return pe}),L.values]:[],ue=ge[0],de=ge[1],ge=L.trans._cache;return c(ue)?(re.addKeys(ue),(ge=ye==="delete"||ue.length===de.length?zs(ue,ge):null)||le.addKeys(ue),(ge||de)&&(K=F,q=ge,J=de,w.indexes.forEach(function(pe){var xe=K(pe.name||"");function Me(Ke){return Ke!=null?pe.extractKey(Ke):null}function Be(Ke){return pe.multiEntry&&c(Ke)?Ke.forEach(function(Nt){return xe.addKey(Nt)}):xe.addKey(Ke)}(q||J).forEach(function(Ke,wt){var Le=q&&Me(q[wt]),wt=J&&Me(J[wt]);We(Le,wt)!==0&&(Le!=null&&Be(Le),wt!=null&&Be(wt))})}))):ue?(de={from:(de=ue.lower)!==null&&de!==void 0?de:o.MIN_KEY,to:(de=ue.upper)!==null&&de!==void 0?de:o.MAX_KEY},le.add(de),re.add(de)):(re.add(f),le.add(f),w.indexes.forEach(function(pe){return F(pe.name).add(f)})),b.mutate(L).then(function(pe){return!ue||L.type!=="add"&&L.type!=="put"||(re.addKeys(pe.results),M&&M.forEach(function(xe){for(var Me=L.values.map(function(Le){return xe.extractKey(Le)}),Be=xe.keyPath.findIndex(function(Le){return Le===I.keyPath}),Ke=0,Nt=pe.results.length;Ke<Nt;++Ke)Me[Ke][Be]=pe.results[Ke];F(xe.name).addKeys(Me)})),X.mutatedParts=Ti(X.mutatedParts||{},ee),pe})}}),j=function(F){var K=F.query,F=K.index,K=K.range;return[F,new _t((F=K.lower)!==null&&F!==void 0?F:o.MIN_KEY,(K=K.upper)!==null&&K!==void 0?K:o.MAX_KEY)]},z={get:function(L){return[I,new _t(L.key)]},getMany:function(L){return[I,new _t().addKeys(L.keys)]},count:j,query:j,openCursor:j};return l(z).forEach(function(L){U[L]=function(F){var K=Oe.subscr,q=!!K,J=Vs(Oe,b)&&Ws(L,F)?F.obsSet={}:K;if(q){var X=function(de){return de="idb://".concat(s,"/").concat(p,"/").concat(de),J[de]||(J[de]=new _t)},ee=X(""),re=X(":dels"),K=z[L](F),q=K[0],K=K[1];if((L==="query"&&q.isPrimaryKey&&!F.values?re:X(q.name||"")).add(K),!q.isPrimaryKey){if(L!=="count"){var le=L==="query"&&N&&F.values&&b.query(r(r({},F),{values:!1}));return b[L].apply(this,arguments).then(function(de){if(L==="query"){if(N&&F.values)return le.then(function(Me){return Me=Me.result,ee.addKeys(Me),de});var ge=F.values?de.result.map(T):de.result;(F.values?ee:re).addKeys(ge)}else if(L==="openCursor"){var pe=de,xe=F.values;return pe&&Object.create(pe,{key:{get:function(){return re.addKey(pe.primaryKey),pe.key}},primaryKey:{get:function(){var Me=pe.primaryKey;return re.addKey(Me),Me}},value:{get:function(){return xe&&ee.addKey(pe.primaryKey),pe.value}}})}return de})}re.add(f)}}return b[L].apply(this,arguments)}}),U}})}};function Hs(o,s,f){if(f.numFailures===0)return s;if(s.type==="deleteRange")return null;var p=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1;return f.numFailures===p?null:(s=r({},s),c(s.keys)&&(s.keys=s.keys.filter(function(b,w){return!(w in f.failures)})),"values"in s&&c(s.values)&&(s.values=s.values.filter(function(b,w){return!(w in f.failures)})),s)}function Xo(o,s){return f=o,((p=s).lower===void 0||(p.lowerOpen?0<We(f,p.lower):0<=We(f,p.lower)))&&(o=o,(s=s).upper===void 0||(s.upperOpen?We(o,s.upper)<0:We(o,s.upper)<=0));var f,p}function Ys(o,s,z,p,b,w){if(!z||z.length===0)return o;var I=s.query.index,T=I.multiEntry,N=s.query.range,M=p.schema.primaryKey.extractKey,U=I.extractKey,j=(I.lowLevelIndex||I).extractKey,z=z.reduce(function(L,F){var K=L,q=[];if(F.type==="add"||F.type==="put")for(var J=new _t,X=F.values.length-1;0<=X;--X){var ee,re=F.values[X],le=M(re);J.hasKey(le)||(ee=U(re),(T&&c(ee)?ee.some(function(pe){return Xo(pe,N)}):Xo(ee,N))&&(J.addKey(le),q.push(re)))}switch(F.type){case"add":var ye=new _t().addKeys(s.values?L.map(function(xe){return M(xe)}):L),K=L.concat(s.values?q.filter(function(xe){return xe=M(xe),!ye.hasKey(xe)&&(ye.addKey(xe),!0)}):q.map(function(xe){return M(xe)}).filter(function(xe){return!ye.hasKey(xe)&&(ye.addKey(xe),!0)}));break;case"put":var ue=new _t().addKeys(F.values.map(function(xe){return M(xe)}));K=L.filter(function(xe){return!ue.hasKey(s.values?M(xe):xe)}).concat(s.values?q:q.map(function(xe){return M(xe)}));break;case"delete":var de=new _t().addKeys(F.keys);K=L.filter(function(xe){return!de.hasKey(s.values?M(xe):xe)});break;case"deleteRange":var ge=F.range;K=L.filter(function(xe){return!Xo(M(xe),ge)})}return K},o);return z===o?o:(z.sort(function(L,F){return We(j(L),j(F))||We(M(L),M(F))}),s.limit&&s.limit<1/0&&(z.length>s.limit?z.length=s.limit:o.length===s.limit&&z.length<s.limit&&(b.dirty=!0)),w?Object.freeze(z):z)}function Gs(o,s){return We(o.lower,s.lower)===0&&We(o.upper,s.upper)===0&&!!o.lowerOpen==!!s.lowerOpen&&!!o.upperOpen==!!s.upperOpen}function Lf(o,s){return function(f,p,b,w){if(f===void 0)return p!==void 0?-1:0;if(p===void 0)return 1;if((p=We(f,p))===0){if(b&&w)return 0;if(b)return 1;if(w)return-1}return p}(o.lower,s.lower,o.lowerOpen,s.lowerOpen)<=0&&0<=function(f,p,b,w){if(f===void 0)return p!==void 0?1:0;if(p===void 0)return-1;if((p=We(f,p))===0){if(b&&w)return 0;if(b)return-1;if(w)return 1}return p}(o.upper,s.upper,o.upperOpen,s.upperOpen)}function Mf(o,s,f,p){o.subscribers.add(f),p.addEventListener("abort",function(){var b,w;o.subscribers.delete(f),o.subscribers.size===0&&(b=o,w=s,setTimeout(function(){b.subscribers.size===0&&Re(w,b)},3e3))})}var qf={stack:"dbcore",level:0,name:"Cache",create:function(o){var s=o.schema.name;return r(r({},o),{transaction:function(f,p,b){var w,I,T=o.transaction(f,p,b);return p==="readwrite"&&(I=(w=new AbortController).signal,b=function(N){return function(){if(w.abort(),p==="readwrite"){for(var M=new Set,U=0,j=f;U<j.length;U++){var z=j[U],L=zn["idb://".concat(s,"/").concat(z)];if(L){var F=o.table(z),K=L.optimisticOps.filter(function(xe){return xe.trans===T});if(T._explicit&&N&&T.mutatedParts)for(var q=0,J=Object.values(L.queries.query);q<J.length;q++)for(var X=0,ee=(ye=J[q]).slice();X<ee.length;X++)Wo((ue=ee[X]).obsSet,T.mutatedParts)&&(Re(ye,ue),ue.subscribers.forEach(function(xe){return M.add(xe)}));else if(0<K.length){L.optimisticOps=L.optimisticOps.filter(function(xe){return xe.trans!==T});for(var re=0,le=Object.values(L.queries.query);re<le.length;re++)for(var ye,ue,de,ge=0,pe=(ye=le[re]).slice();ge<pe.length;ge++)(ue=pe[ge]).res!=null&&T.mutatedParts&&(N&&!ue.dirty?(de=Object.isFrozen(ue.res),de=Ys(ue.res,ue.req,K,F,ue,de),ue.dirty?(Re(ye,ue),ue.subscribers.forEach(function(xe){return M.add(xe)})):de!==ue.res&&(ue.res=de,ue.promise=_e.resolve({result:de}))):(ue.dirty&&Re(ye,ue),ue.subscribers.forEach(function(xe){return M.add(xe)})))}}}M.forEach(function(xe){return xe()})}}},T.addEventListener("abort",b(!1),{signal:I}),T.addEventListener("error",b(!1),{signal:I}),T.addEventListener("complete",b(!0),{signal:I})),T},table:function(f){var p=o.table(f),b=p.schema.primaryKey;return r(r({},p),{mutate:function(w){var I=Oe.trans;if(b.outbound||I.db._options.cache==="disabled"||I.explicit||I.idbtrans.mode!=="readwrite")return p.mutate(w);var T=zn["idb://".concat(s,"/").concat(f)];return T?(I=p.mutate(w),w.type!=="add"&&w.type!=="put"||!(50<=w.values.length||Zo(b,w).some(function(N){return N==null}))?(T.optimisticOps.push(w),w.mutatedParts&&ji(w.mutatedParts),I.then(function(N){0<N.numFailures&&(Re(T.optimisticOps,w),(N=Hs(0,w,N))&&T.optimisticOps.push(N),w.mutatedParts&&ji(w.mutatedParts))}),I.catch(function(){Re(T.optimisticOps,w),w.mutatedParts&&ji(w.mutatedParts)})):I.then(function(N){var M=Hs(0,r(r({},w),{values:w.values.map(function(U,j){var z;return N.failures[j]?U:(U=(z=b.keyPath)!==null&&z!==void 0&&z.includes(".")?H(U):r({},U),W(U,b.keyPath,N.results[j]),U)})}),N);T.optimisticOps.push(M),queueMicrotask(function(){return w.mutatedParts&&ji(w.mutatedParts)})}),I):p.mutate(w)},query:function(w){if(!Vs(Oe,p)||!Ws("query",w))return p.query(w);var I=((M=Oe.trans)===null||M===void 0?void 0:M.db._options.cache)==="immutable",j=Oe,T=j.requery,N=j.signal,M=function(F,K,q,J){var X=zn["idb://".concat(F,"/").concat(K)];if(!X)return[];if(!(K=X.queries[q]))return[null,!1,X,null];var ee=K[(J.query?J.query.index.name:null)||""];if(!ee)return[null,!1,X,null];switch(q){case"query":var re=ee.find(function(le){return le.req.limit===J.limit&&le.req.values===J.values&&Gs(le.req.query.range,J.query.range)});return re?[re,!0,X,ee]:[ee.find(function(le){return("limit"in le.req?le.req.limit:1/0)>=J.limit&&(!J.values||le.req.values)&&Lf(le.req.query.range,J.query.range)}),!1,X,ee];case"count":return re=ee.find(function(le){return Gs(le.req.query.range,J.query.range)}),[re,!!re,X,ee]}}(s,f,"query",w),U=M[0],j=M[1],z=M[2],L=M[3];return U&&j?U.obsSet=w.obsSet:(j=p.query(w).then(function(F){var K=F.result;if(U&&(U.res=K),I){for(var q=0,J=K.length;q<J;++q)Object.freeze(K[q]);Object.freeze(K)}else F.result=H(K);return F}).catch(function(F){return L&&U&&Re(L,U),Promise.reject(F)}),U={obsSet:w.obsSet,promise:j,subscribers:new Set,type:"query",req:w,dirty:!1},L?L.push(U):(L=[U],(z=z||(zn["idb://".concat(s,"/").concat(f)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[w.query.index.name||""]=L)),Mf(U,L,T,N),U.promise.then(function(F){return{result:Ys(F.result,w,z==null?void 0:z.optimisticOps,p,U,I)}})}})}})}};function Ri(o,s){return new Proxy(o,{get:function(f,p,b){return p==="db"?s:Reflect.get(f,p,b)}})}var pn=(ut.prototype.version=function(o){if(isNaN(o)||o<.1)throw new Se.Type("Given version is not a positive number");if(o=Math.round(10*o)/10,this.idbdb||this._state.isBeingOpened)throw new Se.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,o);var s=this._versions,f=s.filter(function(p){return p._cfg.version===o})[0];return f||(f=new this.Version(o),s.push(f),s.sort(Of),f.stores({}),this._state.autoSchema=!1,f)},ut.prototype._whenReady=function(o){var s=this;return this.idbdb&&(this._state.openComplete||Oe.letThrough||this._vip)?o():new _e(function(f,p){if(s._state.openComplete)return p(new Se.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void p(new Se.DatabaseClosed);s.open().catch(ae)}s._state.dbReadyPromise.then(f,p)}).then(o)},ut.prototype.use=function(o){var s=o.stack,f=o.create,p=o.level,b=o.name;return b&&this.unuse({stack:s,name:b}),o=this._middlewares[s]||(this._middlewares[s]=[]),o.push({stack:s,create:f,level:p??10,name:b}),o.sort(function(w,I){return w.level-I.level}),this},ut.prototype.unuse=function(o){var s=o.stack,f=o.name,p=o.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(b){return p?b.create!==p:!!f&&b.name!==f})),this},ut.prototype.open=function(){var o=this;return Un(Vt,function(){return Tf(o)})},ut.prototype._close=function(){var o=this._state,s=ir.indexOf(this);if(0<=s&&ir.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}o.isBeingOpened||(o.dbReadyPromise=new _e(function(f){o.dbReadyResolve=f}),o.openCanceller=new _e(function(f,p){o.cancelOpen=p}))},ut.prototype.close=function(f){var s=(f===void 0?{disableAutoOpen:!0}:f).disableAutoOpen,f=this._state;s?(f.isBeingOpened&&f.cancelOpen(new Se.DatabaseClosed),this._close(),f.autoOpen=!1,f.dbOpenError=new Se.DatabaseClosed):(this._close(),f.autoOpen=this._options.autoOpen||f.isBeingOpened,f.openComplete=!1,f.dbOpenError=null)},ut.prototype.delete=function(o){var s=this;o===void 0&&(o={disableAutoOpen:!0});var f=0<arguments.length&&typeof arguments[0]!="object",p=this._state;return new _e(function(b,w){function I(){s.close(o);var T=s._deps.indexedDB.deleteDatabase(s.name);T.onsuccess=tt(function(){var N,M,U;N=s._deps,M=s.name,U=N.indexedDB,N=N.IDBKeyRange,Ko(U)||M===bi||Bo(U,N).delete(M).catch(ae),b()}),T.onerror=an(w),T.onblocked=s._fireOnBlocked}if(f)throw new Se.InvalidArgument("Invalid closeOptions argument to db.delete()");p.isBeingOpened?p.dbReadyPromise.then(I):I()})},ut.prototype.backendDB=function(){return this.idbdb},ut.prototype.isOpen=function(){return this.idbdb!==null},ut.prototype.hasBeenClosed=function(){var o=this._state.dbOpenError;return o&&o.name==="DatabaseClosed"},ut.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ut.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ut.prototype,"tables",{get:function(){var o=this;return l(this._allTables).map(function(s){return o._allTables[s]})},enumerable:!1,configurable:!0}),ut.prototype.transaction=function(){var o=(function(s,f,p){var b=arguments.length;if(b<2)throw new Se.InvalidArgument("Too few arguments");for(var w=new Array(b-1);--b;)w[b-1]=arguments[b];return p=w.pop(),[s,Y(w),p]}).apply(this,arguments);return this._transaction.apply(this,o)},ut.prototype._transaction=function(o,s,f){var p=this,b=Oe.trans;b&&b.db===this&&o.indexOf("!")===-1||(b=null);var w,I,T=o.indexOf("?")!==-1;o=o.replace("!","").replace("?","");try{if(I=s.map(function(M){if(M=M instanceof p.Table?M.name:M,typeof M!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return M}),o=="r"||o===Ao)w=Ao;else{if(o!="rw"&&o!=Po)throw new Se.InvalidArgument("Invalid transaction mode: "+o);w=Po}if(b){if(b.mode===Ao&&w===Po){if(!T)throw new Se.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");b=null}b&&I.forEach(function(M){if(b&&b.storeNames.indexOf(M)===-1){if(!T)throw new Se.SubTransaction("Table "+M+" not included in parent transaction.");b=null}}),T&&b&&!b.active&&(b=null)}}catch(M){return b?b._promise(null,function(U,j){j(M)}):lt(M)}var N=(function M(U,j,z,L,F){return _e.resolve().then(function(){var K=Oe.transless||Oe,q=U._createTransaction(j,z,U._dbSchema,L);if(q.explicit=!0,K={trans:q,transless:K},L)q.idbtrans=L.idbtrans;else try{q.create(),q.idbtrans._explicit=!0,U._state.PR1398_maxLoop=3}catch(ee){return ee.name===St.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return M(U,j,z,null,F)})):lt(ee)}var J,X=Ne(F);return X&&On(),K=_e.follow(function(){var ee;(J=F.call(q,q))&&(X?(ee=It.bind(null,null),J.then(ee,ee)):typeof J.next=="function"&&typeof J.throw=="function"&&(J=Jo(J)))},K),(J&&typeof J.then=="function"?_e.resolve(J).then(function(ee){return q.active?ee:lt(new Se.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):K.then(function(){return J})).then(function(ee){return L&&q._resolve(),q._completion.then(function(){return ee})}).catch(function(ee){return q._reject(ee),lt(ee)})})}).bind(null,this,w,I,b,f);return b?b._promise(w,N,"lock"):Oe.trans?Un(Oe.transless,function(){return p._whenReady(N)}):this._whenReady(N)},ut.prototype.table=function(o){if(!m(this._allTables,o))throw new Se.InvalidTable("Table ".concat(o," does not exist"));return this._allTables[o]},ut);function ut(o,s){var f=this;this._middlewares={},this.verno=0;var p=ut.dependencies;this._options=s=r({addons:ut.addons,autoOpen:!0,indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},p=s.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var b,w,I,T,N,M={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ae,dbReadyPromise:null,cancelOpen:ae,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen};M.dbReadyPromise=new _e(function(j){M.dbReadyResolve=j}),M.openCanceller=new _e(function(j,z){M.cancelOpen=z}),this._state=M,this.name=o,this.on=Mr(this,"populate","blocked","versionchange","close",{ready:[jt,ae]}),this.on.ready.subscribe=x(this.on.ready.subscribe,function(j){return function(z,L){ut.vip(function(){var F,K=f._state;K.openComplete?(K.dbOpenError||_e.resolve().then(z),L&&j(z)):K.onReadyBeingFired?(K.onReadyBeingFired.push(z),L&&j(z)):(j(z),F=f,L||j(function q(){F.on.ready.unsubscribe(z),F.on.ready.unsubscribe(q)}))})}}),this.Collection=(b=this,qr(_f.prototype,function(J,q){this.db=b;var L=Is,F=null;if(q)try{L=q()}catch(X){F=X}var K=J._ctx,q=K.table,J=q.hook.reading.fire;this._ctx={table:q,index:K.index,isPrimKey:!K.index||q.schema.primKey.keyPath&&K.index===q.schema.primKey.name,range:L,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:F,or:K.or,valueMapper:J!==we?J:null}})),this.Table=(w=this,qr(As.prototype,function(j,z,L){this.db=w,this._tx=L,this.name=j,this.schema=z,this.hook=w._allTables[j]?w._allTables[j].hook:Mr(null,{creating:[Bt,ae],reading:[Ae,we],updating:[Ct,ae],deleting:[Tt,ae]})})),this.Transaction=(I=this,qr(xf.prototype,function(j,z,L,F,K){var q=this;this.db=I,this.mode=j,this.storeNames=z,this.schema=L,this.chromeTransactionDurability=F,this.idbtrans=null,this.on=Mr(this,"complete","error","abort"),this.parent=K||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new _e(function(J,X){q._resolve=J,q._reject=X}),this._completion.then(function(){q.active=!1,q.on.complete.fire()},function(J){var X=q.active;return q.active=!1,q.on.error.fire(J),q.parent?q.parent._reject(J):X&&q.idbtrans&&q.idbtrans.abort(),lt(J)})})),this.Version=(T=this,qr(Pf.prototype,function(j){this.db=T,this._cfg={version:j,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(N=this,qr(Rs.prototype,function(j,z,L){if(this.db=N,this._ctx={table:j,index:z===":id"?null:z,or:L},this._cmp=this._ascending=We,this._descending=function(F,K){return We(K,F)},this._max=function(F,K){return 0<We(F,K)?F:K},this._min=function(F,K){return We(F,K)<0?F:K},this._IDBKeyRange=N._deps.IDBKeyRange,!this._IDBKeyRange)throw new Se.MissingAPI})),this.on("versionchange",function(j){0<j.newVersion?console.warn("Another connection wants to upgrade database '".concat(f.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(f.name,"'. Closing db now to resume the delete request.")),f.close({disableAutoOpen:!1})}),this.on("blocked",function(j){!j.newVersion||j.newVersion<j.oldVersion?console.warn("Dexie.delete('".concat(f.name,"') was blocked")):console.warn("Upgrade '".concat(f.name,"' blocked by other connection holding version ").concat(j.oldVersion/10))}),this._maxKey=Kr(s.IDBKeyRange),this._createTransaction=function(j,z,L,F){return new f.Transaction(j,z,L,f._options.chromeTransactionDurability,F)},this._fireOnBlocked=function(j){f.on("blocked").fire(j),ir.filter(function(z){return z.name===f.name&&z!==f&&!z._state.vcFired}).map(function(z){return z.on("versionchange").fire(j)})},this.use(Rf),this.use(qf),this.use(Nf),this.use(jf),this.use(Df);var U=new Proxy(this,{get:function(j,z,L){if(z==="_vip")return!0;if(z==="table")return function(K){return Ri(f.table(K),U)};var F=Reflect.get(j,z,L);return F instanceof As?Ri(F,U):z==="tables"?F.map(function(K){return Ri(K,U)}):z==="_createTransaction"?function(){return Ri(F.apply(this,arguments),U)}:F}});this.vip=U,p.forEach(function(j){return j(f)})}var Ni,Yt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ff=($o.prototype.subscribe=function(o,s,f){return this._subscribe(o&&typeof o!="function"?o:{next:o,error:s,complete:f})},$o.prototype[Yt]=function(){return this},$o);function $o(o){this._subscribe=o}try{Ni={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Ni={indexedDB:null,IDBKeyRange:null}}function Js(o){var s,f=!1,p=new Ff(function(b){var w=Ne(o),I,T=!1,N={},M={},U={get closed(){return T},unsubscribe:function(){T||(T=!0,I&&I.abort(),j&&Pn.storagemutated.unsubscribe(L))}};b.start&&b.start(U);var j=!1,z=function(){return Co(F)},L=function(K){Ti(N,K),Wo(M,N)&&z()},F=function(){var K,q,J;!T&&Ni.indexedDB&&(N={},K={},I&&I.abort(),I=new AbortController,J=function(X){var ee=En();try{w&&On();var re=on(o,X);return re=w?re.finally(It):re}finally{ee&&Dt()}}(q={subscr:K,signal:I.signal,requery:z,querier:o,trans:null}),Promise.resolve(J).then(function(X){f=!0,s=X,T||q.signal.aborted||(N={},function(ee){for(var re in ee)if(m(ee,re))return;return 1}(M=K)||j||(Pn(Br,L),j=!0),Co(function(){return!T&&b.next&&b.next(X)}))},function(X){f=!1,["DatabaseClosedError","AbortError"].includes(X==null?void 0:X.name)||T||Co(function(){T||b.error&&b.error(X)})}))};return setTimeout(z,0),U});return p.hasValue=function(){return f},p.getValue=function(){return s},p}var Vn=pn;function ea(o){var s=Tn;try{Tn=!0,Pn.storagemutated.fire(o),Go(o,!0)}finally{Tn=s}}y(Vn,r(r({},ie),{delete:function(o){return new Vn(o,{addons:[]}).delete()},exists:function(o){return new Vn(o,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return s=Vn.dependencies,f=s.indexedDB,s=s.IDBKeyRange,(Ko(f)?Promise.resolve(f.databases()).then(function(p){return p.map(function(b){return b.name}).filter(function(b){return b!==bi})}):Bo(f,s).toCollection().primaryKeys()).then(o)}catch{return lt(new Se.MissingAPI)}var s,f},defineClass:function(){return function(o){d(this,o)}},ignoreTransaction:function(o){return Oe.trans?Un(Oe.transless,o):o()},vip:zo,async:function(o){return function(){try{var s=Jo(o.apply(this,arguments));return s&&typeof s.then=="function"?s:_e.resolve(s)}catch(f){return lt(f)}}},spawn:function(o,s,f){try{var p=Jo(o.apply(f,s||[]));return p&&typeof p.then=="function"?p:_e.resolve(p)}catch(b){return lt(b)}},currentTransaction:{get:function(){return Oe.trans||null}},waitFor:function(o,s){return s=_e.resolve(typeof o=="function"?Vn.ignoreTransaction(o):o).timeout(s||6e4),Oe.trans?Oe.trans.waitFor(s):s},Promise:_e,debug:{get:function(){return at},set:function(o){vt(o)}},derive:k,extend:d,props:y,override:x,Events:Mr,on:Pn,liveQuery:Js,extendObservabilitySet:Ti,getByKeyPath:R,setByKeyPath:W,delByKeyPath:function(o,s){typeof s=="string"?W(o,s,void 0):"length"in s&&[].map.call(s,function(f){W(o,f,void 0)})},shallowClone:Z,deepClone:H,getObjectDiff:Qo,cmp:We,asap:D,minKey:-1/0,addons:[],connections:ir,errnames:St,dependencies:Ni,cache:zn,semVer:"4.0.11",version:"4.0.11".split(".").map(function(o){return parseInt(o)}).reduce(function(o,s,f){return o+s/Math.pow(10,2*f)})})),Vn.maxKey=Kr(Vn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Pn(Br,function(o){Tn||(o=new CustomEvent(Ro,{detail:o}),Tn=!0,dispatchEvent(o),Tn=!1)}),addEventListener(Ro,function(o){o=o.detail,Tn||ea(o)}));var sr,Tn=!1,Qs=function(){};return typeof BroadcastChannel<"u"&&((Qs=function(){(sr=new BroadcastChannel(Ro)).onmessage=function(o){return o.data&&ea(o.data)}})(),typeof sr.unref=="function"&&sr.unref(),Pn(Br,function(o){Tn||sr.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!pn.disableBfCache&&o.persisted){at&&console.debug("Dexie: handling persisted pagehide"),sr!=null&&sr.close();for(var s=0,f=ir;s<f.length;s++)f[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(o){!pn.disableBfCache&&o.persisted&&(at&&console.debug("Dexie: handling persisted pageshow"),Qs(),ea({all:new _t(-1/0,[[]])}))})),_e.rejectionMapper=function(o,s){return!o||o instanceof qe||o instanceof TypeError||o instanceof SyntaxError||!o.name||!Ie[o.name]?o:(s=new Ie[o.name](s||o.message,o),"stack"in o&&_(s,"stack",{get:function(){return this.inner.stack}}),s)},vt(at),r(pn,Object.freeze({__proto__:null,Dexie:pn,liveQuery:Js,Entity:Es,cmp:We,PropModification:Fr,replacePrefix:function(o,s){return new Fr({replacePrefix:[o,s]})},add:function(o){return new Fr({add:o})},remove:function(o){return new Fr({remove:o})},default:pn,RangeSet:_t,mergeRanges:Wr,rangesOverlap:Fs}),{default:pn}),pn})}(Ji)),Ji.exports}var th=eh();const Aa=Xv(th),_l=Symbol.for("Dexie"),st=globalThis[_l]||(globalThis[_l]=Aa);if(Aa.semVer!==st.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Aa.semVer} and ${st.semVer}`);const{liveQuery:fr,mergeRanges:Bb,rangesOverlap:Kb,RangeSet:zb,cmp:nh,Entity:Vb,PropModification:wl,replacePrefix:Wb,add:Hb,remove:Yb}=st;var Pa=function(e,t){return Pa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Pa(e,t)};function xn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Pa(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function rh(e,t,n,r){function i(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function c(u){try{h(r.next(u))}catch(m){l(m)}}function d(u){try{h(r.throw(u))}catch(m){l(m)}}function h(u){u.done?a(u.value):i(u.value).then(c,d)}h((r=r.apply(e,t||[])).next())})}function Ju(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(h){return function(u){return d([h,u])}}function d(h){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,h[0]&&(n=0)),n;)try{if(r=1,i&&(a=h[0]&2?i.return:h[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,h[1])).done)return a;switch(i=0,a&&(h=[h[0]&2,a.value]),h[0]){case 0:case 1:a=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,i=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){n.label=h[1];break}if(h[0]===6&&n.label<a[1]){n.label=a[1],a=h;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(h);break}a[2]&&n.ops.pop(),n.trys.pop();continue}h=t.call(e,n)}catch(u){h=[6,u],i=0}finally{r=a=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function wr(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qn(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],l;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){l={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(l)throw l.error}}return a}function kr(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function dr(e){return this instanceof dr?(this.v=e,this):new dr(e)}function ih(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(g){return function(_){return Promise.resolve(_).then(g,m)}}function c(g,_){r[g]&&(i[g]=function(k){return new Promise(function(E,A){a.push([g,k,E,A])>1||d(g,k)})},_&&(i[g]=_(i[g])))}function d(g,_){try{h(r[g](_))}catch(k){y(a[0][3],k)}}function h(g){g.value instanceof dr?Promise.resolve(g.value.v).then(u,m):y(a[0][2],g)}function u(g){d("next",g)}function m(g){d("throw",g)}function y(g,_){g(_),a.shift(),a.length&&d(a[0][0],a[0][1])}}function oh(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof wr=="function"?wr(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=e[a]&&function(l){return new Promise(function(c,d){l=e[a](l),i(c,d,l.done,l.value)})}}function i(a,l,c,d){Promise.resolve(d).then(function(h){a({value:h,done:c})},l)}}function Xe(e){return typeof e=="function"}function os(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var da=os(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function no(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Ar=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,i,a;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var c=wr(l),d=c.next();!d.done;d=c.next()){var h=d.value;h.remove(this)}}catch(k){t={error:k}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}else l.remove(this);var u=this.initialTeardown;if(Xe(u))try{u()}catch(k){a=k instanceof da?k.errors:[k]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var y=wr(m),g=y.next();!g.done;g=y.next()){var _=g.value;try{kl(_)}catch(k){a=a??[],k instanceof da?a=kr(kr([],Qn(a)),Qn(k.errors)):a.push(k)}}}catch(k){r={error:k}}finally{try{g&&!g.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}}if(a)throw new da(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)kl(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&no(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&no(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Qu=Ar.EMPTY;function Zu(e){return e instanceof Ar||e&&"closed"in e&&Xe(e.remove)&&Xe(e.add)&&Xe(e.unsubscribe)}function kl(e){Xe(e)?e():e.unsubscribe()}var ah={Promise:void 0},sh={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,kr([e,t],Qn(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Xu(e){sh.setTimeout(function(){throw e})}function xl(){}function Qi(e){e()}var as=function(e){xn(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Zu(n)&&n.add(r)):r.destination=ch,r}return t.create=function(n,r,i){return new xr(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Ar),lh=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Mi(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Mi(r)}else Mi(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Mi(n)}},e}(),xr=function(e){xn(t,e);function t(n,r,i){var a=e.call(this)||this,l;return Xe(n)||!n?l={next:n??void 0,error:r??void 0,complete:i??void 0}:l=n,a.destination=new lh(l),a}return t}(as);function Mi(e){Xu(e)}function uh(e){throw e}var ch={closed:!0,next:xl,error:uh,complete:xl},ss=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function mo(e){return e}function fh(e){return e.length===0?mo:e.length===1?e[0]:function(n){return e.reduce(function(r,i){return i(r)},n)}}var yt=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i=this,a=vh(t)?t:new xr(t,n,r);return Qi(function(){var l=i,c=l.operator,d=l.source;a.add(c?c.call(a,d):d?i._subscribe(a):i._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=Sl(n),new n(function(i,a){var l=new xr({next:function(c){try{t(c)}catch(d){a(d),l.unsubscribe()}},error:a,complete:i});r.subscribe(l)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[ss]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return fh(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=Sl(t),new t(function(r,i){var a;n.subscribe(function(l){return a=l},function(l){return i(l)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function Sl(e){var t;return(t=e??ah.Promise)!==null&&t!==void 0?t:Promise}function dh(e){return e&&Xe(e.next)&&Xe(e.error)&&Xe(e.complete)}function vh(e){return e&&e instanceof as||dh(e)&&Zu(e)}function hh(e){return Xe(e==null?void 0:e.lift)}function Pr(e){return function(t){if(hh(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Sr(e,t,n,r,i){return new ph(e,t,n,r,i)}var ph=function(e){xn(t,e);function t(n,r,i,a,l,c){var d=e.call(this,n)||this;return d.onFinalize=l,d.shouldUnsubscribe=c,d._next=r?function(h){try{r(h)}catch(u){n.error(u)}}:e.prototype._next,d._error=a?function(h){try{a(h)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,d._complete=i?function(){try{i()}catch(h){n.error(h)}finally{this.unsubscribe()}}:e.prototype._complete,d}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(as),yh=os(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),vi=function(e){xn(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new Il(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new yh},t.prototype.next=function(n){var r=this;Qi(function(){var i,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var l=wr(r.currentObservers),c=l.next();!c.done;c=l.next()){var d=c.value;d.next(n)}}catch(h){i={error:h}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}})},t.prototype.error=function(n){var r=this;Qi(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},t.prototype.complete=function(){var n=this;Qi(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,i=this,a=i.hasError,l=i.isStopped,c=i.observers;return a||l?Qu:(this.currentObservers=null,c.push(n),new Ar(function(){r.currentObservers=null,no(c,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,a=r.thrownError,l=r.isStopped;i?n.error(a):l&&n.complete()},t.prototype.asObservable=function(){var n=new yt;return n.source=this,n},t.create=function(n,r){return new Il(n,r)},t}(yt),Il=function(e){xn(t,e);function t(n,r){var i=e.call(this)||this;return i.destination=n,i.source=r,i}return t.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},t.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:Qu},t}(vi),$t=function(e){xn(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,a=n._value;if(r)throw i;return this._throwIfClosed(),a},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(vi),mh={now:function(){return Date.now()}},gh=function(e){xn(t,e);function t(n,r){return e.call(this)||this}return t.prototype.schedule=function(n,r){return this},t}(Ar),El={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,kr([e,t],Qn(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},bh=function(e){xn(t,e);function t(n,r){var i=e.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return t.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var a=this.id,l=this.scheduler;return a!=null&&(this.id=this.recycleAsyncId(l,a,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(l,this.id,r),this},t.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),El.setInterval(n.flush.bind(n,this),i)},t.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&El.clearInterval(r)},t.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(n,r){var i=!1,a;try{this.work(n)}catch(l){i=!0,a=l||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),a},t.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,a=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,no(a,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(gh),Ol=function(){function e(t,n){n===void 0&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(t,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,t).schedule(r,n)},e.now=mh.now,e}(),_h=function(e){xn(t,e);function t(n,r){r===void 0&&(r=Ol.now);var i=e.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return t.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},t}(Ol),wh=new _h(bh),kh=wh,xh=new yt(function(e){return e.complete()});function Sh(e){return e&&Xe(e.schedule)}function ls(e){return e[e.length-1]}function Ih(e){return Xe(ls(e))?e.pop():void 0}function us(e){return Sh(ls(e))?e.pop():void 0}function Eh(e,t){return typeof ls(e)=="number"?e.pop():t}var cs=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function $u(e){return Xe(e==null?void 0:e.then)}function ec(e){return Xe(e[ss])}function tc(e){return Symbol.asyncIterator&&Xe(e==null?void 0:e[Symbol.asyncIterator])}function nc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Oh(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var rc=Oh();function ic(e){return Xe(e==null?void 0:e[rc])}function oc(e){return ih(this,arguments,function(){var n,r,i,a;return Ju(this,function(l){switch(l.label){case 0:n=e.getReader(),l.label=1;case 1:l.trys.push([1,,9,10]),l.label=2;case 2:return[4,dr(n.read())];case 3:return r=l.sent(),i=r.value,a=r.done,a?[4,dr(void 0)]:[3,5];case 4:return[2,l.sent()];case 5:return[4,dr(i)];case 6:return[4,l.sent()];case 7:return l.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function ac(e){return Xe(e==null?void 0:e.getReader)}function Sn(e){if(e instanceof yt)return e;if(e!=null){if(ec(e))return Ch(e);if(cs(e))return Ah(e);if($u(e))return Ph(e);if(tc(e))return sc(e);if(ic(e))return Th(e);if(ac(e))return jh(e)}throw nc(e)}function Ch(e){return new yt(function(t){var n=e[ss]();if(Xe(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ah(e){return new yt(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Ph(e){return new yt(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Xu)})}function Th(e){return new yt(function(t){var n,r;try{for(var i=wr(e),a=i.next();!a.done;a=i.next()){var l=a.value;if(t.next(l),t.closed)return}}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()})}function sc(e){return new yt(function(t){Dh(e,t).catch(function(n){return t.error(n)})})}function jh(e){return sc(oc(e))}function Dh(e,t){var n,r,i,a;return rh(this,void 0,void 0,function(){var l,c;return Ju(this,function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),n=oh(e),d.label=1;case 1:return[4,n.next()];case 2:if(r=d.sent(),!!r.done)return[3,4];if(l=r.value,t.next(l),t.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=d.sent(),i={error:c},[3,11];case 6:return d.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Nn(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function lc(e,t){return t===void 0&&(t=0),Pr(function(n,r){n.subscribe(Sr(r,function(i){return Nn(r,e,function(){return r.next(i)},t)},function(){return Nn(r,e,function(){return r.complete()},t)},function(i){return Nn(r,e,function(){return r.error(i)},t)}))})}function uc(e,t){return t===void 0&&(t=0),Pr(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Rh(e,t){return Sn(e).pipe(uc(t),lc(t))}function Nh(e,t){return Sn(e).pipe(uc(t),lc(t))}function Lh(e,t){return new yt(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function Mh(e,t){return new yt(function(n){var r;return Nn(n,t,function(){r=e[rc](),Nn(n,t,function(){var i,a,l;try{i=r.next(),a=i.value,l=i.done}catch(c){n.error(c);return}l?n.complete():n.next(a)},0,!0)}),function(){return Xe(r==null?void 0:r.return)&&r.return()}})}function cc(e,t){if(!e)throw new Error("Iterable cannot be null");return new yt(function(n){Nn(n,t,function(){var r=e[Symbol.asyncIterator]();Nn(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function qh(e,t){return cc(oc(e),t)}function Fh(e,t){if(e!=null){if(ec(e))return Rh(e,t);if(cs(e))return Lh(e,t);if($u(e))return Nh(e,t);if(tc(e))return cc(e,t);if(ic(e))return Mh(e,t);if(ac(e))return qh(e,t)}throw nc(e)}function dn(e,t){return t?Fh(e,t):Sn(e)}function wn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=us(e);return dn(e,n)}function Cl(e,t){var n=Xe(e)?e:function(){return e},r=function(i){return i.error(n())};return new yt(r)}var Uh=os(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function vr(e,t){return new Promise(function(n,r){var i=new xr({next:function(a){n(a),i.unsubscribe()},error:r,complete:function(){r(new Uh)}});e.subscribe(i)})}function Bh(e){return e instanceof Date&&!isNaN(e)}function go(e,t){return Pr(function(n,r){var i=0;n.subscribe(Sr(r,function(a){r.next(e.call(t,a,i++))}))})}var Kh=Array.isArray;function zh(e,t){return Kh(t)?e.apply(void 0,kr([],Qn(t))):e(t)}function fc(e){return go(function(t){return zh(e,t)})}var Vh=Array.isArray,Wh=Object.getPrototypeOf,Hh=Object.prototype,Yh=Object.keys;function Gh(e){if(e.length===1){var t=e[0];if(Vh(t))return{args:t,keys:null};if(Jh(t)){var n=Yh(t);return{args:n.map(function(r){return t[r]}),keys:n}}}return{args:e,keys:null}}function Jh(e){return e&&typeof e=="object"&&Wh(e)===Hh}function Qh(e,t){return e.reduce(function(n,r,i){return n[r]=t[i],n},{})}function ro(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=us(e),r=Ih(e),i=Gh(e),a=i.args,l=i.keys;if(a.length===0)return dn([],n);var c=new yt(Zh(a,n,l?function(d){return Qh(l,d)}:mo));return r?c.pipe(fc(r)):c}function Zh(e,t,n){return n===void 0&&(n=mo),function(r){Al(t,function(){for(var i=e.length,a=new Array(i),l=i,c=i,d=function(u){Al(t,function(){var m=dn(e[u],t),y=!1;m.subscribe(Sr(r,function(g){a[u]=g,y||(y=!0,c--),c||r.next(n(a.slice()))},function(){--l||r.complete()}))},r)},h=0;h<i;h++)d(h)},r)}}function Al(e,t,n){e?Nn(n,e,t):t()}function Xh(e,t,n,r,i,a,l,c){var d=[],h=0,u=0,m=!1,y=function(){m&&!d.length&&!h&&t.complete()},g=function(k){return h<r?_(k):d.push(k)},_=function(k){h++;var E=!1;Sn(n(k,u++)).subscribe(Sr(t,function(A){t.next(A)},function(){E=!0},void 0,function(){if(E)try{h--;for(var A=function(){var S=d.shift();l||_(S)};d.length&&h<r;)A();y()}catch(S){t.error(S)}}))};return e.subscribe(Sr(t,g,function(){m=!0,y()})),function(){}}function fs(e,t,n){return n===void 0&&(n=1/0),Xe(t)?fs(function(r,i){return go(function(a,l){return t(r,a,i,l)})(Sn(e(r,i)))},n):(typeof t=="number"&&(n=t),Pr(function(r,i){return Xh(r,i,e,n)}))}function $h(e){return e===void 0&&(e=1/0),fs(mo,e)}var ep=["addListener","removeListener"],tp=["addEventListener","removeEventListener"],np=["on","off"];function cn(e,t,n,r){if(Xe(n)&&(r=n,n=void 0),r)return cn(e,t,n).pipe(fc(r));var i=Qn(op(e)?tp.map(function(c){return function(d){return e[c](t,d,n)}}):rp(e)?ep.map(Pl(e,t)):ip(e)?np.map(Pl(e,t)):[],2),a=i[0],l=i[1];if(!a&&cs(e))return fs(function(c){return cn(c,t,n)})(Sn(e));if(!a)throw new TypeError("Invalid event target");return new yt(function(c){var d=function(){for(var h=[],u=0;u<arguments.length;u++)h[u]=arguments[u];return c.next(1<h.length?h:h[0])};return a(d),function(){return l(d)}})}function Pl(e,t){return function(n){return function(r){return e[n](t,r)}}}function rp(e){return Xe(e.addListener)&&Xe(e.removeListener)}function ip(e){return Xe(e.on)&&Xe(e.off)}function op(e){return Xe(e.addEventListener)&&Xe(e.removeEventListener)}function ap(e,t,n){return n===void 0&&(n=kh),new yt(function(r){var i=Bh(e)?1e3-n.now():e;i<0&&(i=0);var a=0;return n.schedule(function(){r.closed||(r.next(a++),r.complete())},i)})}function dc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=us(e),r=Eh(e,1/0),i=e;return i.length?i.length===1?Sn(i[0]):$h(r)(dn(i,n)):xh}function sp(e,t){return Pr(function(n,r){var i=0;n.subscribe(Sr(r,function(a){return e.call(t,a,i++)&&r.next(a)}))})}function lp(e){e===void 0&&(e={});var t=e.connector,n=t===void 0?function(){return new vi}:t,r=e.resetOnError,i=r===void 0?!0:r,a=e.resetOnComplete,l=a===void 0?!0:a,c=e.resetOnRefCountZero,d=c===void 0?!0:c;return function(h){var u,m,y,g=0,_=!1,k=!1,E=function(){m==null||m.unsubscribe(),m=void 0},A=function(){E(),u=y=void 0,_=k=!1},S=function(){var x=u;A(),x==null||x.unsubscribe()};return Pr(function(x,C){g++,!k&&!_&&E();var D=y=y??n();C.add(function(){g--,g===0&&!k&&!_&&(m=va(S,d))}),D.subscribe(C),!u&&g>0&&(u=new xr({next:function(R){return D.next(R)},error:function(R){k=!0,E(),m=va(A,i,R),D.error(R)},complete:function(){_=!0,E(),m=va(A,l),D.complete()}}),Sn(x).subscribe(u))})(h)}}function va(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t===!0){e();return}if(t!==!1){var i=new xr({next:function(){i.unsubscribe(),e()}});return Sn(t.apply(void 0,kr([],Qn(n)))).subscribe(i)}}var Ta=function(e,t){return Ta=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ta(e,t)};function Tr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Ta(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Pe(e,t,n,r){return new(n||(n=Promise))(function(i,a){function l(h){try{d(r.next(h))}catch(u){a(u)}}function c(h){try{d(r.throw(h))}catch(u){a(u)}}function d(h){var u;h.done?i(h.value):(u=h.value,u instanceof n?u:new n(function(m){m(u)})).then(l,c)}d((r=r.apply(e,[])).next())})}function vc(e,t){var n,r,i,a,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(d){return function(h){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return l.label++,{value:u[1],done:!1};case 5:l.label++,r=u[1],u=[0];continue;case 7:u=l.ops.pop(),l.trys.pop();continue;default:if(i=l.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){l=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){l.label=u[1];break}if(u[0]===6&&l.label<i[1]){l.label=i[1],i=u;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(u);break}i[2]&&l.ops.pop(),l.trys.pop();continue}u=t.call(e,l)}catch(m){u=[6,m],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([d,h])}}}function io(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function li(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),l=[];try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(c){i={error:c}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return l}function ui(e,t,n){if(arguments.length===2)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function hr(e){return this instanceof hr?(this.v=e,this):new hr(e)}function up(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(m){i[m]&&(r[m]=function(y){return new Promise(function(g,_){a.push([m,y,g,_])>1||c(m,y)})})}function c(m,y){try{(function(g){g.value instanceof hr?Promise.resolve(g.value.v).then(d,h):u(a[0][2],g)})(i[m](y))}catch(g){u(a[0][3],g)}}function d(m){c("next",m)}function h(m){c("throw",m)}function u(m,y){m(y),a.shift(),a.length&&c(a[0][0],a[0][1])}}function cp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=io(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(a){return new Promise(function(l,c){(function(d,h,u,m){Promise.resolve(m).then(function(y){d({value:y,done:u})},h)})(l,c,(a=e[i](a)).done,a.value)})}}}function hc(e){if(!e)throw new Error("Assertion Failed")}const fp={}.hasOwnProperty;function oo(e,t,n){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){hc(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)oo(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var l=t.substr(0,a),c=t.substr(a+1);if(c==="")n===void 0?Array.isArray(e)?isNaN(parseInt(l))||e.splice(parseInt(l),1):delete e[l]:e[l]=n;else{var d=e[l];d&&function(h,u){return fp.call(h,u)}(e,l)||(d=e[l]={}),oo(d,c,n)}}else n===void 0?Array.isArray(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}const pc=typeof self<"u"&&typeof crypto<"u"?(e,t=crypto.getRandomValues.bind(crypto))=>{const n=new Uint8Array(e);return t(n),self.btoa(String.fromCharCode.apply(null,n))}:typeof Buffer<"u"?(e,t=dp)=>{const n=Buffer.alloc(e);return t(n),n.toString("base64")}:()=>{throw new Error("No implementation of randomString was found")};function dp(e){for(let t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}function ds(e){return typeof e=="string"||!!(Array.isArray(e)&&e.some(t=>ds(t))&&e.every(yc))}function yc(e){return typeof e=="string"||typeof e=="number"||Array.isArray(e)&&e.every(yc)}function vp(e,t,n){const r=e[t]||(e[t]={}),i=n.keys.map(a=>typeof a=="string"?a:JSON.stringify(a));switch(n.type){case"insert":case"upsert":i.forEach((a,l)=>{r[a]={type:"ups",val:n.values[l]}});break;case"update":case"modify":i.forEach((a,l)=>{const c=n.type==="update"?n.changeSpecs[l]:n.changeSpec,d=r[a];if(d)switch(d.type){case"ups":for(const[h,u]of Object.entries(c))oo(d.val,h,u);break;case"del":break;case"upd":Object.assign(d.mod,c)}else r[a]={type:"upd",mod:c}});break;case"delete":i.forEach(a=>{r[a]={type:"del"}})}return e}function Tl(e,t){for(const{table:n,muts:r}of t)for(const i of r)vp(e,n,i)}function dt(e){return typeof e=="function"}function Ft(e){return function(t){if(function(n){return dt(n==null?void 0:n.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var mc=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function gc(e){return dt(e==null?void 0:e.then)}var jl,qi,ha=(jl=function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}},(qi=jl(function(e){Error.call(e),e.stack=new Error().stack})).prototype=Object.create(Error.prototype),qi.prototype.constructor=qi,qi);function ja(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var bo=function(){function e(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var n,r,i,a,l;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var d=io(c),h=d.next();!h.done;h=d.next())h.value.remove(this)}catch(k){n={error:k}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}else c.remove(this);var u=this.initialTeardown;if(dt(u))try{u()}catch(k){l=k instanceof ha?k.errors:[k]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var y=io(m),g=y.next();!g.done;g=y.next()){var _=g.value;try{Dl(_)}catch(k){l=l??[],k instanceof ha?l=ui(ui([],li(l)),li(k.errors)):l.push(k)}}}catch(k){i={error:k}}finally{try{g&&!g.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}if(l)throw new ha(l)}},e.prototype.add=function(n){var r;if(n&&n!==this)if(this.closed)Dl(n);else{if(n instanceof e){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(n)}},e.prototype._hasParent=function(n){var r=this._parentage;return r===n||Array.isArray(r)&&r.includes(n)},e.prototype._addParent=function(n){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(n),r):r?[r,n]:n},e.prototype._removeParent=function(n){var r=this._parentage;r===n?this._parentage=null:Array.isArray(r)&&ja(r,n)},e.prototype.remove=function(n){var r=this._finalizers;r&&ja(r,n),n instanceof e&&n._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function bc(e){return e instanceof bo||e&&"closed"in e&&dt(e.remove)&&dt(e.add)&&dt(e.unsubscribe)}function Dl(e){dt(e)?e():e.unsubscribe()}bo.EMPTY;var hp={Promise:void 0},pp={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,ui([e,t],li(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function _c(e){pp.setTimeout(function(){throw e})}function Da(){}var vs=function(e){function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,bc(n)&&n.add(r)):r.destination=mp,r}return Tr(t,e),t.create=function(n,r,i){return new Ra(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(bo),yp=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Fi(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Fi(r)}else Fi(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Fi(n)}},e}(),Ra=function(e){function t(n,r,i){var a,l=e.call(this)||this;return dt(n)||!n?a={next:n??void 0,error:r??void 0,complete:i??void 0}:a=n,l.destination=new yp(a),l}return Tr(t,e),t}(vs);function Fi(e){_c(e)}var mp={closed:!0,next:Da,error:function(e){throw e},complete:Da},hs=typeof Symbol=="function"&&Symbol.observable||"@@observable";function _o(e){return e}var en=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i,a=this,l=(i=t)&&i instanceof vs||function(c){return c&&dt(c.next)&&dt(c.error)&&dt(c.complete)}(i)&&bc(i)?t:new Ra(t,n,r);return function(){var c=a,d=c.operator,h=c.source;l.add(d?d.call(l,h):h?a._subscribe(l):a._trySubscribe(l))}(),l},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return new(n=Rl(n))(function(i,a){var l=new Ra({next:function(c){try{t(c)}catch(d){a(d),l.unsubscribe()}},error:a,complete:i});r.subscribe(l)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[hs]=function(){return this},e.prototype.pipe=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return((t=n).length===0?_o:t.length===1?t[0]:function(i){return t.reduce(function(a,l){return l(a)},i)})(this)},e.prototype.toPromise=function(t){var n=this;return new(t=Rl(t))(function(r,i){var a;n.subscribe(function(l){return a=l},function(l){return i(l)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function Rl(e){var t;return(t=e??hp.Promise)!==null&&t!==void 0?t:Promise}function wc(e){return dt(e[hs])}function kc(e){return Symbol.asyncIterator&&dt(e==null?void 0:e[Symbol.asyncIterator])}function xc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Sc=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ic(e){return dt(e==null?void 0:e[Sc])}function Ec(e){return up(this,arguments,function(){var t,n,r;return vc(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,hr(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,hr(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,hr(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Oc(e){return dt(e==null?void 0:e.getReader)}function Zn(e){if(e instanceof en)return e;if(e!=null){if(wc(e))return i=e,new en(function(a){var l=i[hs]();if(dt(l.subscribe))return l.subscribe(a);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(mc(e))return r=e,new en(function(a){for(var l=0;l<r.length&&!a.closed;l++)a.next(r[l]);a.complete()});if(gc(e))return n=e,new en(function(a){n.then(function(l){a.closed||(a.next(l),a.complete())},function(l){return a.error(l)}).then(null,_c)});if(kc(e))return Nl(e);if(Ic(e))return t=e,new en(function(a){var l,c;try{for(var d=io(t),h=d.next();!h.done;h=d.next()){var u=h.value;if(a.next(u),a.closed)return}}catch(m){l={error:m}}finally{try{h&&!h.done&&(c=d.return)&&c.call(d)}finally{if(l)throw l.error}}a.complete()});if(Oc(e))return Nl(Ec(e))}var t,n,r,i;throw xc(e)}function Nl(e){return new en(function(t){(function(n,r){var i,a,l,c;return Pe(this,void 0,void 0,function(){var d,h;return vc(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),i=cp(n),u.label=1;case 1:return[4,i.next()];case 2:if((a=u.sent()).done)return[3,4];if(d=a.value,r.next(d),r.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return h=u.sent(),l={error:h},[3,11];case 6:return u.trys.push([6,,9,10]),a&&!a.done&&(c=i.return)?[4,c.call(i)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(l)throw l.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})})(e,t).catch(function(n){return t.error(n)})})}function qt(e,t,n,r,i){return new gp(e,t,n,r,i)}var gp=function(e){function t(n,r,i,a,l,c){var d=e.call(this,n)||this;return d.onFinalize=l,d.shouldUnsubscribe=c,d._next=r?function(h){try{r(h)}catch(u){n.error(u)}}:e.prototype._next,d._error=a?function(h){try{a(h)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,d._complete=i?function(){try{i()}catch(h){n.error(h)}finally{this.unsubscribe()}}:e.prototype._complete,d}return Tr(t,e),t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(vs),bp=function(e){function t(n,r){return e.call(this)||this}return Tr(t,e),t.prototype.schedule=function(n,r){return this},t}(bo),Na={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Na.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,ui([e,t],li(n))):setInterval.apply(void 0,ui([e,t],li(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},_p=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return Tr(t,e),t.prototype.schedule=function(n,r){if(r===void 0&&(r=0),this.closed)return this;this.state=n;var i=this.id,a=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(a,i,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(a,this.id,r),this},t.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),Na.setInterval(n.flush.bind(n,this),i)},t.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;Na.clearInterval(r)},t.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(n,r){var i,a=!1;try{this.work(n)}catch(l){a=!0,i=l||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),i},t.prototype.unsubscribe=function(){if(!this.closed){var n=this.id,r=this.scheduler,i=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,ja(i,this),n!=null&&(this.id=this.recycleAsyncId(r,n,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(bp),wp={now:function(){return Date.now()}},Ll=function(){function e(t,n){n===void 0&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(t,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,t).schedule(r,n)},e.now=wp.now,e}(),ps=new(function(e){function t(n,r){r===void 0&&(r=Ll.now);var i=e.call(this,n,r)||this;return i.actions=[],i._active=!1,i._scheduled=void 0,i}return Tr(t,e),t.prototype.flush=function(n){var r=this.actions;if(this._active)r.push(n);else{var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}}},t}(Ll))(_p),kp=ps;function Cc(e){return e&&dt(e.schedule)}function xp(e,t,n){e===void 0&&(e=0),n===void 0&&(n=kp);var r=-1;return t!=null&&(Cc(t)?n=t:r=t),new en(function(i){var a,l=(a=e)instanceof Date&&!isNaN(a)?+e-n.now():e;l<0&&(l=0);var c=0;return n.schedule(function(){i.closed||(i.next(c++),0<=r?this.schedule(void 0,r):i.complete())},l)})}function Ac(e){return Cc((t=e)[t.length-1])?e.pop():void 0;var t}function Ln(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function La(e){return Ft(function(t,n){var r,i=null,a=!1;i=t.subscribe(qt(n,void 0,void 0,function(l){r=Zn(e(l,La(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function Ml(e,t){return t===void 0&&(t=0),Ft(function(n,r){n.subscribe(qt(r,function(i){return Ln(r,e,function(){return r.next(i)},t)},function(){return Ln(r,e,function(){return r.complete()},t)},function(i){return Ln(r,e,function(){return r.error(i)},t)}))})}function ql(e,t){return t===void 0&&(t=0),Ft(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Fl(e,t){if(!e)throw new Error("Iterable cannot be null");return new en(function(n){Ln(n,t,function(){var r=e[Symbol.asyncIterator]();Ln(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function Sp(e,t){if(e!=null){if(wc(e))return function(n,r){return Zn(n).pipe(ql(r),Ml(r))}(e,t);if(mc(e))return function(n,r){return new en(function(i){var a=0;return r.schedule(function(){a===n.length?i.complete():(i.next(n[a++]),i.closed||this.schedule())})})}(e,t);if(gc(e))return function(n,r){return Zn(n).pipe(ql(r),Ml(r))}(e,t);if(kc(e))return Fl(e,t);if(Ic(e))return function(n,r){return new en(function(i){var a;return Ln(i,r,function(){a=n[Sc](),Ln(i,r,function(){var l,c,d;try{c=(l=a.next()).value,d=l.done}catch(h){return void i.error(h)}d?i.complete():i.next(c)},0,!0)}),function(){return dt(a==null?void 0:a.return)&&a.return()}})}(e,t);if(Oc(e))return function(n,r){return Fl(Ec(n),r)}(e,t)}throw xc(e)}function fn(e,t){return Ft(function(n,r){var i=0;n.subscribe(qt(r,function(a){r.next(e.call(t,a,i++))}))})}function ys(e,t,n){return n===void 0&&(n=1/0),dt(t)?ys(function(r,i){return fn(function(a,l){return t(r,a,i,l)})(Zn(e(r,i)))},n):(typeof t=="number"&&(n=t),Ft(function(r,i){return function(a,l,c,d,h,u,m,y){var g=[],_=0,k=0,E=!1,A=function(){!E||g.length||_||l.complete()},S=function(C){return _<d?x(C):g.push(C)},x=function(C){u&&l.next(C),_++;var D=!1;Zn(c(C,k++)).subscribe(qt(l,function(R){h==null||h(R),u?S(R):l.next(R)},function(){D=!0},void 0,function(){if(D)try{_--;for(var R=function(){var W=g.shift();m?Ln(l,m,function(){return x(W)}):x(W)};g.length&&_<d;)R();A()}catch(W){l.error(W)}}))};return a.subscribe(qt(l,S,function(){E=!0,A()})),function(){y==null||y()}}(r,i,e,n)}))}function Ip(){return(e=1)===void 0&&(e=1/0),ys(_o,e);var e}function Ul(e,t){return t===void 0&&(t=ps),Ft(function(n,r){var i=null,a=null,l=null,c=function(){if(i){i.unsubscribe(),i=null;var h=a;a=null,r.next(h)}};function d(){var h=l+e,u=t.now();if(u<h)return i=this.schedule(void 0,h-u),void r.add(i);c()}n.subscribe(qt(r,function(h){a=h,l=t.now(),i||(i=t.schedule(d,e),r.add(i))},function(){c(),r.complete()},void 0,function(){a=i=null}))})}function Ma(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Ip()((e=n,(t=Ac(n))?Sp(e,t):Zn(e)))}var Ep=new en(function(e){return e.complete()});function cr(e){return e<=0?function(){return Ep}:Ft(function(t,n){var r=0;t.subscribe(qt(n,function(i){++r<=e&&(n.next(i),e<=r&&n.complete())}))})}function Pc(e,t){return t?function(n){return Ma(t.pipe(cr(1),Ft(function(r,i){r.subscribe(qt(i,Da))})),n.pipe(Pc(e)))}:ys(function(n,r){return e(n,r).pipe(cr(1),function(i){return fn(function(){return i})}(n))})}function Tc(e,t){t===void 0&&(t=ps);var n=xp(e,t);return Pc(function(){return n})}function jc(e,t){return t===void 0&&(t=_o),e=e??Op,Ft(function(n,r){var i,a=!0;n.subscribe(qt(r,function(l){var c=t(l);!a&&e(i,c)||(a=!1,i=c,r.next(l))}))})}function Op(e,t){return e===t}function un(e,t){return Ft(function(n,r){var i=0;n.subscribe(qt(r,function(a){return e.call(t,a,i++)&&r.next(a)}))})}function Bl(e){return un(function(t,n){return e<=n})}function Cp(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Ac(e);return Ft(function(r,i){(n?Ma(e,r,n):Ma(e,r)).subscribe(i)})}function Ot(e,t){return Ft(function(n,r){var i=null,a=0,l=!1,c=function(){return l&&!i&&r.complete()};n.subscribe(qt(r,function(d){i==null||i.unsubscribe();var h=0,u=a++;Zn(e(d,u)).subscribe(i=qt(r,function(m){return r.next(t?t(d,m,u,h++):m)},function(){i=null,c()}))},function(){l=!0,c()}))})}function Kl(e,t,n){var r=dt(e)||t||n?{next:e,error:t,complete:n}:e;return r?Ft(function(i,a){var l;(l=r.subscribe)===null||l===void 0||l.call(r);var c=!0;i.subscribe(qt(a,function(d){var h;(h=r.next)===null||h===void 0||h.call(r,d),a.next(d)},function(){var d;c=!1,(d=r.complete)===null||d===void 0||d.call(r),a.complete()},function(d){var h;c=!1,(h=r.error)===null||h===void 0||h.call(r,d),a.error(d)},function(){var d,h;c&&((d=r.unsubscribe)===null||d===void 0||d.call(r)),(h=r.finalize)===null||h===void 0||h.call(r)}))}):_o}function Dc(e,t){return Pe(this,void 0,void 0,function*(){try{const n=yield navigator.serviceWorker.ready;if(t==="push"&&n.sync&&(yield n.sync.register(`dexie-cloud:${e.name}`)),!n.active)throw new Error("Failed to trigger sync - there's no active service worker");return void n.active.postMessage({type:"dexie-cloud-sync",dbName:e.name,purpose:t})}catch{}})}function _n(e,t){e.cloud.usingServiceWorker?Dc(e,t):e.localSyncEvent.next({purpose:t})}const Rc=typeof Buffer<"u"?e=>Buffer.from(e,"base64"):e=>{const t=atob(e),n=t.length,r=new Uint8Array(n);for(var i=0;i<n;i++)r[i]=t.charCodeAt(i);return r},hi=typeof Buffer<"u"?e=>ArrayBuffer.isView(e)?Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"):Buffer.from(e).toString("base64"):e=>{const t=ArrayBuffer.isView(e)?e:new Uint8Array(e),n=[];for(let r=0,i=t.length;r<i;r+=4096){const a=t.subarray(r,r+4096);n.push(String.fromCharCode.apply(null,a))}return btoa(n.join(""))};class qa extends Error{constructor({title:t,message:n,messageCode:r,messageParams:i}){super(n),this.name="TokenErrorResponseError",this.title=t,this.messageCode=r,this.messageParams=i}}function pi(e,t){return new Promise((n,r)=>{const i=Object.assign(Object.assign({submitLabel:"Submit",cancelLabel:"Cancel"},t),{onSubmit:a=>{e.next(void 0),n(a)},onCancel:()=>{e.next(void 0),r(new st.AbortError("User cancelled"))}});e.next(i)})}function Fa(e,t,...n){return pi(e,{type:"message-alert",title:t,alerts:n,fields:{},submitLabel:"OK",cancelLabel:null})}function zl(e,t,n){return Pe(this,void 0,void 0,function*(){let r=n||"";for(;!r||!/^[\w-+.]+@([\w-]+\.)+[\w-]{2,10}(\sas\s[\w-+.]+@([\w-]+\.)+[\w-]{2,10})?$/.test(r);)r=(yield pi(e,{type:"email",title:t,alerts:r?[{type:"error",messageCode:"INVALID_EMAIL",message:"Please enter a valid email address",messageParams:{}}]:[],fields:{email:{type:"email",placeholder:"you@somedomain.com"}}})).email;return r})}function Vl(e,t,n){return Pe(this,void 0,void 0,function*(){const r=[{type:"info",messageCode:"OTP_SENT",message:"A One-Time password has been sent to {email}",messageParams:{email:t}}];n&&r.push(n);const{otp:i}=yield pi(e,{type:"otp",title:"Enter OTP",alerts:r,fields:{otp:{type:"otp",label:"OTP",placeholder:"Paste OTP here"}}});return i})}function ms(e){var t,n,r;return Pe(this,void 0,void 0,function*(){const i=yield e.getCurrentUser(),{accessToken:a,accessTokenExpiration:l,refreshToken:c,refreshTokenExpiration:d,claims:h}=i;if(!a)return null;if(((t=l==null?void 0:l.getTime())!==null&&t!==void 0?t:1/0)>Date.now()&&(((n=i.license)===null||n===void 0?void 0:n.status)||"ok")==="ok")return i;if(!c)throw new Error("Refresh token missing");if(((r=d==null?void 0:d.getTime())!==null&&r!==void 0?r:1/0)<=Date.now())throw new Error("Refresh token has expired");const u=yield wo(e.cloud.options.databaseUrl,i);return yield e.table("$logins").update(h.sub,{accessToken:u.accessToken,accessTokenExpiration:u.accessTokenExpiration,claims:u.claims,license:u.license}),u})}function Ap(e,t,n,r,i){return Pe(this,void 0,void 0,function*(){return t.accessToken&&t.accessTokenExpiration.getTime()>Date.now()?t:t.refreshToken&&(!t.refreshTokenExpiration||t.refreshTokenExpiration.getTime()>Date.now())?yield wo(e,t):yield function(a,l,c,d){return Pe(this,void 0,void 0,function*(){if(!crypto.subtle)throw typeof location<"u"&&location.protocol==="http:"?new Error("Dexie Cloud Addon needs to use WebCrypto, but your browser has disabled it due to being served from an insecure location. Please serve it from https or http://localhost:<port> (See https://stackoverflow.com/questions/46670556/how-to-enable-crypto-subtle-for-unsecure-origins-in-chrome/46671627#46671627)"):new Error("This browser does not support WebCrypto.");const{privateKey:h,publicKey:u}=yield crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!1,["sign","verify"]);if(!h||!u)throw new Error("Could not generate RSA keypair");a.nonExportablePrivateKey=h;const m=function(y){const g=hi(y);return function(_){let k=`-----BEGIN PUBLIC KEY-----
`;for(;_.length>0;)k+=_.substring(0,64)+`
`,_=_.substring(64);return k+="-----END PUBLIC KEY-----",k}(g)}(yield crypto.subtle.exportKey("spki",u));a.publicKey=u;try{const y=yield l({public_key:m,hints:d});if(y.type==="error")throw new qa(y);if(y.type!=="tokens")throw new Error(`Unexpected response type from token endpoint: ${y.type}`);return a.accessToken=y.accessToken,a.accessTokenExpiration=new Date(y.accessTokenExpiration),a.refreshToken=y.refreshToken,y.refreshTokenExpiration&&(a.refreshTokenExpiration=new Date(y.refreshTokenExpiration)),a.userId=y.claims.sub,a.email=y.claims.email,a.name=y.claims.name,a.claims=y.claims,a.license={type:y.userType,status:y.claims.license||"ok"},a.data=y.data,y.evalDaysLeft!=null&&(a.license.evalDaysLeft=y.evalDaysLeft),y.userValidUntil!=null&&(a.license.validUntil=new Date(y.userValidUntil)),y.alerts&&y.alerts.length>0&&(yield pi(c,{type:"message-alert",title:"Authentication Alert",fields:{},alerts:y.alerts})),a}catch(y){if(y instanceof qa)throw yield Fa(c,y.title,{type:"error",messageCode:y.messageCode,message:y.message,messageParams:{}}),y;let g="We're having a problem authenticating right now.";throw y instanceof TypeError&&(g=typeof navigator!==void 0&&!navigator.onLine?"You seem to be offline. Please connect to the internet and try again.":st.debug||typeof location<"u"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1")?`Could not connect to server. Please verify that your origin '${location.origin}' is whitelisted using \`npx dexie-cloud whitelist\``:"Could not connect to server. Please verify the connection.",yield Fa(c,"Authentication Failed",{type:"error",messageCode:"GENERIC_ERROR",message:g,messageParams:{}}).catch(()=>{})),y}})}(t,n,r,i)})}function wo(e,t){return Pe(this,void 0,void 0,function*(){if(!t.refreshToken)throw new Error("Cannot refresh token - refresh token is missing.");if(!t.nonExportablePrivateKey)throw new Error("login.nonExportablePrivateKey is missing - cannot sign refresh token without a private key.");const n=Date.now(),r="RSASSA-PKCS1-v1_5",i=new TextEncoder().encode(t.refreshToken+n),a=yield crypto.subtle.sign(r,t.nonExportablePrivateKey,i),l=hi(a),c={grant_type:"refresh_token",refresh_token:t.refreshToken,scopes:["ACCESS_DB"],signature:l,signing_algorithm:r,time_stamp:n},d=yield fetch(`${e}/token`,{body:JSON.stringify(c),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});if(d.status!==200)throw new Error(`RefreshToken: Status ${d.status} from ${e}/token`);const h=yield d.json();if(h.type==="error")throw new qa(h);return t.accessToken=h.accessToken,t.accessTokenExpiration=h.accessTokenExpiration?new Date(h.accessTokenExpiration):void 0,t.claims=h.claims,t.license={type:h.userType,status:h.claims.license||"ok"},h.evalDaysLeft!=null&&(t.license.evalDaysLeft=h.evalDaysLeft),h.userValidUntil!=null&&(t.license.validUntil=new Date(h.userValidUntil)),h.data&&(t.data=h.data),t})}const Wl=new WeakMap;class gs{constructor(t,n){Wl.set(this,t),Object.assign(this,n)}static load(t,n){return t.table("$logins").get(n).then(r=>new gs(t,r||{userId:n,claims:{sub:n},lastLogin:new Date(0)}))}save(){return Pe(this,void 0,void 0,function*(){Wl.get(this).table("$logins").put(this)})}}const Mt={userId:"unauthorized",name:"Unauthorized",claims:{sub:"unauthorized"},lastLogin:new Date(0)};try{Object.freeze(Mt),Object.freeze(Mt.claims)}catch{}function Nc(e,t){return vr(dn(e).pipe(sp(t)))}function Lc(e){return Pe(this,void 0,void 0,function*(){const t=yield Ua(e);if(t){if(!(yield function(n,r,i){return Pe(this,void 0,void 0,function*(){const a=[{type:"warning",messageCode:"LOGOUT_CONFIRMATION",message:`{numUnsyncedChanges} unsynced changes will get lost!
                Logout anyway?`,messageParams:{currentUserId:r,numUnsyncedChanges:i.toString()}}];return yield pi(n,{type:"logout-confirmation",title:"Confirm Logout",alerts:a,fields:{},submitLabel:"Confirm logout",cancelLabel:"Cancel"}).then(()=>!0).catch(()=>!1)})}(e.cloud.userInteraction,e.cloud.currentUserId,t)))throw new Error("User cancelled logout due to unsynced changes");yield Ua(e,{deleteUnsyncedData:!0})}})}function Ua(e,{deleteUnsyncedData:t=!1}={}){return Pe(this,void 0,void 0,function*(){const[n,r]=yield e.dx.transaction("rw",e.dx.tables,i=>Pe(this,void 0,void 0,function*(){const a=i.idbtrans;a.disableChangeTracking=!0,a.disableAccessControl=!0;const l=i.storeNames.filter(d=>d.endsWith("_mutations")),c=(yield Promise.all(l.map(d=>i.table(d).count()))).reduce((d,h)=>d+h,0);if(c>0&&!t)return[c,!1];e.$syncState.delete("syncState");for(const d of e.dx.tables)d.name!=="$jobs"&&d.name!=="$syncState"&&d.clear();return[c,!0]}));return r&&(yield Nc(e.cloud.currentUser,i=>i.userId===Mt.userId),yield e.cloud.sync({purpose:"pull",wait:!0})),n})}class Ba extends Error{constructor(t,n){super(n||`${t.status} ${t.statusText}`),this.httpStatus=t.status}get name(){return"HttpError"}}function Ui(e,...t){globalThis.console[e](...t)}function pa(e,t){var n;return Pe(this,void 0,void 0,function*(){const r=yield e.getCurrentUser(),i=r.userId;if(r.isLoggedIn&&(!t||!t.email&&!t.userId)){if((((n=r.license)===null||n===void 0?void 0:n.status)||"ok")==="ok"&&r.accessToken&&(!r.accessTokenExpiration||r.accessTokenExpiration.getTime()>Date.now()))return!1;if(r.refreshToken&&(!r.refreshTokenExpiration||r.refreshTokenExpiration.getTime()>Date.now()))return yield ms(e),!1}const a=new gs(e,{claims:{},lastLogin:new Date(0)});return yield Ap(e.cloud.options.databaseUrl,a,e.cloud.options.fetchTokens||function(l){const{userInteraction:c}=l.cloud;return function({public_key:d,hints:h}){var u;return Pe(this,void 0,void 0,function*(){let m;const y=(u=l.cloud.options)===null||u===void 0?void 0:u.databaseUrl;if(!y)throw new Error("No database URL given.");if((h==null?void 0:h.grant_type)==="demo")m={demo_user:yield zl(c,"Enter a demo user email",(h==null?void 0:h.email)||(h==null?void 0:h.userId)),grant_type:"demo",scopes:["ACCESS_DB"],public_key:d};else if(h!=null&&h.otpId&&h.otp)m={grant_type:"otp",otp_id:h.otpId,otp:h.otp,scopes:["ACCESS_DB"],public_key:d};else{const k=yield zl(c,"Enter email address",h==null?void 0:h.email);m=/@demo.local$/.test(k)?{demo_user:k,grant_type:"demo",scopes:["ACCESS_DB"],public_key:d}:{email:k,grant_type:"otp",scopes:["ACCESS_DB"]}}const g=yield fetch(`${y}/token`,{body:JSON.stringify(m),method:"post",headers:{"Content-Type":"application/json",mode:"cors"}});if(g.status!==200){const k=yield g.text();throw yield Fa(c,"Token request failed",{type:"error",messageCode:"GENERIC_ERROR",message:k,messageParams:{}}).catch(()=>{}),new Ba(g,k)}const _=yield g.json();if(_.type==="tokens"||_.type==="error")return _;if(m.grant_type==="otp"&&"email"in m){if(_.type!=="otp-sent")throw new Error(`Unexpected response from ${y}/token`);const k=yield Vl(c,m.email),E=Object.assign(Object.assign({},m),{otp:k||"",otp_id:_.otp_id,public_key:d});let A=yield fetch(`${y}/token`,{body:JSON.stringify(E),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});for(;A.status===401;){const S=yield A.text();E.otp=yield Vl(c,m.email,{type:"error",messageCode:"INVALID_OTP",message:S,messageParams:{}}),A=yield fetch(`${y}/token`,{body:JSON.stringify(E),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"})}if(A.status!==200){const S=yield A.text();throw new Ba(A,S)}return yield A.json()}throw new Error(`Unexpected response from ${y}/token`)})}}(e),e.cloud.userInteraction,t),i!==Mt.userId&&a.userId!==i&&(yield Lc(e)),yield function(l,c){return Pe(this,void 0,void 0,function*(){if(c.userId===l.cloud.currentUserId)return;const d=l.table("$logins");yield l.transaction("rw",d,h=>Pe(this,void 0,void 0,function*(){const u=yield d.toArray();yield Promise.all(u.filter(m=>m.userId!==c.userId&&m.isLoggedIn).map(m=>(m.isLoggedIn=!1,d.put(m)))),c.isLoggedIn=!0,c.lastLogin=new Date;try{yield c.save()}catch(m){try{m.name==="DataCloneError"&&(Ui("debug","Login context property names:",Object.keys(c)),Ui("debug","Login context property names:",Object.keys(c)),Ui("debug","Login context:",c),Ui("debug","Login context JSON:",JSON.stringify(c)))}catch{}throw m}})),yield Nc(l.cloud.currentUser,h=>h.userId===c.userId)})}(e,a),_n(e,"pull"),a.userId!==i})}const Ka={},ri=typeof self<"u"&&self.document&&typeof navigator<"u"&&navigator.serviceWorker;ri&&ri.ready.then(e=>Ka.registration=e),typeof self<"u"&&"clients"in self&&!self.document&&addEventListener("message",e=>{var t,n;!((n=(t=e.data)===null||t===void 0?void 0:t.type)===null||n===void 0)&&n.startsWith("sw-broadcast-")&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>{var i;return r.id!==((i=e.source)===null||i===void 0?void 0:i.id)&&r.postMessage(e.data)})});class ya{constructor(t){this.name=t}subscribe(t){if(!ri)return()=>{};const n=r=>{var i;((i=r.data)===null||i===void 0?void 0:i.type)===`sw-broadcast-${this.name}`&&t(r.data.message)};return ri.addEventListener("message",n),()=>ri.removeEventListener("message",n)}postMessage(t){var n;typeof self.clients=="object"?[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:`sw-broadcast-${this.name}`,message:t})):Ka.registration&&((n=Ka.registration.active)===null||n===void 0||n.postMessage({type:`sw-broadcast-${this.name}`,message:t}))}}const Zr=globalThis["lbc-events"]||(globalThis["lbc-events"]=new Map);class Bi extends yt{constructor(t){const n=typeof BroadcastChannel>"u"?new ya(t):new BroadcastChannel(t);super(r=>{function i(c){r.next(c.detail)}function a(c){r.next(c.data)}let l;(function(c,d){Zr.has(c)?Zr.get(c).push(d):Zr.set(c,[d])})(`lbc-${t}`,i);try{n instanceof ya?l=n.subscribe(c=>r.next(c)):n.addEventListener("message",a)}catch{}return()=>{(function(c,d){const h=Zr.get(c);if(h){const u=h.indexOf(d);u!==-1&&h.splice(u,1)}})(`lbc-${t}`,i),n instanceof ya?l():n.removeEventListener("message",a)}}),this.name=t,this.bc=n}next(t){this.bc.postMessage(t),function(n){const r=Zr.get(n.type);r&&r.forEach(i=>{try{i(n)}catch{}})}(new CustomEvent(`lbc-${this.name}`,{detail:t}))}}function za({realms:e,inviteRealms:t}){return Pe(this,void 0,void 0,function*(){const n=JSON.stringify([...e.map(a=>({realmId:a,accepted:!0})),...t.map(a=>({realmId:a,accepted:!1}))].sort((a,l)=>a.realmId<l.realmId?-1:a.realmId>l.realmId?1:0)),r=new TextEncoder().encode(n),i=yield crypto.subtle.digest("SHA-1",r);return hi(i)})}function Zi(e){return Object.entries(e.cloud.schema||{}).filter(([,{markedForSync:t}])=>t).map(([t])=>e.tables.filter(({name:n})=>n===t)[0]).filter(t=>t)}function bs(e){return`$${e}_mutations`}function Mc(e){var t;const n=(t=/^\$(.*)_mutations$/.exec(e))===null||t===void 0?void 0:t[1];if(!n)throw new Error(`Given mutationTable ${e} is not correct`);return n}const Pp=[].concat;function qc(e){return Pp.apply([],e)}function Va(e,t,{since:n={},limit:r=1/0}={}){return Pe(this,void 0,void 0,function*(){const i=qc(yield Promise.all(e.map(d=>Pe(this,void 0,void 0,function*(){const h=Mc(d.name),u=n[h];let m=u?d.where("rev").above(u):d;return r<1/0&&(m=m.limit(r)),(yield m.toArray()).map(y=>({table:h,mut:y}))})))).sort((d,h)=>d.mut.txid===h.mut.txid?d.mut.opNo-h.mut.opNo:d.mut.ts-h.mut.ts),a=[];let l=null,c=null;for(const{table:d,mut:h}of i)l&&l.table===d&&c===h.txid?l.muts.push(h):(l={table:d,muts:[h]},c=h.txid,a.push(l));return a})}function Fc(e){const t=new Uint8Array(e);if(typeof crypto<"u")crypto.getRandomValues(t);else for(let n=0;n<e;n++)t[n]=Math.floor(256*Math.random());if(typeof Buffer<"u"&&Buffer.from)return Buffer.from(t).toString("base64");if(typeof btoa<"u")return btoa(String.fromCharCode.apply(null,t));throw new Error("No btoa or Buffer available")}const{toString:Tp}={},Hl={replace:function(e){const t=Object.keys(e);let n=null;for(let i=0,a=t.length;i<a;++i)t[i][0]==="$"&&(n=n||[],n.push(t[i]));if(!n)return e;const r={...e};for(const i of n)delete r[i];for(const i of n)r["$"+i]=e[i];return r}};function Uc(...e){const t=e.reduce((r,i)=>({...r,...i}),e.reduce((r,i)=>({...i,...r}),{})),n=new WeakMap;return{stringify(r,i,a){return JSON.stringify(r,function(c){const d=this[c],h=function(u){const m=typeof u;switch(typeof u){case"object":case"function":{if(u===null)return null;const g=Object.getPrototypeOf(u);if(!g)return Hl;let _=n.get(g);if(_!==void 0)return _;const k=(y=u,Tp.call(y).slice(8,-1)),E=Object.entries(t).find(([A,S])=>{var x,C;return(C=(x=S==null?void 0:S.test)===null||x===void 0?void 0:x.call(S,u,k))!==null&&C!==void 0?C:A===k});return _=E==null?void 0:E[1],_||(_=Array.isArray(u)?null:typeof u=="function"?t.function||null:Hl),n.set(g,_),_}default:return t[m]}var y}(d);return h?h.replace(d,i,t):d},a)},parse(r,i){const a=[];return JSON.parse(r,function(l,c){const d=c==null?void 0:c.$t;if(d){const u=t[d];c=u?u.revive(c,i,t):c}let h=a[a.length-1];if(h&&h[0]===c){c={...c};for(const u of h[1])delete c[u];for(const[u,m]of Object.entries(h[2]))c[u]=m;a.pop()}if(c===void 0||l[0]==="$"&&l!=="$t"){let u,m;h=a[a.length-1],h&&h[0]===this?(u=h[1],m=h[2]):a.push([this,u=[],m={}]),l[0]==="$"&&l!=="$t"?(u.push(l),m[l.substr(1)]=c):m[l]=void 0}return c})}}}const jp={Blob:{test:(e,t)=>t==="Blob",replace:(e,t)=>{const n=t.length;return t.push(e),{$t:"Blob",mimeType:e.type,i:n}},revive:({i:e,mimeType:t},n)=>new Blob([n[e]],{type:t})}};var Dp={number:{replace:e=>{switch(!0){case isNaN(e):return{$t:"number",v:"NaN"};case e===1/0:return{$t:"number",v:"Infinity"};case e===-1/0:return{$t:"number",v:"-Infinity"};default:return e}},revive:({v:e})=>Number(e)}};const Rp={bigint:{replace:e=>({$t:"bigint",v:""+e}),revive:e=>BigInt(e.v)}};var Np={Date:{replace:e=>({$t:"Date",v:isNaN(e.getTime())?"NaN":e.toISOString()}),revive:({v:e})=>new Date(e==="NaN"?NaN:Date.parse(e))}},Lp={Set:{replace:e=>({$t:"Set",v:Array.from(e.entries())}),revive:({v:e})=>new Set(e)}},Mp={Map:{replace:e=>({$t:"Map",v:Array.from(e.entries())}),revive:({v:e})=>new Map(e)}};const qp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0;var Fp=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","DataView","BigInt64Array","BigUint64Array"].reduce((e,t)=>({...e,[t]:{replace:(n,r,i)=>({$t:t,v:i.ArrayBuffer.replace(n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength),r,i).v}),revive:({v:n},r,i)=>{const a=qp[t];return a&&new a(i.ArrayBuffer.revive({v:n},r,i))}}}),{});function Bc(e){return function(t){for(var n="",r=0,i=t.length;r<i;r++)n+=Kc[t[r]];return n}(hi(e))}function Up(e){return Rc(function(t){if(typeof t!="string")throw new Error("invalid decoder input: "+t);for(var n="",r=0,i=t.length;r<i;r++)n+=Wa[t[r]];return n}(e))}const Wa={"-":"=",0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",A:"K",B:"L",C:"M",D:"N",E:"O",F:"P",G:"Q",H:"R",I:"S",J:"T",K:"U",L:"V",M:"W",N:"X",O:"Y",P:"Z",Q:"a",R:"b",S:"c",T:"d",U:"e",V:"f",W:"g",X:"h",Y:"i",Z:"j",_:"k",a:"l",b:"m",c:"n",d:"o",e:"p",f:"q",g:"r",h:"s",i:"t",j:"u",k:"v",l:"w",m:"x",n:"y",o:"z",p:"0",q:"1",r:"2",s:"3",t:"4",u:"5",v:"6",w:"7",x:"8",y:"9",z:"+","|":"/"},Kc={};for(const e of Object.keys(Wa))Kc[Wa[e]]=e;var Bp={ArrayBuffer:{replace:e=>({$t:"ArrayBuffer",v:Bc(e)}),revive:({v:e})=>{const t=Up(e);return t.buffer.byteLength===t.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}}};class ma{constructor(t,n){this.buf=t,this.type=n}}function Kp(e){const t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return t.responseText}function zp(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}var Vp={Blob:{test:(e,t)=>t==="Blob"||e instanceof ma,replace:e=>({$t:"Blob",v:hi(e instanceof ma?e.buf:zp(Kp(e))),type:e.type}),revive:({type:e,v:t})=>{const n=Rc(t);return typeof Blob!==void 0?new Blob([n]):new ma(n.buffer,e)}}};const zc={...Dp,...Rp,...Np,...Lp,...Mp,...Fp,...Bp,...Vp};function Yl(e){return new Promise((t,n)=>{const r=new FileReader;r.onabort=i=>n(new Error("file read aborted")),r.onerror=i=>n(i.target.error),r.onload=i=>t(i.target.result),r.readAsArrayBuffer(e)})}var Wp={undefined:{replace:()=>({$t:"undefined"}),revive:()=>{}}};const Hp=typeof BigInt=="function"&&typeof BigInt(0)=="bigint";class Gl{toString(){return this.v}constructor(t){this.v=t}}const Yp=Hp?{}:{bigint:{test:e=>e instanceof Gl,replace:e=>Object.assign({$t:"bigint"},e),revive:({v:e})=>new Gl(e)}},Vc=Object.assign(Object.assign(Object.assign({},Wp),Yp),{PropModification:{test:e=>e instanceof wl,replace:e=>Object.assign({$t:"PropModification"},e["@@propmod"]),revive:e=>{var t=function(n,r){var i={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&r.indexOf(a)<0&&(i[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(a=Object.getOwnPropertySymbols(n);l<a.length;l++)r.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(n,a[l])&&(i[a[l]]=n[a[l]])}return i}(e,["$t"]);return new wl(t)}}}),ao=Uc(zc,Vc),Gp=function(...e){const t=Uc(zc,jp,...e);return{toBinary(n){const[r,i]=this.stringify(n),a=new ArrayBuffer(4);return new DataView(a).setUint32(0,r.size),new Blob([a,r,i])},stringify(n){const r=[],i=t.stringify(n,r);return[new Blob(r.map(l=>{const c=new ArrayBuffer(4);return new DataView(c).setUint32(0,"byteLength"in l?l.byteLength:l.size),new Blob([c,l])})),i]},async parse(n,r){let i=0;const a=[],l=await Yl(r),c=new DataView(l);for(;i<l.byteLength;){const d=c.getUint32(i);i+=4;const h=l.slice(i,i+d);i+=d,a.push(h)}return t.parse(n,a)},async fromBinary(n){const r=new DataView(await Yl(n.slice(0,4))).getUint32(0),i=n.slice(4,r+4),a=await function(l){return new Promise((c,d)=>{const h=new FileReader;h.onabort=u=>d(new Error("file read aborted")),h.onerror=u=>d(u.target.error),h.onload=u=>c(u.target.result),h.readAsText(l)})}(n.slice(r+4));return await this.parse(a,i)}}}(Vc);function Jp(e,t,n){const r=[];for(let i of n){const{table:a,muts:l}=i,c=e.tables.find(u=>u.name===a);if(!c)throw new Error(`Internal error: table ${a} not found in DBCore schema`);const{primaryKey:d}=c;let h=i;l.forEach((u,m)=>{const y=!d.outbound&&(u.type==="upsert"||u.type==="insert");u.keys.forEach((g,_)=>{if(Array.isArray(g)){h===i&&(h=Jl(i,y));const k=h.muts[m],E=JSON.stringify(g);k.keys[_]=E}else if(g[0]==="#"){h===i&&(h=Jl(i,y));const k=h.muts[m];if(!t.isLoggedIn)throw new Error("Internal error: Cannot sync private IDs before authenticated");const E=`${g}:${t.userId}`;k.keys[_]=E,y&&st.setByKeyPath(k.values[_],d.keyPath,E)}})}),r.push(h)}return r}function Jl(e,t){return Object.assign(Object.assign({},e),{muts:t?e.muts.map(n=>n.type!=="insert"&&n.type!=="upsert"||!n.values?Object.assign(Object.assign({},n),{keys:n.keys.slice()}):Object.assign(Object.assign({},n),{keys:n.keys.slice(),values:n.values.slice()})):e.muts.map(n=>Object.assign(Object.assign({},n),{keys:n.keys.slice()}))})}let Ha=new WeakMap;function Wc(e){var t,n;return Pe(this,void 0,void 0,function*(){const r=((n=(t=Ha.get(e))===null||t===void 0?void 0:t.getTime())!==null&&n!==void 0?n:0)-Date.now();r>0&&(yield new Promise(i=>setTimeout(i,r)))})}function Qp(e,t,n,r,i,a,l,c){return Pe(this,void 0,void 0,function*(){const d={Accept:"application/json, application/x-bison, application/x-bison-stream","Content-Type":"application/tson"},h=yield ms(r),u=h==null?void 0:h.accessToken;u&&(d.Authorization=`Bearer ${u}`);const m={v:2,dbID:t==null?void 0:t.remoteDbId,clientIdentity:l,schema:a||{},lastPull:t?{serverRevision:t.serverRevision,realms:t.realms,inviteRealms:t.inviteRealms}:void 0,baseRevs:n,changes:Jp(r.dx.core.schema,c,e)};r.syncStateChangedEvent.next({phase:"pushing"});const y=yield fetch(`${i}/sync`,{method:"post",headers:d,credentials:"include",body:ao.stringify(m)});if(r.syncStateChangedEvent.next({phase:"pulling"}),function(g,_){const k=_.headers.get("Ratelimit-Limit"),E=_.headers.get("Ratelimit-Remaining"),A=_.headers.get("Ratelimit-Reset");if(k&&E&&A){const S=Number(k),x=Math.max(0,Number(E)),C=Number(A);if(x<S/2){const D=Math.ceil(C/(x+1));Ha.set(g,new Date(Date.now()+1e3*D))}else Ha.delete(g)}}(r,y),!y.ok)throw new Ba(y);if(y.headers.get("content-type")==="application/x-bison")return Gp.fromBinary(yield y.blob());{const g=yield y.text();return ao.parse(g)}})}function Xr(e){if(e!=null&&e.cancelled)throw new st.AbortError("Operation was cancelled")}let pr=!1;function Hc(e,t,n,r){return Pe(this,void 0,void 0,function*(){yield e.$baseRevs.bulkPut(Object.keys(t).filter(i=>t[i].markedForSync).map(i=>({tableName:i,clientRev:(n[i]||0)+1,serverRev:r}))),yield e.$baseRevs.where("tableName").noneOf(Object.keys(t).filter(i=>t[i].markedForSync)).delete()})}function Ya(e,t={}){for(const{table:n,muts:r}of e){const i=r.length>0?r[r.length-1].rev:null;t[n]=i||t[n]||0}return t}function Zp(e,t,n){return Pe(this,void 0,void 0,function*(){const r=yield e.bulkGet(t),i=[],a=[];t.forEach((l,c)=>{const d=r[c];if(d){for(const[h,u]of Object.entries(n[c]))if(h===e.schema.primKey.keyPath){if(nh(u,l)!==0)throw new Error("Cannot change primary key")}else st.setByKeyPath(d,h,u);i.push(l),a.push(d)}}),yield e.schema.primKey.keyPath==null?e.bulkPut(a,i):e.bulkPut(a)})}function Yc(e,t){return Pe(this,void 0,void 0,function*(){for(const{table:n,muts:r}of e){const i=t.table(n);if(!i)continue;const{primaryKey:a}=i.core.schema,l=c=>{switch(c[0]){case"[":if(c.endsWith("]"))try{return JSON.parse(c)}catch{}return c;case"#":return c.endsWith(":"+t.cloud.currentUserId)?c.substr(0,c.length-t.cloud.currentUserId.length-1):c;default:return c}};for(const c of r){const d=c.keys.map(l);switch(c.type){case"insert":a.outbound?yield i.bulkAdd(c.values,d):(d.forEach((h,u)=>{st.setByKeyPath(c.values[u],a.keyPath,h)}),yield i.bulkAdd(c.values));break;case"upsert":a.outbound?yield i.bulkPut(c.values,d):(d.forEach((h,u)=>{st.setByKeyPath(c.values[u],a.keyPath,h)}),yield i.bulkPut(c.values));break;case"modify":d.length===1?yield i.update(d[0],c.changeSpec):yield i.where(":id").anyOf(d).modify(c.changeSpec);break;case"update":yield Zp(i,d,c.changeSpecs);break;case"delete":yield i.bulkDelete(d)}}}})}typeof self<"u"&&typeof navigator<"u"&&(pr=navigator.onLine,self.addEventListener("online",()=>pr=!0),self.addEventListener("offline",()=>pr=!1));const Xp="currentSyncWorker";function ci(e,t,n,r){return Gc.apply(this,arguments).then(i=>(r!=null&&r.justCheckIfNeeded||e.syncStateChangedEvent.next({phase:"in-sync"}),i)).catch(i=>Pe(this,void 0,void 0,function*(){return r!=null&&r.justCheckIfNeeded?Promise.reject(i):pr&&(r!=null&&r.retryImmediatelyOnFetchError)&&(i==null?void 0:i.name)==="TypeError"&&/fetch/.test(i==null?void 0:i.message)?(e.syncStateChangedEvent.next({phase:"error",error:i}),yield new Promise(a=>setTimeout(a,500)),yield ci(e,t,n,Object.assign(Object.assign({},r),{retryImmediatelyOnFetchError:!1}))):(yield e.$syncState.update("syncState",{timestamp:new Date,error:""+i}),e.syncStateChangedEvent.next({phase:pr?"error":"offline",error:new Error(""+(i==null?void 0:i.message)||i)}),Promise.reject(i))}))}function Gc(e,t,n,{isInitialSync:r,cancelToken:i,justCheckIfNeeded:a,purpose:l}={isInitialSync:!1}){var c;return Pe(this,void 0,void 0,function*(){if(!(!((c=e.cloud.options)===null||c===void 0)&&c.databaseUrl))throw new Error("Internal error: sync must not be called when no databaseUrl is configured");const{databaseUrl:d}=t,h=yield e.getCurrentUser(),u=h.isLoggedIn?Zi(e):[],m=u.map(Z=>e.table(bs(Z.name))),y=yield e.getPersistedSyncState(),g=!r&&h.isLoggedIn,_=g?function(Z,G){const Y=(G==null?void 0:G.syncedTables)||[];return Zi(Z).filter(ne=>!Y.includes(ne.name))}(e,y):[];Xr(i);const k=_.length>0;if(k){if(a)return!0;yield e.transaction("rw",_,Z=>Pe(this,void 0,void 0,function*(){Z.idbtrans.disableChangeTracking=!0,Z.idbtrans.disableAccessControl=!0,yield function(G,Y,ne){return Pe(this,void 0,void 0,function*(){const te=new Set(ne||[]);for(const H of G)H.name==="members"?yield H.toCollection().modify($=>{te.has($.realmId)||$.userId&&$.userId!==Mt.userId||($.userId=Y.userId)}):H.name==="roles"||(H.name==="realms"?yield H.toCollection().modify($=>{te.has($.realmId)||$.owner!==void 0&&$.owner!==Mt.userId||($.owner=Y.userId)}):yield H.toCollection().modify($=>{$.realmId&&te.has($.realmId)||($.owner&&$.owner!==Mt.userId||($.owner=Y.userId),$.realmId&&$.realmId!==Mt.userId||($.realmId=Y.userId))}))})}(_,h,y==null?void 0:y.realms)})),Xr(i)}const[E,A,S]=yield e.transaction("r",e.tables,()=>Pe(this,void 0,void 0,function*(){const Z=yield e.getPersistedSyncState();let G=yield e.$baseRevs.toArray();G=G.filter(ne=>u.some(te=>te.name===ne.tableName));let Y=yield Va(m);if(Xr(i),k){const ne=[...(y==null?void 0:y.realms)||[],...(y==null?void 0:y.inviteRealms)||[]],te=yield function(H,$,oe,ce){return Pe(this,void 0,void 0,function*(){const De=`upload-${Fc(8)}`;if($.isLoggedIn&&H.length>0){const Re=new Set(ce||[]);return(yield Promise.all(H.map(he=>Pe(this,void 0,void 0,function*(){const{extractKey:B}=he.core.schema.primaryKey;if(!B)return{table:he.name,muts:[]};const Ne=oe[he.name],Ue=Ne!=null&&Ne.generatedGlobalId?he.filter(Ze=>{return B(Ze),!Re.has(Ze.realmId||"")&&(Ge=B(Ze),!(Je=Ne==null?void 0:Ne.idPrefix)||typeof Ge=="string"&&Ge.startsWith(Je));var Ge,Je}):he.filter(Ze=>{const Ge=B(Ze);return!Re.has(Ze.realmId||"")&&ds(Ge)}),qe=yield Ue.toArray();if(qe.length>0){const Ze={type:"upsert",values:qe,keys:qe.map(B),userId:$.userId,txid:De};return{table:he.name,muts:[Ze]}}return{table:he.name,muts:[]}})))).filter(he=>he.muts.length>0)}return[]})}(_,h,n,ne);return Xr(i),Y=Y.concat(te),[Y,Z,G]}return[Y,Z,G]})),x=E.some(Z=>Z.muts.some(G=>G.keys.length>0));if(a)return x;if(l==="push"&&!x)return!1;const C=Ya(E,A==null?void 0:A.latestRevisions),D=(A==null?void 0:A.clientIdentity)||pc(16);Xr(i);const R=yield Qp(E,A,S,e,d,n,D,h);return(yield e.transaction("rw",e.tables,Z=>Pe(this,void 0,void 0,function*(){Z.idbtrans.disableChangeTracking=!0,Z.idbtrans.disableAccessControl=!0;for(const H of Object.keys(n))R.schema[H]&&(n[H]=R.schema[H]);yield e.$syncState.put(n,"schema");const G=yield Va(m,0,{since:C});for(const H of m){const $=Mc(H.name);if(G.some(oe=>oe.table===$&&oe.muts.length>0)){if(C[$]){const oe=C[$]||0;yield Promise.all([H.where("rev").belowOrEqual(oe).delete(),e.$baseRevs.where(":id").between([$,-1/0],[$,oe+1],!0,!0).reverse().offset(1).delete()])}}else yield Promise.all([H.clear(),e.$baseRevs.where({tableName:$}).delete()])}Ya(G,C),yield Hc(e,n,C,R.serverRevision);const Y=yield e.getPersistedSyncState();yield function(H,$,oe){return Pe(this,void 0,void 0,function*(){const ce=new Set,De=new Set,Re=oe?oe.realms:[],he=oe?oe.inviteRealms:[],B=new Set($.realms),Ne=new Set($.realms.concat($.inviteRealms));for(const Ue of Re)B.has(Ue)||(De.add(Ue),Ne.has(Ue)||ce.add(Ue));for(const Ue of he.concat(Re))Ne.has(Ue)||ce.add(Ue);if(ce.size>0||De.size>0){const Ue=Zi(H);for(const qe of Ue){let Ze=["realms","members","roles"].includes(qe.name)?ce:De;Ze.size!==0&&(qe.schema.indexes.some(Ge=>Ge.keyPath==="realmId"||Array.isArray(Ge.keyPath)&&Ge.keyPath[0]==="realmId")?yield qe.where("realmId").anyOf([...Ze]).delete():yield qe.filter(Ge=>!!(Ge!=null&&Ge.realmId)&&Ze.has(Ge.realmId)).delete())}}})}(e,R,Y);const ne=Y||{syncedTables:[],latestRevisions:{},realms:[],inviteRealms:[],clientIdentity:D};g&&(ne.syncedTables=u.map(H=>H.name).concat(_.map(H=>H.name))),ne.latestRevisions=C,ne.remoteDbId=R.dbId,ne.initiallySynced=!0,ne.realms=R.realms,ne.inviteRealms=R.inviteRealms,ne.serverRevision=R.serverRevision,ne.timestamp=new Date,delete ne.error;const te=Jc(R.changes,G);return yield Yc(te,e),e.$syncState.put(ne,"syncState"),G.length===0})))?(e.syncCompleteEvent.next(),!1):(yield Wc(e),yield Gc(e,t,n,{isInitialSync:r,cancelToken:i}))})}function Jc(e,t){const n={};Tl(n,e);const r={};return Tl(r,t),function(i,a){var l,c,d;for(const[h,u]of Object.entries(a))for(const[m,y]of Object.entries(u))switch(y.type){case"ups":{const g=(l=i[h])===null||l===void 0?void 0:l[m];if(g)switch(g.type){case"ups":case"upd":delete i[h][m]}}break;case"del":(c=i[h])===null||c===void 0||delete c[m];break;case"upd":{const g=(d=i[h])===null||d===void 0?void 0:d[m];if(g)switch(g.type){case"ups":for(const[_,k]of Object.entries(y.mod))oo(g.val,_,k);break;case"del":break;case"upd":for(const _ of Object.keys(y.mod))delete g.mod[_]}break}}}(n,r),function(i,a=""){a||(a=pc(16));const l={};for(const[d,h]of Object.entries(i))for(const[u,m]of Object.entries(h)){const y=l[d]||(l[d]={});(y[m.type]||(y[m.type]=[])).push(Object.assign({key:u},m))}const c=[];for(const[d,h]of Object.entries(l)){const u={table:d,muts:[]};for(const[m,y]of Object.entries(h))switch(m){case"ups":{const g={type:"upsert",keys:y.map(_=>_.key),values:y.map(_=>_.val),txid:a};u.muts.push(g);break}case"upd":{const g={type:"update",keys:y.map(_=>_.key),changeSpecs:y.map(_=>_.mod),txid:a};u.muts.push(g);break}case"del":{const g={type:"delete",keys:y.map(_=>_.key),txid:a};u.muts.push(g);break}}c.push(u)}return c}(n)}const $p=10,ey=1e4,ty=1e3;function ny(e){const t=[],n=new $t(!0),r=new $t(null);let i=!1,a=new Array($p).fill(0);return r.subscribe(()=>Pe(this,void 0,void 0,function*(){if(!i&&t.length>0){i=!0,a.shift(),a.push(Date.now()),n.next(!1);try{yield function(){var l,c,d,h,u,m;return Pe(this,void 0,void 0,function*(){for(;t.length>0;){const y=t.shift();try{yield vr(e.cloud.syncState.pipe(un(({phase:_})=>_==="in-sync"||_==="error")));const g=e.cloud.persistedSyncState.value;if(!y)continue;switch(y.type){case"token-expired":const _=e.cloud.currentUser.value,k=yield wo(e.cloud.options.databaseUrl,_);yield e.table("$logins").update(_.userId,{accessToken:k.accessToken,accessTokenExpiration:k.accessTokenExpiration,claims:k.claims,license:k.license,data:k.data});break;case"realm-added":!((l=g==null?void 0:g.realms)===null||l===void 0)&&l.includes(y.realm)||!((c=g==null?void 0:g.inviteRealms)===null||c===void 0)&&c.includes(y.realm)||(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-accepted":!((d=g==null?void 0:g.realms)===null||d===void 0)&&d.includes(y.realm)||(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-removed":(!((h=g==null?void 0:g.realms)===null||h===void 0)&&h.includes(y.realm)||!((u=g==null?void 0:g.inviteRealms)===null||u===void 0)&&u.includes(y.realm))&&(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realms-changed":yield e.cloud.sync({purpose:"pull",wait:!0});break;case"changes":if(((m=e.cloud.syncState.value)===null||m===void 0?void 0:m.phase)==="error"){_n(e,"pull");break}yield e.transaction("rw",e.dx.tables,E=>Pe(this,void 0,void 0,function*(){E.idbtrans.disableChangeTracking=!0,E.idbtrans.disableAccessControl=!0;const[A,S,x]=yield Promise.all([e.getSchema(),e.getPersistedSyncState(),e.getCurrentUser()]);if(!S||!A||!x)return;if(y.baseRev!==S.serverRevision)return void(typeof y.baseRev!="string"||typeof S.serverRevision!="bigint"&&typeof S.serverRevision!="object"||_n(e,"pull"));if((yield st.waitFor(za(S)))!==y.realmSetHash)return void _n(e,"pull");let C=[];if(x.isLoggedIn){const D=Zi(e).map(R=>e.table(bs(R.name)));C=yield Va(D)}if(y.changes.length>0){const D=Jc(y.changes,C);yield Yc(D,e)}S.latestRevisions=Ya(C,S.latestRevisions),S.serverRevision=y.newRev,yield Hc(e,A,S.latestRevisions,y.newRev),yield e.$syncState.put(S,"syncState")}))}}catch{}}})}()}finally{a[a.length-1]-a[0]<ey&&(yield new Promise(l=>setTimeout(l,ty))),i=!1,n.next(!0)}}})),{enqueue:function(l){t.push(l),r.next(null)},readyToServe:n}}const Ql=new WeakMap,Ki={members:"@id, [userId+realmId], [email+realmId], realmId",roles:"[realmId+name]",realms:"@realmId",$jobs:"",$syncState:"",$baseRevs:"[tableName+clientRev]",$logins:"claims.sub, lastLogin"};let ry=0;function mn(e){"vip"in e&&(e=e.vip);let t=Ql.get(e.cloud);if(!t){const n=new vi;let r=new Bi(`syncstatechanged-${e.name}`),i=new Bi(`synccomplete-${e.name}`);n.id=++ry;let a=!1;t={get name(){return e.name},close:()=>e.close(),transaction:e.transaction.bind(e),table:e.table.bind(e),get tables(){return e.tables},cloud:e.cloud,get $jobs(){return e.table("$jobs")},get $syncState(){return e.table("$syncState")},get $baseRevs(){return e.table("$baseRevs")},get $logins(){return e.table("$logins")},get realms(){return e.realms},get members(){return e.members},get roles(){return e.roles},get initiallySynced(){return a},localSyncEvent:n,get syncStateChangedEvent(){return r},get syncCompleteEvent(){return i},dx:e},Object.assign(t,{getCurrentUser:()=>t.$logins.toArray().then(c=>c.find(d=>d.isLoggedIn)||Mt),getPersistedSyncState:()=>t.$syncState.get("syncState"),getSchema:()=>t.$syncState.get("schema").then(c=>{if(c)for(const h of t.tables)h.schema.primKey&&h.schema.primKey.keyPath&&c[h.name]&&(c[h.name].primaryKey=typeof(d=h.schema.primKey.keyPath)=="string"?d:d?"["+[].join.call(d,"+")+"]":"");var d;return c}),getOptions:()=>t.$syncState.get("options"),setInitiallySynced(c){a=c},reconfigure(){r=new Bi(`syncstatechanged-${e.name}`),i=new Bi(`synccomplete-${e.name}`)}}),t.messageConsumer=ny(t),Ql.set(e.cloud,t)}return t}const iy=typeof InstallTrigger<"u",Qc=typeof navigator<"u"&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\/|Edge\//.test(navigator.userAgent),oy=Qc?[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]:NaN,ay=Qc&&oy<=605||iy,sy=typeof self<"u"&&"clients"in self&&!self.document;function Zc(){throw new st.SchemaError("Version increment needed to allow dexie-cloud change tracking")}const{toString:ly}={};function Zl(e){return ly.call(e).slice(8,-1)}function ga(e,t){var n;return t.type==="delete"?t.keys:((n=t.keys)===null||n===void 0?void 0:n.slice())||t.values.map(e.extractKey)}const uy=/b|c|d|f|g|h|j|k|l|m|n|p|q|r|s|t|v|x|y|z/i;let gn=0;function Xc(e,t){const n=new Uint8Array(18),r=new Uint8Array(n.buffer,0,6),i=Date.now();gn>=i?++gn:gn=i,r[0]=gn/1099511627776,r[1]=gn/4294967296,r[2]=gn/16777216,r[3]=gn/65536,r[4]=gn/256,r[5]=gn;const a=new Uint8Array(n.buffer,6);return crypto.getRandomValues(a),e+Bc(new Uint8Array(n.buffer))+(t||"")}function cy(e){return{stack:"dbcore",name:"idGenerationMiddleware",level:1,create:t=>Object.assign(Object.assign({},t),{table:n=>{const r=t.table(n);return Object.assign(Object.assign({},r),{mutate:i=>{var a,l;if(i.trans.disableChangeTracking)return r.mutate(i);if(i.type==="add"||i.type==="put"){const c=(a=e.cloud.schema)===null||a===void 0?void 0:a[n];if(c!=null&&c.generatedGlobalId){if(!((l=e.cloud.options)===null||l===void 0)&&l.databaseUrl&&!e.initiallySynced){const d=ga(r.schema.primaryKey,i);return r.getMany({keys:d,trans:i.trans,cache:"immutable"}).then(h=>{if(h.length<d.length)throw new Error("Unable to create new objects without an initial sync having been performed.");return r.mutate(i)})}return function(d,h){let u=null;const m=ga(r.schema.primaryKey,d);return m.forEach((y,g)=>{if(y===void 0){const _=d.values[g].realmId||e.cloud.currentUserId,k=_.substr(_.length-3);m[g]=Xc(h,k),r.schema.primaryKey.outbound||(u||(u=d.values.slice()),u[g]=st.deepClone(u[g]),st.setByKeyPath(u[g],r.schema.primaryKey.keyPath,m[g]))}else if(typeof y!="string"||!y.startsWith(h)&&!y.startsWith("#"+h))throw new st.ConstraintError(`The ID "${y}" is not valid for table "${n}". Primary '@' keys requires the key to be prefixed with "${h}" (or "#${h}).
If you want to generate IDs programmatically, remove '@' from the schema to get rid of this constraint. Dexie Cloud supports custom IDs as long as they are random and globally unique.`)}),r.mutate(Object.assign(Object.assign({},d),{keys:m,values:u||d.values}))}(i,c.idPrefix)}c!=null&&c.markedForSync&&ga(r.schema.primaryKey,i).forEach((d,h)=>{if(!ds(d)){const u=Array.isArray(d)?d.map(Zl).join(","):Zl(d);throw new st.ConstraintError(`Invalid primary key type ${u} for table ${n}. Tables marked for sync has primary keys of type string or Array of string (and optional numbers)`)}})}return r.mutate(i)}})}})}}let fy=0;function $r(e,t){return function(n){const{readers:r,writers:i}=n.trans[t]||(n.trans[t]={writers:[],readers:[]}),a=i.length,l=(a>0?i[a-1].then(()=>e(n),()=>e(n)):e(n)).finally(()=>{r.splice(r.indexOf(l))});return r.push(l),l}}function dy(e,t){return function(n){const{readers:r,writers:i}=n.trans[t]||(n.trans[t]={writers:[],readers:[]});let a=(i.length>0?i[i.length-1].then(()=>e(n),()=>e(n)):r.length>0?(l=r,new Promise(c=>{l.length===0&&c([]);let d=l.length;const h=new Array(d);l.forEach((u,m)=>Promise.resolve(u).then(y=>h[m]={status:"fulfilled",value:y},y=>h[m]={status:"rejected",reason:y}).then(()=>--d||c(h)))})).then(()=>e(n)):e(n)).finally(()=>{i.shift()});var l;return i.push(a),a}}const lr=new $t(new Set);function $c(e){var t,n,r,i;return((t=e.cloud.options)===null||t===void 0?void 0:t.disableEagerSync)||((r=(n=e.cloud.currentUser.value)===null||n===void 0?void 0:n.license)===null||r===void 0?void 0:r.status)!=="ok"||!(!((i=e.cloud.options)===null||i===void 0)&&i.databaseUrl)}function vy({currentUserObservable:e,db:t}){return{stack:"dbcore",name:"MutationTrackingMiddleware",level:1,create:n=>{const r=n.schema.tables.filter(a=>!/^\$/.test(a.name));let i;try{i=new Map(r.map(a=>[a.name,n.table(`$${a.name}_mutations`)]))}catch{Zc()}return Object.assign(Object.assign({},n),{transaction:(a,l)=>{let c;if(l==="readwrite"){const d=a.filter(h=>{var u,m;return(m=(u=t.cloud.schema)===null||u===void 0?void 0:u[h])===null||m===void 0?void 0:m.markedForSync}).map(h=>bs(h));c=n.transaction([...a,...d],l)}else c=n.transaction(a,l);if(l==="readwrite"){c.txid=Fc(16),c.opCount=0,c.currentUser=e.value,lr.value.add(c),lr.next(lr.value);const d=()=>{c.removeEventListener("complete",h),c.removeEventListener("error",d),c.removeEventListener("abort",d),lr.value.delete(c),lr.next(lr.value)},h=()=>{c.mutationsAdded&&!$c(t)&&_n(t,"push"),d()};c.addEventListener("complete",h),c.addEventListener("error",d),c.addEventListener("abort",d)}return c},table:a=>{const l=n.table(a);if(/^\$/.test(a))return a.endsWith("_mutations")?Object.assign(Object.assign({},l),{mutate:u=>(u.type!=="add"&&u.type!=="put"||(u.trans.mutationsAdded=!0),l.mutate(u))}):a==="$logins"?Object.assign(Object.assign({},l),{mutate:u=>l.mutate(u).then(m=>(u.trans.mutationsAdded=!0,m)).catch(m=>Promise.reject(m))}):l;const{schema:c}=l,d=i.get(a);return function(u){const m="$lock"+ ++fy;return Object.assign(Object.assign({},u),{count:$r(u.count,m),get:$r(u.get,m),getMany:$r(u.getMany,m),openCursor:$r(u.openCursor,m),query:$r(u.query,m),mutate:dy(u.mutate,m)})}(Object.assign(Object.assign({},l),{mutate:u=>{var m,y,g;const _=u.trans;return _.txid?_.disableChangeTracking?l.mutate(u):!((y=(m=t.cloud.schema)===null||m===void 0?void 0:m[a])===null||y===void 0)&&y.markedForSync&&(!((g=_.currentUser)===null||g===void 0)&&g.isLoggedIn)?u.type==="deleteRange"?l.query({query:{range:u.range,index:c.primaryKey},trans:u.trans,values:!1}).then(k=>h({type:"delete",keys:k.result,trans:u.trans,criteria:{index:null,range:u.range}})):h(u):l.mutate(u):l.mutate(u)}}));function h(u){const m=u.trans;m.mutationsAdded=!0;const{txid:y,currentUser:{userId:g}}=m,{type:_}=u,k=++m.opCount;return l.mutate(u).then(E=>{const{numFailures:A,failures:S}=E;let x=_==="delete"?u.keys:E.results,C="values"in u?u.values:[],D="updates"in u&&u.updates;A&&(x=x.filter((Z,G)=>!S[G]),C=C.filter((Z,G)=>!S[G]));const R=Date.now(),W=u.type==="delete"?{type:"delete",ts:R,opNo:k,keys:x,criteria:u.criteria,txid:y,userId:g}:u.type==="add"?{type:"insert",ts:R,opNo:k,keys:x,txid:y,userId:g,values:C}:u.criteria&&u.changeSpec?{type:"modify",ts:R,opNo:k,keys:x,criteria:u.criteria,changeSpec:u.changeSpec,txid:y,userId:g}:D?{type:"update",ts:R,opNo:k,keys:D.keys,changeSpecs:D.changeSpecs,txid:y,userId:g}:{type:"upsert",ts:R,opNo:k,keys:x,values:C,txid:y,userId:g};return"isAdditionalChunk"in u&&u.isAdditionalChunk&&(W.isAdditionalChunk=!0),x.length>0||"criteria"in u&&u.criteria?d.mutate({type:"add",trans:m,values:[W]}).then(()=>E):E})}}})}}}function hy(e,t){return function(n,r){const i=Object.assign(Object.assign({},Ki),n);Object.keys(Ki).forEach(c=>{const d=i[c];if(d==null)throw new Error(`Cannot delete table ${c} as it is needed for access control of Dexie Cloud`);if(!n[c])return;const h=d.split(",").map(y=>y.trim()),u=Ki[c].split(",").map(y=>y.trim()),m=new Set(h.map(y=>y.replace(/([&*]|\+\+)/g,"")));if(h[0]!==u[0])throw new Error(`Cannot override primary key of table ${c}. Please declare it as {${c}: ${JSON.stringify(Ki[c])}`);for(let y=1;y<u.length;++y){const g=u[y];m.has(g.replace(/([&*]|\+\+)/g,""))||(i[c]+=`,${g}`)}});const a=t.cloud.schema||(t.cloud.schema={}),l=new Set;return Object.keys(i).forEach(c=>{const d=i[c],h=a[c]||(a[c]={});d!=null?(/^\@/.test(d)&&(i[c]=i[c].substr(1),h.generatedGlobalId=!0,h.idPrefix=function(u,m){let y=u[0].toLocaleLowerCase();for(let E=1,A=u.length;E<A&&y.length<3;++E)(uy.test(u[E])||(g=u[E])>="A"&&g<="Z")&&(y+=u[E].toLowerCase());for(var g,_,k;m.has(y);){if(/\d/g.test(y)){if(y=y.substr(0,y.length-1)+(y[y.length-1]+1),!(y.length>3))continue;y=y.substr(0,3)}else if(y.length<3){y+="2";continue}let E=1,A=y;for(;m.has(A)&&E<8;)_=y,A=(1&(k=E)?_[0].toUpperCase():_[0].toLowerCase())+(2&k?_[1].toUpperCase():_[1].toLowerCase())+(4&k?_[2].toUpperCase():_[2].toLowerCase()),++E;if(E<8)y=A;else{let S=y.charCodeAt(2)+1&127;y=y.substr(0,2)+String.fromCharCode(S)}}return y}(c,l),l.add(h.idPrefix)),/^\$/.test(c)||(i[`$${c}_mutations`]="++rev",h.markedForSync=!0),h.deleted&&(h.deleted=!1)):(h.deleted=!0,h.markedForSync=!1,i[`$${c}_mutations`]=null)}),e.call(this,i,r)}}const ii=new $t(!0),Ga=new $t(!0);ii.pipe(Ot(e=>e?wn(!0):wn(!1).pipe(Tc(2e4))),jc()).subscribe(Ga);const ef=typeof document<"u"?cn(document,"visibilitychange"):wn({}),py=ef.pipe(un(()=>document.visibilityState==="hidden")),yy=ef.pipe(un(()=>document.visibilityState==="visible")),tf=typeof window<"u"?dc(yy,cn(window,"mousedown"),cn(window,"mousemove"),cn(window,"keydown"),cn(window,"wheel"),cn(window,"touchmove")):wn({});typeof document<"u"&&dc(wn(!0),py,tf).pipe(fn(()=>document.visibilityState==="visible"),Kl(e=>{ii.value!==e&&ii.next(e)}),Ot(e=>e?wn(0).pipe(Tc(16e4),Kl(()=>ii.next(!1))):wn(0))).subscribe(()=>{});class my extends Error{constructor(){super(...arguments),this.name="TokenExpiredError"}}class gy extends yt{constructor(t,n,r,i,a,l,c,d){super(h=>new _y(t,n,r,i,c,d,h,a,l))}}let by=0;class _y extends Ar{constructor(t,n,r,i,a,l,c,d,h){super(()=>this.teardown()),this.id=++by,this.reconnecting=!1,this.databaseUrl=t,this.rev=n,this.realmSetHash=r,this.clientIdentity=i,this.token=a,this.tokenExpiration=l,this.subscriber=c,this.lastUserActivity=new Date,this.messageProducer=d,this.messageProducerSubscription=null,this.webSocketStatus=h,this.connect()}teardown(){this.disconnect()}disconnect(){if(this.webSocketStatus.next("disconnected"),this.pinger&&(clearInterval(this.pinger),this.pinger=null),this.ws)try{this.ws.close()}catch{}this.ws=null,this.messageProducerSubscription&&(this.messageProducerSubscription.unsubscribe(),this.messageProducerSubscription=null)}reconnect(){if(!this.reconnecting){this.reconnecting=!0;try{this.disconnect()}catch{}this.connect().catch(()=>{}).then(()=>this.reconnecting=!1)}}connect(){return Pe(this,void 0,void 0,function*(){if(this.lastServerActivity=new Date,this.pauseUntil&&this.pauseUntil>new Date)return;if(this.ws)throw new Error("Called connect() when a connection is already open");if(!this.databaseUrl)throw new Error("Cannot connect without a database URL");if(this.closed)return;if(this.tokenExpiration&&this.tokenExpiration<new Date)return void this.subscriber.error(new my);this.webSocketStatus.next("connecting"),this.pinger=setInterval(()=>Pe(this,void 0,void 0,function*(){if(this.closed)this.teardown();else if(this.ws)try{this.ws.send(JSON.stringify({type:"ping"})),setTimeout(()=>{this.pinger&&(this.closed?this.teardown():this.lastServerActivity<new Date(Date.now()-2e4)&&this.reconnect())},2e4)}catch{this.reconnect()}else this.reconnect()}),3e4);const t=new URL(this.databaseUrl);t.protocol=t.protocol==="http:"?"ws":"wss";const n=new URLSearchParams;if(this.subscriber.closed)return;n.set("v","2"),n.set("rev",this.rev),n.set("realmsHash",this.realmSetHash),n.set("clientId",this.clientIdentity),this.token&&n.set("token",this.token);const r=this.ws=new WebSocket(`${t}/changes?${n}`);r.onclose=i=>{this.pinger&&this.reconnect()},r.onmessage=i=>{if(this.pinger){this.lastServerActivity=new Date;try{const a=ao.parse(i.data);if(a.type==="error")throw new Error(`Error message from dexie-cloud: ${a.error}`);a.type==="rev"&&(this.rev=a.rev),a.type!=="pong"&&this.subscriber.next(a)}catch(a){this.subscriber.error(a)}}};try{let i=!1;yield new Promise((a,l)=>{r.onopen=c=>{i=!0,a(null)},r.onerror=c=>{if(i)this.reconnect();else{const d=c.error||new Error("WebSocket Error");this.subscriber.error(d),this.webSocketStatus.next("error"),l(d)}}}),this.messageProducerSubscription=this.messageProducer.subscribe(a=>{var l;this.closed||(a.type==="ready"&&this.webSocketStatus.value!=="connected"&&this.webSocketStatus.next("connected"),(l=this.ws)===null||l===void 0||l.send(ao.stringify(a)))})}catch{this.pauseUntil=new Date(Date.now()+6e4)}})}}class wy extends Error{constructor(t){super(t==="expired"?"License expired":t==="deactivated"?"User deactivated":"Invalid license"),this.name="InvalidLicenseError",t&&(this.license=t)}}function ky(e){return Pe(this,void 0,void 0,function*(){var t;yield(t=3e3,new Promise(n=>setTimeout(n,t))),yield vr(tf)})}function Xl(e){var t;return Pe(this,void 0,void 0,function*(){return!(!(!((t=e.cloud.options)===null||t===void 0)&&t.databaseUrl)||!e.cloud.schema)&&(yield ci(e,e.cloud.options,e.cloud.schema,{justCheckIfNeeded:!0}))})}const zi=new WeakMap;function nf(e,t,n,r){const i=zi.get(e);if(i){if(i.pull||(r==null?void 0:r.purpose)==="push")return i.promise;{let l=!1;const c=e.cloud.syncState.subscribe(d=>{d.phase==="pulling"&&(l=!0)});return i.promise.then(()=>{c.unsubscribe()}).catch(d=>(c.unsubscribe(),Promise.reject(d))).then(()=>{if(!l)return nf(e,t,n,r)})}}const a=function(){return Pe(this,void 0,void 0,function*(){try{if(yield Wc(e),e.cloud.isServiceWorkerDB)yield ci(e,t,n,r);else{if(e.cloud.usingServiceWorker)throw hc(!1),new Error("Internal _syncIfPossible() - invalid precondition - should not have been called.");yield function(l,c,d){return typeof navigator<"u"&&navigator.locks?navigator.locks.request(l.name+"|"+c,()=>d()):d()}(e,Xp,()=>ci(e,t,n,r))}zi.delete(e)}catch(l){throw zi.delete(e),l}})}();return zi.set(e,{promise:a,pull:(r==null?void 0:r.purpose)!=="push"}),a}const xy=6e4;function Sy(e,t,n){let r=null,i={cancelled:!1},a=null,l=null;function c(h,u=1){setTimeout(()=>{a&&clearTimeout(a);const m=l==="pull"?"pull":h;a=null,l=null,nf(e,t,n,{cancelToken:i,retryImmediatelyOnFetchError:!0,purpose:m}).catch(y=>{if(i.cancelled)d();else if(u<3){const g=l&&l==="pull"?"pull":h,_=setTimeout(()=>c(g,u+1),[0,5,15][u]*xy);a&&clearTimeout(a),a=_,l=g}})},0)}const d=()=>{i.cancelled=!0,r&&r.unsubscribe()};return{start:()=>{r=e.localSyncEvent.subscribe(({purpose:h})=>{try{c(h||"pull")}catch{}})},stop:d}}function ba(e,t){if(e&&t&&t.unsyncedTables)for(const n of t.unsyncedTables)e[n]&&(e[n].markedForSync=!1)}var ko,Fe,rf,oi,$l,so={},of=[],Iy=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Rn(e,t){for(var n in t)e[n]=t[n];return e}function af(e){var t=e.parentNode;t&&t.removeChild(e)}function ht(e,t,n){var r,i,a,l={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?ko.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)l[a]===void 0&&(l[a]=e.defaultProps[a]);return Xi(e,l,r,i,null)}function Xi(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++rf};return i==null&&Fe.vnode!=null&&Fe.vnode(a),a}function Ir(e){return e.children}function ai(e,t){this.props=e,this.context=t}function Er(e,t){if(t==null)return e.__?Er(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Er(e):null}function sf(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return sf(e)}}function eu(e){(!e.__d&&(e.__d=!0)&&oi.push(e)&&!lo.__r++||$l!==Fe.debounceRendering)&&(($l=Fe.debounceRendering)||setTimeout)(lo)}function lo(){for(var e;lo.__r=oi.length;)e=oi.sort(function(t,n){return t.__v.__b-n.__v.__b}),oi=[],e.some(function(t){var n,r,i,a,l,c;t.__d&&(l=(a=(n=t).__v).__e,(c=n.__P)&&(r=[],(i=Rn({},a)).__v=a.__v+1,_s(c,a,i,n.__n,c.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Er(a),a.__h),ff(r,a),a.__e!=l&&sf(a)))})}function lf(e,t,n,r,i,a,l,c,d,h){var u,m,y,g,_,k,E,A=r&&r.__k||of,S=A.length;for(n.__k=[],u=0;u<t.length;u++)if((g=n.__k[u]=(g=t[u])==null||typeof g=="boolean"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?Xi(null,g,null,null,g):Array.isArray(g)?Xi(Ir,{children:g},null,null,null):g.__b>0?Xi(g.type,g.props,g.key,null,g.__v):g)!=null){if(g.__=n,g.__b=n.__b+1,(y=A[u])===null||y&&g.key==y.key&&g.type===y.type)A[u]=void 0;else for(m=0;m<S;m++){if((y=A[m])&&g.key==y.key&&g.type===y.type){A[m]=void 0;break}y=null}_s(e,g,y=y||so,i,a,l,c,d,h),_=g.__e,(m=g.ref)&&y.ref!=m&&(E||(E=[]),y.ref&&E.push(y.ref,null,g),E.push(m,g.__c||_,g)),_!=null?(k==null&&(k=_),typeof g.type=="function"&&g.__k===y.__k?g.__d=d=uf(g,d,e):d=cf(e,g,y,A,_,d),typeof n.type=="function"&&(n.__d=d)):d&&y.__e==d&&d.parentNode!=e&&(d=Er(y))}for(n.__e=k,u=S;u--;)A[u]!=null&&(typeof n.type=="function"&&A[u].__e!=null&&A[u].__e==n.__d&&(n.__d=Er(r,u+1)),vf(A[u],A[u]));if(E)for(u=0;u<E.length;u++)df(E[u],E[++u],E[++u])}function uf(e,t,n){for(var r,i=e.__k,a=0;i&&a<i.length;a++)(r=i[a])&&(r.__=e,t=typeof r.type=="function"?uf(r,t,n):cf(n,r,r,i,r.__e,t));return t}function cf(e,t,n,r,i,a){var l,c,d;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),l=null;else{for(c=a,d=0;(c=c.nextSibling)&&d<r.length;d+=2)if(c==i)break e;e.insertBefore(i,a),l=a}return l!==void 0?l:i.nextSibling}function tu(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||Iy.test(t)?n:n+"px"}function Vi(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||tu(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||tu(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?ru:nu,a):e.removeEventListener(t,a?ru:nu,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function nu(e){this.l[e.type+!1](Fe.event?Fe.event(e):e)}function ru(e){this.l[e.type+!0](Fe.event?Fe.event(e):e)}function _s(e,t,n,r,i,a,l,c,d){var h,u,m,y,g,_,k,E,A,S,x,C,D,R=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(d=n.__h,c=t.__e=n.__e,t.__h=null,a=[c]),(h=Fe.__b)&&h(t);try{e:if(typeof R=="function"){if(E=t.props,A=(h=R.contextType)&&r[h.__c],S=h?A?A.props.value:h.__:r,n.__c?k=(u=t.__c=n.__c).__=u.__E:("prototype"in R&&R.prototype.render?t.__c=u=new R(E,S):(t.__c=u=new ai(E,S),u.constructor=R,u.render=Oy),A&&A.sub(u),u.props=E,u.state||(u.state={}),u.context=S,u.__n=r,m=u.__d=!0,u.__h=[]),u.__s==null&&(u.__s=u.state),R.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Rn({},u.__s)),Rn(u.__s,R.getDerivedStateFromProps(E,u.__s))),y=u.props,g=u.state,m)R.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(R.getDerivedStateFromProps==null&&E!==y&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(E,S),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(E,u.__s,S)===!1||t.__v===n.__v){u.props=E,u.state=u.__s,t.__v!==n.__v&&(u.__d=!1),u.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(W){W&&(W.__=t)}),u.__h.length&&l.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(E,u.__s,S),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(y,g,_)})}if(u.context=S,u.props=E,u.__v=t,u.__P=e,x=Fe.__r,C=0,"prototype"in R&&R.prototype.render)u.state=u.__s,u.__d=!1,x&&x(t),h=u.render(u.props,u.state,u.context);else do u.__d=!1,x&&x(t),h=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++C<25);u.state=u.__s,u.getChildContext!=null&&(r=Rn(Rn({},r),u.getChildContext())),m||u.getSnapshotBeforeUpdate==null||(_=u.getSnapshotBeforeUpdate(y,g)),D=h!=null&&h.type===Ir&&h.key==null?h.props.children:h,lf(e,Array.isArray(D)?D:[D],t,n,r,i,a,l,c,d),u.base=t.__e,t.__h=null,u.__h.length&&l.push(u),k&&(u.__E=u.__=null),u.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Ey(n.__e,t,n,r,i,a,l,d);(h=Fe.diffed)&&h(t)}catch(W){t.__v=null,(d||a!=null)&&(t.__e=c,t.__h=!!d,a[a.indexOf(c)]=null),Fe.__e(W,t,n)}}function ff(e,t){Fe.__c&&Fe.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){Fe.__e(r,n.__v)}})}function Ey(e,t,n,r,i,a,l,c){var d,h,u,m=n.props,y=t.props,g=t.type,_=0;if(g==="svg"&&(i=!0),a!=null){for(;_<a.length;_++)if((d=a[_])&&"setAttribute"in d==!!g&&(g?d.localName===g:d.nodeType===3)){e=d,a[_]=null;break}}if(e==null){if(g===null)return document.createTextNode(y);e=i?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,y.is&&y),a=null,c=!1}if(g===null)m===y||c&&e.data===y||(e.data=y);else{if(a=a&&ko.call(e.childNodes),h=(m=n.props||so).dangerouslySetInnerHTML,u=y.dangerouslySetInnerHTML,!c){if(a!=null)for(m={},_=0;_<e.attributes.length;_++)m[e.attributes[_].name]=e.attributes[_].value;(u||h)&&(u&&(h&&u.__html==h.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(k,E,A,S,x){var C;for(C in A)C==="children"||C==="key"||C in E||Vi(k,C,null,A[C],S);for(C in E)x&&typeof E[C]!="function"||C==="children"||C==="key"||C==="value"||C==="checked"||A[C]===E[C]||Vi(k,C,E[C],A[C],S)}(e,y,m,i,c),u)t.__k=[];else if(_=t.props.children,lf(e,Array.isArray(_)?_:[_],t,n,r,i&&g!=="foreignObject",a,l,a?a[0]:n.__k&&Er(n,0),c),a!=null)for(_=a.length;_--;)a[_]!=null&&af(a[_]);c||("value"in y&&(_=y.value)!==void 0&&(_!==e.value||g==="progress"&&!_||g==="option"&&_!==m.value)&&Vi(e,"value",_,m.value,!1),"checked"in y&&(_=y.checked)!==void 0&&_!==e.checked&&Vi(e,"checked",_,m.checked,!1))}return e}function df(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){Fe.__e(r,n)}}function vf(e,t,n){var r,i;if(Fe.unmount&&Fe.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||df(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){Fe.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&vf(r[i],t,typeof e.type!="function");n||e.__e==null||af(e.__e),e.__e=e.__d=void 0}function Oy(e,t,n){return this.constructor(e,n)}function iu(e,t,n){var r,i,a;Fe.__&&Fe.__(e,t),i=(r=!1)?null:t.__k,a=[],_s(t,e=t.__k=ht(Ir,null,[e]),i||so,so,t.ownerSVGElement!==void 0,i?null:t.firstChild?ko.call(t.childNodes):null,a,i?i.__e:t.firstChild,r),ff(a,e)}ko=of.slice,Fe={__e:function(e,t,n,r){for(var i,a,l;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&a.getDerivedStateFromError!=null&&(i.setState(a.getDerivedStateFromError(e)),l=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,r||{}),l=i.__d),l)return i.__E=i}catch(c){e=c}throw e}},rf=0,ai.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Rn({},this.state),typeof e=="function"&&(e=e(Rn({},n),this.props)),e&&Rn(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),eu(this))},ai.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),eu(this))},ai.prototype.render=Ir,oi=[],lo.__r=0;const ln={Alert:{error:{color:"red",fontWeight:"bold"},warning:{color:"#f80",fontWeight:"bold"},info:{color:"black"}},Darken:{position:"fixed",top:0,left:0,opacity:.5,backgroundColor:"#000",width:"100vw",height:"100vh",zIndex:150,webkitBackdropFilter:"blur(2px)",backdropFilter:"blur(2px)"},DialogOuter:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:150,alignItems:"center",display:"flex",justifyContent:"center"},DialogInner:{position:"relative",color:"#222",backgroundColor:"#fff",padding:"30px",marginBottom:"2em",maxWidth:"90%",maxHeight:"90%",overflowY:"auto",border:"3px solid #3d3d5d",borderRadius:"8px",boxShadow:"0 0 80px 10px #666",width:"auto",fontFamily:"sans-serif"},Input:{height:"35px",width:"17em",borderColor:"#ccf4",outline:"none",fontSize:"17pt",padding:"8px"}};function Cy({children:e,className:t}){return ht("div",{className:t},ht("div",{style:ln.Darken}),ht("div",{style:ln.DialogOuter},ht("div",{style:ln.DialogInner},e)))}var xo,pt,_a,ou,uo=0,hf=[],$i=[],au=Fe.__b,su=Fe.__r,lu=Fe.diffed,uu=Fe.__c,cu=Fe.unmount;function ws(e,t){Fe.__h&&Fe.__h(pt,e,uo||t),uo=0;var n=pt.__H||(pt.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:$i}),n.__[e]}function Ay(e){return uo=1,function(t,n,r){var i=ws(xo++,2);if(i.t=t,!i.__c&&(i.__=[du(void 0,n),function(l){var c=i.__N?i.__N[0]:i.__[0],d=i.t(c,l);c!==d&&(i.__N=[d,i.__[1]],i.__c.setState({}))}],i.__c=pt,!pt.u)){pt.u=!0;var a=pt.shouldComponentUpdate;pt.shouldComponentUpdate=function(l,c,d){if(!i.__c.__H)return!0;var h=i.__c.__H.__.filter(function(m){return m.__c});if(h.every(function(m){return!m.__N}))return!a||a.call(this,l,c,d);var u=!1;return h.forEach(function(m){if(m.__N){var y=m.__[0];m.__=m.__N,m.__N=void 0,y!==m.__[0]&&(u=!0)}}),!!u&&(!a||a.call(this,l,c,d))}}return i.__N||i.__}(du,e)}function Py(e){return uo=5,function(t,n){var r=ws(xo++,7);return pf(r.__H,n)?(r.__V=t(),r.i=n,r.__h=t,r.__V):r.__}(function(){return{current:e}},[])}function Ty(){for(var e;e=hf.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(eo),e.__H.__h.forEach(Ja),e.__H.__h=[]}catch(t){e.__H.__h=[],Fe.__e(t,e.__v)}}Fe.__b=function(e){pt=null,au&&au(e)},Fe.__r=function(e){su&&su(e),xo=0;var t=(pt=e.__c).__H;t&&(_a===pt?(t.__h=[],pt.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=$i,n.__N=n.i=void 0})):(t.__h.forEach(eo),t.__h.forEach(Ja),t.__h=[])),_a=pt},Fe.diffed=function(e){lu&&lu(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(hf.push(t)!==1&&ou===Fe.requestAnimationFrame||((ou=Fe.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),fu&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);fu&&(r=requestAnimationFrame(i))})(Ty)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==$i&&(n.__=n.__V),n.i=void 0,n.__V=$i})),_a=pt=null},Fe.__c=function(e,t){t.some(function(n){try{n.__h.forEach(eo),n.__h=n.__h.filter(function(r){return!r.__||Ja(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],Fe.__e(r,n.__v)}}),uu&&uu(e,t)},Fe.unmount=function(e){cu&&cu(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{eo(r)}catch(i){t=i}}),t&&Fe.__e(t,n.__v))};var fu=typeof requestAnimationFrame=="function";function eo(e){var t=pt,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),pt=t}function Ja(e){var t=pt;e.__c=e.__(),pt=t}function pf(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function du(e,t){return typeof t=="function"?t(e):t}function jy({message:e,messageCode:t,messageParams:n}){return e.replace(/\{\w+\}/gi,r=>n[r.substring(1,r.length-1)])}function Dy({title:e,type:t,alerts:n,fields:r,submitLabel:i,cancelLabel:a,onCancel:l,onSubmit:c}){const[d,h]=Ay({}),u=Py(null);return function(m,y){var g=ws(xo++,4);!Fe.__s&&pf(g.__H,y)&&(g.__=m,g.i=y,pt.__h.push(g))}(()=>{var m;return(m=u.current)===null||m===void 0?void 0:m.focus()},[]),ht(Cy,{className:"dxc-login-dlg"},ht(Ir,null,ht("h3",{style:ln.WindowHeader},e),n.map(m=>ht("p",{style:ln.Alert[m.type]},jy(m))),ht("form",{onSubmit:m=>{m.preventDefault(),c(d)}},Object.entries(r).map(([m,{type:y,label:g,placeholder:_}],k)=>ht("label",{style:ln.Label,key:k},g?`${g}: `:"",ht("input",{ref:k===0?u:void 0,type:y,name:m,autoComplete:"on",style:ln.Input,autoFocus:!0,placeholder:_,value:d[m]||"",onInput:E=>{var A;const S=function(C,D){switch(C){case"email":return D.toLowerCase();case"otp":return D.toUpperCase();default:return D}}(y,(A=E.target)===null||A===void 0?void 0:A.value);let x=Object.assign(Object.assign({},d),{[m]:S});h(x),y==="otp"&&(S==null?void 0:S.trim().length)===8&&c(x)}}))))),ht("div",{style:ln.ButtonsDiv},ht(Ir,null,ht("button",{type:"submit",style:ln.Button,onClick:()=>c(d)},i),a&&ht("button",{style:ln.Button,onClick:l},a))))}class vu extends ai{constructor(t){super(t),this.observer=n=>this.setState({userInteraction:n}),this.state={userInteraction:void 0}}componentDidMount(){this.subscription=dn(this.props.db.cloud.userInteraction).subscribe(this.observer)}componentWillUnmount(){this.subscription&&(this.subscription.unsubscribe(),delete this.subscription)}render(t,{userInteraction:n}){return n?ht(Dy,Object.assign({},n)):null}}function yi(e){const t=new WeakMap;return n=>{let r=t.get(n);return r||(r=e(n),t.set(n,r)),r}}const co=yi(e=>new $t(Mt));function So(e,t){let n=t,r=dn(e).pipe(go(a=>n=a),lp({resetOnRefCountZero:()=>ap(1e3)}));const i=new yt(a=>{let l=!1;const c=r.subscribe({next(d){l=!0,a.next(d)},error(d){a.error(d)},complete(){a.complete()}});return l||c.closed||a.next(n),c});return i.getValue=()=>n,i}const yf=yi(e=>So(fr(()=>e.roles.where({realmId:"rlm-public"}).toArray().then(t=>{const n={};for(const r of t.slice().sort((i,a)=>(i.sortOrder||0)-(a.sortOrder||0)))n[r.name]=r;return n})),{})),mf=yi(e=>So(co(e._novip).pipe(Ot(t=>fr(()=>e.transaction("r","realms","members",()=>Promise.all([e.members.where({userId:t.userId}).toArray(),e.realms.toArray(),t.userId]).then(([n,r,i])=>({selfMembers:n,realms:r,userId:i})))))),{selfMembers:[],realms:[],get userId(){return e.cloud.currentUserId}}));function Ry(...e){return e.length===0?{}:e.reduce((n,r)=>{const i=Object.assign({},n);for(const[a,l]of Object.entries(r))if(a in i&&i[a]){if(i[a]==="*")continue;if(l==="*")i[a]="*";else if(Array.isArray(l)&&Array.isArray(i[a])){const c=i,d=c[a];c[a]=[...new Set([...d,...l])]}else if(typeof l=="object"&&l&&typeof i[a]=="object"){const c=i[a];for(const[d,h]of Object.entries(l))c[d]!=="*"&&(h==="*"?c[d]="*":Array.isArray(c[d])&&Array.isArray(h)&&(c[d]=[...new Set([...c[d],...h])]))}}else i[a]=r[a];return i})}const gf=yi(e=>function(t,n){let r;const i=t.pipe(go(a=>r=n(a)));return i.getValue=()=>r!==void 0?r:r=n(t.getValue()),i}(So(ro([mf(e._novip),yf(e._novip)]).pipe(fn(([{selfMembers:t,realms:n,userId:r},i])=>({selfMembers:t,realms:n,userId:r,globalRoles:i}))),{selfMembers:[],realms:[],userId:Mt.userId,globalRoles:{}}),({selfMembers:t,realms:n,userId:r,globalRoles:i})=>n.map(l=>{const c=t.filter(u=>u.realmId===l.realmId),d=c.map(u=>u.permissions).filter(u=>u),h=qc(c.map(u=>u.roles).filter(u=>u)).map(u=>i[u]).filter(u=>u).map(u=>u.permissions);return Object.assign(Object.assign({},l),{permissions:l.owner===r?{manage:"*"}:Ry(...d,...h)})}).reduce((l,c)=>Object.assign(Object.assign({},l),{[c.realmId]:c}),{[r]:{realmId:r,owner:r,name:r,permissions:{manage:"*"}}})));class hu{constructor(t,n,r){this.permissions=t||{},this.tableName=n,this.isOwner=r}add(...t){var n;return this.permissions.manage==="*"||!!(!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))||this.permissions.add==="*"||!!t.every(r=>{var i;return(i=this.permissions.add)===null||i===void 0?void 0:i.includes(r)})}update(...t){var n,r;if(this.isOwner||this.permissions.manage==="*"||!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))return!0;if(this.permissions.update==="*")return t.every(a=>a!=="owner");const i=(r=this.permissions.update)===null||r===void 0?void 0:r[this.tableName];return i==="*"?t.every(a=>a!=="owner"):t.every(a=>i==null?void 0:i.some(l=>l===a||l==="*"&&a!=="owner"))}delete(){var t;return!(!this.isOwner&&this.permissions.manage!=="*")||!!(!((t=this.permissions.manage)===null||t===void 0)&&t.includes(this.tableName))}}const Ny=yi(e=>{const t=co(e._novip).pipe(Ot(i=>fr(()=>e.members.where({email:i.email||""}).toArray()))),n=gf(e._novip),r=mf(e._novip);return So(ro([t,r,n]).pipe(fn(([i,a,l])=>{const c=(u,m)=>Object.assign(Object.assign({},u),{[m.id]:Object.assign(Object.assign({},m),{realm:l[m.realmId]})}),d=i.reduce(c,{}),h=a.selfMembers.reduce(c,d);return Object.values(h).filter(u=>!u.accepted).map(u=>Object.assign(Object.assign({},u),{accept(){return Pe(this,void 0,void 0,function*(){yield e.members.update(u.id,{accepted:new Date})})},reject(){return Pe(this,void 0,void 0,function*(){yield e.members.update(u.id,{rejected:new Date})})}}))})),[])}),Ly={nameSuffix:!0};function Qa(e){const t=e.name,n=co(e),r=[];let i=!1,a=null;e.on("ready",u=>Pe(this,void 0,void 0,function*(){try{yield function(m){var y,g,_,k,E,A,S;return Pe(this,void 0,void 0,function*(){l=!1;const x=mn(m);typeof window<"u"&&typeof document<"u"&&(!((y=x.cloud.options)===null||y===void 0)&&y.customLoginGui||r.push(function(Y){let ne=!1;const te=document.createElement("div");return document.body?(document.body.appendChild(te),iu(ht(vu,{db:Y.vip}),te)):addEventListener("DOMContentLoaded",()=>{ne||(document.body.appendChild(te),iu(ht(vu,{db:Y.vip}),te))}),{unsubscribe(){try{te.remove()}catch{}ne=!0},get closed(){return ne}}}(m))),x.cloud.isServiceWorkerDB||r.push(function(Y){let ne=Y.cloud.webSocketStatus.value;const te=Y.cloud.webSocketStatus.pipe(Ot(H=>{const $=ne;ne=H;const oe=wn(H);switch(H){case"disconnected":return ii.value?oe.pipe(Ul(500)):oe;case"connecting":return $==="not-started"||$==="error"?oe:oe.pipe(Ul(4e3));default:return oe}}));return ro([te,Y.syncStateChangedEvent.pipe(Cp({phase:"initial"})),co(Y.dx._novip),Ga]).pipe(fn(([H,$,oe,ce])=>{var De;if(!((De=oe.license)===null||De===void 0)&&De.status&&oe.license.status!=="ok")return{phase:"offline",status:"offline",license:oe.license.status};let{phase:Re,error:he,progress:B}=$,Ne=H;return Re==="error"&&(Ne="error"),H==="not-started"&&(Re!=="pushing"&&Re!=="pulling"||(Ne="connecting")),Y.cloud.syncState.value.phase!=="error"||$.phase!=="pushing"&&$.phase!=="pulling"||(Ne="connecting"),ce||(Ne="disconnected"),{phase:Re,error:he,progress:B,status:pr?Ne:"offline",license:"ok"}}))}(x).subscribe(m.cloud.syncState)),r.push(x.syncCompleteEvent.subscribe(d)),x.tables.every(Y=>Y.core)||Zc();const C="serviceWorker"in navigator?yield navigator.serviceWorker.getRegistrations():[],[D,R]=yield x.transaction("rw",x.$syncState,()=>Pe(this,void 0,void 0,function*(){var Y,ne;const{options:te,schema:H}=x.cloud,[$,oe,ce]=yield Promise.all([x.getOptions(),x.getSchema(),x.getPersistedSyncState()]);if(i){if(!$||JSON.stringify($)!==JSON.stringify(te)){if(!te)throw new Error("Internal error");const De=Object.assign({},te);delete De.fetchTokens,yield x.$syncState.put(De,"options")}}else x.cloud.options=$||null;if(!((Y=x.cloud.options)===null||Y===void 0)&&Y.tryUseServiceWorker&&"serviceWorker"in navigator&&C.length>0&&!ay?x.cloud.usingServiceWorker=!0:(!((ne=x.cloud.options)===null||ne===void 0)&&ne.tryUseServiceWorker&&x.cloud.isServiceWorkerDB,x.cloud.usingServiceWorker=!1),ba(H,x.cloud.options),ba(oe,x.cloud.options),H){if(!oe||JSON.stringify(oe)!==JSON.stringify(H)){const De=oe||{};for(const[Re,he]of Object.entries(H)){const B=De[Re];B?(B.markedForSync=he.markedForSync,he.deleted=B.deleted,B.generatedGlobalId=he.generatedGlobalId):De[Re]=Object.assign({},he)}yield x.$syncState.put(De,"schema"),Object.assign(H,De)}}else x.cloud.schema=oe||null;return[ce==null?void 0:ce.initiallySynced,ce==null?void 0:ce.realms]}));D&&x.setInitiallySynced(!0),function(Y){var ne,te;for(const H of Y.tables)if(!((te=(ne=Y.cloud.schema)===null||ne===void 0?void 0:ne[H.name])===null||te===void 0)&&te.markedForSync){if(H.schema.primKey.auto)throw new st.SchemaError(`Table ${H.name} is both autoIncremented and synced. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(H.name)}]}) to blacklist it from sync`);if(!H.schema.primKey.keyPath)throw new st.SchemaError(`Table ${H.name} cannot be both synced and outbound. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(H.name)}]}) to blacklist it from sync`)}}(x),!((g=x.cloud.options)===null||g===void 0)&&g.databaseUrl&&!D&&(yield function(Y,ne,te){return Pe(this,void 0,void 0,function*(){yield ci(Y,ne,te,{isInitialSync:!0})})}(x,x.cloud.options,x.cloud.schema),x.setInitiallySynced(!0)),c(),x.cloud.isServiceWorkerDB||(r.push(fr(()=>x.getCurrentUser()).subscribe(n)),r.push(fr(()=>x.getPersistedSyncState()).subscribe(x.cloud.persistedSyncState)),yield vr(ro([n.pipe(Bl(1),cr(1)),x.cloud.persistedSyncState.pipe(Bl(1),cr(1))])));let W=!1;const Z=yield x.getCurrentUser(),G=(_=x.cloud.options)===null||_===void 0?void 0:_.requireAuth;G&&(typeof G=="object"?(!Z.isLoggedIn||G.userId&&Z.userId!==G.userId||G.email&&Z.email!==G.email)&&(W=yield pa(x,G)):Z.isLoggedIn||(W=yield pa(x))),!Z.isLoggedIn||R&&R.includes(Z.userId)||(W=!0),a&&a.stop(),a=null,c(),x.cloud.usingServiceWorker&&(!((k=x.cloud.options)===null||k===void 0)&&k.databaseUrl)?(Dc(x,W?"pull":"push").catch(()=>{}),function(Y){var ne;return Pe(this,void 0,void 0,function*(){try{const{periodicSync:te}=yield navigator.serviceWorker.ready;if(te)try{yield te.register(`dexie-cloud:${Y.name}`,(ne=Y.cloud.options)===null||ne===void 0?void 0:ne.periodicSync)}catch{}}catch{}})}(x).catch(()=>{})):!((E=x.cloud.options)===null||E===void 0)&&E.databaseUrl&&x.cloud.schema&&!x.cloud.isServiceWorkerDB&&(a=Sy(x,x.cloud.options,x.cloud.schema),a.start(),_n(x,W?"pull":"push")),c(),x.cloud.isServiceWorkerDB||r.push(cn(self,"online").subscribe(()=>{x.syncStateChangedEvent.next({phase:"not-in-sync"}),$c(x)||_n(x,"push")}),cn(self,"offline").subscribe(()=>{x.syncStateChangedEvent.next({phase:"offline"})})),!(!((A=x.cloud.options)===null||A===void 0)&&A.databaseUrl)||!((S=x.cloud.options)===null||S===void 0)&&S.disableWebSocket||sy||r.push(function(Y){var ne;if(!(!((ne=Y.cloud.options)===null||ne===void 0)&&ne.databaseUrl))throw new Error("No database URL to connect WebSocket to");const te=Y.messageConsumer.readyToServe.pipe(un(H=>H),Ot(()=>Y.getPersistedSyncState()),un(H=>H&&H.serverRevision),Ot(H=>Pe(this,void 0,void 0,function*(){return{type:"ready",rev:H.serverRevision,realmSetHash:yield za(H)}})));return function H(){return Y.cloud.persistedSyncState.pipe(un($=>$==null?void 0:$.serverRevision),cr(1),Ot($=>Y.cloud.currentUser.pipe(fn(oe=>[oe,$]))),Ot(([$,oe])=>Ga.pipe(fn(ce=>[ce?$:null,oe]))),Ot(([$,oe])=>$!=null&&$.isLoggedIn&&!(oe!=null&&oe.realms.includes($.userId))?Y.cloud.persistedSyncState.pipe(un(ce=>(ce==null?void 0:ce.realms.includes($.userId))||!1),cr(1),fn(ce=>[$,ce])):new $t([$,oe])),Ot(([$,oe])=>Pe(this,void 0,void 0,function*(){return[$,yield za(oe)]})),jc(([$,oe],[ce,De])=>$===ce&&oe===De),Ot(([$,oe])=>{var ce;return!((ce=Y.cloud.persistedSyncState)===null||ce===void 0)&&ce.value?$?new gy(Y.cloud.options.databaseUrl,Y.cloud.persistedSyncState.value.serverRevision,oe,Y.cloud.persistedSyncState.value.clientIdentity,te,Y.cloud.webSocketStatus,$.accessToken,$.accessTokenExpiration):dn([]):H()}),La($=>($==null?void 0:$.name)==="TokenExpiredError"?wn(!0).pipe(Ot(()=>Pe(this,void 0,void 0,function*(){const oe=yield Y.getCurrentUser(),ce=yield wo(Y.cloud.options.databaseUrl,oe);yield Y.table("$logins").update(oe.userId,{accessToken:ce.accessToken,accessTokenExpiration:ce.accessTokenExpiration,claims:ce.claims,license:ce.license,data:ce.data})})),Ot(()=>H())):Cl(()=>$)),La($=>(Y.cloud.webSocketStatus.next("error"),$ instanceof wy?Cl(()=>$):dn(ky()).pipe(Ot(()=>H())))))}().subscribe({next:H=>{H&&Y.messageConsumer.enqueue(H)},error:H=>{},complete:()=>{}})}(x))})}(u)}catch{}}),!0);let l=!1;function c(){if(l)throw new st.DatabaseClosedError}(function(u,m){u.on.close.subscribe(m);const y=u._close;u._close=function(){y.call(this),m()}})(e,()=>{r.forEach(u=>u.unsubscribe()),l=!0,a&&a.stop(),a=null,n.next(Mt)});const d=new vi;var h;e.cloud={version:"4.0.12",options:Object.assign({},Ly),schema:null,get currentUserId(){return n.value.userId||Mt.userId},currentUser:n,syncState:new $t({phase:"initial",status:"not-started"}),events:{syncComplete:d},persistedSyncState:new $t(void 0),userInteraction:new $t(void 0),webSocketStatus:new $t("not-started"),login(u){return Pe(this,void 0,void 0,function*(){const m=mn(e);yield m.cloud.sync(),yield pa(m,u)})},invites:Ny(e),roles:yf(e),configure(u){u=e.cloud.options=Object.assign(Object.assign({},e.cloud.options),u),i=!0,u.databaseUrl&&u.nameSuffix&&(e.name=`${t}-${function(m){const y=new URL(m);return y.pathname==="/"?y.hostname.split(".")[0]:y.pathname.split("/")[1]}(u.databaseUrl)}`,mn(e).reconfigure()),ba(e.cloud.schema,e.cloud.options)},logout({force:u}={}){return Pe(this,void 0,void 0,function*(){u?yield Ua(mn(e),{deleteUnsyncedData:!0}):yield Lc(mn(e))})},sync({wait:u,purpose:m}={wait:!0,purpose:"push"}){var y;return Pe(this,void 0,void 0,function*(){u===void 0&&(u=!0);const g=mn(e);if((((y=g.cloud.currentUser.value.license)===null||y===void 0?void 0:y.status)||"ok")!=="ok"&&(yield ms(g)),m==="pull"){const _=g.cloud.persistedSyncState.value;if(_n(g,m),u){const k=yield vr(g.cloud.persistedSyncState.pipe(un(E=>(E==null?void 0:E.timestamp)!=null&&(!_||E.timestamp>_.timestamp))));if(k!=null&&k.error)throw new Error("Sync error: "+k.error)}}else if(yield Xl(g)){const _=g.cloud.persistedSyncState.value;_n(g,m),u&&(yield vr(dn(fr(()=>Pe(this,void 0,void 0,function*(){const k=yield Xl(g),E=yield g.getPersistedSyncState();if((E==null?void 0:E.timestamp)!==(_==null?void 0:_.timestamp)&&(E!=null&&E.error))throw new Error("Sync error: "+E.error);return k}))).pipe(un(k=>!k))))}})},permissions:(u,m)=>function(y,g,_){if(!g)throw new TypeError("Cannot check permissions of undefined or null. A Dexie Cloud object with realmId and owner expected.");const{owner:k,realmId:E}=g;if(!_){if(typeof g.table!="function")throw new TypeError("Missing 'table' argument to permissions and table could not be extracted from entity");_=g.table()}const A=gf(y),S=C=>{const D=C[E||y.cloud.currentUserId];return D?new hu(D.permissions,_,E===void 0||E===y.cloud.currentUserId||k===y.cloud.currentUserId):new hu({},_,!k||k===y.cloud.currentUserId)},x=A.pipe(fn(S));return x.getValue=()=>S(A.getValue()),x}(e._novip,u,m)},e.Version.prototype._parseStoresSpec=st.override(e.Version.prototype._parseStoresSpec,u=>hy(u,e)),e.Table.prototype.newId=function({colocateWith:u}={}){const m=u&&u.substr(u.length-3);return Xc(e.cloud.schema[this.name].idPrefix||"",m)},e.Table.prototype.idPrefix=function(){var u,m;return((m=(u=this.db.cloud.schema)===null||u===void 0?void 0:u[this.name])===null||m===void 0?void 0:m.idPrefix)||""},e.use(vy({currentUserObservable:e.cloud.currentUser,db:mn(e)})),e.use((h=mn(e),{stack:"dbcore",name:"implicitPropSetterMiddleware",level:1,create:u=>Object.assign(Object.assign({},u),{table:m=>{const y=u.table(m);return Object.assign(Object.assign({},y),{mutate:g=>{var _,k,E,A;if(g.trans.disableChangeTracking)return y.mutate(g);const S=g.trans;if(!((k=(_=h.cloud.schema)===null||_===void 0?void 0:_[m])===null||k===void 0)&&k.markedForSync){if(S.mode==="versionchange")return Promise.reject(new st.UpgradeError(`Dexie Cloud Addon: Cannot upgrade or populate synced table "${m}". See https://dexie.org/cloud/docs/best-practices`));if(g.type==="add"||g.type==="put"){if(m==="members")for(const x of g.values)typeof x.email=="string"&&(x.email=x.email.trim().toLowerCase());for(const x of g.values){x.owner||(x.owner=S.currentUser.userId),x.realmId||(x.realmId=S.currentUser.userId);const C=(A=(E=y.schema.primaryKey).extractKey)===null||A===void 0?void 0:A.call(E,x);typeof C=="string"&&C[0]==="#"&&g.type==="put"&&(delete g.criteria,delete g.changeSpec,delete g.updates,x.$ts=Date.now())}}}return y.mutate(g)}})}})})),e.use(cy(mn(e)))}Qa.version="4.0.12",st.Cloud=Qa;class Io{constructor(){this._db=new st("FlavorAwesome",{addons:[Qa]}),this._db.version(20).stores({review:"id, created_at, updated_at, type",settings:"id"}),this._db.cloud.configure({customLoginGui:!0,databaseUrl:"https://zwa7o6jty.dexie.cloud",requireAuth:!1})}_filter(t,n){return t.filter(r=>!!(r.name.toLowerCase().indexOf(n)>=0||r.notes&&r.notes.toLowerCase().indexOf(n)>=0))}browseReview(t=null,n=null){return t===null?n===null?this._db.review.orderBy("updated_at").reverse().toArray():this._db.review.orderBy("updated_at").reverse().toArray().then(r=>this._filter(r,n)):n===null?this._db.review.where("type").equals(t).reverse().sortBy("updated_at"):this._db.review.where("type").equals(t).reverse().sortBy("updated_at").then(r=>this._filter(r,n))}readReview(t){return this._db.review.where("id").equals(t).toArray().then(n=>n[0])}addReview(t,n){const r=oa(n);return r.id=crypto.randomUUID(),r.type=t,r.created_at=new Date,r.updated_at=new Date,r.favorite=!1,this._db.review.add(r)}editReview(t){const n=oa(t);return n.updated_at=new Date,this._db.review.put(n).then(()=>this._db.review.where("id").equals(t.id).toArray().then(r=>r[0]))}deleteReview(t){return this._db.review.delete(t)}countReview(){return this._db.review.toArray().then(t=>t.reduce((n,r)=>(n.hasOwnProperty(r.type)?n[r.type]=n[r.type]+1:n[r.type]=1,n),{All:t.length}))}favoriteReview(t,n){return this._db.review.update(t,{favorite:n,updated_at:new Date}).then(()=>this._db.review.where("id").equals(t).toArray().then(r=>r[0]))}countReviews(){return this._db.review.toArray().then(t=>t.length)}createSettings(){const t={id:crypto.randomUUID(),created_at:new Date,updated_at:new Date,book:null,avatar:null,name:null,selected:null};return this._db.settings.add(t).then(()=>this._db.settings.toArray()).then(n=>n[0])}readSettings(){return this._db.settings.toArray().then(t=>t.length===0?null:t[0])}updateSettings(t){const n=oa(t);return n.updated_at=new Date,this._db.settings.put(n).then(()=>this._db.settings.toArray()).then(r=>r[0])}deleteSettings(){return this._db.settings.clear()}login(t){console.log("LOGIN EMAIL: "+t),this._db.cloud.login({email:t,grant_type:"otp"})}logout(){this._db.cloud.logout()}sync(){return console.log("DC SYNC"),this._db.cloud.sync({purpose:"pull",wait:!0})}get ui(){return this._db.cloud.userInteraction}get user(){return this._db.cloud.currentUser}get userId(){return this._db.cloud.currentUserId}}class My{constructor(t){const n=new Intl.NumberFormat(t).formatToParts(12345.6),r=[...new Intl.NumberFormat(t,{useGrouping:!1}).format(9876543210)].reverse(),i=new Map(r.map((a,l)=>[a,l]));this.group=new RegExp(`[${n.find(a=>a.type==="group").value}]`,"g"),this.decimal=new RegExp(`[${n.find(a=>a.type==="decimal").value}]`),this.numeral=new RegExp(`[${r.join("")}]`,"g"),this.index=a=>i.get(a)}parse(t){return(t=t.trim().replace(this.group,"").replace(this.decimal,".").replace(this.numeral,this.index))?+t:NaN}}function qy(e,t,n){t().trim().length===0&&t(null),n.onchange&&n.onchange({name:n.name,value:t()})}var Fy=se('<p class="svelte-mpcejc"> </p>'),Uy=se('<button tabindex="-1" type="button" class="svelte-mpcejc"><!></button>'),By=se('<label class="svelte-mpcejc"><div class="field svelte-mpcejc"><p class="svelte-mpcejc"> </p> <div class="parts svelte-mpcejc"><input type="text" class="svelte-mpcejc"> <!></div></div> <!></label> <!>',1);function kn(e,t){He(t,!0);let n=be(t,"mode",3,"text"),r=be(t,"value",7,null),i;function a(C){C.preventDefault(),r(null),i.focus(),t.onchange&&t.onchange({name:t.name,value:r()})}function l(){if(n()==="numeric"||n()==="decimal"){const C=n()==="numeric"?0:2;r()!==null&&r(new Number(r()).toLocaleString(navigator.language,{minimumFractionDigits:C,maximumFractionDigits:C}))}}function c(){if((n()==="numeric"||n()==="decimal")&&r()!==null){const C=new My(navigator.language);r(C.parse(r()).toString(10))}}var d=By(),h=Ce(d),u=P(h),m=P(u),y=P(m,!0);O(m);var g=V(m,2),_=P(g);Ru(_),_.__input=[qy,r,t],it(_,C=>i=C,()=>i);var k=V(_,2);{var E=C=>{var D=Fy(),R=P(D,!0);O(D),me(()=>Ee(R,t.suffix)),Q(C,D)};ve(k,C=>{t.suffix&&C(E)})}O(g),O(u);var A=V(u,2);{var S=C=>{var D=Uy();D.__click=a;var R=P(D);Te(R,{height:"24",icon:"material-symbols:cancel-outline",width:"24"}),O(D),Q(C,D)};ve(A,C=>{r()!==null&&C(S)})}O(h);var x=V(h,2);bn(x,()=>t.children??Cr),me(()=>{Ee(y,t.label),je(_,"inputmode",n()),je(_,"placeholder",t.placeholder)}),br("blur",_,l),br("focus",_,c),es(_,r),Q(e,d),Ye()}$e(["input","click"]);var Ky=se('<img alt="Edit avatar" class="svelte-1y1y2xg">'),zy=se('<span class="svelte-1y1y2xg"><!></span>'),Vy=se('<img alt="Loader. Not seen." class="loader svelte-1y1y2xg">'),Wy=se('<button type="button" class="svelte-1y1y2xg"><!></button> <!> <canvas class="svelte-1y1y2xg"></canvas> <input accept="image/*" type="file" class="svelte-1y1y2xg">',1);function Hy(e,t){let n=be(t,"value",7),r=ze(void 0),i,a;const l=.8,c=300;function d(){a.click()}function h(C){const D=C.currentTarget,R=D.getAttribute("data-type");D.getAttribute("data-name").lastIndexOf(".")+1;let Z=D.width,G=D.height;const Y=Math.max(Z,G);if(Y>c){const te=c/Y;Z=Z*te,G=G*te}i.width=Z,i.height=G,i.getContext("2d").drawImage(D,0,0,Z,G),n(i.toDataURL(R,l)),C.target.remove()}function u(){a.files.length>0&&(ke(r,a.files[0],!0),a.value="")}var m=Wy(),y=Ce(m);y.__click=d;var g=P(y);{var _=C=>{var D=Ky();me(()=>je(D,"src",n())),Q(C,D)},k=C=>{var D=zy(),R=P(D);Te(R,{height:"32",icon:"material-symbols:person-edit-rounded",width:"32"}),O(D),Q(C,D)};ve(g,C=>{n()?C(_):C(k,!1)})}O(y);var E=V(y,2);{var A=C=>{var D=Vy();me(R=>{je(D,"data-name",v(r).name),je(D,"data-type",v(r).type),je(D,"src",R)},[()=>URL.createObjectURL(v(r))]),br("load",D,h),$a(D),Q(C,D)};ve(E,C=>{v(r)&&C(A)})}var S=V(E,2);it(S,C=>i=C,()=>i);var x=V(S,2);x.__change=u,it(x,C=>a=C,()=>a),Q(e,m)}$e(["click","change"]);var Yy=se('<div><span><!></span> <div class="svelte-1wl9158"><p class="svelte-1wl9158"> </p> <p class="svelte-1wl9158"> </p></div></div>');function tn(e,t){let n=be(t,"bottom",3,!0),r=be(t,"gap",3,!0),i=be(t,"top",3,!1);var a=Yy();let l;var c=P(a);let d;var h=P(c);Te(h,{height:"24",get icon(){return t.icon},width:"24"}),O(c);var u=V(c,2),m=P(u),y=P(m);O(m);var g=V(m,2),_=P(g,!0);O(g),O(u),O(a),me((k,E)=>{l=ot(a,1,"svelte-1wl9158",null,l,k),d=ot(c,1,"svelte-1wl9158",null,d,E),Ee(y,`${t.value??""}${r()?" ":""}${t.suffix??""}`),Ee(_,t.label)},[()=>({bottom:n(),top:i()}),()=>({noicon:!t.icon})]),Q(e,a)}var Gy=se('<div class="svelte-11ggxxf"><span><!></span> <!></div>');function bf(e,t){He(t,!0);let n=be(t,"gap",3,!0),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()})}var l=Ve(),c=Ce(l);{var d=u=>{var m=Ve(),y=Ce(m);{var g=_=>{tn(_,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get value(){return i()}})};ve(y,_=>{i()!==null&&_(g)})}Q(u,m)},h=u=>{var m=Gy(),y=P(m);let g;var _=P(y);Te(_,{height:"24",get icon(){return t.icon},width:"24"}),O(y);var k=V(y,2);kn(k,{get label(){return t.label},onchange:a,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),O(m),me(E=>g=ot(y,1,"svelte-11ggxxf",null,g,E),[()=>({noicon:!t.icon})]),Q(u,m)};ve(c,u=>{r()?u(d):u(h,!1)})}Q(e,l),Ye()}var Jy=(e,t,n)=>t(v(n).singular),Qy=se('<li class="svelte-12pt6h9"><span class="svelte-12pt6h9"><!></span> <p class="svelte-12pt6h9"> </p> <button type="button" class="svelte-12pt6h9"><!></button></li>'),Zy=se('<div class="screen svelte-12pt6h9"><!> <p class="email svelte-12pt6h9"> </p> <form class="svelte-12pt6h9"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></form> <div class="heading svelte-12pt6h9"><span class="svelte-12pt6h9"><!></span> <h3 class="svelte-12pt6h9">Flavors</h3> <button type="button" class="svelte-12pt6h9">Select none</button></div> <ul class="flavor svelte-12pt6h9"></ul> <button class="utility svelte-12pt6h9" type="button">Logout</button></div>');function Xy(e,t){He(t,!0);let n=new Io,r=ze(void 0),i=fe(()=>{const S={};if(t.tastes)for(let x=0;x<t.tastes.length;x++)v(r)&&v(r).selected?S[t.tastes[x].singular]=v(r).selected.indexOf(t.tastes[x].singular)>=0:S[t.tastes[x].singular]=!0;return S});function a(S){if(!v(r).hasOwnProperty("selected")){v(r).selected={};for(let x=0;x<t.tastes.length;x++)v(r).selected[t.tastes[x].singular]=!0}console.log(S),v(r).selected[S]=!v(r).selected[S],console.log(v(r)),n.updateSettings(v(r))}di(()=>{ke(r,n.readSettings().then(S=>S),!0),console.log(v(r))});var l=Zy(),c=P(l);const d=fe(()=>v(r)&&v(r).avatar?v(r).avatar:null);Hy(c,{get src(){return v(d)}});var h=V(c,2),u=P(h,!0);O(h);var m=V(h,2),y=P(m);Yn(y,()=>({"--primary-accent-color":"#5fb2ff"})),bf(y.lastChild,{icon:"material-symbols:label-outline-rounded",label:"Name",placeholder:"How should I refer to you?",get value(){return t.name}}),O(y),O(m);var g=V(m,2),_=P(g),k=P(_);Te(k,{height:"24",icon:"material-symbols:book-4-outline-rounded",width:"24"}),O(_),Pt(4),O(g);var E=V(g,2);ft(E,21,()=>t.tastes,ct,(S,x)=>{var C=Qy(),D=P(C),R=P(D);Te(R,{get color(){return v(x).primary},height:"24",icon:"material-symbols:circle",width:"24"}),O(D);var W=V(D,2),Z=P(W,!0);O(W);var G=V(W,2);G.__click=[Jy,a,x];var Y=P(G);const ne=fe(()=>v(i)&&v(i).hasOwnProperty(v(x).singular)&&v(i)[v(x).singular]===!0?"material-symbols:check-box-rounded":"material-symbols:check-box-outline-blank");Te(Y,{height:"24",get icon(){return v(ne)},width:"24"}),O(G),O(C),me(()=>Ee(Z,v(x).singular)),Q(S,C)}),O(E);var A=V(E,2);A.__click=onLogoutClick,O(l),me(()=>Ee(u,t.email)),Q(e,l),Ye()}$e(["click"]);function $y(e,t,n,r){if(v(t)===null){alert("Name is required.");return}if(v(n)===null){alert("Email address is required.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v(n))){alert("Email address is invalid.");return}console.log("SEND: "+v(n)),r.login(v(n))}function em(e,t,n){console.log("OTP: "+v(t)),v(n).onSubmit({otp:v(t)})}var tm=se('<section class="svelte-1sejw5e"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <article class="svelte-1sejw5e"><div class="screen svelte-1sejw5e"><figure class="svelte-1sejw5e"><img alt="Feature details" src="/img/secure.svg" class="svelte-1sejw5e"></figure> <h3 class="svelte-1sejw5e">Verify Identity</h3> <p class="svelte-1sejw5e">Enter name and email address<br>to send one-time password.</p> <form class="svelte-1sejw5e"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <button type="button" class="svelte-1sejw5e">Send verification</button></form></div> <div class="screen svelte-1sejw5e" style="justify-content: center;"><h3 class="svelte-1sejw5e">Verification Code</h3> <p style="padding: 0 16px 0 16px;" class="svelte-1sejw5e">A one-time password (OTP/verification) has been sent to the provided email address.</p> <form class="svelte-1sejw5e"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <button type="button" class="svelte-1sejw5e">Sign in</button></form></div> <!></article></section>');function nm(e,t){He(t,!0);let n=new Io,r,i=ze(null),a=ze(null),l=ze(null),c=ze(null);function d(){return r.animate([{top:0},{top:"100vh"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished}function h(){r.animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"})}di(()=>{console.log("CURRENT"),console.log(n.userId),n.ui.subscribe(Z=>{console.log("INTERACTION"),console.log(Z),Z===void 0?(console.log("INTERACTION:USER"),console.log(n.userId),n.userId!=="unauthorized"&&(console.log("INTERACTION: LOGGED IN"),n.sync().then(()=>{console.log("INTERACTION: INITIAL SYNC"),t.onchange&&t.onchange()})),ke(a,null)):(console.log("MESSAGE"),console.log(Z.messageCode),ke(a,Z,!0))})});function u(){d()}var m=tm(),y=P(m);{const Z=Y=>{Lt(Y,{name:"material-symbols:close",onclick:u})},G=Y=>{Lt(Y,{name:"material-symbols:done"})};Yn(y,()=>({"--primary-accent-color":"#5fb2ff"})),is(y.lastChild,{label:"Account",variation:"sm",left:Z,right:G,$$slots:{left:!0,right:!0}}),O(y)}var g=V(y,2),_=P(g),k=V(P(_),6),E=P(k);Yn(E,()=>({"--primary-accent-color":"#5fb2ff"})),kn(E.lastChild,{label:"Name",placeholder:"How should I refer to you?",onchange:Z=>ke(l,Z.value,!0)}),O(E);var A=V(E,2);Yn(A,()=>({"--primary-accent-color":"#5fb2ff"})),kn(A.lastChild,{label:"Email address",placeholder:"Use email to login",onchange:Z=>ke(i,Z.value,!0)}),O(A);var S=V(A,2);S.__click=[$y,l,i,n],O(k),O(_);var x=V(_,2),C=V(P(x),4),D=P(C);Yn(D,()=>({"--primary-accent-color":"#5fb2ff"})),kn(D.lastChild,{label:"OTP",onchange:Z=>ke(c,Z.value,!0),placeholder:"One-time password from email"}),O(D);var R=V(D,2);R.__click=[em,c,a],O(C),O(x);var W=V(x,2);return Xy(W,{get email(){return n.userId},get tastes(){return t.tastes}}),O(g),O(m),it(m,Z=>r=Z,()=>r),Q(e,m),Ye({hide:d,show:h})}$e(["click"]);var rm=xt('<circle class="ring svelte-7yw9ie" cx="0" cy="0"></circle>'),im=xt('<circle cx="0" r="2" class="svelte-7yw9ie"></circle>'),om=xt('<g class="spoke"><rect width="1" x="-0.50" y="0" class="svelte-7yw9ie"></rect><!></g>'),am=xt("<text> </text>"),sm=xt('<g class="labels"></g>'),lm=xt('<svg class="svelte-7yw9ie"><g class="chart svelte-7yw9ie"><g class="wheel svelte-7yw9ie"></g><g class="spokes svelte-7yw9ie"></g><!><path class="svelte-7yw9ie"></path></g></svg>');function fo(e,t){He(t,!0);let n=be(t,"interactive",3,!1),r=be(t,"labels",3,!0),i=be(t,"maximum",3,5),a=be(t,"rotate",3,0),l=be(t,"spokes",19,()=>[]),c=be(t,"value",19,()=>[]),d=ze(void 0),h=ze(void 0),u=150;Or(()=>{if(v(h))if(n())v(d).setAttributeNS(null,"viewBox","-70 -150 140 200");else{const D=v(h).getBoundingClientRect();v(d).setAttributeNS(null,"viewBox",`${0-D.width/2} ${0-D.height/2} ${D.width} ${D.height}`)}});let m=fe(()=>{if(c().length===0)return"";const D=360/l().length*(Math.PI/180);let R=null;for(let W=0;W<c().length;W++){const Z=c()[W]===0?.25:c()[W],G=(u-3)/i()*Z,Y={x:G*Math.cos(D*W-1.5708),y:G*Math.sin(D*W-1.5708)};W===0?R=`M ${Y.x} ${Y.y} `:R=R+`L ${Y.x} ${Y.y} `}return R+"Z"});function y(D){let R="middle",W="auto";const G=360/l().length*(Math.PI/180)*D*(180/Math.PI);return G===0?(R="middle",W="auto"):G>0&&G<90?(R="start",W="auto"):G===90?(R="start",W="middle"):G>90&&G<180?(R="start",W="hanging"):G===180?(R="middle",W="hanging"):G>180&&G<270?(R="end",W="hanging"):G===270?(R="end",W="middle"):(R="end",W="auto"),{"dominant-baseline":W,"text-anchor":R}}var g=lm(),_=P(g);let k;var E=P(_);ft(E,21,()=>({length:i()}),ct,(D,R,W)=>{var Z=rm();je(Z,"stroke-width",W===0?3:1),Gn(Z,"",{},{fill:W===0?"#ffffff":"none"}),me(()=>je(Z,"r",(u-3)/i()*(i()-W))),Q(D,Z)}),O(E);var A=V(E);ft(A,21,l,ct,(D,R,W)=>{var Z=om();let G;var Y=P(Z);je(Y,"height",u-3);var ne=V(Y);ft(ne,17,()=>({length:i()}),ct,(te,H,$)=>{var oe=im();me(()=>je(oe,"cy",(u-3)/i()*($+1))),Q(te,oe)}),O(Z),me(()=>G=Gn(Z,"",G,{rotate:`${360/l().length*W}deg`})),Q(D,Z)}),O(A);var S=V(A);{var x=D=>{var R=sm();ft(R,21,l,ct,(W,Z,G)=>{var Y=am();const ne=fe(()=>360/l().length*(Math.PI/180));let te;var H=P(Y,!0);O(Y),me(($,oe,ce)=>{te=xa(Y,te,{...$,x:oe,y:ce},"svelte-7yw9ie"),Ee(H,v(Z))},[()=>y(G),()=>(u+5)*Math.cos(v(ne)*G-1.5708),()=>(u+5)*Math.sin(v(ne)*G-1.5708)]),Q(W,Y)}),O(R),Q(D,R)};ve(S,D=>{r()&&D(x)})}var C=V(S);O(_),it(_,D=>ke(h,D),()=>v(h)),O(g),it(g,D=>ke(d,D),()=>v(d)),me(()=>{k=Gn(_,"",k,{rotate:`${a()??""}deg`}),je(C,"d",v(m))}),Q(e,g),Ye()}var um=se('<h3 class="svelte-1kvllfw">Profile</h3> <div class="wheel svelte-1kvllfw"><!></div> <h3 class="svelte-1kvllfw">Recommendations</h3>',1),cm=se('<article><h3 class="svelte-1kvllfw">At a Glance</h3> <div class="stats svelte-1kvllfw"><div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Entries</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Photos</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Day of posts</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Time of posts</p></div></div> <h3 class="svelte-1kvllfw">Ratings</h3> <div class="stats svelte-1kvllfw"><div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Ratings</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Average</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Middle</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Most frequent</p></div></div> <!></article>');function fm(e,t){He(t,!0);let n=be(t,"flavor",3,null),r=be(t,"hidden",3,!1),i=be(t,"items",19,()=>[]);const a=fe(()=>i().length),l=fe(()=>i().reduce((Ie,ie)=>(Ie=Ie+(ie.photos===null?0:ie.photos.length),Ie),0)),c=fe(()=>{if(i().length===0)return null;const Ie={};for(let Ae=0;Ae<i().length;Ae++)Ie.hasOwnProperty(i()[Ae].created_at.getDay())?Ie[i()[Ae].created_at.getDay()]=Ie[i()[Ae].created_at.getDay()]+1:Ie[i()[Ae].created_at.getDay()]=1;let ie=0,ae=0;const we=Object.keys(Ie);for(let Ae=0;Ae<we.length;Ae++)Ie[we[Ae]]>ie&&(ie=Ie[we[Ae]],ae=we[Ae]);return ae}),d=fe(()=>{if(i().length===0)return null;const Ie={};for(let Ae=0;Ae<i().length;Ae++)Ie.hasOwnProperty(i()[Ae].created_at.getHours())?Ie[i()[Ae].created_at.getHours()]=Ie[i()[Ae].created_at.getHours()]+1:Ie[i()[Ae].created_at.getHours()]=1;let ie=0,ae=0;const we=Object.keys(Ie);for(let Ae=0;Ae<we.length;Ae++)Ie[we[Ae]]>ie&&(ie=Ie[we[Ae]],ae=we[Ae]);return ae}),h=fe(()=>i().reduce((Ie,ie)=>(Ie=Ie+(ie.rating===null?0:1),Ie),0)),u=fe(()=>{const Ie=i().reduce((ie,ae)=>(ie=ie+(ae.rating===null?0:ae.rating),ie),0);return v(h)===0?0:Ie/v(h)}),m=fe(()=>{const Ie=i().reduce((ae,we)=>(we.rating!==null&&ae.push(we.rating),ae),[]);if(Ie.length===0)return 0;Ie.sort((ae,we)=>ae>we?1:ae<we?-1:0);const ie=Math.floor(Ie.length/2);return Ie.length%2===0?(Ie[ie-1]+Ie[ie])/2:Ie[ie]}),y=fe(()=>{const Ie=i().reduce((Ae,et)=>(et.rating!==null&&Ae.push(et.rating),Ae),[]);if(Ie.length===0)return[];const ie={},ae=[];let we=0;for(const Ae of Ie)ie[Ae]=(ie[Ae]||0)+1,ie[Ae]>we&&(we=ie[Ae]);for(const Ae in ie)ie[Ae]===we&&ae.push(Number(Ae));return ae.length===Object.keys(ie).length?[]:ae});let g=fe(()=>{if(n()){for(let Ie=0;Ie<n().fields.length;Ie++)if(n().fields[Ie].kind==="profile")return n().fields[Ie].options;return[]}return[]});function _(Ie){const ie=new Date,ae=Ie-ie.getDay();return ie.setDate(ie.getDate()+ae),new Intl.DateTimeFormat(navigator.language,{weekday:"long"}).format(ie)}function k(Ie){const ie=new Date;return ie.setHours(Ie),ie.toLocaleTimeString(navigator.language,{hour:"numeric",hour12:!0})}var E=cm();let A;var S=V(P(E),2),x=P(S),C=P(x),D=P(C,!0);O(C),Pt(2),O(x);var R=V(x,2),W=P(R),Z=P(W,!0);O(W),Pt(2),O(R);var G=V(R,2),Y=P(G),ne=P(Y,!0);O(Y),Pt(2),O(G);var te=V(G,2),H=P(te),$=P(H,!0);O(H),Pt(2),O(te),O(S);var oe=V(S,4),ce=P(oe),De=P(ce),Re=P(De,!0);O(De),Pt(2),O(ce);var he=V(ce,2),B=P(he),Ne=P(B,!0);O(B),Pt(2),O(he);var Ue=V(he,2),qe=P(Ue),Ze=P(qe,!0);O(qe),Pt(2),O(Ue);var Ge=V(Ue,2),Je=P(Ge),St=P(Je,!0);O(Je),Pt(2),O(Ge),O(oe);var Ut=V(oe,2);{var Se=Ie=>{var ie=um(),ae=V(Ce(ie),2),we=P(ae);fo(we,{get spokes(){return v(g)}}),O(ae),Pt(2),Q(Ie,ie)};ve(Ut,Ie=>{n()&&Ie(Se)})}O(E),me((Ie,ie,ae,we,Ae,et)=>{A=ot(E,1,"svelte-1kvllfw",null,A,Ie),Ee(D,v(a)),Ee(Z,v(l)),Ee(ne,ie),Ee($,ae),Ee(Re,v(h)),Ee(Ne,we),Ee(Ze,Ae),Ee(St,et)},[()=>({hidden:r()}),()=>v(c)===null?"TBD":_(v(c)),()=>v(d)===null?"TBD":k(v(d)),()=>v(u).toFixed(2),()=>v(m).toFixed(2),()=>v(y).length===0?"0":v(y).join(", ")]),Q(e,E),Ye()}function dm(e,t){window.open("https://flavorawesome.com","_blank"),t()}var vm=(e,t)=>t(),hm=(e,t)=>t(null),pm=(e,t,n)=>t(v(n).singular),ym=se('<li><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i"> </span> <span class="svelte-84fq4i"> </span></button></li>'),mm=se('<section class="svelte-84fq4i"><article class="scrim svelte-84fq4i"><button type="button" class="svelte-84fq4i"><!></button></article> <article class="drawer svelte-84fq4i"><h3 class="svelte-84fq4i">Flavors</h3> <ul class="svelte-84fq4i"><li><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">All</span> <span class="svelte-84fq4i"> </span></button></li> <!></ul> <ul class="svelte-84fq4i"><li class="svelte-84fq4i"><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">About Flavor Awesome</span> <span class="svelte-84fq4i"></span></button></li> <li class="svelte-84fq4i"><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">Help and Feedback</span> <span class="svelte-84fq4i"></span></button></li></ul></article></section>');function gm(e,t){He(t,!0);let n=be(t,"selected",7,null),r,i,a;function l(ce){n()!==ce?(n(ce),t.onchange&&(c(),t.onchange(n()))):c()}function c(){i.animate([{opacity:"1.0"},{opacity:"0"}],{duration:300,easing:"ease-in-out",fill:"forwards"}),r.animate([{left:"0"},{left:"-100vw"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{a.style.left="-100vw"})}function d(){a.style.left="0",i.animate([{opacity:"0"},{opacity:"1.0"}],{duration:300,easing:"ease-in-out",fill:"forwards"}),r.animate([{left:"-100vw"},{left:"0"}],{duration:300,easing:"ease-in-out",fill:"forwards"})}var h=mm(),u=P(h),m=P(u);m.__click=[vm,c];var y=P(m);Te(y,{color:"#ffffff",height:"24",icon:"material-symbols:cancel-rounded",width:"24"}),O(m),O(u),it(u,ce=>i=ce,()=>i);var g=V(u,2),_=V(P(g),2),k=P(_);let E;var A=P(k);A.__click=[hm,l];var S=P(A),x=P(S);Te(x,{color:"#5fb2ff",height:"24",icon:"material-symbols:circle",width:"24"}),O(S);var C=V(S,4),D=P(C,!0);O(C),O(A),O(k);var R=V(k,2);ft(R,17,()=>t.items,ct,(ce,De)=>{var Re=ym();let he;var B=P(Re);B.__click=[pm,l,De];var Ne=P(B),Ue=P(Ne);Te(Ue,{get color(){return v(De).primary},height:"24",icon:"material-symbols:circle",width:"24"}),O(Ne);var qe=V(Ne,2),Ze=P(qe,!0);O(qe);var Ge=V(qe,2),Je=P(Ge,!0);O(Ge),O(B),O(Re),me((St,Ut)=>{he=ot(Re,1,"svelte-84fq4i",null,he,St),Ee(Ze,v(De).singular),Ee(Je,Ut)},[()=>({selected:v(De).singular===n()}),()=>t.count.hasOwnProperty(v(De).singular)?t.count[v(De).singular]:0]),Q(ce,Re)}),O(_);var W=V(_,2),Z=P(W),G=P(Z);G.__click=[dm,c];var Y=P(G),ne=P(Y);Te(ne,{color:"#49454F",height:"24",icon:"material-symbols:info-rounded",width:"24"}),O(Y),Pt(4),O(G),O(Z);var te=V(Z,2),H=P(te),$=P(H),oe=P($);return Te(oe,{color:"#49454F",height:"24",icon:"material-symbols:help-rounded",width:"24"}),O($),Pt(4),O(H),O(te),O(W),O(g),it(g,ce=>r=ce,()=>r),O(h),it(h,ce=>a=ce,()=>a),me(ce=>{E=ot(k,1,"svelte-84fq4i",null,E,ce),Ee(D,t.count.All)},[()=>({selected:n()===null})]),Q(e,h),Ye({hide:c,show:d})}$e(["click"]);var bm=zf(`<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""> <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="">
  <\/script>`,1),_m=se('<article><div class="svelte-hy6652"></div></article>');function wm(e,t){He(t,!0);let n=be(t,"hidden",3,!1),r=be(t,"items",19,()=>[]),i,a,l,c=null;function d(){if(i){c.clearLayers();for(let g=0;g<r().length;g++){const _=`<svg width="32" height="32" viewBox="0 0 24 24"><path fill="${r()[g].color}" d="M12 12q.825 0 1.413-.587T14 10t-.587-1.412T12 8t-1.412.588T10 10t.588 1.413T12 12m0 10q-4.025-3.425-6.012-6.362T4 10.2q0-3.75 2.413-5.975T12 2t5.588 2.225T20 10.2q0 2.5-1.987 5.438T12 22"/></svg>`,k=i.divIcon({className:"pin",iconSize:[32,32],iconAnchor:[16,32],html:_}),E=i.marker([r()[g].latitude,r()[g].longitude],{icon:k});E.data=r()[g].id,E.addTo(c).on("click",A=>{t.onchange&&t.onchange(A.target.data)})}}}function h(){i=window.L,a=i.map(l,{preferCanvas:!0,zoomControl:!1}).setView([39.51,-104.84],10),i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(a),c=i.layerGroup(),c.addTo(a),d()}Or(()=>{r(),d()});var u=_m();Cu(g=>{var _=bm(),k=V(Ce(_),2);br("load",k,h),$a(k),Q(g,_)});let m;var y=P(u);return it(y,g=>l=g,()=>l),O(u),me(g=>m=ot(u,1,"svelte-hy6652",null,m,g),[()=>({hidden:n()})]),Q(e,u),Ye({update:d})}var km=se('<nav class="svelte-1h9b4b6"><ul class="svelte-1h9b4b6"><!></ul></nav>');function xm(e,t){var n=km(),r=P(n),i=P(r);bn(i,()=>t.children),O(r),O(n),Q(e,n)}var Sm=se('<span class="icon svelte-wnxw5f"><!></span>'),Im=se("<span> </span>"),Em=se('<li class="svelte-wnxw5f"><button type="button"><!></button></li>');function Wi(e,t){var n=Em(),r=P(n);r.__click=function(...d){var h;(h=t.onclick)==null||h.apply(this,d)};let i;var a=P(r);{var l=d=>{var h=Sm(),u=P(h);Te(u,{height:"20",get icon(){return t.icon},width:"20"}),O(h),Q(d,h)},c=d=>{var h=Im(),u=P(h,!0);O(h),me(()=>Ee(u,t.label)),Q(d,h)};ve(a,d=>{t.icon?d(l):d(c,!1)})}O(r),O(n),me(d=>i=ot(r,1,"svelte-wnxw5f",null,i,d),[()=>({active:t.active})]),Q(e,n)}$e(["click"]);var Om=(e,t,n)=>t(v(n).id),Cm=se('<span class="svelte-1leb39h"><!></span>'),Am=se('<li class="svelte-1leb39h"><button type="button" class="svelte-1leb39h"><img alt="Thumbnail" class="svelte-1leb39h"> <p class="date svelte-1leb39h"> </p> <p class="month svelte-1leb39h"> </p> <!></button></li>'),Pm=se('<ul class="svelte-1leb39h"></ul>'),Tm=se("<article><!></article>");function jm(e,t){He(t,!0);let n=be(t,"hidden",3,!1),r=be(t,"items",19,()=>[]);function i(m){return new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(m)}function a(m){t.onchange&&t.onchange(m)}var l=Tm();let c;var d=P(l);{var h=m=>{var y=Ve(),g=Ce(y);bn(g,()=>t.children),Q(m,y)},u=m=>{var y=Pm();ft(y,21,r,ct,(g,_)=>{var k=Am(),E=P(k);E.__click=[Om,a,_];var A=P(E),S=V(A,2),x=P(S,!0);O(S);var C=V(S,2),D=P(C,!0);O(C);var R=V(C,2);{var W=Z=>{var G=Cm(),Y=P(G);Te(Y,{height:"24",icon:"material-symbols:favorite",width:"24"}),O(G),Q(Z,G)};ve(R,Z=>{v(_).favorite&&Z(W)})}O(E),O(k),me((Z,G)=>{je(A,"src",v(_).data),Ee(x,Z),Ee(D,G)},[()=>v(_).created_at.getDate(),()=>i(v(_).created_at)]),Q(g,k)}),O(y),Q(m,y)};ve(d,m=>{r().length===0?m(h):m(u,!1)})}O(l),me(m=>c=ot(l,1,"svelte-1leb39h",null,c,m),[()=>({hidden:n()})]),Q(e,l),Ye()}$e(["click"]);function Dm(e,t,n){const r=new Date(parseInt(e.currentTarget.getAttribute("data-year")),parseInt(e.currentTarget.getAttribute("data-month")),parseInt(e.currentTarget.getAttribute("data-date")));t(new Date(r.getTime())),n.onchange&&n.onchange(t())}var Rm=se('<li class="svelte-hcex0j"><button type="button"> </button></li>'),Nm=se('<div class="svelte-hcex0j"><p class="svelte-hcex0j"> </p> <ul class="svelte-hcex0j"></ul></div>');function Lm(e,t){He(t,!0);let n=be(t,"display",19,()=>new Date),r=be(t,"value",7,null),i=fe(()=>new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(n())),a=fe(()=>{const m=new Date(n().getFullYear(),n().getMonth(),1),y=[],g=new Date;m.setDate(m.getDate()-m.getDay());const _=l(n().getFullYear(),n().getMonth()+1,m.getDay());for(let k=0;k<7*_;k++){let E=!0,A=!1,S=!1;r()===null?A=!1:m.getFullYear()===r().getFullYear()&&m.getMonth()===r().getMonth()&&m.getDate()===r().getDate()&&(A=!0),m.getFullYear()===n().getFullYear()&&m.getMonth()===n().getMonth()&&(E=!1),m.getFullYear()===g.getFullYear()&&m.getMonth()===g.getMonth()&&m.getDate()===g.getDate()&&(S=!0),y.push({date:m.getDate(),month:m.getMonth(),year:m.getFullYear(),outside:E,selected:A,today:S}),m.setDate(m.getDate()+1)}return y});function l(m,y,g=0){const _=g||0,k=new Date(m,y-1,1),A=new Date(m,y,0).getDate(),x=(k.getDay()-_+7)%7+A;return Math.ceil(x/7)}var c=Nm(),d=P(c),h=P(d,!0);O(d);var u=V(d,2);ft(u,21,()=>v(a),ct,(m,y)=>{var g=Rm(),_=P(g);let k;_.__click=[Dm,r,t];var E=P(_,!0);O(_),O(g),me(A=>{k=ot(_,1,"day svelte-hcex0j",null,k,A),je(_,"data-date",v(y).date),je(_,"data-month",v(y).month),je(_,"data-year",v(y).year),Ee(E,v(y).date)},[()=>({outside:v(y).outside,selected:v(y).selected,today:v(y).today})]),Q(m,g)}),O(u),O(c),me(()=>Ee(h,v(i))),Q(e,c),Ye()}$e(["click"]);var Mm=se('<li class="svelte-13buufu"> </li>'),qm=se('<section class="svelte-13buufu"><p class="svelte-13buufu"> </p> <h3 class="svelte-13buufu"> </h3> <ul class="svelte-13buufu"></ul> <article class="svelte-13buufu"></article> <footer class="svelte-13buufu"><button type="button" class="svelte-13buufu">Cancel</button> <button type="button" class="svelte-13buufu">Ok</button></footer></section>');function Fm(e,t){He(t,!0);let n=be(t,"display",19,()=>new Date),r=be(t,"value",7),i=fe(()=>{let S=new Date(n().getTime());return r()!==null&&(S=new Date(r().getTime())),new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"short",weekday:"short",year:"numeric"}).format(S)}),a=mr([]),l=mr([]);di(()=>{const S=new Intl.DateTimeFormat(navigator.language,{weekday:"narrow"});let x=new Date;x.setDate(1),x.setDate(x.getDate()-x.getDay());for(let C=0;C<7;C++)l.push(S.format(x)),x.setDate(x.getDate()+1);x=new Date,x.setDate(15);for(let C=0;C<6;C++)a.push(new Date(x.getTime())),x.setMonth(x.getMonth()-1)});function c(S){r(new Date(S.getTime())),t.onchange&&t.onchange({name:t.name,value:r()})}var d=qm(),h=P(d),u=P(h,!0);O(h);var m=V(h,2),y=P(m,!0);O(m);var g=V(m,2);ft(g,21,()=>l,ct,(S,x)=>{var C=Mm(),D=P(C,!0);O(C),me(()=>Ee(D,v(x))),Q(S,C)}),O(g);var _=V(g,2);ft(_,21,()=>a,ct,(S,x)=>{Lm(S,{get display(){return v(x)},onchange:c})}),O(_);var k=V(_,2),E=P(k);E.__click=function(...S){var x;(x=t.onclose)==null||x.apply(this,S)};var A=V(E,2);A.__click=function(...S){var x;(x=t.onsave)==null||x.apply(this,S)},O(k),O(d),me(()=>{Ee(u,t.label),Ee(y,v(i))}),Q(e,d),Ye()}$e(["click"]);var Um=se('<dialog class="svelte-zsytrm"><header class="svelte-zsytrm"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <h3 class="svelte-zsytrm"> </h3> <button type="button" class="svelte-zsytrm">Save</button></header> <!></dialog>');function ks(e,t){He(t,!0);let n=ze(void 0);function r(){v(n).close()}function i(){v(n).showModal()}var a=Um(),l=P(a),c=P(l);Yn(c,()=>({"--icon-button-color":"var( --primary-accent-color )"})),Lt(c.lastChild,{name:"material-symbols:close",get onclick(){return t.onclose}}),O(c);var d=V(c,2),h=P(d,!0);O(d);var u=V(d,2);u.__click=function(...y){var g;(g=t.onsave)==null||g.apply(this,y)},O(l);var m=V(l,2);return bn(m,()=>t.children??Cr),O(a),it(a,y=>ke(n,y),()=>v(n)),me(()=>Ee(h,t.label)),Q(e,a),Ye({close:r,showModal:i})}$e(["click"]);var Bm=(e,t)=>v(t).showModal(),Km=se('<div class="svelte-1govqhv"><span class="svelte-1govqhv"><!></span> <button type="button" class="svelte-1govqhv"><p class="svelte-1govqhv"><span class="svelte-1govqhv"> </span> <span><!></span></p></button></div> <!>',1);function zm(e,t){He(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null),i=ze(void 0),a=fe(()=>r()!==null?new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"short",weekday:"short",year:"numeric"}).format(r()):"");function l(g){console.log(g),r(new Date(g.value.getTime())),t.onchange&&t.onchange({name:t.name,value:r()})}function c(){v(i).close()}function d(){v(i).close()}var h=Ve(),u=Ce(h);{var m=g=>{var _=Ve(),k=Ce(_);{var E=A=>{tn(A,{icon:"material-symbols:calendar-month-outline",get label(){return t.label},get value(){return v(a)}})};ve(k,A=>{r()&&A(E)})}Q(g,_)},y=g=>{var _=Km(),k=Ce(_),E=P(k),A=P(E);Te(A,{height:"24",icon:"material-symbols:calendar-month-outline",width:"24"}),O(E);var S=V(E,2);S.__click=[Bm,i];var x=P(S),C=P(x),D=P(C,!0);O(C);var R=V(C,2);let W;var Z=P(R);{var G=te=>{var H=tl();me(()=>Ee(H,v(a))),Q(te,H)},Y=te=>{var H=tl();me(()=>Ee(H,t.placeholder?t.placeholder:"")),Q(te,H)};ve(Z,te=>{r()?te(G):te(Y,!1)})}O(R),O(x),O(S),O(k);var ne=V(k,2);it(ks(ne,{onclose:c,onsave:d,children:(te,H)=>{Fm(te,{onchange:l,onclose:c,onsave:d,name:"date",get label(){return t.label},get value(){return r()}})},$$slots:{default:!0}}),te=>ke(i,te,!0),()=>v(i)),me(te=>{Ee(D,t.label),W=ot(R,1,"svelte-1govqhv",null,W,te)},[()=>({placeholder:!r()&&t.placeholder})]),Q(g,_)};ve(u,g=>{n()?g(m):g(y,!1)})}Q(e,h),Ye()}$e(["click"]);var Vm=se('<div class="svelte-hm3w6m"><span><!></span> <!></div>');function Wm(e,t){He(t,!0);let n=be(t,"gap",3,!0),r=be(t,"readonly",3,!1),i=be(t,"value",7,null),a=fe(()=>{if(i()!==null)return i().toLocaleString(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})});function l(m){i(m.value),t.onchange&&t.onchange({name:t.name,value:i()===null?null:parseFloat(i())})}var c=Ve(),d=Ce(c);{var h=m=>{var y=Ve(),g=Ce(y);{var _=k=>{tn(k,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get format(){return v(a)},get value(){return i()}})};ve(g,k=>{i()!==null&&k(_)})}Q(m,y)},u=m=>{var y=Vm(),g=P(y);let _;var k=P(g);Te(k,{height:"24",get icon(){return t.icon},width:"24"}),O(g);var E=V(g,2);kn(E,{get label(){return t.label},mode:"decimal",name:"decimal",onchange:l,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),O(y),me(A=>_=ot(g,1,"svelte-hm3w6m",null,_,A),[()=>({noicon:!t.icon})]),Q(m,y)};ve(d,m=>{r()?m(h):m(u,!1)})}Q(e,c),Ye()}const Hm=(e,t=Cr)=>{var n=Jm(),r=V(P(n));let i;O(n),me(a=>i=ot(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)},Ym=(e,t=Cr)=>{var n=Qm(),r=V(P(n));let i;O(n),me(a=>i=ot(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)},Gm=(e,t=Cr)=>{var n=Zm(),r=V(P(n));let i;O(n),me(a=>i=ot(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)};var Jm=xt('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 20, -1 L 20, 36 A 8.5 8.5 0 0 1 3 36 L 3, -1 Z"></path><path d="M 7, -1 L 7, 36 A 3 3 0 0 0 16 36 L 16, -1 Z"></path></svg>'),Qm=xt('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 3, -1 L 3, 48 L 20, 48 L 20, -1 Z"></path><path d="M 7, -1 L 7, 48 L 16, 48 L 16 -1 Z"></path></svg>'),Zm=xt('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 3, 48 L 3, 12 A 8.5 8.5 0 0 1 20 12 L 20, 48 Z"></path><path d="M 7, 48 L 7, 12 A 3 3 0 0 1 16 12 L 16, 48 Z"></path></svg>'),Xm=se('<li class="svelte-ibqihf"><button type="button" class="svelte-ibqihf"><span class="svelte-ibqihf"> </span> <!></button></li>'),$m=se('<div class="svelte-ibqihf"><div class="svelte-ibqihf"><span class="svelte-ibqihf"><!></span> <p class="svelte-ibqihf"> </p></div> <ul class="svelte-ibqihf"></ul></div>');function eg(e,t){He(t,!0);let n=be(t,"items",19,()=>[]),r=be(t,"readonly",3,!1),i=be(t,"value",7,null),a=fe(()=>n().findIndex(y=>y===i()));function l(y){return i()===null?!0:!(y>=v(a))}function c(y){const g=y.currentTarget.getAttribute("data-value");i(i()===g?null:g),t.onchange&&t.onchange({name:t.name,value:i()})}var d=Ve(),h=Ce(d);{var u=y=>{var g=Ve(),_=Ce(g);{var k=E=>{tn(E,{get icon(){return t.icon},get label(){return t.label},get value(){return i()}})};ve(_,E=>{i()!==null&&E(k)})}Q(y,g)},m=y=>{var g=$m(),_=P(g),k=P(_),E=P(k);Te(E,{height:"24",get icon(){return t.icon},width:"24"}),O(k);var A=V(k,2),S=P(A,!0);O(A),O(_);var x=V(_,2);ft(x,21,n,ct,(C,D,R)=>{var W=Xm();const Z=fe(()=>l(R));var G=P(W);G.__click=c;var Y=P(G),ne=P(Y,!0);O(Y);var te=V(Y,2);{var H=oe=>{Gm(oe,()=>v(Z))},$=(oe,ce)=>{{var De=he=>{Ym(he,()=>v(Z))},Re=he=>{Hm(he,()=>v(Z))};ve(oe,he=>{R>0&&R<n().length-1?he(De):he(Re,!1)},ce)}};ve(te,oe=>{R===0?oe(H):oe($,!1)})}O(G),O(W),me(()=>{je(G,"data-value",v(D)),Ee(ne,v(D))}),Q(C,W)}),O(x),O(g),me(()=>Ee(S,t.label)),Q(y,g)};ve(h,y=>{r()?y(u):y(m,!1)})}Q(e,d),Ye()}$e(["click"]);var tg=se('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),ng=se('<div class="svelte-1bz35xs"><span class="svelte-1bz35xs"><!></span> <!></div>');function rg(e,t){He(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null);function i(h){r(h.value),t.onchange&&t.onchange({name:t.name,value:r()})}var a=Ve(),l=Ce(a);{var c=h=>{var u=Ve(),m=Ce(u);{var y=g=>{var _=tg(),k=Ce(_);Yn(k,()=>({"--label-field-font-size":"22px","--label-field-line-height":"28px"})),tn(k.lastChild,{icon:"material-symbols:label-outline",get label(){return t.label},get value(){return r()}}),O(k),Q(g,_)};ve(m,g=>{r()!==null&&g(y)})}Q(h,u)},d=h=>{var u=ng(),m=P(u),y=P(m);Te(y,{height:"24",icon:"material-symbols:label-outline",width:"24"}),O(m);var g=V(m,2);kn(g,{get label(){return t.label},name:"name",onchange:i,get placeholder(){return t.placeholder},get value(){return r()}}),O(u),Q(h,u)};ve(l,h=>{n()?h(c):h(d,!1)})}Q(e,a),Ye()}function ig(e,t,n){t().trim().length===0&&t(null),n.onchange&&n.onchange({name:n.name,value:t()})}var og=se('<div class="label svelte-lsm8ct"><span class="svelte-lsm8ct"><!></span> <div class="svelte-lsm8ct"><p class="svelte-lsm8ct">Notes</p> <p class="svelte-lsm8ct"> </p></div></div>'),ag=se('<div class="field svelte-lsm8ct"><div class="svelte-lsm8ct"><span class="svelte-lsm8ct"><!></span> <p class="svelte-lsm8ct">Notes</p></div> <label class="svelte-lsm8ct"><textarea class="svelte-lsm8ct"></textarea></label></div>');function sg(e,t){He(t,!0);let n=be(t,"placeholder",3,"Notes"),r=be(t,"value",7,null),i=ze(void 0);Or(()=>{t.readonly||r()!==null&&(v(i).style.height=v(i).scrollHeight+"px")});var a=Ve(),l=Ce(a);{var c=h=>{var u=Ve(),m=Ce(u);{var y=g=>{var _=og(),k=P(_),E=P(k);Te(E,{height:"24",icon:"material-symbols:text-snippet-outline",width:"24"}),O(k);var A=V(k,2),S=V(P(A),2),x=P(S,!0);O(S),O(A),O(_),me(()=>Ee(x,r())),Q(g,_)};ve(m,g=>{r()!==null&&g(y)})}Q(h,u)},d=h=>{var u=ag(),m=P(u),y=P(m),g=P(y);Te(g,{height:"24",icon:"material-symbols:text-snippet-outline",width:"24"}),O(y),Pt(2),O(m);var _=V(m,2),k=P(_);kd(k),k.__input=[ig,r,t],it(k,E=>ke(i,E),()=>v(i)),O(_),O(u),me(()=>je(k,"placeholder",n())),es(k,r),Q(h,u)};ve(l,h=>{t.readonly?h(c):h(d,!1)})}Q(e,a),Ye()}$e(["input"]);var lg=se('<div class="svelte-hm3w6m"><span><!></span> <!></div>');function ug(e,t){He(t,!0);let n=be(t,"gap",3,!0),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()===null?null:parseInt(i())})}var l=Ve(),c=Ce(l);{var d=u=>{var m=Ve(),y=Ce(m);{var g=_=>{tn(_,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get value(){return i()}})};ve(y,_=>{i()!==null&&_(g)})}Q(u,m)},h=u=>{var m=lg(),y=P(m);let g;var _=P(y);Te(_,{height:"24",get icon(){return t.icon},width:"24"}),O(y);var k=V(y,2);kn(k,{get label(){return t.label},mode:"numeric",name:"number",onchange:a,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),O(m),me(E=>g=ot(y,1,"svelte-hm3w6m",null,g,E),[()=>({noicon:!t.icon})]),Q(u,m)};ve(c,u=>{r()?u(d):u(h,!1)})}Q(e,l),Ye()}function cg(e,t){v(t).click()}function fg(e,t,n,r){t().splice(v(n),1),t(t().length===0?null:[...t()]),ke(n,v(n)===0?0:v(n)-1,!0),r.onchange&&r.onchange({name:r.name,value:t()})}function dg(e,t,n){v(t).files.length>0&&(ke(n,[...v(t).files],!0),v(t).value="")}function pu(e,t,n){ke(t,v(t)===n().length-1?0:v(t)+1,!0)}function yu(e,t,n){ke(t,v(t)===0?n().length-1:v(t)-1,!0)}var vg=se('<button aria-label="Previous photo" class="left svelte-1kbyvvc" type="button"><!></button> <button aria-label="Next photo" class="right svelte-1kbyvvc" type="button"><!></button>',1),hg=se('<figure class="svelte-1kbyvvc"><img alt="Cigar" class="svelte-1kbyvvc"> <!></figure>'),pg=se('<p class="svelte-1kbyvvc"> </p>'),yg=se('<button aria-label="Previous photo" class="left svelte-1kbyvvc" type="button"><!></button> <button aria-label="Next photo" class="right svelte-1kbyvvc" type="button"><!></button>',1),mg=se('<img class="svelte-1kbyvvc"> <!> <button aria-label="Delete photo" class="delete svelte-1kbyvvc" type="button"><!></button>',1),gg=se('<img alt="Loader. Not seen." class="loader svelte-1kbyvvc">'),bg=se('<figure class="svelte-1kbyvvc"><!> <button aria-label="Add photo" class="add svelte-1kbyvvc" type="button"><!></button> <!> <canvas class="svelte-1kbyvvc"></canvas> <input accept="image/*" type="file" class="svelte-1kbyvvc"></figure>');function _g(e,t){He(t,!0);let n=be(t,"placeholder",3,"Add photos"),r=be(t,"readonly",3,!1),i=be(t,"value",7,null),a=ze(mr([])),l=ze(0),c=!0;const d=.8,h=1800;let u=ze(void 0),m=ze(void 0);Or(()=>{i()===null&&(ke(a,[],!0),ke(l,0))});function y(A){const S=A.currentTarget,x=S.getAttribute("data-type"),C=S.getAttribute("data-name"),D=C.lastIndexOf(".")+1;let R=S.width,W=S.height;const Z=Math.max(R,W);if(Z>h){const ne=h/Z;R=R*ne,W=W*ne}v(u).width=R,v(u).height=W,v(u).getContext("2d").drawImage(S,0,0,R,W);const Y={id:crypto.randomUUID(),created_at:new Date,updated_at:new Date,data:v(u).toDataURL(x,d),format:x,name:C,extension:C.substring(D),width:R,height:W};i()===null?i([Y]):i([...i(),Y]),ke(l,i().length-1),A.target.remove(),t.onchange&&t.onchange({name:t.name,value:i()})}var g=Ve(),_=Ce(g);{var k=A=>{var S=Ve(),x=Ce(S);{var C=D=>{var R=hg(),W=P(R),Z=V(W,2);{var G=Y=>{var ne=vg(),te=Ce(ne);te.__click=[yu,l,i];var H=P(te);Te(H,{width:"24",height:"24",icon:"material-symbols:chevron-left"}),O(te);var $=V(te,2);$.__click=[pu,l,i];var oe=P($);Te(oe,{width:"24",height:"24",icon:"material-symbols:chevron-right"}),O($),Q(Y,ne)};ve(Z,Y=>{i().length>1&&Y(G)})}O(R),me(()=>je(W,"src",i()[v(l)].data?i()[v(l)].data:i()[v(l)].storage_url)),Q(D,R)};ve(x,D=>{i()!==null&&D(C)})}Q(A,S)},E=A=>{var S=bg(),x=P(S);{var C=ne=>{var te=pg(),H=P(te,!0);O(te),me(()=>Ee(H,n())),Q(ne,te)},D=ne=>{var te=mg(),H=Ce(te),$=V(H,2);{var oe=Re=>{var he=yg(),B=Ce(he);B.__click=[yu,l,i];var Ne=P(B);Te(Ne,{width:"24",height:"24",icon:"material-symbols:chevron-left"}),O(B);var Ue=V(B,2);Ue.__click=[pu,l,i];var qe=P(Ue);Te(qe,{width:"24",height:"24",icon:"material-symbols:chevron-right"}),O(Ue),Q(Re,he)};ve($,Re=>{i().length>1&&Re(oe)})}var ce=V($,2);ce.__click=[fg,i,l,t];var De=P(ce);Te(De,{width:"24",height:"24",icon:"material-symbols:delete-outline"}),O(ce),me(()=>{je(H,"alt",t.label),je(H,"src",i()[v(l)].data?i()[v(l)].data:i()[v(l)].storage_url)}),Q(ne,te)};ve(x,ne=>{i()===null||i().length===0?ne(C):ne(D,!1)})}var R=V(x,2);R.__click=[cg,m];var W=P(R);Te(W,{width:"24",height:"24",icon:"material-symbols:add-a-photo-outline"}),O(R);var Z=V(R,2);ft(Z,17,()=>v(a),ct,(ne,te)=>{var H=gg();me($=>{je(H,"data-name",v(te).name),je(H,"data-type",v(te).type),je(H,"src",$)},[()=>URL.createObjectURL(v(te))]),br("load",H,y),$a(H),Q(ne,H)});var G=V(Z,2);it(G,ne=>ke(u,ne),()=>v(u));var Y=V(G,2);Y.__change=[dg,m,a],it(Y,ne=>ke(m,ne),()=>v(m)),O(S),me(()=>Y.multiple=c),Q(A,S)};ve(_,A=>{r()?A(k):A(E,!1)})}Q(e,g),Ye()}$e(["click","change"]);function wg(e,t,n,r,i,a,l,c){if(t())return;e.preventDefault();const d=v(n).getBoundingClientRect(),h=r(e.offsetX,0,d.width,-1,1),u=r(e.offsetY,0,d.height,1,-1);i({x:h,y:u}),document.addEventListener("pointermove",a),document.addEventListener("pointerup",l),c.onchange&&c.onchange({name:c.name,value:i()})}var kg=xt('<g><circle class="dot svelte-1p2qqpi" cx="0" cy="0" r="5.5"></circle><circle class="ring svelte-1p2qqpi" cx="0" cy="0" r="10"></circle></g>'),xg=xt('<svg tabindex="-1" class="svelte-1p2qqpi"><rect y="-0.50" height="1" class="svelte-1p2qqpi"></rect><rect x="-0.50" width="1" class="svelte-1p2qqpi"></rect><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><text x="0" dominant-baseline="middle" text-anchor="middle" class="svelte-1p2qqpi"> </text><text x="0" dominant-baseline="middle" text-anchor="middle" class="svelte-1p2qqpi"> </text><text class="left svelte-1p2qqpi" x="0" dominant-baseline="middle" text-anchor="middle"> </text><text class="right svelte-1p2qqpi" x="0" dominant-baseline="middle" text-anchor="middle"> </text><!></svg>');function mu(e,t){He(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"size",3,300),i=be(t,"value",7,null),a=fe(()=>i()===null?null:{x:c(i().x,-1,1,0-r()/2,r()/2),y:c(i().y,1,-1,0-r()/2,r()/2)}),l=ze(void 0);function c(te,H,$,oe,ce){return(te-H)*(ce-oe)/($-H)+oe}function d(te){if(te.target===v(l)){te.preventDefault();const H=v(l).getBoundingClientRect(),$=c(te.offsetX,0,H.width,-1,1),oe=c(te.offsetY,0,H.height,1,-1);i({x:$,y:oe}),t.onchange&&t.onchange({name:t.name,value:i()})}}function h(){document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",h)}var u=xg();u.__pointerdown=[wg,n,l,c,i,d,h,t];let m;var y=P(u),g=V(y),_=V(g),k=V(_),E=V(k),A=V(E),S=V(A),x=P(S,!0);O(S);var C=V(S),D=P(C,!0);O(C);var R=V(C),W=P(R,!0);O(R);var Z=V(R),G=P(Z,!0);O(Z);var Y=V(Z);{var ne=te=>{var H=kg();let $;me(()=>$=Gn(H,"",$,{translate:`${v(a).x??""}px ${v(a).y??""}px`})),Q(te,H)};ve(Y,te=>{i()!==null&&te(ne)})}O(u),it(u,te=>ke(l,te),()=>v(l)),me(()=>{je(u,"role",n()?"none":"button"),je(u,"viewBox",`${0-r()/2} ${0-r()/2} ${r()??""} ${r()??""}`),m=Gn(u,"",m,{cursor:n()?"default":"crosshair"}),je(y,"x",0-r()/2),je(y,"width",r()),je(g,"y",0-r()/2),je(g,"height",r()),je(_,"d",`M ${0-r()/4} ${0-r()/2} L ${0-r()/4} ${r()??""}`),je(k,"d",`M ${r()/4} ${0-(r()-2)} L ${r()/4} ${r()??""}`),je(E,"d",`M ${0-r()/2} ${0-r()/4} L ${r()/2} ${0-r()/4}`),je(A,"d",`M ${0-r()/2} ${r()/4} L ${r()/2} ${r()/4}`),je(S,"y",(0-r()/8)*3),Ee(x,t.yhigh),je(C,"y",r()/8*3),Ee(D,t.ylow),je(R,"y",(0-r()/8)*3),Ee(W,t.xlow),je(Z,"y",(0-r()/8)*3),Ee(G,t.xhigh)}),Q(e,u),Ye()}$e(["pointerdown"]);var Sg=se('<div class="label svelte-1i5ik4b"><div class="svelte-1i5ik4b"><span class="svelte-1i5ik4b"><!></span> <p class="svelte-1i5ik4b"> </p></div> <div class="chart svelte-1i5ik4b"><!></div></div>'),Ig=se('<div class="field svelte-1i5ik4b"><div class="svelte-1i5ik4b"><span class="svelte-1i5ik4b"><!></span> <p class="svelte-1i5ik4b"> </p></div> <div class="chart svelte-1i5ik4b"><!></div></div>');function Eg(e,t){He(t,!0);let n=be(t,"icon",3,"material-symbols:texture"),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()})}var l=Ve(),c=Ce(l);{var d=u=>{var m=Ve(),y=Ce(m);{var g=_=>{var k=Sg(),E=P(k),A=P(E),S=P(A);Te(S,{height:"24",get icon(){return n()},width:"24"}),O(A);var x=V(A,2),C=P(x,!0);O(x),O(E);var D=V(E,2),R=P(D);mu(R,{get label(){return t.label},name:"plot",get readonly(){return r()},get value(){return i()},get xhigh(){return t.xhigh},get xlow(){return t.xlow},get yhigh(){return t.yhigh},get ylow(){return t.ylow}}),O(D),O(k),me(()=>Ee(C,t.label)),Q(_,k)};ve(y,_=>{i()!==null&&_(g)})}Q(u,m)},h=u=>{var m=Ig(),y=P(m),g=P(y),_=P(g);Te(_,{height:"24",get icon(){return n()},width:"24"}),O(g);var k=V(g,2),E=P(k,!0);O(k),O(y);var A=V(y,2),S=P(A);mu(S,{get label(){return t.label},name:"plot",onchange:a,get readonly(){return r()},get value(){return i()},get xhigh(){return t.xhigh},get xlow(){return t.xlow},get yhigh(){return t.yhigh},get ylow(){return t.ylow}}),O(A),O(m),me(()=>Ee(E,t.label)),Q(u,m)};ve(c,u=>{r()?u(d):u(h,!1)})}Q(e,l),Ye()}function Og(e,t,n){t(e.currentTarget.getAttribute("data-value")),n.onchange&&n.onchange(t())}var Cg=se('<li class="svelte-1ry2dq3"><button type="button" class="svelte-1ry2dq3"><!> <span class="svelte-1ry2dq3"> </span> <!></button></li>'),Ag=se('<ul class="svelte-1ry2dq3"></ul>');function Pg(e,t){He(t,!0);let n=be(t,"items",19,()=>[]),r=be(t,"value",7,"USD");var i=Ag();ft(i,21,n,ct,(a,l)=>{var c=Cg(),d=P(c);d.__click=[Og,r,t];var h=P(d);Te(h,{height:"20",get icon(){return v(l).icon},width:"20"});var u=V(h,2),m=P(u,!0);O(u);var y=V(u,2);const g=fe(()=>v(l).value===r()?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");Te(y,{height:"20",get icon(){return v(g)},width:"20"}),O(d),O(c),me(()=>{je(d,"data-value",v(l).value),Ee(m,v(l).label)}),Q(a,c)}),O(i),Q(e,i),Ye()}$e(["click"]);function Tg(e,t){v(t).showModal()}var jg=se('<div class="svelte-cc835x"><span class="svelte-cc835x"><!></span> <!> <button type="button" class="svelte-cc835x"><p class="svelte-cc835x"><span class="label svelte-cc835x">Currency</span> <span class="value svelte-cc835x"> </span></p> <span class="svelte-cc835x"><!></span></button></div> <!>',1);function Dg(e,t){He(t,!0);let n=be(t,"currency",7,"USD"),r=be(t,"placeholder",3,"0.00"),i=be(t,"readonly",3,!1),a=be(t,"value",7,null);const l=[{value:"USD",label:"US Dollar",icon:"material-symbols:attach-money"},{value:"EUR",label:"Euro",icon:"material-symbols:euro"},{value:"JPY",label:"Japanese Yen",icon:"material-symbols:currency-yen"},{value:"GBP",label:"Great Britain Pound",icon:"material-symbols:currency-pound"},{value:"AUD",label:"Australian Dollar",icon:"material-symbols:attach-money"},{value:"CAD",label:"Canadian Dollar",icon:"material-symbols:attach-money"},{value:"CHF",label:"Swiss Franc",icon:"material-symbols:currency-franc"},{value:"CNY",label:"Chinese Yuan",icon:"material-symbols:currency-yuan"},{value:"HKD",label:"Hong Kong Dollar",icon:"material-symbols:attach-money"},{value:"NZD",label:"New Zealand Dollar",icon:"material-symbols:attach-money"}];let c=ze(void 0),d=fe(()=>l.find(S=>S.value===n()).icon),h=null;function u(S){n(S),t.onchange&&t.onchange({name:t.name,value:n()})}function m(){v(c).close()}function y(S){n(h),v(c).close()}function g(S){a(S.value),t.onchange&&t.onchange({name:t.name,value:a()===null?null:parseFloat(a())})}var _=Ve(),k=Ce(_);{var E=S=>{var x=Ve(),C=Ce(x);{var D=R=>{tn(R,{get icon(){return v(d)},label:"Price",get suffix(){return n()},get value(){return a()}})};ve(C,R=>{a()!==null&&R(D)})}Q(S,x)},A=S=>{var x=jg(),C=Ce(x),D=P(C),R=P(D);Te(R,{height:"24",get icon(){return v(d)},width:"24"}),O(D);var W=V(D,2);const Z=fe(()=>typeof a()=="number"?a().toString(10):a());kn(W,{label:"Price",mode:"decimal",name:"price",onchange:g,get placeholder(){return r()},get value(){return v(Z)}});var G=V(W,2);G.__click=[Tg,c];var Y=P(G),ne=V(P(Y),2),te=P(ne,!0);O(ne),O(Y);var H=V(Y,2),$=P(H);Te($,{height:"24",icon:"material-symbols:arrow-drop-down",width:"24"}),O(H),O(G),O(C);var oe=V(C,2);it(ks(oe,{label:"Currency",onclose:m,onsave:y,children:(ce,De)=>{Pg(ce,{items:l,onchange:u,get value(){return n()}})},$$slots:{default:!0}}),ce=>ke(c,ce,!0),()=>v(c)),me(()=>Ee(te,n())),Q(S,x)};ve(k,S=>{i()?S(E):S(A,!1)})}Q(e,_),Ye()}$e(["click"]);function Rg(e,t,n,r){ke(t,v(t)+1),v(n)===0?ke(n,r.spokes.length-1):ke(n,v(n)-1)}function ei(e,t,n,r,i){t()===null&&t(new Array(n.spokes.length));const a=parseInt(e.currentTarget.getAttribute("data-value"));t()[v(r)]===a?t()[v(r)]=0:t()[v(r)]=a,t([...t()]),n.onchange&&n.onchange({name:n.name,value:t()}),i()}var Ng=se('<div class="profile svelte-ylrvbk"><div class="controls svelte-ylrvbk"><button type="button" class="svelte-ylrvbk"><!></button> <p class="svelte-ylrvbk"> </p> <button type="button" class="svelte-ylrvbk"><!></button></div> <!> <div class="value svelte-ylrvbk"><button data-value="5" type="button" class="svelte-ylrvbk">5</button> <button data-value="4" type="button" class="svelte-ylrvbk">4</button> <button data-value="3" type="button" class="svelte-ylrvbk">3</button> <button data-value="2" type="button" class="svelte-ylrvbk">2</button> <button data-value="1" type="button" class="svelte-ylrvbk">1</button></div></div>');function Lg(e,t){He(t,!0);let n=be(t,"value",7,null),r=ze(0),i=ze(0);function a(){ke(i,v(i)-1),v(r)===t.spokes.length-1?ke(r,0):ke(r,v(r)+1)}var l=Ng(),c=P(l),d=P(c);d.__click=[Rg,i,r,t];var h=P(d);Te(h,{height:"24",icon:"material-symbols:chevron-left",width:"24"}),O(d);var u=V(d,2),m=P(u,!0);O(u);var y=V(u,2);y.__click=a;var g=P(y);Te(g,{height:"24",icon:"material-symbols:chevron-right",width:"24"}),O(y),O(c);var _=V(c,2);const k=fe(()=>n()===null?[]:n()),E=fe(()=>360/t.spokes.length*v(i));fo(_,{interactive:!0,labels:!1,get spokes(){return t.spokes},get value(){return v(k)},get rotate(){return v(E)}});var A=V(_,2),S=P(A);S.__click=[ei,n,t,r,a];var x=V(S,2);x.__click=[ei,n,t,r,a];var C=V(x,2);C.__click=[ei,n,t,r,a];var D=V(C,2);D.__click=[ei,n,t,r,a];var R=V(D,2);R.__click=[ei,n,t,r,a],O(A),O(l),me(()=>Ee(m,t.spokes[v(r)])),Q(e,l),Ye()}$e(["click"]);function Mg(e,t){v(t).showModal()}var qg=se('<div class="label svelte-a3m5ng"><div class="svelte-a3m5ng"><span class="svelte-a3m5ng"><!></span> <p class="svelte-a3m5ng"> </p></div> <div class="chart svelte-a3m5ng"><!></div></div>'),Fg=se('<div class="field svelte-a3m5ng"><div class="svelte-a3m5ng"><span class="svelte-a3m5ng"><!></span> <p class="svelte-a3m5ng"> </p></div> <button type="button" class="svelte-a3m5ng"><!></button></div> <!>',1);function Ug(e,t){He(t,!0);let n=be(t,"icon",3,"material-symbols:social-leaderboard-outline"),r=be(t,"readonly",3,!1),i=be(t,"spokes",19,()=>[]),a=be(t,"value",7,null),l=ze(void 0),c=ze(void 0);function d(){v(l).close()}function h(){v(l).close()}function u(k){a([...k.value]),t.onchange&&t.onchange({name:t.name,value:k.value})}var m=Ve(),y=Ce(m);{var g=k=>{var E=Ve(),A=Ce(E);{var S=x=>{var C=qg(),D=P(C),R=P(D),W=P(R);Te(W,{height:"24",get icon(){return n()},width:"24"}),O(R);var Z=V(R,2),G=P(Z,!0);O(Z),O(D);var Y=V(D,2),ne=P(Y);const te=fe(()=>v(c)/2),H=fe(()=>a()===null?[]:a());fo(ne,{get radius(){return v(te)},get spokes(){return i()},get value(){return v(H)}}),O(Y),O(C),me(()=>Ee(G,t.label)),Q(x,C)};ve(A,x=>{a()!==null&&x(S)})}Q(k,E)},_=k=>{var E=Fg(),A=Ce(E),S=P(A),x=P(S),C=P(x);Te(C,{height:"24",get icon(){return n()},width:"24"}),O(x);var D=V(x,2),R=P(D,!0);O(D),O(S);var W=V(S,2);W.__click=[Mg,l];var Z=P(W);const G=fe(()=>v(c)/2),Y=fe(()=>a()===null?[]:a());fo(Z,{get radius(){return v(G)},get spokes(){return i()},get value(){return v(Y)}}),O(W),O(A);var ne=V(A,2);it(ks(ne,{onclose:d,onsave:h,get label(){return t.label},children:(te,H)=>{Lg(te,{name:"profile",onchange:u,get spokes(){return i()},get value(){return a()}})},$$slots:{default:!0}}),te=>ke(l,te,!0),()=>v(l)),me(()=>Ee(R,t.label)),Ld(W,"clientWidth",te=>ke(c,te)),Q(k,E)};ve(y,k=>{r()?k(g):k(_,!1)})}Q(e,m),Ye()}$e(["click"]);var Bg=se('<li class="svelte-1fz3u9v"><!></li>'),Kg=se('<div class="label svelte-1fz3u9v"><span class="svelte-1fz3u9v"><!></span> <div class="svelte-1fz3u9v"><ul class="svelte-1fz3u9v"></ul> <p class="svelte-1fz3u9v"> </p></div></div>'),zg=se('<li><button type="button" class="svelte-1fz3u9v"><!></button></li>'),Vg=se('<div class="field svelte-1fz3u9v"><div class="svelte-1fz3u9v"><span class="svelte-1fz3u9v"><!></span> <p class="svelte-1fz3u9v"> </p></div> <ul class="svelte-1fz3u9v"></ul></div>');function Wg(e,t){He(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null);function i(h){const u=parseInt(h.currentTarget.getAttribute("data-index"));u===r()?r(null):r(u),t.onchange&&t.onchange({name:t.name,value:r()})}var a=Ve(),l=Ce(a);{var c=h=>{var u=Ve(),m=Ce(u);{var y=g=>{var _=Kg(),k=P(_),E=P(k);Te(E,{height:"24",icon:"material-symbols:stars-outline",width:"24"}),O(k);var A=V(k,2),S=P(A);ft(S,20,()=>({length:5}),ct,(D,R,W)=>{var Z=Bg();const G=fe(()=>W<r()?"material-symbols:star":"material-symbols:star-outline");var Y=P(Z);Te(Y,{height:"24",get icon(){return v(G)},width:"24"}),O(Z),Q(D,Z)}),O(S);var x=V(S,2),C=P(x,!0);O(x),O(A),O(_),me(()=>Ee(C,t.label)),Q(g,_)};ve(m,g=>{r()!==null&&g(y)})}Q(h,u)},d=h=>{var u=Vg(),m=P(u),y=P(m),g=P(y);Te(g,{height:"24",icon:"material-symbols:stars-outline",width:"24"}),O(y);var _=V(y,2),k=P(_,!0);O(_),O(m);var E=V(m,2);ft(E,20,()=>({length:5}),ct,(A,S,x)=>{var C=zg();const D=fe(()=>r()===null?0:r()),R=fe(()=>x<v(D)?"material-symbols:star":"material-symbols:star-outline");var W=P(C);je(W,"aria-label",`Rating of ${x+1}`),je(W,"data-index",x+1),W.__click=i;var Z=P(W);Te(Z,{height:"48",get icon(){return v(R)},width:"48"}),O(W),O(C),Q(A,C)}),O(E),O(u),me(()=>Ee(k,t.label)),Q(h,u)};ve(l,h=>{n()?h(c):h(d,!1)})}Q(e,a),Ye()}$e(["click"]);function Hg(e,t){e.preventDefault(),v(t).focus()}function Yg(){}var Gg=se('<li class="svelte-24e094"><button type="button" class="svelte-24e094"><span class="svelte-24e094"> </span> <!></button></li>'),Jg=se('<li class="other svelte-24e094"><label class="svelte-24e094"><input placeholder="Other" text="text" class="svelte-24e094"> <button type="button" class="svelte-24e094"><!></button></label></li>'),Qg=se('<div class="svelte-24e094"><div class="svelte-24e094"><span class="svelte-24e094"><!></span> <p class="svelte-24e094"> </p></div> <ul class="svelte-24e094"><!> <!></ul></div>');function Zg(e,t){He(t,!0);let n=be(t,"items",19,()=>[]),r=be(t,"other",3,!1),i=be(t,"readonly",3,!1),a=be(t,"value",7,null),l=ze(void 0);function c(g){const _=g.currentTarget.getAttribute("data-value");a(a()===_?null:_),t.onchange&&t.onchange({name:t.name,value:a()})}function d(){}var h=Ve(),u=Ce(h);{var m=g=>{var _=Ve(),k=Ce(_);{var E=A=>{tn(A,{get icon(){return t.icon},get label(){return t.label},get value(){return a()}})};ve(k,A=>{a()!==null&&A(E)})}Q(g,_)},y=g=>{var _=Qg(),k=P(_),E=P(k),A=P(E);Te(A,{height:"24",get icon(){return t.icon},width:"24"}),O(E);var S=V(E,2),x=P(S,!0);O(S),O(k);var C=V(k,2),D=P(C);ft(D,17,n,ct,(Z,G)=>{var Y=Gg();const ne=fe(()=>a()===v(G)?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");var te=P(Y);te.__click=c;var H=P(te),$=P(H,!0);O(H);var oe=V(H,2);Te(oe,{height:"24",get icon(){return v(ne)},width:"24"}),O(te),O(Y),me(()=>{je(te,"data-value",v(G)),Ee($,v(G))}),Q(Z,Y)});var R=V(D,2);{var W=Z=>{var G=Jg(),Y=P(G),ne=P(Y);ne.__input=[Yg],it(ne,$=>ke(l,$),()=>v(l));var te=V(ne,2);te.__click=[Hg,l];var H=P(te);Te(H,{height:"24",icon:"material-symbols:circle-outline",width:"24"}),O(te),O(Y),O(G),br("focus",ne,d),Q(Z,G)};ve(R,Z=>{r()&&Z(W)})}O(C),O(_),me(()=>Ee(x,t.label)),Q(g,_)};ve(u,g=>{i()?g(m):g(y,!1)})}Q(e,h),Ye()}$e(["click","input"]);const Xg=(e,t,n)=>{let r=Jn(()=>gr(t==null?void 0:t(),!1)),i=Jn(()=>gr(n==null?void 0:n(),!1));var a=tb();let l;me(c=>l=ot(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:v(r),selected:v(i)})]),Q(e,a)},$g=(e,t,n)=>{let r=Jn(()=>gr(t==null?void 0:t(),!1)),i=Jn(()=>gr(n==null?void 0:n(),!1));var a=nb();let l;me(c=>l=ot(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:v(r),selected:v(i)})]),Q(e,a)},eb=(e,t,n)=>{let r=Jn(()=>gr(t==null?void 0:t(),!1)),i=Jn(()=>gr(n==null?void 0:n(),!1));var a=rb();let l;me(c=>l=ot(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:v(r),selected:v(i)})]),Q(e,a)};var tb=xt('<svg><rect x="50%" y="50%" width="48" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),nb=xt('<svg><rect x="0" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><rect x="50%" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),rb=xt('<svg><rect x="0" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),ib=xt('<circle cy="12" r="8"></circle>'),ob=se('<div class="label svelte-jfhagg"><span class="svelte-jfhagg"><!></span> <div class="svelte-jfhagg"><p class="svelte-jfhagg"> </p> <svg class="svelte-jfhagg"><path class="svelte-jfhagg"></path><path class="filled svelte-jfhagg"></path><!><text dominant-baseline="hanging" x="0" y="28" class="svelte-jfhagg"> </text><text dominant-baseline="hanging" text-anchor="end" y="28" class="svelte-jfhagg"> </text></svg></div></div>'),ab=se('<button type="button" class="svelte-jfhagg"><!></button>'),sb=se('<div class="field svelte-jfhagg"><div class="svelte-jfhagg"><span class="svelte-jfhagg"><!></span> <p class="svelte-jfhagg"> </p></div> <div class="slider svelte-jfhagg"></div> <div class="range svelte-jfhagg"><p class="svelte-jfhagg"> </p> <p class="svelte-jfhagg"> </p></div></div>');function lb(e,t){He(t,!0);let n=be(t,"maximum",3,7),r=be(t,"readonly",3,!1),i=be(t,"value",7,null);function a(u){const m=parseInt(u.currentTarget.getAttribute("data-index"));m===i()?i(null):i(m),t.onchange&&t.onchange({name:t.name,value:i()})}var l=Ve(),c=Ce(l);{var d=u=>{var m=Ve(),y=Ce(m);{var g=_=>{var k=ob(),E=P(k),A=P(E);Te(A,{height:"24",get icon(){return t.icon},width:"24"}),O(E);var S=V(E,2),x=P(S),C=P(x,!0);O(x);var D=V(x,2),R=P(D),W=V(R),Z=V(W);ft(Z,17,()=>({length:n()}),ct,(H,$,oe)=>{var ce=ib();const De=fe(()=>i()>oe);je(ce,"cx",10+oe*30);let Re;me(he=>Re=ot(ce,0,"svelte-jfhagg",null,Re,he),[()=>({filled:v(De)})]),Q(H,ce)});var G=V(Z),Y=P(G,!0);O(G);var ne=V(G),te=P(ne,!0);O(ne),O(D),O(S),O(k),me(()=>{Ee(C,t.label),je(R,"d",`M 10 12 L ${10+(n()-1)*30} 12`),je(W,"d",`M 10 12 L ${10+(i()-1)*30} 12`),Ee(Y,t.low),je(ne,"x",(n()-2)*40),Ee(te,t.high)}),Q(_,k)};ve(y,_=>{i()!==null&&_(g)})}Q(u,m)},h=u=>{var m=sb(),y=P(m),g=P(y),_=P(g);Te(_,{height:"24",get icon(){return t.icon},width:"24"}),O(g);var k=V(g,2),E=P(k,!0);O(k),O(y);var A=V(y,2);ft(A,21,()=>({length:n()}),ct,(W,Z,G)=>{var Y=ab();const ne=fe(()=>i()>G+1),te=fe(()=>i()===G+1);je(Y,"aria-label",G),je(Y,"data-index",G+1),Y.__click=a;var H=P(Y);{var $=ce=>{Xg(ce,()=>v(ne),()=>v(te))},oe=(ce,De)=>{{var Re=B=>{$g(B,()=>v(ne),()=>v(te))},he=(B,Ne)=>{{var Ue=qe=>{eb(qe,()=>v(ne),()=>v(te))};ve(B,qe=>{G===n()-1&&qe(Ue)},Ne)}};ve(ce,B=>{G<n()-1?B(Re):B(he,!1)},De)}};ve(H,ce=>{G===0?ce($):ce(oe,!1)})}O(Y),Q(W,Y)}),O(A);var S=V(A,2),x=P(S),C=P(x,!0);O(x);var D=V(x,2),R=P(D,!0);O(D),O(S),O(m),me(()=>{Ee(E,t.label),Ee(C,t.low),Ee(R,t.high)}),Q(u,m)};ve(c,u=>{r()?u(d):u(h,!1)})}Q(e,l),Ye()}$e(["click"]);var ub=se('<button tabindex="-1" type="button" class="svelte-ng495u"><!></button>'),cb=se('<div class="svelte-ng495u"><span><!></span> <!></div>');function fb(e,t){He(t,!0);let n=be(t,"readonly",3,!1),r=be(t,"value",7,null),i=ze(mr(r()===null?t.suffix[0]:r().units)),a=fe(()=>r()===null?null:r().measure.toLocaleString(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2}));function l(y){y.value===null?r(null):r({measure:y.value,units:v(i)}),t.onchange&&t.onchange({name:t.name,value:{measure:parseFloat(r().measure),units:v(i)}})}function c(){let y=t.suffix.indexOf(v(i));y===t.suffix.length-1?y=0:y=y+1,ke(i,t.suffix[y],!0),r()!==null&&t.onchange&&t.onchange({name:t.name,value:{measure:parseFloat(r().measure),units:v(i)}})}var d=Ve(),h=Ce(d);{var u=y=>{var g=Ve(),_=Ce(g);{var k=E=>{tn(E,{get icon(){return t.icon},get label(){return t.label},get suffix(){return r().units},get value(){return v(a)}})};ve(_,E=>{r()!==null&&E(k)})}Q(y,g)},m=y=>{var g=cb(),_=P(g);let k;var E=P(_);Te(E,{height:"24",get icon(){return t.icon},width:"24"}),O(_);var A=V(_,2);kn(A,{get label(){return t.label},mode:"decimal",name:"units",onchange:l,get placeholder(){return t.placeholder},get suffix(){return v(i)},get value(){return v(a)},children:(S,x)=>{var C=ub();C.__click=c;var D=P(C);Te(D,{height:"24",icon:"material-symbols:conversion-path",width:"24"}),O(C),Q(S,C)},$$slots:{default:!0}}),O(g),me(S=>k=ot(_,1,"svelte-ng495u",null,k,S),[()=>({noicon:!t.icon})]),Q(y,g)};ve(h,y=>{n()?y(u):y(m,!1)})}Q(e,d),Ye()}$e(["click"]);var db=se("<!> <!> <!>",1),vb=se('<div class="extra"><!></div>'),hb=se('<div class="extra"><!></div>'),pb=se('<section class="svelte-wtn90l"><!> <form><!> <!> <!></form></section>');function yb(e,t){He(t,!0);let n=be(t,"flavor",3,null),r=ze(void 0),i=ze(!1),a=ze(void 0),l=ze(null),c=fe(()=>n()===null?null:n().fields),d=fe(()=>v(l)===null||v(l).id===null?`New ${n()===null?"":n().singular}`:v(i)?"":`Edit ${n()===null?"":n().singular}`),h=fe(()=>v(l)!==null&&v(l).name!==null);const u=new Io;let m=null,y=null,g=null,_=null,k=null,E=null;function A(){const he={id:null,photos:null};for(let B=0;B<v(c).length;B++)he[v(c)[B].name]=null;ke(l,he,!0)}function S(){return v(a).animate([{top:0},{top:"100vh"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{ke(i,!0),v(r).scrollTo({top:0}),A()})}function x(he=null){he===null?(A(),ke(i,!1),v(a).animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{m=navigator.geolocation.watchPosition(B=>{y=B.coords.latitude,g=B.coords.longitude,navigator.geolocation.clearWatch(m),m=null,fetch(`/api/weather?location=${y},${g}`).then(Ne=>Ne.json()).then(Ne=>{E=Ne.icon,_=Ne.temperature,k=Ne.condition})})})):u.readReview(he).then(B=>{ke(l,B,!0),ke(i,!0),v(a).animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"})})}async function C(){v(l)===null||v(l).id===null?S():u.readReview(v(l).id).then(he=>{ke(l,he,!0),ke(i,!0)})}function D(){confirm("Are you sure you want to delete this review?")&&u.deleteReview(v(l).id).then(()=>{t.onchange(),S()})}function R(){if(v(h))v(l).id===null?(v(l).latitude=y,v(l).longitude=g,v(l).temperature=_,v(l).condition=k,v(l).weather=E,u.addReview(n().singular,v(l)).then(()=>{t.onchange(),S()})):(ke(i,!0),u.editReview(v(l)).then(he=>{ke(l,he,!0),t.onchange()}));else{const he=v(c).find(B=>B.name==="name");alert(`${he.label} is required.`)}}function W(){ke(i,!1)}function Z(){v(l).favorite=!v(l).favorite,u.favoriteReview(v(l).id,v(l).favorite).then(he=>{ke(l,he,!0),t.onchange&&t.onchange()})}function G(he){v(l)!==null&&(v(l)[he.name]=he.value)}var Y=pb(),ne=P(Y);is(ne,{get label(){return v(d)},variation:"sm",left:Ne=>{var Ue=Ve(),qe=Ce(Ue);{var Ze=Je=>{Lt(Je,{name:"material-symbols:close",onclick:C})},Ge=Je=>{Lt(Je,{name:"material-symbols:arrow-back",onclick:()=>S()})};ve(qe,Je=>{v(i)?Je(Ge,!1):Je(Ze)})}Q(Ne,Ue)},right:Ne=>{var Ue=Ve(),qe=Ce(Ue);{var Ze=Je=>{var St=db(),Ut=Ce(St);const Se=fe(()=>v(l).favorite?"material-symbols:favorite":"material-symbols:favorite-outline");Lt(Ut,{get name(){return v(Se)},onclick:Z});var Ie=V(Ut,2);Lt(Ie,{name:"material-symbols:delete-outline-rounded",onclick:D});var ie=V(Ie,2);Lt(ie,{name:"material-symbols:edit-outline-rounded",onclick:W}),Q(Je,St)},Ge=Je=>{Lt(Je,{onclick:R,name:"material-symbols:done"})};ve(qe,Je=>{v(l)&&v(l).id!==null&&v(i)?Je(Ze):Je(Ge,!1)})}Q(Ne,Ue)},$$slots:{left:!0,right:!0}});var te=V(ne,2);let H;var $=P(te);ft($,17,()=>v(c),ct,(he,B)=>{var Ne=Ve(),Ue=Ce(Ne);{var qe=Ze=>{var Ge=Ve(),Je=Ce(Ge);{var St=Se=>{const Ie=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);_g(Se,{get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get value(){return v(Ie)}})},Ut=(Se,Ie)=>{{var ie=we=>{const Ae=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);rg(we,{get label(){return v(B).label},get name(){return v(B).name},onchange:G,get placeholder(){return v(B).label},get readonly(){return v(i)},get value(){return v(Ae)}})},ae=(we,Ae)=>{{var et=Tt=>{const Ct=fe(()=>v(B).hint===null?v(B).label:v(B).hint),bt=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);bf(Tt,{get icon(){return v(B).icon},get label(){return v(B).label},get name(){return v(B).name},onchange:G,get placeholder(){return v(Ct)},get readonly(){return v(i)},get value(){return v(bt)}})},Bt=(Tt,Ct)=>{{var bt=at=>{const vt=fe(()=>v(B).hint===null?v(B).label:v(B).hint),At=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);Wm(at,{get icon(){return v(B).icon},get label(){return v(B).label},get name(){return v(B).name},onchange:G,get placeholder(){return v(vt)},get readonly(){return v(i)},get suffix(){return v(B).suffix},get value(){return v(At)}})},jt=(at,vt)=>{{var At=Kt=>{const Gt=fe(()=>v(B).hint===null?v(B).label:v(B).hint),Jt=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);ug(Kt,{get icon(){return v(B).icon},get label(){return v(B).label},get name(){return v(B).name},onchange:G,get placeholder(){return v(Gt)},get readonly(){return v(i)},get suffix(){return v(B).suffix},get value(){return v(Jt)}})},Xn=(Kt,Gt)=>{{var Jt=zt=>{const Mn=fe(()=>v(B).hint===null?v(B).label:v(B).hint),In=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);fb(zt,{get icon(){return v(B).icon},get label(){return v(B).label},get name(){return v(B).name},onchange:G,get placeholder(){return v(Mn)},get readonly(){return v(i)},get suffix(){return v(B).options},get value(){return v(In)}})},jr=(zt,Mn)=>{{var In=Qt=>{const qn=fe(()=>v(l)&&v(l).currency?v(l).currency:"USD"),Vt=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);Dg(Qt,{get currency(){return v(qn)},get label(){return v(B).label},get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get value(){return v(Vt)}})},vn=(Qt,qn)=>{{var Vt=Wt=>{const Zt=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);zm(Wt,{get label(){return v(B).label},get name(){return v(B).name},onchange:G,get placeholder(){return v(B).label},get readonly(){return v(i)},get value(){return v(Zt)}})},Oe=(Wt,Zt)=>{{var $n=nn=>{const er=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);Wg(nn,{get label(){return v(B).label},get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get value(){return v(er)}})},_e=(nn,er)=>{{var Dr=rn=>{const Rr=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);eg(rn,{get icon(){return v(B).icon},get items(){return v(B).options},get label(){return v(B).label},get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get value(){return v(Rr)}})},mi=(rn,Rr)=>{{var Eo=Dt=>{const Fn=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);Zg(Dt,{get icon(){return v(B).icon},get items(){return v(B).options},get label(){return v(B).label},get name(){return v(B).name},onchange:G,get other(){return v(B).other},get readonly(){return v(i)},get value(){return v(Fn)}})},En=(Dt,Fn)=>{{var tr=nt=>{const Nr=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);Ug(nt,{get label(){return v(B).label},get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get spokes(){return v(B).options},get value(){return v(Nr)}})},tt=(nt,Nr)=>{{var nr=Xt=>{const Lr=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);lb(Xt,{get icon(){return v(B).icon},get high(){return v(B).high},get label(){return v(B).label},get low(){return v(B).low},get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get value(){return v(Lr)}})},rr=(Xt,Lr)=>{{var on=It=>{const Cn=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);Eg(It,{get label(){return v(B).label},get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get value(){return v(Cn)},get xhigh(){return v(B).xhigh},get xlow(){return v(B).xlow},get yhigh(){return v(B).yhigh},get ylow(){return v(B).ylow}})},On=(It,Cn)=>{{var Oo=Ht=>{const gi=fe(()=>v(l)&&v(l)[v(B).name]?v(l)[v(B).name]:null);sg(Ht,{get name(){return v(B).name},onchange:G,get readonly(){return v(i)},get value(){return v(gi)}})};ve(It,Ht=>{v(B).kind==="notes"&&Ht(Oo)},Cn)}};ve(Xt,It=>{v(B).kind==="plot"?It(on):It(On,!1)},Lr)}};ve(nt,Xt=>{v(B).kind==="slider"?Xt(nr):Xt(rr,!1)},Nr)}};ve(Dt,nt=>{v(B).kind==="profile"?nt(tr):nt(tt,!1)},Fn)}};ve(rn,Dt=>{v(B).kind==="radio"?Dt(Eo):Dt(En,!1)},Rr)}};ve(nn,rn=>{v(B).kind==="meter"?rn(Dr):rn(mi,!1)},er)}};ve(Wt,nn=>{v(B).kind==="rating"?nn($n):nn(_e,!1)},Zt)}};ve(Qt,Wt=>{v(B).kind==="date"?Wt(Vt):Wt(Oe,!1)},qn)}};ve(zt,Qt=>{v(B).kind==="price"?Qt(In):Qt(vn,!1)},Mn)}};ve(Kt,zt=>{v(B).kind==="units"?zt(Jt):zt(jr,!1)},Gt)}};ve(at,Kt=>{v(B).kind==="number"?Kt(At):Kt(Xn,!1)},vt)}};ve(Tt,at=>{v(B).kind==="decimal"?at(bt):at(jt,!1)},Ct)}};ve(we,Tt=>{v(B).kind==="text"?Tt(et):Tt(Bt,!1)},Ae)}};ve(Se,we=>{v(B).kind==="name"?we(ie):we(ae,!1)},Ie)}};ve(Je,Se=>{v(B).kind==="photo"?Se(St):Se(Ut,!1)})}Q(Ze,Ge)};ve(Ue,Ze=>{v(B).hidden||Ze(qe)})}Q(he,Ne)});var oe=V($,2);{var ce=he=>{var B=vb(),Ne=P(B);const Ue=fe(()=>v(l).latitude.toFixed(5)),qe=fe(()=>v(l).longitude.toFixed(5));tn(Ne,{bottom:!1,icon:"material-symbols:my-location-outline-rounded",label:"Coordinates",top:!0,get value(){return`${v(Ue)??""}, ${v(qe)??""}`}}),O(B),Q(he,B)};ve(oe,he=>{v(i)&&v(l)&&v(l).latitude&&he(ce)})}var De=V(oe,2);{var Re=he=>{var B=hb(),Ne=P(B);const Ue=fe(()=>v(l).condition),qe=fe(()=>v(l).temperature.toFixed(0));tn(Ne,{bottom:!1,get icon(){return v(l).weather},label:"Weather",top:!0,get value(){return`${v(Ue)??""}, ${v(qe)??""}°F`}}),O(B),Q(he,B)};ve(De,he=>{v(i)&&v(l)&&v(l).weather&&he(Re)})}return O(te),it(te,he=>ke(r,he),()=>v(r)),O(Y),it(Y,he=>ke(a,he),()=>v(a)),me(he=>H=ot(te,1,"svelte-wtn90l",null,H,he),[()=>({readonly:v(i)})]),Q(e,Y),Ye({hide:S,show:x})}var mb=(e,t,n)=>t.onchange(v(n).id),gb=se('<figcaption class="svelte-9ufrua"> </figcaption>'),bb=se('<img alt="Thumbnail" height="64" width="100" class="svelte-9ufrua">'),_b=se('<span class="svelte-9ufrua"><!></span>'),wb=se('<li class="svelte-9ufrua"><button type="button" class="svelte-9ufrua"><figure class="svelte-9ufrua"><!> <!></figure> <div class="item svelte-9ufrua"><p class="created svelte-9ufrua"> </p> <div class="rating svelte-9ufrua"></div> <p class="name svelte-9ufrua"> </p></div></button></li>'),kb=se('<ul class="svelte-9ufrua"></ul>'),xb=se("<article><!></article>");function Sb(e,t){He(t,!0);let n=be(t,"hidden",3,!1),r=be(t,"items",19,()=>[]);function i(m){return new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"numeric",year:"numeric"}).format(m)}function a(m){const g=m.replace(/\([^()]*\)/g,"").split(" ");let _="";for(let k=0;k<g.length;k++){const E=g[k].trim();if(E.length===0)continue;let A=E.charAt(0);if(E.indexOf("-")>-1){const S=E.split("-");for(let x=1;x<S.length;x++)A=A+S[x].charAt(0)}_=_+A}return _.toUpperCase()}var l=xb();let c;var d=P(l);{var h=m=>{var y=Ve(),g=Ce(y);bn(g,()=>t.children),Q(m,y)},u=m=>{var y=kb();ft(y,21,r,ct,(g,_)=>{var k=wb(),E=P(k);E.__click=[mb,t,_];var A=P(E),S=P(A);{var x=H=>{var $=gb(),oe=P($,!0);O($),me(ce=>Ee(oe,ce),[()=>a(v(_).name)]),Q(H,$)},C=H=>{var $=bb();me(()=>je($,"src",v(_).photos[0].data)),Q(H,$)};ve(S,H=>{v(_).photos===null?H(x):H(C,!1)})}var D=V(S,2);{var R=H=>{var $=_b(),oe=P($);Te(oe,{height:"14",icon:"material-symbols:favorite",width:"14"}),O($),Q(H,$)};ve(D,H=>{v(_).favorite&&H(R)})}O(A);var W=V(A,2),Z=P(W),G=P(Z,!0);O(Z);var Y=V(Z,2);ft(Y,20,()=>({length:5}),ct,(H,$,oe)=>{const ce=fe(()=>oe<v(_).rating?"material-symbols:star":"material-symbols:star-outline");Te(H,{color:"#161616",height:"16",get icon(){return v(ce)},width:"16"})}),O(Y);var ne=V(Y,2),te=P(ne,!0);O(ne),O(W),O(E),O(k),me(H=>{Ee(G,H),Ee(te,v(_).name)},[()=>i(v(_).updated_at)]),Q(g,k)}),O(y),Q(m,y)};ve(d,m=>{r().length===0?m(h):m(u,!1)})}O(l),me(m=>c=ot(l,1,"svelte-9ufrua",null,c,m),[()=>({hidden:n()})]),Q(e,l),Ye()}$e(["click"]);var Ib=se('<link rel="manifest" href="./manifest.json"> <meta name="theme-color">',1),Eb=se("<!> <!>",1),Ob=se("<!> <!> <!> <!>",1),Cb=se('<p class="svelte-cbft3s">Empty Timeline</p> <p class="svelte-cbft3s">Add a review to get started!</p>',1),Ab=se('<p class="svelte-cbft3s">Select a flavor to get started!</p> <button class="m3 svelte-cbft3s" type="button">Select a flavor</button>',1),Pb=se('<div class="empty svelte-cbft3s"><!></div>'),Tb=se('<div class="empty svelte-cbft3s"><p class="photos svelte-cbft3s">Empty Photos</p> <p class="photos svelte-cbft3s">There are no reviews with photos.</p></div>'),jb=se('<button class="fab svelte-cbft3s" type="button"><span class="svelte-cbft3s"><!></span></button>'),Db=se('<section class="svelte-cbft3s"><!> <!> <!> <!></section> <!> <!> <!>',1);function Gb(e,t){He(t,!0);let n,r,i,a=ze(void 0),l=ze(mr({})),c=ze(mr([])),d=ze(!1),h=ze(void 0),u=ze(1),m=fe(()=>v(h)&&v(h).book?v(h).book:null),y=fe(()=>{var ie;return(ie=v(a))==null?void 0:ie.tastes.reduce((ae,we)=>(ae[we.singular]=we.primary,ae),{})}),g=fe(()=>v(m)===null?null:v(a).tastes.find(ie=>ie.singular===v(m))),_=fe(()=>v(c).reduce((ie,ae)=>{if(ae.photos!==null)for(let we=0;we<ae.photos.length;we++)ie.push({id:ae.id,created_at:new Date(ae.created_at.getTime()),data:ae.photos[we].data,favorite:ae.favorite});return ie},[])),k=fe(()=>v(c).reduce((ie,ae)=>(ae.latitude!==null&&ie.push({id:ae.id,color:v(y)[ae.type],latitude:ae.latitude,longitude:ae.longitude}),ie),[])),E=fe(()=>v(d)?v(c).length===0?"There are no matching reviews":v(c).length===1?`There is ${v(c).length} matching review`:`There are ${v(c).length} matching reviews`:v(m)===null?`You have made ${v(c).length} ${v(c).length===1?"review":"reviews"}`:v(c).length===0?"There are no reviews for this flavor":`You have made ${v(c).length} ${v(g).singular.toLowerCase()} ${v(c).length===1?"review":"reviews"}`),A=fe(()=>v(g)===null?"#5fb2ff":v(g).primary);const S=new Io;di(()=>{fetch("/flavors.json").then(ie=>ie.json()).then(ie=>{const ae=ie.tastes.filter(we=>we.active);ae.sort((we,Ae)=>we.singular>Ae.singular?1:we.singular<Ae.singular?-1:0),ie.tastes=[...ae],ke(a,ie,!0),S.readSettings().then(we=>we!==null?(ke(h,we,!0),!v(h).book&&v(h).book===null?S.browseReview():S.browseReview(v(h).book)):S.browseReview()).then(we=>(ke(c,[...we],!0),S.countReview())).then(we=>{ke(l,we,!0)})})}),Or(()=>{v(g)?(document.documentElement.style.setProperty("--primary-accent-color",v(g).primary),document.documentElement.style.setProperty("--secondary-accent-color",v(g).secondary)):(document.documentElement.style.setProperty("--primary-accent-color","#5fb2ff"),document.documentElement.style.setProperty("--secondary-accent-color","#003f7f"))});function x(){console.log("SHOW ACCOUNT: "+S.userId),n.show()}function C(){S.userId==="unauthorized"?S.countReviews().then(ie=>{ie>=3?confirm("Create an account to continue?")&&n.show():r.show()}):r.show()}async function D(ie){ke(c,[],!0),v(h)||ke(h,await S.createSettings(),!0),v(h).book=ie===null?null:ie,await S.updateSettings(v(h)),ke(c,await S.browseReview(v(h).book===null?null:v(h).book),!0),i.hide()}function R(ie){r.show(ie)}function W(ie){r.show(ie)}function Z(){S.browseReview(v(g).singular).then(ie=>ke(c,[...ie],!0)),S.countReview().then(ie=>ke(l,ie,!0))}function G(){ke(d,!1),S.browseReview(v(g)?v(g).singular:null).then(ie=>ke(c,[...ie],!0))}function Y(ie){ie===null?S.browseReview(v(g)?v(g).singular:null).then(ae=>ke(c,[...ae],!0)):S.browseReview(v(g)?v(g).singular:null,ie).then(ae=>ke(c,[...ae],!0))}function ne(ie){ie.preventDefault(),ke(d,!0)}function te(ie){r.show(ie)}var H=Db();Cu(ie=>{var ae=Ib(),we=V(Ce(ae),2);me(()=>je(we,"content",v(A))),Q(ie,ae)});var $=Ce(H),oe=P($);const ce=fe(()=>v(g)?v(g).phrase:"Flavor Awesome"),De=fe(()=>v(d)?"search":null);is(oe,{get label(){return v(ce)},oncancel:G,onchange:Y,get subtitle(){return v(E)},get variation(){return v(De)},left:we=>{Lt(we,{name:"material-symbols:menu",onclick:()=>i.show()})},right:we=>{var Ae=Eb(),et=Ce(Ae);Lt(et,{name:"material-symbols:search",onclick:ne});var Bt=V(et,2);Lt(Bt,{name:"material-symbols:account-circle",onclick:x}),Q(we,Ae)},$$slots:{left:!0,right:!0}});var Re=V(oe,2);xm(Re,{children:(ie,ae)=>{var we=Ob(),Ae=Ce(we);const et=fe(()=>v(u)===0);Wi(Ae,{get active(){return v(et)},icon:"material-symbols:book-ribbon-outline-rounded",onclick:()=>ke(u,0)});var Bt=V(Ae,2);const Tt=fe(()=>v(u)===1);Wi(Bt,{get active(){return v(Tt)},onclick:()=>ke(u,1),label:"Timeline"});var Ct=V(Bt,2);const bt=fe(()=>v(u)===2);Wi(Ct,{get active(){return v(bt)},label:"Photos",onclick:()=>ke(u,2)});var jt=V(Ct,2);const at=fe(()=>v(u)===3);Wi(jt,{get active(){return v(at)},label:"Map",onclick:()=>ke(u,3)}),Q(ie,we)}});var he=V(Re,2);{var B=ie=>{const ae=fe(()=>v(u)!==0);fm(ie,{get flavor(){return v(g)},get hidden(){return v(ae)},get items(){return v(c)}})},Ne=(ie,ae)=>{{var we=et=>{Sb(et,{get items(){return v(c)},onchange:te,children:(Bt,Tt)=>{var Ct=Pb(),bt=P(Ct);{var jt=vt=>{var At=Cb();Pt(2),Q(vt,At)},at=vt=>{var At=Ab(),Xn=V(Ce(At),2);Xn.__click=()=>i.show(),Q(vt,At)};ve(bt,vt=>{v(g)?vt(jt):vt(at,!1)})}O(Ct),Q(Bt,Ct)},$$slots:{default:!0}})},Ae=(et,Bt)=>{{var Tt=bt=>{jm(bt,{get items(){return v(_)},onchange:W,children:(jt,at)=>{var vt=Tb();Q(jt,vt)},$$slots:{default:!0}})},Ct=(bt,jt)=>{{var at=vt=>{wm(vt,{get items(){return v(k)},onchange:R})};ve(bt,vt=>{v(u)===3&&vt(at)},jt)}};ve(et,bt=>{v(u)===2?bt(Tt):bt(Ct,!1)},Bt)}};ve(ie,et=>{v(u)===1?et(we):et(Ae,!1)},ae)}};ve(he,ie=>{v(u)===0?ie(B):ie(Ne,!1)})}var Ue=V(he,2);{var qe=ie=>{var ae=jb();ae.__click=C;var we=P(ae),Ae=P(we);Te(Ae,{height:"24",icon:"material-symbols:add",width:"24"}),O(we),O(ae),Q(ie,ae)};ve(Ue,ie=>{v(g)&&ie(qe)})}O($);var Ze=V($,2);const Ge=fe(()=>v(a)&&v(a).tastes?v(a).tastes:null),Je=fe(()=>v(g)?v(g).singular:null);it(gm(Ze,{get count(){return v(l)},get items(){return v(Ge)},onchange:D,get selected(){return v(Je)}}),ie=>i=ie,()=>i);var St=V(Ze,2);const Ut=fe(()=>v(g)?v(g):null);it(yb(St,{get flavor(){return v(Ut)},onchange:Z}),ie=>r=ie,()=>r);var Se=V(St,2);const Ie=fe(()=>v(a)&&v(a).tastes?v(a).tastes:null);it(nm(Se,{onchange:Z,get tastes(){return v(Ie)}}),ie=>n=ie,()=>n),Q(e,H),Ye()}$e(["click"]);export{Gb as component};
