var Mf=Object.defineProperty;var Js=e=>{throw TypeError(e)};var qf=(e,t,n)=>t in e?Mf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Qs=(e,t,n)=>qf(e,typeof t!="symbol"?t+"":t,n),na=(e,t,n)=>t.has(e)||Js("Cannot "+n);var dn=(e,t,n)=>(na(e,t,"read from private field"),n?n.call(e):t.get(e)),Vr=(e,t,n)=>t.has(e)?Js("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ra=(e,t,n,r)=>(na(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Zs=(e,t,n)=>(na(e,t,"access private method"),n);import{b as Xs,e as Ff,t as ue,a as Q,c as He,n as It,f as Uf,d as $s}from"../chunks/B6u9Wa-7.js";import{a9 as yu,ao as mu,ap as Bf,q as gu,aa as Kf,h as gt,s as $r,N as ar,b as zf,i as _a,z as y,y as Hn,j as Vf,r as el,k as ei,c as zn,af as Wf,m as bu,a as _u,p as Hf,aq as ia,ai as wu,Q as wa,ar as tl,J as Yf,as as nl,at as Qa,au as Gf,a4 as Jf,av as Qf,d as Zf,aw as Za,ax as Xf,ac as ku,M as $f,ay as xu,t as ed,az as td,$ as _e,aA as nd,ag as rd,ae as id,o as Su,aB as od,aC as ad,aD as sd,aE as ld,aF as ud,aG as cd,g as Iu,a1 as P,a2 as E,f as Ae,n as xr,a3 as W,_ as Qe,u as Sr,a0 as Ze,al as Ge,C as Ee,aH as fd,an as fe,aI as St,B as Vn,aJ as pr}from"../chunks/MyxID9jh.js";import{a as dd,i as vd,c as hd,d as it,b as pd,n as yd,e as md,l as gd,s as Oe,f as oi,g as Eu,r as Ou,j as bd}from"../chunks/B_W0AqVO.js";import{i as he,r as _d,p as ge,b as st}from"../chunks/D16ImUdI.js";import{o as po,a as wd}from"../chunks/Bcl-jklz.js";import{s as pn}from"../chunks/C1tbqaM7.js";const kd=[];function Li(e,t=!1){return Hi(e,new Map,"",kd)}function Hi(e,t,n,r,i=null){if(typeof e=="object"&&e!==null){var a=t.get(e);if(a!==void 0)return a;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(yu(e)){var l=Array(e.length);t.set(e,l),i!==null&&t.set(i,l);for(var c=0;c<e.length;c+=1){var d=e[c];c in e&&(l[c]=Hi(d,t,n,r))}return l}if(mu(e)===Bf){l={},t.set(e,l),i!==null&&t.set(i,l);for(var v in e)l[v]=Hi(e[v],t,n,r);return l}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function")return Hi(e.toJSON(),t,n,r,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function sr(e,t){gt&&$r(ar(e)),gu(()=>{var n=t();for(var r in n){var i=n[r];i?e.style.setProperty(r,i):e.style.removeProperty(r)}}),Kf(()=>{e.remove()})}function ft(e,t){return t}function xd(e,t,n,r){for(var i=[],a=t.length,l=0;l<a;l++)Gf(t[l].e,i,!0);var c=a>0&&i.length===0&&n!==null;if(c){var d=n.parentNode;Jf(d),d.append(n),r.clear(),An(e,t[0].prev,t[a-1].next)}Qf(i,()=>{for(var v=0;v<a;v++){var u=t[v];c||(r.delete(u.k),An(e,u.prev,u.next)),Zf(u.e,!c)}})}function dt(e,t,n,r,i,a=null){var l=e,c={flags:t,items:new Map,first:null},d=(t&xu)!==0;if(d){var v=e;l=gt?$r(ar(v)):v.appendChild($f())}gt&&_a();var u=null,m=!1,h=Hn(()=>{var g=n();return yu(g)?g:g==null?[]:wu(g)});zf(()=>{var g=y(h),_=g.length;if(m&&_===0)return;m=_===0;let k=!1;if(gt){var O=l.data===Vf;O!==(_===0)&&(l=el(),$r(l),ei(!1),k=!0)}if(gt){for(var A=null,I,x=0;x<_;x++){if(zn.nodeType===8&&zn.data===Wf){l=zn,k=!0,ei(!1);break}var C=g[x],q=r(C,x);I=Au(zn,c,A,null,C,q,x,i,t,n),c.items.set(q,I),A=I}_>0&&$r(el())}gt||Sd(g,c,l,i,t,r,n),a!==null&&(_===0?u?bu(u):u=_u(()=>a(l)):u!==null&&Hf(u,()=>{u=null})),k&&ei(!0),y(h)}),gt&&(l=zn)}function Sd(e,t,n,r,i,a,l){var ee,ie,oe,Re;var c=(i&td)!==0,d=(i&(Za|Qa))!==0,v=e.length,u=t.items,m=t.first,h=m,g,_=null,k,O=[],A=[],I,x,C,q;if(c)for(q=0;q<v;q+=1)I=e[q],x=a(I,q),C=u.get(x),C!==void 0&&((ee=C.a)==null||ee.measure(),(k??(k=new Set)).add(C));for(q=0;q<v;q+=1){if(I=e[q],x=a(I,q),C=u.get(x),C===void 0){var L=h?h.e.nodes_start:n;_=Au(L,t,_,_===null?t.first:_.next,I,x,q,r,i,l),u.set(x,_),O=[],A=[],h=_.next;continue}if(d&&Id(C,I,q,i),(C.e.f&ia)!==0&&(bu(C.e),c&&((ie=C.a)==null||ie.unfix(),(k??(k=new Set)).delete(C))),C!==h){if(g!==void 0&&g.has(C)){if(O.length<A.length){var V=A[0],te;_=V.prev;var J=O[0],G=O[O.length-1];for(te=0;te<O.length;te+=1)rl(O[te],V,n);for(te=0;te<A.length;te+=1)g.delete(A[te]);An(t,J.prev,G.next),An(t,_,J),An(t,G,V),h=V,_=G,q-=1,O=[],A=[]}else g.delete(C),rl(C,h,n),An(t,C.prev,C.next),An(t,C,_===null?t.first:_.next),An(t,_,C),_=C;continue}for(O=[],A=[];h!==null&&h.k!==x;)(h.e.f&ia)===0&&(g??(g=new Set)).add(h),A.push(h),h=h.next;if(h===null)continue;C=h}O.push(C),_=C,h=C.next}if(h!==null||g!==void 0){for(var ne=g===void 0?[]:wu(g);h!==null;)(h.e.f&ia)===0&&ne.push(h),h=h.next;var $=ne.length;if($>0){var H=(i&xu)!==0&&v===0?n:null;if(c){for(q=0;q<$;q+=1)(oe=ne[q].a)==null||oe.measure();for(q=0;q<$;q+=1)(Re=ne[q].a)==null||Re.fix()}xd(t,ne,H,u)}}c&&ed(()=>{var je;if(k!==void 0)for(C of k)(je=C.a)==null||je.apply()}),wa.first=t.first&&t.first.e,wa.last=_&&_.e}function Id(e,t,n,r){(r&Za)!==0&&tl(e.v,t),(r&Qa)!==0?tl(e.i,n):e.i=n}function Au(e,t,n,r,i,a,l,c,d,v){var u=(d&Za)!==0,m=(d&Xf)===0,h=u?m?Yf(i):nl(i):i,g=(d&Qa)===0?l:nl(l),_={i:g,v:h,k:a,a:null,e:null,prev:n,next:r};try{return _.e=_u(()=>c(e,h,g,v),gt),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?t.first=_:(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function rl(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==r;){var l=ku(a);i.before(a),a=l}}function An(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Ed(e,t,n=!1,r=!1,i=!1){var a=e,l="";_e(()=>{var c=wa;if(l===(l=t()??"")){gt&&_a();return}if(c.nodes_start!==null&&(nd(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),l!==""){if(gt){zn.data;for(var d=_a(),v=d;d!==null&&(d.nodeType!==8||d.data!=="");)v=d,d=ku(d);if(d===null)throw rd(),id;Xs(zn,v),a=$r(d);return}var u=l+"";n?u=`<svg>${u}</svg>`:r&&(u=`<math>${u}</math>`);var m=Ff(u);if((n||r)&&(m=ar(m)),Xs(ar(m),m.lastChild),n||r)for(;ar(m);)a.before(ar(m));else a.before(m)}})}function Od(e,t){Su(()=>{const n=t();return n&&n(e)})}function Cu(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Cu(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Ad(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Cu(e))&&(r&&(r+=" "),r+=t);return r}function Cd(e){return typeof e=="object"?Ad(e):e??""}const il=[...` 	
\r\fÂ \v\uFEFF`];function Pd(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var a=i.length,l=0;(l=r.indexOf(i,l))>=0;){var c=l+a;(l===0||il.includes(r[l-1]))&&(c===r.length||il.includes(r[c]))?r=(l===0?"":r.substring(0,l))+r.substring(c+1):l=c}}return r===""?null:r}function ol(e,t=!1){var n=t?" !important;":";",r="";for(var i in e){var a=e[i];a!=null&&a!==""&&(r+=" "+i+": "+a+n)}return r}function oa(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function Td(e,t){if(t){var n="",r,i;if(Array.isArray(t)?(r=t[0],i=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,l=0,c=!1,d=[];r&&d.push(...Object.keys(r).map(oa)),i&&d.push(...Object.keys(i).map(oa));var v=0,u=-1;const k=e.length;for(var m=0;m<k;m++){var h=e[m];if(c?h==="/"&&e[m-1]==="*"&&(c=!1):a?a===h&&(a=!1):h==="/"&&e[m+1]==="*"?c=!0:h==='"'||h==="'"?a=h:h==="("?l++:h===")"&&l--,!c&&a===!1&&l===0){if(h===":"&&u===-1)u=m;else if(h===";"||m===k-1){if(u!==-1){var g=oa(e.substring(v,u).trim());if(!d.includes(g)){h!==";"&&m++;var _=e.substring(v,m).trim();n+=" "+_+";"}}v=m+1,u=-1}}}}return r&&(n+=ol(r)),i&&(n+=ol(i,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function rt(e,t,n,r,i,a){var l=e.__className;if(gt||l!==n||l===void 0){var c=Pd(n,r,a);(!gt||c!==e.getAttribute("class"))&&(c==null?e.removeAttribute("class"):t?e.className=c:e.setAttribute("class",c)),e.__className=n}else if(a&&i!==a)for(var d in a){var v=!!a[d];(i==null||v!==!!i[d])&&e.classList.toggle(d,v)}return a}function aa(e,t={},n,r){for(var i in n){var a=n[i];t[i]!==a&&(n[i]==null?e.style.removeProperty(i):e.style.setProperty(i,a,r))}}function Wn(e,t,n,r){var i=e.__style;if(gt||i!==t){var a=Td(t,r);(!gt||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}else r&&(Array.isArray(r)?(aa(e,n==null?void 0:n[0],r[0]),aa(e,n==null?void 0:n[1],r[1],"important")):aa(e,n,r));return r}const Wr=Symbol("class"),Hr=Symbol("style"),Pu=Symbol("is custom element"),Tu=Symbol("is html");function jd(e){if(gt){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var r=e.value;Ne(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var i=e.checked;Ne(e,"checked",null),e.checked=i}}};e.__on_r=n,sd(n),dd()}}function Dd(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function Ne(e,t,n,r){var i=ju(e);gt&&(i[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||i[t]!==(i[t]=n)&&(t==="loading"&&(e[ud]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Du(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function ka(e,t,n,r,i=!1){var a=ju(e),l=a[Pu],c=!a[Tu];let d=gt&&l;d&&ei(!1);var v=t||{},u=e.tagName==="OPTION";for(var m in t)m in n||(n[m]=null);n.class?n.class=Cd(n.class):(r||n[Wr])&&(n.class=null),n[Hr]&&(n.style??(n.style=null));var h=Du(e);for(const x in n){let C=n[x];if(u&&x==="value"&&C==null){e.value=e.__value="",v[x]=C;continue}if(x==="class"){var g=e.namespaceURI==="http://www.w3.org/1999/xhtml";rt(e,g,C,r,t==null?void 0:t[Wr],n[Wr]),v[x]=C,v[Wr]=n[Wr];continue}if(x==="style"){Wn(e,C,t==null?void 0:t[Hr],n[Hr]),v[x]=C,v[Hr]=n[Hr];continue}var _=v[x];if(C!==_){v[x]=C;var k=x[0]+x[1];if(k!=="$$")if(k==="on"){const q={},L="$$"+x;let V=x.slice(2);var O=md(V);if(vd(V)&&(V=V.slice(0,-7),q.capture=!0),!O&&_){if(C!=null)continue;e.removeEventListener(V,v[L],q),v[L]=null}if(C!=null)if(O)e[`__${V}`]=C,it([V]);else{let te=function(J){v[x].call(this,J)};v[L]=hd(V,e,te,q)}else O&&(e[`__${V}`]=void 0)}else if(x==="style")Ne(e,x,C);else if(x==="autofocus")pd(e,!!C);else if(!l&&(x==="__value"||x==="value"&&C!=null))e.value=e.__value=C;else if(x==="selected"&&u)Dd(e,C);else{var A=x;c||(A=yd(A));var I=A==="defaultValue"||A==="defaultChecked";if(C==null&&!l&&!I)if(a[x]=null,A==="value"||A==="checked"){let q=e;const L=t===void 0;if(A==="value"){let V=q.defaultValue;q.removeAttribute(A),q.defaultValue=V,q.value=q.__value=L?V:null}else{let V=q.defaultChecked;q.removeAttribute(A),q.defaultChecked=V,q.checked=L?V:!1}}else e.removeAttribute(x);else I||h.includes(A)&&(l||typeof C!="string")?e[A]=C:typeof C!="function"&&Ne(e,A,C)}}}d&&ei(!0);for(let x of Object.getOwnPropertySymbols(n))x.description===ld&&Od(e,()=>n[x]);return v}function ju(e){return e.__attributes??(e.__attributes={[Pu]:e.nodeName.includes("-"),[Tu]:e.namespaceURI===od})}var al=new Map;function Du(e){var t=al.get(e.nodeName);if(t)return t;al.set(e.nodeName,t=[]);for(var n,r=e,i=Element.prototype;i!==r;){n=ad(r);for(var a in n)n[a].set&&t.push(a);r=mu(r)}return t}function Ru(e,t,n=t){var r=cd();gd(e,"input",i=>{var a=i?e.defaultValue:e.value;if(a=sa(e)?la(a):a,n(a),r&&a!==(a=t())){var l=e.selectionStart,c=e.selectionEnd;e.value=a??"",c!==null&&(e.selectionStart=l,e.selectionEnd=Math.min(c,e.value.length))}}),(gt&&e.defaultValue!==e.value||Iu(t)==null&&e.value)&&n(sa(e)?la(e.value):e.value),gu(()=>{var i=t();sa(e)&&i===la(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function sa(e){var t=e.type;return t==="number"||t==="range"}function la(e){return e===""?null:+e}var Cn,hr,ci,vo,Nu;const ho=class ho{constructor(t){Vr(this,vo);Vr(this,Cn,new WeakMap);Vr(this,hr);Vr(this,ci);ra(this,ci,t)}observe(t,n){var r=dn(this,Cn).get(t)||new Set;return r.add(n),dn(this,Cn).set(t,r),Zs(this,vo,Nu).call(this).observe(t,dn(this,ci)),()=>{var i=dn(this,Cn).get(t);i.delete(n),i.size===0&&(dn(this,Cn).delete(t),dn(this,hr).unobserve(t))}}};Cn=new WeakMap,hr=new WeakMap,ci=new WeakMap,vo=new WeakSet,Nu=function(){return dn(this,hr)??ra(this,hr,new ResizeObserver(t=>{for(var n of t){ho.entries.set(n.target,n);for(var r of dn(this,Cn).get(n.target)||[])r(n)}}))},Qs(ho,"entries",new WeakMap);let xa=ho;var Rd=new xa({box:"border-box"});function Nd(e,t,n){var r=Rd.observe(e,()=>n(e[t]));Su(()=>(Iu(()=>n(e[t])),r))}var Ld=ue('<!> <h3 class="svelte-z90h8u"> </h3> <!>',1),Md=ue('<p class="svelte-z90h8u"> </p>'),qd=ue('<div class="svelte-z90h8u"><div class="svelte-z90h8u"><!></div> <div class="svelte-z90h8u"><!></div></div> <h3 class="svelte-z90h8u"> </h3> <!>',1),Fd=ue("<header><!></header>");function Xa(e,t){var n=Fd();let r;var i=P(n);{var a=c=>{var d=Ld(),v=Ae(d);pn(v,()=>t.left??xr);var u=W(v,2),m=P(u,!0);E(u);var h=W(u,2);pn(h,()=>t.right),_e(()=>Oe(m,t.label)),Q(c,d)},l=c=>{var d=qd(),v=Ae(d),u=P(v),m=P(u);pn(m,()=>t.left),E(u);var h=W(u,2),g=P(h);pn(g,()=>t.right),E(h),E(v);var _=W(v,2),k=P(_,!0);E(_);var O=W(_,2);{var A=I=>{var x=Md(),C=P(x,!0);E(x),_e(()=>Oe(C,t.subtitle)),Q(I,x)};he(O,I=>{t.subtitle&&I(A)})}_e(()=>Oe(k,t.label)),Q(c,d)};he(i,c=>{t.variation==="sm"?c(a):c(l,!1)})}E(n),_e(c=>r=rt(n,1,"svelte-z90h8u",null,r,c),[()=>({small:t.variation==="sm"})]),Q(e,n)}var Ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Yi={exports:{}},Kd=Yi.exports,sl;function zd(){return sl||(sl=1,function(e,t){(function(n,r){e.exports=r()})(Kd,function(){var n=function(o,s){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var b in p)Object.prototype.hasOwnProperty.call(p,b)&&(f[b]=p[b])})(o,s)},r=function(){return(r=Object.assign||function(o){for(var s,f=1,p=arguments.length;f<p;f++)for(var b in s=arguments[f])Object.prototype.hasOwnProperty.call(s,b)&&(o[b]=s[b]);return o}).apply(this,arguments)};function i(o,s,f){for(var p,b=0,w=s.length;b<w;b++)!p&&b in s||((p=p||Array.prototype.slice.call(s,0,b))[b]=s[b]);return o.concat(p||Array.prototype.slice.call(s))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ud,l=Object.keys,c=Array.isArray;function d(o,s){return typeof s!="object"||l(s).forEach(function(f){o[f]=s[f]}),o}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var v=Object.getPrototypeOf,u={}.hasOwnProperty;function m(o,s){return u.call(o,s)}function h(o,s){typeof s=="function"&&(s=s(v(o))),(typeof Reflect>"u"?l:Reflect.ownKeys)(s).forEach(function(f){_(o,f,s[f])})}var g=Object.defineProperty;function _(o,s,f,p){g(o,s,d(f&&m(f,"get")&&typeof f.get=="function"?{get:f.get,set:f.set,configurable:!0}:{value:f,configurable:!0,writable:!0},p))}function k(o){return{from:function(s){return o.prototype=Object.create(s.prototype),_(o.prototype,"constructor",o),{extend:h.bind(null,o.prototype)}}}}var O=Object.getOwnPropertyDescriptor,A=[].slice;function I(o,s,f){return A.call(o,s,f)}function x(o,s){return s(o)}function C(o){if(!o)throw new Error("Assertion Failed")}function q(o){a.setImmediate?setImmediate(o):setTimeout(o,0)}function L(o,s){if(typeof s=="string"&&m(o,s))return o[s];if(!s)return o;if(typeof s!="string"){for(var f=[],p=0,b=s.length;p<b;++p){var w=L(o,s[p]);f.push(w)}return f}var S=s.indexOf(".");if(S!==-1){var T=o[s.substr(0,S)];return T==null?void 0:L(T,s.substr(S+1))}}function V(o,s,f){if(o&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof s!="string"&&"length"in s){C(typeof f!="string"&&"length"in f);for(var p=0,b=s.length;p<b;++p)V(o,s[p],f[p])}else{var w,S,T=s.indexOf(".");T!==-1?(w=s.substr(0,T),(S=s.substr(T+1))===""?f===void 0?c(o)&&!isNaN(parseInt(w))?o.splice(w,1):delete o[w]:o[w]=f:V(T=!(T=o[w])||!m(o,w)?o[w]={}:T,S,f)):f===void 0?c(o)&&!isNaN(parseInt(s))?o.splice(s,1):delete o[s]:o[s]=f}}function te(o){var s,f={};for(s in o)m(o,s)&&(f[s]=o[s]);return f}var J=[].concat;function G(o){return J.apply([],o)}var zt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(G([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(s){return s+o+"Array"})}))).filter(function(o){return a[o]}),ne=new Set(zt.map(function(o){return a[o]})),$=null;function H(o){return $=new WeakMap,o=function s(f){if(!f||typeof f!="object")return f;var p=$.get(f);if(p)return p;if(c(f)){p=[],$.set(f,p);for(var b=0,w=f.length;b<w;++b)p.push(s(f[b]))}else if(ne.has(f.constructor))p=f;else{var S,T=v(f);for(S in p=T===Object.prototype?{}:Object.create(T),$.set(f,p),f)m(f,S)&&(p[S]=s(f[S]))}return p}(o),$=null,o}var ee={}.toString;function ie(o){return ee.call(o).slice(8,-1)}var oe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Re=typeof oe=="symbol"?function(o){var s;return o!=null&&(s=o[oe])&&s.apply(o)}:function(){return null};function je(o,s){return s=o.indexOf(s),0<=s&&o.splice(s,1),0<=s}var le={};function B(o){var s,f,p,b;if(arguments.length===1){if(c(o))return o.slice();if(this===le&&typeof o=="string")return[o];if(b=Re(o)){for(f=[];!(p=b.next()).done;)f.push(p.value);return f}if(o==null)return[o];if(typeof(s=o.length)!="number")return[o];for(f=new Array(s);s--;)f[s]=o[s];return f}for(s=arguments.length,f=new Array(s);s--;)f[s]=arguments[s];return f}var Le=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Lt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Bt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Lt),Fe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ke(o,s){this.name=o,this.message=s}function Xe(o,s){return o+". Errors: "+Object.keys(s).map(function(f){return s[f].toString()}).filter(function(f,p,b){return b.indexOf(f)===p}).join(`
`)}function de(o,s,f,p){this.failures=s,this.failedKeys=p,this.successCount=f,this.message=Xe(o,s)}function we(o,s){this.name="BulkError",this.failures=Object.keys(s).map(function(f){return s[f]}),this.failuresByPos=s,this.message=Xe(o,this.failures)}k(Ke).from(Error).extend({toString:function(){return this.name+": "+this.message}}),k(de).from(Ke),k(we).from(Ke);var qe=Bt.reduce(function(o,s){return o[s]=s+"Error",o},{}),ot=Ke,me=Bt.reduce(function(o,s){var f=s+"Error";function p(b,w){this.name=f,b?typeof b=="string"?(this.message="".concat(b).concat(w?`
 `+w:""),this.inner=w||null):typeof b=="object"&&(this.message="".concat(b.name," ").concat(b.message),this.inner=b):(this.message=Fe[s]||f,this.inner=null)}return k(p).from(ot),o[s]=p,o},{});me.Syntax=SyntaxError,me.Type=TypeError,me.Range=RangeError;var ke=Lt.reduce(function(o,s){return o[s+"Error"]=me[s],o},{}),Pe=Bt.reduce(function(o,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(o[s+"Error"]=me[s]),o},{});function Se(){}function Me(o){return o}function Te(o,s){return o==null||o===Me?s:function(f){return s(o(f))}}function lt(o,s){return function(){o.apply(this,arguments),s.apply(this,arguments)}}function _t(o,s){return o===Se?s:function(){var f=o.apply(this,arguments);f!==void 0&&(arguments[0]=f);var p=this.onsuccess,b=this.onerror;this.onsuccess=null,this.onerror=null;var w=s.apply(this,arguments);return p&&(this.onsuccess=this.onsuccess?lt(p,this.onsuccess):p),b&&(this.onerror=this.onerror?lt(b,this.onerror):b),w!==void 0?w:f}}function Ct(o,s){return o===Se?s:function(){o.apply(this,arguments);var f=this.onsuccess,p=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),f&&(this.onsuccess=this.onsuccess?lt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?lt(p,this.onerror):p)}}function Dn(o,s){return o===Se?s:function(f){var p=o.apply(this,arguments);d(f,p);var b=this.onsuccess,w=this.onerror;return this.onsuccess=null,this.onerror=null,f=s.apply(this,arguments),b&&(this.onsuccess=this.onsuccess?lt(b,this.onsuccess):b),w&&(this.onerror=this.onerror?lt(w,this.onerror):w),p===void 0?f===void 0?void 0:f:d(p,f)}}function Ar(o,s){return o===Se?s:function(){return s.apply(this,arguments)!==!1&&o.apply(this,arguments)}}function Cr(o,s){return o===Se?s:function(){var f=o.apply(this,arguments);if(f&&typeof f.then=="function"){for(var p=this,b=arguments.length,w=new Array(b);b--;)w[b]=arguments[b];return f.then(function(){return s.apply(p,w)})}return s.apply(this,arguments)}}Pe.ModifyError=de,Pe.DexieError=Ke,Pe.BulkError=we;var bt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Jn(o){bt=o}var ln={},pi=100,zt=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,v(o),o];var s=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[s,v(s),o]}(),Lt=zt[0],Bt=zt[1],zt=zt[2],Bt=Bt&&Bt.then,Vt=Lt&&Lt.constructor,Pr=!!zt,Mt=function(o,s){Ft.push([o,s]),wn&&(queueMicrotask(Eo),wn=!1)},Rn=!0,wn=!0,un=[],Wt=[],Nn=Me,qt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Se,pgp:!1,env:{},finalize:Se},Ie=qt,Ft=[],Ht=0,Qn=[];function be(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Ie;if(typeof o!="function"){if(o!==ln)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Tr(this,this._value))}this._state=null,this._value=null,++s.ref,function f(p,b){try{b(function(w){if(p._state===null){if(w===p)throw new TypeError("A promise cannot be resolved with itself.");var S=p._lib&&kn();w&&typeof w.then=="function"?f(p,function(T,D){w instanceof be?w._then(T,D):w.then(T,D)}):(p._state=!0,p._value=w,yi(p)),S&&Pt()}},Tr.bind(null,p))}catch(w){Tr(p,w)}}(this,o)}var Zt={get:function(){var o=Ie,s=Yt;function f(p,b){var w=this,S=!o.global&&(o!==Ie||s!==Yt),T=S&&!Et(),D=new be(function(N,U){Xt(w,new Zn(ws(p,o,S,T),ws(b,o,S,T),N,U,o))});return this._consoleTask&&(D._consoleTask=this._consoleTask),D}return f.prototype=ln,f},set:function(o){_(this,"then",o&&o.prototype===ln?Zt:{get:function(){return o},set:Zt.set})}};function Zn(o,s,f,p,b){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof s=="function"?s:null,this.resolve=f,this.reject=p,this.psd=b}function Tr(o,s){var f,p;Wt.push(s),o._state===null&&(f=o._lib&&kn(),s=Nn(s),o._state=!1,o._value=s,p=o,un.some(function(b){return b._value===p._value})||un.push(p),yi(o),f&&Pt())}function yi(o){var s=o._listeners;o._listeners=[];for(var f=0,p=s.length;f<p;++f)Xt(o,s[f]);var b=o._PSD;--b.ref||b.finalize(),Ht===0&&(++Ht,Mt(function(){--Ht==0&&Ln()},[]))}function Xt(o,s){if(o._state!==null){var f=o._state?s.onFulfilled:s.onRejected;if(f===null)return(o._state?s.resolve:s.reject)(o._value);++s.psd.ref,++Ht,Mt(jr,[f,o,s])}else o._listeners.push(s)}function jr(o,s,f){try{var p,b=s._value;!s._state&&Wt.length&&(Wt=[]),p=bt&&s._consoleTask?s._consoleTask.run(function(){return o(b)}):o(b),s._state||Wt.indexOf(b)!==-1||function(w){for(var S=un.length;S;)if(un[--S]._value===w._value)return un.splice(S,1)}(s),f.resolve(p)}catch(w){f.reject(w)}finally{--Ht==0&&Ln(),--f.psd.ref||f.psd.finalize()}}function Eo(){Mn(qt,function(){kn()&&Pt()})}function kn(){var o=Rn;return wn=Rn=!1,o}function Pt(){var o,s,f;do for(;0<Ft.length;)for(o=Ft,Ft=[],f=o.length,s=0;s<f;++s){var p=o[s];p[0].apply(null,p[1])}while(0<Ft.length);wn=Rn=!0}function Ln(){var o=un;un=[],o.forEach(function(p){p._PSD.onunhandled.call(null,p._value,p)});for(var s=Qn.slice(0),f=s.length;f;)s[--f]()}function Xn(o){return new be(ln,!1,o)}function et(o,s){var f=Ie;return function(){var p=kn(),b=Ie;try{return Ut(f,!0),o.apply(this,arguments)}catch(w){s&&s(w)}finally{Ut(b,!1),p&&Pt()}}}h(be.prototype,{then:Zt,_then:function(o,s){Xt(this,new Zn(null,null,o,s,Ie))},catch:function(o){if(arguments.length===1)return this.then(null,o);var s=o,f=arguments[1];return typeof s=="function"?this.then(null,function(p){return(p instanceof s?f:Xn)(p)}):this.then(null,function(p){return(p&&p.name===s?f:Xn)(p)})},finally:function(o){return this.then(function(s){return be.resolve(o()).then(function(){return s})},function(s){return be.resolve(o()).then(function(){return Xn(s)})})},timeout:function(o,s){var f=this;return o<1/0?new be(function(p,b){var w=setTimeout(function(){return b(new me.Timeout(s))},o);f.then(p,b).finally(clearTimeout.bind(null,w))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&_(be.prototype,Symbol.toStringTag,"Dexie.Promise"),qt.env=mi(),h(be,{all:function(){var o=B.apply(null,arguments).map(Sn);return new be(function(s,f){o.length===0&&s([]);var p=o.length;o.forEach(function(b,w){return be.resolve(b).then(function(S){o[w]=S,--p||s(o)},f)})})},resolve:function(o){return o instanceof be?o:o&&typeof o.then=="function"?new be(function(s,f){o.then(s,f)}):new be(ln,!0,o)},reject:Xn,race:function(){var o=B.apply(null,arguments).map(Sn);return new be(function(s,f){o.map(function(p){return be.resolve(p).then(s,f)})})},PSD:{get:function(){return Ie},set:function(o){return Ie=o}},totalEchoes:{get:function(){return Yt}},newPSD:$t,usePSD:Mn,scheduler:{get:function(){return Mt},set:function(o){Mt=o}},rejectionMapper:{get:function(){return Nn},set:function(o){Nn=o}},follow:function(o,s){return new be(function(f,p){return $t(function(b,w){var S=Ie;S.unhandleds=[],S.onunhandled=w,S.finalize=lt(function(){var T,D=this;T=function(){D.unhandleds.length===0?b():w(D.unhandleds[0])},Qn.push(function N(){T(),Qn.splice(Qn.indexOf(N),1)}),++Ht,Mt(function(){--Ht==0&&Ln()},[])},S.finalize),o()},s,f,p)})}}),Vt&&(Vt.allSettled&&_(be,"allSettled",function(){var o=B.apply(null,arguments).map(Sn);return new be(function(s){o.length===0&&s([]);var f=o.length,p=new Array(f);o.forEach(function(b,w){return be.resolve(b).then(function(S){return p[w]={status:"fulfilled",value:S}},function(S){return p[w]={status:"rejected",reason:S}}).then(function(){return--f||s(p)})})})}),Vt.any&&typeof AggregateError<"u"&&_(be,"any",function(){var o=B.apply(null,arguments).map(Sn);return new be(function(s,f){o.length===0&&f(new AggregateError([]));var p=o.length,b=new Array(p);o.forEach(function(w,S){return be.resolve(w).then(function(T){return s(T)},function(T){b[S]=T,--p||f(new AggregateError(b))})})})}),Vt.withResolvers&&(be.withResolvers=Vt.withResolvers));var tt={awaits:0,echoes:0,id:0},Dr=0,$n=[],er=0,Yt=0,Rr=0;function $t(o,s,f,p){var b=Ie,w=Object.create(b);return w.parent=b,w.ref=0,w.global=!1,w.id=++Rr,qt.env,w.env=Pr?{Promise:be,PromiseProp:{value:be,configurable:!0,writable:!0},all:be.all,race:be.race,allSettled:be.allSettled,any:be.any,resolve:be.resolve,reject:be.reject}:{},s&&d(w,s),++b.ref,w.finalize=function(){--this.parent.ref||this.parent.finalize()},p=Mn(w,o,f,p),w.ref===0&&w.finalize(),p}function xn(){return tt.id||(tt.id=++Dr),++tt.awaits,tt.echoes+=pi,tt.id}function Et(){return!!tt.awaits&&(--tt.awaits==0&&(tt.id=0),tt.echoes=tt.awaits*pi,!0)}function Sn(o){return tt.echoes&&o&&o.constructor===Vt?(xn(),o.then(function(s){return Et(),s},function(s){return Et(),ut(s)})):o}function Oo(){var o=$n[$n.length-1];$n.pop(),Ut(o,!1)}function Ut(o,s){var f,p=Ie;(s?!tt.echoes||er++&&o===Ie:!er||--er&&o===Ie)||queueMicrotask(s?(function(b){++Yt,tt.echoes&&--tt.echoes!=0||(tt.echoes=tt.awaits=tt.id=0),$n.push(Ie),Ut(b,!0)}).bind(null,o):Oo),o!==Ie&&(Ie=o,p===qt&&(qt.env=mi()),Pr&&(f=qt.env.Promise,s=o.env,(p.global||o.global)&&(Object.defineProperty(a,"Promise",s.PromiseProp),f.all=s.all,f.race=s.race,f.resolve=s.resolve,f.reject=s.reject,s.allSettled&&(f.allSettled=s.allSettled),s.any&&(f.any=s.any))))}function mi(){var o=a.Promise;return Pr?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function Mn(o,s,f,p,b){var w=Ie;try{return Ut(o,!0),s(f,p,b)}finally{Ut(w,!1)}}function ws(o,s,f,p){return typeof o!="function"?o:function(){var b=Ie;f&&xn(),Ut(s,!0);try{return o.apply(this,arguments)}finally{Ut(b,!1),p&&queueMicrotask(Et)}}}function Ao(o){Promise===Vt&&tt.echoes===0?er===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}(""+Bt).indexOf("[native code]")===-1&&(xn=Et=Se);var ut=be.reject,qn="ï¿¿",cn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ks="String expected.",tr=[],gi="__dbnames",Co="readonly",Po="readwrite";function Fn(o,s){return o?s?function(){return o.apply(this,arguments)&&s.apply(this,arguments)}:o:s}var xs={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function bi(o){return typeof o!="string"||/\./.test(o)?function(s){return s}:function(s){return s[o]===void 0&&o in s&&delete(s=H(s))[o],s}}function Ss(){throw me.Type()}function Ye(o,s){try{var f=Is(o),p=Is(s);if(f!==p)return f==="Array"?1:p==="Array"?-1:f==="binary"?1:p==="binary"?-1:f==="string"?1:p==="string"?-1:f==="Date"?1:p!=="Date"?NaN:-1;switch(f){case"number":case"Date":case"string":return s<o?1:o<s?-1:0;case"binary":return function(b,w){for(var S=b.length,T=w.length,D=S<T?S:T,N=0;N<D;++N)if(b[N]!==w[N])return b[N]<w[N]?-1:1;return S===T?0:S<T?-1:1}(Es(o),Es(s));case"Array":return function(b,w){for(var S=b.length,T=w.length,D=S<T?S:T,N=0;N<D;++N){var U=Ye(b[N],w[N]);if(U!==0)return U}return S===T?0:S<T?-1:1}(o,s)}}catch{}return NaN}function Is(o){var s=typeof o;return s!="object"?s:ArrayBuffer.isView(o)?"binary":(o=ie(o),o==="ArrayBuffer"?"binary":o)}function Es(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var Os=(nt.prototype._trans=function(o,s,f){var p=this._tx||Ie.trans,b=this.name,w=bt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(o==="readonly"?"read":"write"," ").concat(this.name));function S(N,U,j){if(!j.schema[b])throw new me.NotFound("Table "+b+" not part of transaction");return s(j.idbtrans,j)}var T=kn();try{var D=p&&p.db._novip===this.db._novip?p===Ie.trans?p._promise(o,S,f):$t(function(){return p._promise(o,S,f)},{trans:p,transless:Ie.transless||Ie}):function N(U,j,z,R){if(U.idbdb&&(U._state.openComplete||Ie.letThrough||U._vip)){var F=U._createTransaction(j,z,U._dbSchema);try{F.create(),U._state.PR1398_maxLoop=3}catch(K){return K.name===qe.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return N(U,j,z,R)})):ut(K)}return F._promise(j,function(K,M){return $t(function(){return Ie.trans=F,R(K,M,F)})}).then(function(K){if(j==="readwrite")try{F.idbtrans.commit()}catch{}return j==="readonly"?K:F._completion.then(function(){return K})})}if(U._state.openComplete)return ut(new me.DatabaseClosed(U._state.dbOpenError));if(!U._state.isBeingOpened){if(!U._state.autoOpen)return ut(new me.DatabaseClosed);U.open().catch(Se)}return U._state.dbReadyPromise.then(function(){return N(U,j,z,R)})}(this.db,o,[this.name],S);return w&&(D._consoleTask=w,D=D.catch(function(N){return console.trace(N),ut(N)})),D}finally{T&&Pt()}},nt.prototype.get=function(o,s){var f=this;return o&&o.constructor===Object?this.where(o).first(s):o==null?ut(new me.Type("Invalid argument to Table.get()")):this._trans("readonly",function(p){return f.core.get({trans:p,key:o}).then(function(b){return f.hook.reading.fire(b)})}).then(s)},nt.prototype.where=function(o){if(typeof o=="string")return new this.db.WhereClause(this,o);if(c(o))return new this.db.WhereClause(this,"[".concat(o.join("+"),"]"));var s=l(o);if(s.length===1)return this.where(s[0]).equals(o[s[0]]);var f=this.schema.indexes.concat(this.schema.primKey).filter(function(T){if(T.compound&&s.every(function(N){return 0<=T.keyPath.indexOf(N)})){for(var D=0;D<s.length;++D)if(s.indexOf(T.keyPath[D])===-1)return!1;return!0}return!1}).sort(function(T,D){return T.keyPath.length-D.keyPath.length})[0];if(f&&this.db._maxKey!==qn){var w=f.keyPath.slice(0,s.length);return this.where(w).equals(w.map(function(D){return o[D]}))}!f&&bt&&console.warn("The query ".concat(JSON.stringify(o)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var p=this.schema.idxByName;function b(T,D){return Ye(T,D)===0}var S=s.reduce(function(j,D){var N=j[0],U=j[1],j=p[D],z=o[D];return[N||j,N||!j?Fn(U,j&&j.multi?function(R){return R=L(R,D),c(R)&&R.some(function(F){return b(z,F)})}:function(R){return b(z,L(R,D))}):U]},[null,null]),w=S[0],S=S[1];return w?this.where(w.name).equals(o[w.keyPath]).filter(S):f?this.filter(S):this.where(s).equals("")},nt.prototype.filter=function(o){return this.toCollection().and(o)},nt.prototype.count=function(o){return this.toCollection().count(o)},nt.prototype.offset=function(o){return this.toCollection().offset(o)},nt.prototype.limit=function(o){return this.toCollection().limit(o)},nt.prototype.each=function(o){return this.toCollection().each(o)},nt.prototype.toArray=function(o){return this.toCollection().toArray(o)},nt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},nt.prototype.orderBy=function(o){return new this.db.Collection(new this.db.WhereClause(this,c(o)?"[".concat(o.join("+"),"]"):o))},nt.prototype.reverse=function(){return this.toCollection().reverse()},nt.prototype.mapToClass=function(o){var s,f=this.db,p=this.name;function b(){return s!==null&&s.apply(this,arguments)||this}(this.schema.mappedClass=o).prototype instanceof Ss&&(function(D,N){if(typeof N!="function"&&N!==null)throw new TypeError("Class extends value "+String(N)+" is not a constructor or null");function U(){this.constructor=D}n(D,N),D.prototype=N===null?Object.create(N):(U.prototype=N.prototype,new U)}(b,s=o),Object.defineProperty(b.prototype,"db",{get:function(){return f},enumerable:!1,configurable:!0}),b.prototype.table=function(){return p},o=b);for(var w=new Set,S=o.prototype;S;S=v(S))Object.getOwnPropertyNames(S).forEach(function(D){return w.add(D)});function T(D){if(!D)return D;var N,U=Object.create(o.prototype);for(N in D)if(!w.has(N))try{U[N]=D[N]}catch{}return U}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=T,this.hook("reading",T),o},nt.prototype.defineClass=function(){return this.mapToClass(function(o){d(this,o)})},nt.prototype.add=function(o,s){var f=this,p=this.schema.primKey,b=p.auto,w=p.keyPath,S=o;return w&&b&&(S=bi(w)(o)),this._trans("readwrite",function(T){return f.core.mutate({trans:T,type:"add",keys:s!=null?[s]:null,values:[S]})}).then(function(T){return T.numFailures?be.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{V(o,w,T)}catch{}return T})},nt.prototype.update=function(o,s){return typeof o!="object"||c(o)?this.where(":id").equals(o).modify(s):(o=L(o,this.schema.primKey.keyPath),o===void 0?ut(new me.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(s))},nt.prototype.put=function(o,s){var f=this,p=this.schema.primKey,b=p.auto,w=p.keyPath,S=o;return w&&b&&(S=bi(w)(o)),this._trans("readwrite",function(T){return f.core.mutate({trans:T,type:"put",values:[S],keys:s!=null?[s]:null})}).then(function(T){return T.numFailures?be.reject(T.failures[0]):T.lastResult}).then(function(T){if(w)try{V(o,w,T)}catch{}return T})},nt.prototype.delete=function(o){var s=this;return this._trans("readwrite",function(f){return s.core.mutate({trans:f,type:"delete",keys:[o]})}).then(function(f){return f.numFailures?be.reject(f.failures[0]):void 0})},nt.prototype.clear=function(){var o=this;return this._trans("readwrite",function(s){return o.core.mutate({trans:s,type:"deleteRange",range:xs})}).then(function(s){return s.numFailures?be.reject(s.failures[0]):void 0})},nt.prototype.bulkGet=function(o){var s=this;return this._trans("readonly",function(f){return s.core.getMany({keys:o,trans:f}).then(function(p){return p.map(function(b){return s.hook.reading.fire(b)})})})},nt.prototype.bulkAdd=function(o,s,f){var p=this,b=Array.isArray(s)?s:void 0,w=(f=f||(b?void 0:s))?f.allKeys:void 0;return this._trans("readwrite",function(S){var N=p.schema.primKey,T=N.auto,N=N.keyPath;if(N&&b)throw new me.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(b&&b.length!==o.length)throw new me.InvalidArgument("Arguments objects and keys must have the same length");var D=o.length,N=N&&T?o.map(bi(N)):o;return p.core.mutate({trans:S,type:"add",keys:b,values:N,wantResults:w}).then(function(F){var j=F.numFailures,z=F.results,R=F.lastResult,F=F.failures;if(j===0)return w?z:R;throw new we("".concat(p.name,".bulkAdd(): ").concat(j," of ").concat(D," operations failed"),F)})})},nt.prototype.bulkPut=function(o,s,f){var p=this,b=Array.isArray(s)?s:void 0,w=(f=f||(b?void 0:s))?f.allKeys:void 0;return this._trans("readwrite",function(S){var N=p.schema.primKey,T=N.auto,N=N.keyPath;if(N&&b)throw new me.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(b&&b.length!==o.length)throw new me.InvalidArgument("Arguments objects and keys must have the same length");var D=o.length,N=N&&T?o.map(bi(N)):o;return p.core.mutate({trans:S,type:"put",keys:b,values:N,wantResults:w}).then(function(F){var j=F.numFailures,z=F.results,R=F.lastResult,F=F.failures;if(j===0)return w?z:R;throw new we("".concat(p.name,".bulkPut(): ").concat(j," of ").concat(D," operations failed"),F)})})},nt.prototype.bulkUpdate=function(o){var s=this,f=this.core,p=o.map(function(S){return S.key}),b=o.map(function(S){return S.changes}),w=[];return this._trans("readwrite",function(S){return f.getMany({trans:S,keys:p,cache:"clone"}).then(function(T){var D=[],N=[];o.forEach(function(j,z){var R=j.key,F=j.changes,K=T[z];if(K){for(var M=0,Y=Object.keys(F);M<Y.length;M++){var Z=Y[M],X=F[Z];if(Z===s.schema.primKey.keyPath){if(Ye(X,R)!==0)throw new me.Constraint("Cannot update primary key in bulkUpdate()")}else V(K,Z,X)}w.push(z),D.push(R),N.push(K)}});var U=D.length;return f.mutate({trans:S,type:"put",keys:D,values:N,updates:{keys:p,changeSpecs:b}}).then(function(j){var z=j.numFailures,R=j.failures;if(z===0)return U;for(var F=0,K=Object.keys(R);F<K.length;F++){var M,Y=K[F],Z=w[Number(Y)];Z!=null&&(M=R[Y],delete R[Y],R[Z]=M)}throw new we("".concat(s.name,".bulkUpdate(): ").concat(z," of ").concat(U," operations failed"),R)})})})},nt.prototype.bulkDelete=function(o){var s=this,f=o.length;return this._trans("readwrite",function(p){return s.core.mutate({trans:p,type:"delete",keys:o})}).then(function(S){var b=S.numFailures,w=S.lastResult,S=S.failures;if(b===0)return w;throw new we("".concat(s.name,".bulkDelete(): ").concat(b," of ").concat(f," operations failed"),S)})},nt);function nt(){}function Nr(o){function s(S,T){if(T){for(var D=arguments.length,N=new Array(D-1);--D;)N[D-1]=arguments[D];return f[S].subscribe.apply(null,N),o}if(typeof S=="string")return f[S]}var f={};s.addEventType=w;for(var p=1,b=arguments.length;p<b;++p)w(arguments[p]);return s;function w(S,T,D){if(typeof S!="object"){var N;T=T||Ar;var U={subscribers:[],fire:D=D||Se,subscribe:function(j){U.subscribers.indexOf(j)===-1&&(U.subscribers.push(j),U.fire=T(U.fire,j))},unsubscribe:function(j){U.subscribers=U.subscribers.filter(function(z){return z!==j}),U.fire=U.subscribers.reduce(T,D)}};return f[S]=s[S]=U}l(N=S).forEach(function(j){var z=N[j];if(c(z))w(j,N[j][0],N[j][1]);else{if(z!=="asap")throw new me.InvalidArgument("Invalid event config");var R=w(j,Me,function(){for(var F=arguments.length,K=new Array(F);F--;)K[F]=arguments[F];R.subscribers.forEach(function(M){q(function(){M.apply(null,K)})})})}})}}function Lr(o,s){return k(s).from({prototype:o}),s}function nr(o,s){return!(o.filter||o.algorithm||o.or)&&(s?o.justLimit:!o.replayFilter)}function To(o,s){o.filter=Fn(o.filter,s)}function jo(o,s,f){var p=o.replayFilter;o.replayFilter=p?function(){return Fn(p(),s())}:s,o.justLimit=f&&!p}function _i(o,s){if(o.isPrimKey)return s.primaryKey;var f=s.getIndexByKeyPath(o.index);if(!f)throw new me.Schema("KeyPath "+o.index+" on object store "+s.name+" is not indexed");return f}function As(o,s,f){var p=_i(o,s.schema);return s.openCursor({trans:f,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:p,range:o.range}})}function wi(o,s,f,p){var b=o.replayFilter?Fn(o.filter,o.replayFilter()):o.filter;if(o.or){var w={},S=function(T,D,N){var U,j;b&&!b(D,N,function(z){return D.stop(z)},function(z){return D.fail(z)})||((j=""+(U=D.primaryKey))=="[object ArrayBuffer]"&&(j=""+new Uint8Array(U)),m(w,j)||(w[j]=!0,s(T,D,N)))};return Promise.all([o.or._iterate(S,f),Cs(As(o,p,f),o.algorithm,S,!o.keysOnly&&o.valueMapper)])}return Cs(As(o,p,f),Fn(o.algorithm,b),s,!o.keysOnly&&o.valueMapper)}function Cs(o,s,f,p){var b=et(p?function(w,S,T){return f(p(w),S,T)}:f);return o.then(function(w){if(w)return w.start(function(){var S=function(){return w.continue()};s&&!s(w,function(T){return S=T},function(T){w.stop(T),S=Se},function(T){w.fail(T),S=Se})||b(w.value,w,function(T){return S=T}),S()})})}var Mr=(Ps.prototype.execute=function(o){var s=this["@@propmod"];if(s.add!==void 0){var f=s.add;if(c(f))return i(i([],c(o)?o:[],!0),f).sort();if(typeof f=="number")return(Number(o)||0)+f;if(typeof f=="bigint")try{return BigInt(o)+f}catch{return BigInt(0)+f}throw new TypeError("Invalid term ".concat(f))}if(s.remove!==void 0){var p=s.remove;if(c(p))return c(o)?o.filter(function(b){return!p.includes(b)}).sort():[];if(typeof p=="number")return Number(o)-p;if(typeof p=="bigint")try{return BigInt(o)-p}catch{return BigInt(0)-p}throw new TypeError("Invalid subtrahend ".concat(p))}return f=(f=s.replacePrefix)===null||f===void 0?void 0:f[0],f&&typeof o=="string"&&o.startsWith(f)?s.replacePrefix[1]+o.substring(f.length):o},Ps);function Ps(o){this["@@propmod"]=o}var mf=(Je.prototype._read=function(o,s){var f=this._ctx;return f.error?f.table._trans(null,ut.bind(null,f.error)):f.table._trans("readonly",o).then(s)},Je.prototype._write=function(o){var s=this._ctx;return s.error?s.table._trans(null,ut.bind(null,s.error)):s.table._trans("readwrite",o,"locked")},Je.prototype._addAlgorithm=function(o){var s=this._ctx;s.algorithm=Fn(s.algorithm,o)},Je.prototype._iterate=function(o,s){return wi(this._ctx,o,s,this._ctx.table.core)},Je.prototype.clone=function(o){var s=Object.create(this.constructor.prototype),f=Object.create(this._ctx);return o&&d(f,o),s._ctx=f,s},Je.prototype.raw=function(){return this._ctx.valueMapper=null,this},Je.prototype.each=function(o){var s=this._ctx;return this._read(function(f){return wi(s,o,f,s.table.core)})},Je.prototype.count=function(o){var s=this;return this._read(function(f){var p=s._ctx,b=p.table.core;if(nr(p,!0))return b.count({trans:f,query:{index:_i(p,b.schema),range:p.range}}).then(function(S){return Math.min(S,p.limit)});var w=0;return wi(p,function(){return++w,!1},f,b).then(function(){return w})}).then(o)},Je.prototype.sortBy=function(o,s){var f=o.split(".").reverse(),p=f[0],b=f.length-1;function w(D,N){return N?w(D[f[N]],N-1):D[p]}var S=this._ctx.dir==="next"?1:-1;function T(D,N){return Ye(w(D,b),w(N,b))*S}return this.toArray(function(D){return D.sort(T)}).then(s)},Je.prototype.toArray=function(o){var s=this;return this._read(function(f){var p=s._ctx;if(p.dir==="next"&&nr(p,!0)&&0<p.limit){var b=p.valueMapper,w=_i(p,p.table.core.schema);return p.table.core.query({trans:f,limit:p.limit,values:!0,query:{index:w,range:p.range}}).then(function(T){return T=T.result,b?T.map(b):T})}var S=[];return wi(p,function(T){return S.push(T)},f,p.table.core).then(function(){return S})},o)},Je.prototype.offset=function(o){var s=this._ctx;return o<=0||(s.offset+=o,nr(s)?jo(s,function(){var f=o;return function(p,b){return f===0||(f===1?--f:b(function(){p.advance(f),f=0}),!1)}}):jo(s,function(){var f=o;return function(){return--f<0}})),this},Je.prototype.limit=function(o){return this._ctx.limit=Math.min(this._ctx.limit,o),jo(this._ctx,function(){var s=o;return function(f,p,b){return--s<=0&&p(b),0<=s}},!0),this},Je.prototype.until=function(o,s){return To(this._ctx,function(f,p,b){return!o(f.value)||(p(b),s)}),this},Je.prototype.first=function(o){return this.limit(1).toArray(function(s){return s[0]}).then(o)},Je.prototype.last=function(o){return this.reverse().first(o)},Je.prototype.filter=function(o){var s;return To(this._ctx,function(f){return o(f.value)}),(s=this._ctx).isMatch=Fn(s.isMatch,o),this},Je.prototype.and=function(o){return this.filter(o)},Je.prototype.or=function(o){return new this.db.WhereClause(this._ctx.table,o,this)},Je.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Je.prototype.desc=function(){return this.reverse()},Je.prototype.eachKey=function(o){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(f,p){o(p.key,p)})},Je.prototype.eachUniqueKey=function(o){return this._ctx.unique="unique",this.eachKey(o)},Je.prototype.eachPrimaryKey=function(o){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(f,p){o(p.primaryKey,p)})},Je.prototype.keys=function(o){var s=this._ctx;s.keysOnly=!s.isMatch;var f=[];return this.each(function(p,b){f.push(b.key)}).then(function(){return f}).then(o)},Je.prototype.primaryKeys=function(o){var s=this._ctx;if(s.dir==="next"&&nr(s,!0)&&0<s.limit)return this._read(function(p){var b=_i(s,s.table.core.schema);return s.table.core.query({trans:p,values:!1,limit:s.limit,query:{index:b,range:s.range}})}).then(function(p){return p.result}).then(o);s.keysOnly=!s.isMatch;var f=[];return this.each(function(p,b){f.push(b.primaryKey)}).then(function(){return f}).then(o)},Je.prototype.uniqueKeys=function(o){return this._ctx.unique="unique",this.keys(o)},Je.prototype.firstKey=function(o){return this.limit(1).keys(function(s){return s[0]}).then(o)},Je.prototype.lastKey=function(o){return this.reverse().firstKey(o)},Je.prototype.distinct=function(){var o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];if(!o||!o.multi)return this;var s={};return To(this._ctx,function(b){var p=b.primaryKey.toString(),b=m(s,p);return s[p]=!0,!b}),this},Je.prototype.modify=function(o){var s=this,f=this._ctx;return this._write(function(p){var b,w,S;S=typeof o=="function"?o:(b=l(o),w=b.length,function(M){for(var Y=!1,Z=0;Z<w;++Z){var X=b[Z],re=o[X],ae=L(M,X);re instanceof Mr?(V(M,X,re.execute(ae)),Y=!0):ae!==re&&(V(M,X,re),Y=!0)}return Y});var T=f.table.core,j=T.schema.primaryKey,D=j.outbound,N=j.extractKey,U=200,j=s.db._options.modifyChunkSize;j&&(U=typeof j=="object"?j[T.name]||j["*"]||200:j);function z(M,X){var Z=X.failures,X=X.numFailures;F+=M-X;for(var re=0,ae=l(Z);re<ae.length;re++){var pe=ae[re];R.push(Z[pe])}}var R=[],F=0,K=[];return s.clone().primaryKeys().then(function(M){function Y(X){var re=Math.min(U,M.length-X);return T.getMany({trans:p,keys:M.slice(X,X+re),cache:"immutable"}).then(function(ae){for(var pe=[],se=[],ce=D?[]:null,ye=[],ve=0;ve<re;++ve){var xe=ae[ve],Be={value:H(xe),primKey:M[X+ve]};S.call(Be,Be.value,Be)!==!1&&(Be.value==null?ye.push(M[X+ve]):D||Ye(N(xe),N(Be.value))===0?(se.push(Be.value),D&&ce.push(M[X+ve])):(ye.push(M[X+ve]),pe.push(Be.value)))}return Promise.resolve(0<pe.length&&T.mutate({trans:p,type:"add",values:pe}).then(function(Ve){for(var We in Ve.failures)ye.splice(parseInt(We),1);z(pe.length,Ve)})).then(function(){return(0<se.length||Z&&typeof o=="object")&&T.mutate({trans:p,type:"put",keys:ce,values:se,criteria:Z,changeSpec:typeof o!="function"&&o,isAdditionalChunk:0<X}).then(function(Ve){return z(se.length,Ve)})}).then(function(){return(0<ye.length||Z&&o===Do)&&T.mutate({trans:p,type:"delete",keys:ye,criteria:Z,isAdditionalChunk:0<X}).then(function(Ve){return z(ye.length,Ve)})}).then(function(){return M.length>X+re&&Y(X+U)})})}var Z=nr(f)&&f.limit===1/0&&(typeof o!="function"||o===Do)&&{index:f.index,range:f.range};return Y(0).then(function(){if(0<R.length)throw new de("Error modifying one or more objects",R,F,K);return M.length})})})},Je.prototype.delete=function(){var o=this._ctx,s=o.range;return nr(o)&&(o.isPrimKey||s.type===3)?this._write(function(f){var p=o.table.core.schema.primaryKey,b=s;return o.table.core.count({trans:f,query:{index:p,range:b}}).then(function(w){return o.table.core.mutate({trans:f,type:"deleteRange",range:b}).then(function(S){var T=S.failures;if(S.lastResult,S.results,S=S.numFailures,S)throw new de("Could not delete some values",Object.keys(T).map(function(D){return T[D]}),w-S);return w-S})})}):this.modify(Do)},Je);function Je(){}var Do=function(o,s){return s.value=null};function gf(o,s){return o<s?-1:o===s?0:1}function bf(o,s){return s<o?-1:o===s?0:1}function Tt(o,s,f){return o=o instanceof js?new o.Collection(o):o,o._ctx.error=new(f||TypeError)(s),o}function rr(o){return new o.Collection(o,function(){return Ts("")}).limit(0)}function ki(o,s,f,p){var b,w,S,T,D,N,U,j=f.length;if(!f.every(function(F){return typeof F=="string"}))return Tt(o,ks);function z(F){b=F==="next"?function(M){return M.toUpperCase()}:function(M){return M.toLowerCase()},w=F==="next"?function(M){return M.toLowerCase()}:function(M){return M.toUpperCase()},S=F==="next"?gf:bf;var K=f.map(function(M){return{lower:w(M),upper:b(M)}}).sort(function(M,Y){return S(M.lower,Y.lower)});T=K.map(function(M){return M.upper}),D=K.map(function(M){return M.lower}),U=(N=F)==="next"?"":p}z("next"),o=new o.Collection(o,function(){return In(T[0],D[j-1]+p)}),o._ondirectionchange=function(F){z(F)};var R=0;return o._addAlgorithm(function(F,K,M){var Y=F.key;if(typeof Y!="string")return!1;var Z=w(Y);if(s(Z,D,R))return!0;for(var X=null,re=R;re<j;++re){var ae=function(pe,se,ce,ye,ve,xe){for(var Be=Math.min(pe.length,ye.length),Ve=-1,We=0;We<Be;++We){var jt=se[We];if(jt!==ye[We])return ve(pe[We],ce[We])<0?pe.substr(0,We)+ce[We]+ce.substr(We+1):ve(pe[We],ye[We])<0?pe.substr(0,We)+ye[We]+ce.substr(We+1):0<=Ve?pe.substr(0,Ve)+se[Ve]+ce.substr(Ve+1):null;ve(pe[We],jt)<0&&(Ve=We)}return Be<ye.length&&xe==="next"?pe+ce.substr(pe.length):Be<pe.length&&xe==="prev"?pe.substr(0,ce.length):Ve<0?null:pe.substr(0,Ve)+ye[Ve]+ce.substr(Ve+1)}(Y,Z,T[re],D[re],S,N);ae===null&&X===null?R=re+1:(X===null||0<S(X,ae))&&(X=ae)}return K(X!==null?function(){F.continue(X+U)}:M),!1}),o}function In(o,s,f,p){return{type:2,lower:o,upper:s,lowerOpen:f,upperOpen:p}}function Ts(o){return{type:1,lower:o,upper:o}}var js=(Object.defineProperty(mt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),mt.prototype.between=function(o,s,f,p){f=f!==!1,p=p===!0;try{return 0<this._cmp(o,s)||this._cmp(o,s)===0&&(f||p)&&(!f||!p)?rr(this):new this.Collection(this,function(){return In(o,s,!f,!p)})}catch{return Tt(this,cn)}},mt.prototype.equals=function(o){return o==null?Tt(this,cn):new this.Collection(this,function(){return Ts(o)})},mt.prototype.above=function(o){return o==null?Tt(this,cn):new this.Collection(this,function(){return In(o,void 0,!0)})},mt.prototype.aboveOrEqual=function(o){return o==null?Tt(this,cn):new this.Collection(this,function(){return In(o,void 0,!1)})},mt.prototype.below=function(o){return o==null?Tt(this,cn):new this.Collection(this,function(){return In(void 0,o,!1,!0)})},mt.prototype.belowOrEqual=function(o){return o==null?Tt(this,cn):new this.Collection(this,function(){return In(void 0,o)})},mt.prototype.startsWith=function(o){return typeof o!="string"?Tt(this,ks):this.between(o,o+qn,!0,!0)},mt.prototype.startsWithIgnoreCase=function(o){return o===""?this.startsWith(o):ki(this,function(s,f){return s.indexOf(f[0])===0},[o],qn)},mt.prototype.equalsIgnoreCase=function(o){return ki(this,function(s,f){return s===f[0]},[o],"")},mt.prototype.anyOfIgnoreCase=function(){var o=B.apply(le,arguments);return o.length===0?rr(this):ki(this,function(s,f){return f.indexOf(s)!==-1},o,"")},mt.prototype.startsWithAnyOfIgnoreCase=function(){var o=B.apply(le,arguments);return o.length===0?rr(this):ki(this,function(s,f){return f.some(function(p){return s.indexOf(p)===0})},o,qn)},mt.prototype.anyOf=function(){var o=this,s=B.apply(le,arguments),f=this._cmp;try{s.sort(f)}catch{return Tt(this,cn)}if(s.length===0)return rr(this);var p=new this.Collection(this,function(){return In(s[0],s[s.length-1])});p._ondirectionchange=function(w){f=w==="next"?o._ascending:o._descending,s.sort(f)};var b=0;return p._addAlgorithm(function(w,S,T){for(var D=w.key;0<f(D,s[b]);)if(++b===s.length)return S(T),!1;return f(D,s[b])===0||(S(function(){w.continue(s[b])}),!1)}),p},mt.prototype.notEqual=function(o){return this.inAnyRange([[-1/0,o],[o,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},mt.prototype.noneOf=function(){var o=B.apply(le,arguments);if(o.length===0)return new this.Collection(this);try{o.sort(this._ascending)}catch{return Tt(this,cn)}var s=o.reduce(function(f,p){return f?f.concat([[f[f.length-1][1],p]]):[[-1/0,p]]},null);return s.push([o[o.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},mt.prototype.inAnyRange=function(Y,s){var f=this,p=this._cmp,b=this._ascending,w=this._descending,S=this._min,T=this._max;if(Y.length===0)return rr(this);if(!Y.every(function(Z){return Z[0]!==void 0&&Z[1]!==void 0&&b(Z[0],Z[1])<=0}))return Tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",me.InvalidArgument);var D=!s||s.includeLowers!==!1,N=s&&s.includeUppers===!0,U,j=b;function z(Z,X){return j(Z[0],X[0])}try{(U=Y.reduce(function(Z,X){for(var re=0,ae=Z.length;re<ae;++re){var pe=Z[re];if(p(X[0],pe[1])<0&&0<p(X[1],pe[0])){pe[0]=S(pe[0],X[0]),pe[1]=T(pe[1],X[1]);break}}return re===ae&&Z.push(X),Z},[])).sort(z)}catch{return Tt(this,cn)}var R=0,F=N?function(Z){return 0<b(Z,U[R][1])}:function(Z){return 0<=b(Z,U[R][1])},K=D?function(Z){return 0<w(Z,U[R][0])}:function(Z){return 0<=w(Z,U[R][0])},M=F,Y=new this.Collection(this,function(){return In(U[0][0],U[U.length-1][1],!D,!N)});return Y._ondirectionchange=function(Z){j=Z==="next"?(M=F,b):(M=K,w),U.sort(z)},Y._addAlgorithm(function(Z,X,re){for(var ae,pe=Z.key;M(pe);)if(++R===U.length)return X(re),!1;return!F(ae=pe)&&!K(ae)||(f._cmp(pe,U[R][1])===0||f._cmp(pe,U[R][0])===0||X(function(){j===b?Z.continue(U[R][0]):Z.continue(U[R][1])}),!1)}),Y},mt.prototype.startsWithAnyOf=function(){var o=B.apply(le,arguments);return o.every(function(s){return typeof s=="string"})?o.length===0?rr(this):this.inAnyRange(o.map(function(s){return[s,s+qn]})):Tt(this,"startsWithAnyOf() only works with strings")},mt);function mt(){}function en(o){return et(function(s){return qr(s),o(s.target.error),!1})}function qr(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var Fr="storagemutated",Ro="x-storagemutated-1",En=Nr(null,Fr),_f=(tn.prototype._lock=function(){return C(!Ie.global),++this._reculock,this._reculock!==1||Ie.global||(Ie.lockOwnerFor=this),this},tn.prototype._unlock=function(){if(C(!Ie.global),--this._reculock==0)for(Ie.global||(Ie.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var o=this._blockedFuncs.shift();try{Mn(o[1],o[0])}catch{}}return this},tn.prototype._locked=function(){return this._reculock&&Ie.lockOwnerFor!==this},tn.prototype.create=function(o){var s=this;if(!this.mode)return this;var f=this.db.idbdb,p=this.db._state.dbOpenError;if(C(!this.idbtrans),!o&&!f)switch(p&&p.name){case"DatabaseClosedError":throw new me.DatabaseClosed(p);case"MissingAPIError":throw new me.MissingAPI(p.message,p);default:throw new me.OpenFailed(p)}if(!this.active)throw new me.TransactionInactive;return C(this._completion._state===null),(o=this.idbtrans=o||(this.db.core||f).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=et(function(b){qr(b),s._reject(o.error)}),o.onabort=et(function(b){qr(b),s.active&&s._reject(new me.Abort(o.error)),s.active=!1,s.on("abort").fire(b)}),o.oncomplete=et(function(){s.active=!1,s._resolve(),"mutatedParts"in o&&En.storagemutated.fire(o.mutatedParts)}),this},tn.prototype._promise=function(o,s,f){var p=this;if(o==="readwrite"&&this.mode!=="readwrite")return ut(new me.ReadOnly("Transaction is readonly"));if(!this.active)return ut(new me.TransactionInactive);if(this._locked())return new be(function(w,S){p._blockedFuncs.push([function(){p._promise(o,s,f).then(w,S)},Ie])});if(f)return $t(function(){var w=new be(function(S,T){p._lock();var D=s(S,T,p);D&&D.then&&D.then(S,T)});return w.finally(function(){return p._unlock()}),w._lib=!0,w});var b=new be(function(w,S){var T=s(w,S,p);T&&T.then&&T.then(w,S)});return b._lib=!0,b},tn.prototype._root=function(){return this.parent?this.parent._root():this},tn.prototype.waitFor=function(o){var s,f=this._root(),p=be.resolve(o);f._waitingFor?f._waitingFor=f._waitingFor.then(function(){return p}):(f._waitingFor=p,f._waitingQueue=[],s=f.idbtrans.objectStore(f.storeNames[0]),function w(){for(++f._spinCount;f._waitingQueue.length;)f._waitingQueue.shift()();f._waitingFor&&(s.get(-1/0).onsuccess=w)}());var b=f._waitingFor;return new be(function(w,S){p.then(function(T){return f._waitingQueue.push(et(w.bind(null,T)))},function(T){return f._waitingQueue.push(et(S.bind(null,T)))}).finally(function(){f._waitingFor===b&&(f._waitingFor=null)})})},tn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new me.Abort))},tn.prototype.table=function(o){var s=this._memoizedTables||(this._memoizedTables={});if(m(s,o))return s[o];var f=this.schema[o];if(!f)throw new me.NotFound("Table "+o+" not part of transaction");return f=new this.db.Table(o,f,this),f.core=this.db.core.table(o),s[o]=f},tn);function tn(){}function No(o,s,f,p,b,w,S){return{name:o,keyPath:s,unique:f,multi:p,auto:b,compound:w,src:(f&&!S?"&":"")+(p?"*":"")+(b?"++":"")+Ds(s)}}function Ds(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Lo(o,s,f){return{name:o,primKey:s,indexes:f,mappedClass:null,idxByName:(p=function(b){return[b.name,b]},f.reduce(function(b,w,S){return S=p(w,S),S&&(b[S[0]]=S[1]),b},{}))};var p}var Ur=function(o){try{return o.only([[]]),Ur=function(){return[[]]},[[]]}catch{return Ur=function(){return qn},qn}};function Mo(o){return o==null?function(){}:typeof o=="string"?(s=o).split(".").length===1?function(f){return f[s]}:function(f){return L(f,s)}:function(f){return L(f,o)};var s}function Rs(o){return[].slice.call(o)}var wf=0;function Br(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function kf(o,s,D){function p(M){if(M.type===3)return null;if(M.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var R=M.lower,F=M.upper,K=M.lowerOpen,M=M.upperOpen;return R===void 0?F===void 0?null:s.upperBound(F,!!M):F===void 0?s.lowerBound(R,!!K):s.bound(R,F,!!K,!!M)}function b(z){var R,F=z.name;return{name:F,schema:z,mutate:function(K){var M=K.trans,Y=K.type,Z=K.keys,X=K.values,re=K.range;return new Promise(function(ae,pe){ae=et(ae);var se=M.objectStore(F),ce=se.keyPath==null,ye=Y==="put"||Y==="add";if(!ye&&Y!=="delete"&&Y!=="deleteRange")throw new Error("Invalid operation type: "+Y);var ve,xe=(Z||X||{length:1}).length;if(Z&&X&&Z.length!==X.length)throw new Error("Given keys array must have same length as given values array.");if(xe===0)return ae({numFailures:0,failures:{},results:[],lastResult:void 0});function Be(Ot){++jt,qr(Ot)}var Ve=[],We=[],jt=0;if(Y==="deleteRange"){if(re.type===4)return ae({numFailures:jt,failures:We,results:[],lastResult:void 0});re.type===3?Ve.push(ve=se.clear()):Ve.push(ve=se.delete(p(re)))}else{var ce=ye?ce?[X,Z]:[X,null]:[Z,null],Ue=ce[0],kt=ce[1];if(ye)for(var xt=0;xt<xe;++xt)Ve.push(ve=kt&&kt[xt]!==void 0?se[Y](Ue[xt],kt[xt]):se[Y](Ue[xt])),ve.onerror=Be;else for(xt=0;xt<xe;++xt)Ve.push(ve=se[Y](Ue[xt])),ve.onerror=Be}function Ni(Ot){Ot=Ot.target.result,Ve.forEach(function(Kn,ta){return Kn.error!=null&&(We[ta]=Kn.error)}),ae({numFailures:jt,failures:We,results:Y==="delete"?Z:Ve.map(function(Kn){return Kn.result}),lastResult:Ot})}ve.onerror=function(Ot){Be(Ot),Ni(Ot)},ve.onsuccess=Ni})},getMany:function(K){var M=K.trans,Y=K.keys;return new Promise(function(Z,X){Z=et(Z);for(var re,ae=M.objectStore(F),pe=Y.length,se=new Array(pe),ce=0,ye=0,ve=function(Ve){Ve=Ve.target,se[Ve._pos]=Ve.result,++ye===ce&&Z(se)},xe=en(X),Be=0;Be<pe;++Be)Y[Be]!=null&&((re=ae.get(Y[Be]))._pos=Be,re.onsuccess=ve,re.onerror=xe,++ce);ce===0&&Z(se)})},get:function(K){var M=K.trans,Y=K.key;return new Promise(function(Z,X){Z=et(Z);var re=M.objectStore(F).get(Y);re.onsuccess=function(ae){return Z(ae.target.result)},re.onerror=en(X)})},query:(R=N,function(K){return new Promise(function(M,Y){M=et(M);var Z,X,re,ce=K.trans,ae=K.values,pe=K.limit,ve=K.query,se=pe===1/0?void 0:pe,ye=ve.index,ve=ve.range,ce=ce.objectStore(F),ye=ye.isPrimaryKey?ce:ce.index(ye.name),ve=p(ve);if(pe===0)return M({result:[]});R?((se=ae?ye.getAll(ve,se):ye.getAllKeys(ve,se)).onsuccess=function(xe){return M({result:xe.target.result})},se.onerror=en(Y)):(Z=0,X=!ae&&"openKeyCursor"in ye?ye.openKeyCursor(ve):ye.openCursor(ve),re=[],X.onsuccess=function(xe){var Be=X.result;return Be?(re.push(ae?Be.value:Be.primaryKey),++Z===pe?M({result:re}):void Be.continue()):M({result:re})},X.onerror=en(Y))})}),openCursor:function(K){var M=K.trans,Y=K.values,Z=K.query,X=K.reverse,re=K.unique;return new Promise(function(ae,pe){ae=et(ae);var ye=Z.index,se=Z.range,ce=M.objectStore(F),ce=ye.isPrimaryKey?ce:ce.index(ye.name),ye=X?re?"prevunique":"prev":re?"nextunique":"next",ve=!Y&&"openKeyCursor"in ce?ce.openKeyCursor(p(se),ye):ce.openCursor(p(se),ye);ve.onerror=en(pe),ve.onsuccess=et(function(xe){var Be,Ve,We,jt,Ue=ve.result;Ue?(Ue.___id=++wf,Ue.done=!1,Be=Ue.continue.bind(Ue),Ve=(Ve=Ue.continuePrimaryKey)&&Ve.bind(Ue),We=Ue.advance.bind(Ue),jt=function(){throw new Error("Cursor not stopped")},Ue.trans=M,Ue.stop=Ue.continue=Ue.continuePrimaryKey=Ue.advance=function(){throw new Error("Cursor not started")},Ue.fail=et(pe),Ue.next=function(){var kt=this,xt=1;return this.start(function(){return xt--?kt.continue():kt.stop()}).then(function(){return kt})},Ue.start=function(kt){function xt(){if(ve.result)try{kt()}catch(Ot){Ue.fail(Ot)}else Ue.done=!0,Ue.start=function(){throw new Error("Cursor behind last entry")},Ue.stop()}var Ni=new Promise(function(Ot,Kn){Ot=et(Ot),ve.onerror=en(Kn),Ue.fail=Kn,Ue.stop=function(ta){Ue.stop=Ue.continue=Ue.continuePrimaryKey=Ue.advance=jt,Ot(ta)}});return ve.onsuccess=et(function(Ot){ve.onsuccess=xt,xt()}),Ue.continue=Be,Ue.continuePrimaryKey=Ve,Ue.advance=We,xt(),Ni},ae(Ue)):ae(null)},pe)})},count:function(K){var M=K.query,Y=K.trans,Z=M.index,X=M.range;return new Promise(function(re,ae){var pe=Y.objectStore(F),se=Z.isPrimaryKey?pe:pe.index(Z.name),pe=p(X),se=pe?se.count(pe):se.count();se.onsuccess=et(function(ce){return re(ce.target.result)}),se.onerror=en(ae)})}}}var w,S,T,U=(S=D,T=Rs((w=o).objectStoreNames),{schema:{name:w.name,tables:T.map(function(z){return S.objectStore(z)}).map(function(z){var R=z.keyPath,M=z.autoIncrement,F=c(R),K={},M={name:z.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:R==null,compound:F,keyPath:R,autoIncrement:M,unique:!0,extractKey:Mo(R)},indexes:Rs(z.indexNames).map(function(Y){return z.index(Y)}).map(function(re){var Z=re.name,X=re.unique,ae=re.multiEntry,re=re.keyPath,ae={name:Z,compound:c(re),keyPath:re,unique:X,multiEntry:ae,extractKey:Mo(re)};return K[Br(re)]=ae}),getIndexByKeyPath:function(Y){return K[Br(Y)]}};return K[":id"]=M.primaryKey,R!=null&&(K[Br(R)]=M.primaryKey),M})},hasGetAll:0<T.length&&"getAll"in S.objectStore(T[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),D=U.schema,N=U.hasGetAll,U=D.tables.map(b),j={};return U.forEach(function(z){return j[z.name]=z}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function(z){if(!j[z])throw new Error("Table '".concat(z,"' not found"));return j[z]},MIN_KEY:-1/0,MAX_KEY:Ur(s),schema:D}}function xf(o,s,f,p){var b=f.IDBKeyRange;return f.indexedDB,{dbcore:(p=kf(s,b,p),o.dbcore.reduce(function(w,S){return S=S.create,r(r({},w),S(w))},p))}}function xi(o,p){var f=p.db,p=xf(o._middlewares,f,o._deps,p);o.core=p.dbcore,o.tables.forEach(function(b){var w=b.name;o.core.schema.tables.some(function(S){return S.name===w})&&(b.core=o.core.table(w),o[w]instanceof o.Table&&(o[w].core=b.core))})}function Si(o,s,f,p){f.forEach(function(b){var w=p[b];s.forEach(function(S){var T=function D(N,U){return O(N,U)||(N=v(N))&&D(N,U)}(S,b);(!T||"value"in T&&T.value===void 0)&&(S===o.Transaction.prototype||S instanceof o.Transaction?_(S,b,{get:function(){return this.table(b)},set:function(D){g(this,b,{value:D,writable:!0,configurable:!0,enumerable:!0})}}):S[b]=new o.Table(b,w))})})}function qo(o,s){s.forEach(function(f){for(var p in f)f[p]instanceof o.Table&&delete f[p]})}function Sf(o,s){return o._cfg.version-s._cfg.version}function If(o,s,f,p){var b=o._dbSchema;f.objectStoreNames.contains("$meta")&&!b.$meta&&(b.$meta=Lo("$meta",Ls("")[0],[]),o._storeNames.push("$meta"));var w=o._createTransaction("readwrite",o._storeNames,b);w.create(f),w._completion.catch(p);var S=w._reject.bind(w),T=Ie.transless||Ie;$t(function(){return Ie.trans=w,Ie.transless=T,s!==0?(xi(o,f),N=s,((D=w).storeNames.includes("$meta")?D.table("$meta").get("version").then(function(U){return U??N}):be.resolve(N)).then(function(U){return z=U,R=w,F=f,K=[],U=(j=o)._versions,M=j._dbSchema=Ei(0,j.idbdb,F),(U=U.filter(function(Y){return Y._cfg.version>=z})).length!==0?(U.forEach(function(Y){K.push(function(){var Z=M,X=Y._cfg.dbschema;Oi(j,Z,F),Oi(j,X,F),M=j._dbSchema=X;var re=Fo(Z,X);re.add.forEach(function(ye){Uo(F,ye[0],ye[1].primKey,ye[1].indexes)}),re.change.forEach(function(ye){if(ye.recreate)throw new me.Upgrade("Not yet support for changing primary key");var ve=F.objectStore(ye.name);ye.add.forEach(function(xe){return Ii(ve,xe)}),ye.change.forEach(function(xe){ve.deleteIndex(xe.name),Ii(ve,xe)}),ye.del.forEach(function(xe){return ve.deleteIndex(xe)})});var ae=Y._cfg.contentUpgrade;if(ae&&Y._cfg.version>z){xi(j,F),R._memoizedTables={};var pe=te(X);re.del.forEach(function(ye){pe[ye]=Z[ye]}),qo(j,[j.Transaction.prototype]),Si(j,[j.Transaction.prototype],l(pe),pe),R.schema=pe;var se,ce=Le(ae);return ce&&xn(),re=be.follow(function(){var ye;(se=ae(R))&&ce&&(ye=Et.bind(null,null),se.then(ye,ye))}),se&&typeof se.then=="function"?be.resolve(se):re.then(function(){return se})}}),K.push(function(Z){var X,re,ae=Y._cfg.dbschema;X=ae,re=Z,[].slice.call(re.db.objectStoreNames).forEach(function(pe){return X[pe]==null&&re.db.deleteObjectStore(pe)}),qo(j,[j.Transaction.prototype]),Si(j,[j.Transaction.prototype],j._storeNames,j._dbSchema),R.schema=j._dbSchema}),K.push(function(Z){j.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(j.idbdb.version/10)===Y._cfg.version?(j.idbdb.deleteObjectStore("$meta"),delete j._dbSchema.$meta,j._storeNames=j._storeNames.filter(function(X){return X!=="$meta"})):Z.objectStore("$meta").put(Y._cfg.version,"version"))})}),function Y(){return K.length?be.resolve(K.shift()(R.idbtrans)).then(Y):be.resolve()}().then(function(){Ns(M,F)})):be.resolve();var j,z,R,F,K,M}).catch(S)):(l(b).forEach(function(U){Uo(f,U,b[U].primKey,b[U].indexes)}),xi(o,f),void be.follow(function(){return o.on.populate.fire(w)}).catch(S));var D,N})}function Ef(o,s){Ns(o._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var f=Ei(0,o.idbdb,s);Oi(o,o._dbSchema,s);for(var p=0,b=Fo(f,o._dbSchema).change;p<b.length;p++){var w=function(S){if(S.change.length||S.recreate)return console.warn("Unable to patch indexes of table ".concat(S.name," because it has changes on the type of index or primary key.")),{value:void 0};var T=s.objectStore(S.name);S.add.forEach(function(D){bt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(S.name,".").concat(D.src)),Ii(T,D)})}(b[p]);if(typeof w=="object")return w.value}}function Fo(o,s){var f,p={del:[],add:[],change:[]};for(f in o)s[f]||p.del.push(f);for(f in s){var b=o[f],w=s[f];if(b){var S={name:f,def:w,recreate:!1,del:[],add:[],change:[]};if(""+(b.primKey.keyPath||"")!=""+(w.primKey.keyPath||"")||b.primKey.auto!==w.primKey.auto)S.recreate=!0,p.change.push(S);else{var T=b.idxByName,D=w.idxByName,N=void 0;for(N in T)D[N]||S.del.push(N);for(N in D){var U=T[N],j=D[N];U?U.src!==j.src&&S.change.push(j):S.add.push(j)}(0<S.del.length||0<S.add.length||0<S.change.length)&&p.change.push(S)}}else p.add.push([f,w])}return p}function Uo(o,s,f,p){var b=o.db.createObjectStore(s,f.keyPath?{keyPath:f.keyPath,autoIncrement:f.auto}:{autoIncrement:f.auto});return p.forEach(function(w){return Ii(b,w)}),b}function Ns(o,s){l(o).forEach(function(f){s.db.objectStoreNames.contains(f)||(bt&&console.debug("Dexie: Creating missing table",f),Uo(s,f,o[f].primKey,o[f].indexes))})}function Ii(o,s){o.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Ei(o,s,f){var p={};return I(s.objectStoreNames,0).forEach(function(b){for(var w=f.objectStore(b),S=No(Ds(N=w.keyPath),N||"",!0,!1,!!w.autoIncrement,N&&typeof N!="string",!0),T=[],D=0;D<w.indexNames.length;++D){var U=w.index(w.indexNames[D]),N=U.keyPath,U=No(U.name,N,!!U.unique,!!U.multiEntry,!1,N&&typeof N!="string",!1);T.push(U)}p[b]=Lo(b,S,T)}),p}function Oi(o,s,f){for(var p=f.db.objectStoreNames,b=0;b<p.length;++b){var w=p[b],S=f.objectStore(w);o._hasGetAll="getAll"in S;for(var T=0;T<S.indexNames.length;++T){var D=S.indexNames[T],N=S.index(D).keyPath,U=typeof N=="string"?N:"["+I(N).join("+")+"]";!s[w]||(N=s[w].idxByName[U])&&(N.name=D,delete s[w].idxByName[U],s[w].idxByName[D]=N)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function Ls(o){return o.split(",").map(function(s,f){var p=(s=s.trim()).replace(/([&*]|\+\+)/g,""),b=/^\[/.test(p)?p.match(/^\[(.*)\]$/)[1].split("+"):p;return No(p,b||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),c(b),f===0)})}var Of=(Ai.prototype._parseStoresSpec=function(o,s){l(o).forEach(function(f){if(o[f]!==null){var p=Ls(o[f]),b=p.shift();if(b.unique=!0,b.multi)throw new me.Schema("Primary key cannot be multi-valued");p.forEach(function(w){if(w.auto)throw new me.Schema("Only primary key can be marked as autoIncrement (++)");if(!w.keyPath)throw new me.Schema("Index must have a name and cannot be an empty string")}),s[f]=Lo(f,b,p)}})},Ai.prototype.stores=function(f){var s=this.db;this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,f):f;var f=s._versions,p={},b={};return f.forEach(function(w){d(p,w._cfg.storesSource),b=w._cfg.dbschema={},w._parseStoresSpec(p,b)}),s._dbSchema=b,qo(s,[s._allTables,s,s.Transaction.prototype]),Si(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],l(b),b),s._storeNames=l(b),this},Ai.prototype.upgrade=function(o){return this._cfg.contentUpgrade=Cr(this._cfg.contentUpgrade||Se,o),this},Ai);function Ai(){}function Bo(o,s){var f=o._dbNamesDB;return f||(f=o._dbNamesDB=new fn(gi,{addons:[],indexedDB:o,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),f.table("dbnames")}function Ko(o){return o&&typeof o.databases=="function"}function zo(o){return $t(function(){return Ie.letThrough=!0,o()})}function Vo(o){return!("from"in o)}var wt=function(o,s){if(!this){var f=new wt;return o&&"d"in o&&d(f,o),f}d(this,arguments.length?{d:1,from:o,to:1<arguments.length?s:o}:{d:0})};function Kr(o,s,f){var p=Ye(s,f);if(!isNaN(p)){if(0<p)throw RangeError();if(Vo(o))return d(o,{from:s,to:f,d:1});var b=o.l,p=o.r;if(Ye(f,o.from)<0)return b?Kr(b,s,f):o.l={from:s,to:f,d:1,l:null,r:null},qs(o);if(0<Ye(s,o.to))return p?Kr(p,s,f):o.r={from:s,to:f,d:1,l:null,r:null},qs(o);Ye(s,o.from)<0&&(o.from=s,o.l=null,o.d=p?p.d+1:1),0<Ye(f,o.to)&&(o.to=f,o.r=null,o.d=o.l?o.l.d+1:1),f=!o.r,b&&!o.l&&zr(o,b),p&&f&&zr(o,p)}}function zr(o,s){Vo(s)||function f(p,D){var w=D.from,S=D.to,T=D.l,D=D.r;Kr(p,w,S),T&&f(p,T),D&&f(p,D)}(o,s)}function Ms(o,s){var f=Ci(s),p=f.next();if(p.done)return!1;for(var b=p.value,w=Ci(o),S=w.next(b.from),T=S.value;!p.done&&!S.done;){if(Ye(T.from,b.to)<=0&&0<=Ye(T.to,b.from))return!0;Ye(b.from,T.from)<0?b=(p=f.next(T.from)).value:T=(S=w.next(b.from)).value}return!1}function Ci(o){var s=Vo(o)?null:{s:0,n:o};return{next:function(f){for(var p=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,p)for(;s.n.l&&Ye(f,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!p||Ye(f,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function qs(o){var s,f,p=(((s=o.r)===null||s===void 0?void 0:s.d)||0)-(((f=o.l)===null||f===void 0?void 0:f.d)||0),b=1<p?"r":p<-1?"l":"";b&&(s=b=="r"?"l":"r",f=r({},o),p=o[b],o.from=p.from,o.to=p.to,o[b]=p[b],f[b]=p[s],(o[s]=f).d=Fs(f)),o.d=Fs(o)}function Fs(f){var s=f.r,f=f.l;return(s?f?Math.max(s.d,f.d):s.d:f?f.d:0)+1}function Pi(o,s){return l(s).forEach(function(f){o[f]?zr(o[f],s[f]):o[f]=function p(b){var w,S,T={};for(w in b)m(b,w)&&(S=b[w],T[w]=!S||typeof S!="object"||ne.has(S.constructor)?S:p(S));return T}(s[f])}),o}function Wo(o,s){return o.all||s.all||Object.keys(o).some(function(f){return s[f]&&Ms(s[f],o[f])})}h(wt.prototype,((Bt={add:function(o){return zr(this,o),this},addKey:function(o){return Kr(this,o,o),this},addKeys:function(o){var s=this;return o.forEach(function(f){return Kr(s,f,f)}),this},hasKey:function(o){var s=Ci(this).next(o).value;return s&&Ye(s.from,o)<=0&&0<=Ye(s.to,o)}})[oe]=function(){return Ci(this)},Bt));var Un={},Ho={},Yo=!1;function Ti(o){Pi(Ho,o),Yo||(Yo=!0,setTimeout(function(){Yo=!1,Go(Ho,!(Ho={}))},0))}function Go(o,s){s===void 0&&(s=!1);var f=new Set;if(o.all)for(var p=0,b=Object.values(Un);p<b.length;p++)Us(S=b[p],o,f,s);else for(var w in o){var S,T=/^idb\:\/\/(.*)\/(.*)\//.exec(w);T&&(w=T[1],T=T[2],(S=Un["idb://".concat(w,"/").concat(T)])&&Us(S,o,f,s))}f.forEach(function(D){return D()})}function Us(o,s,f,p){for(var b=[],w=0,S=Object.entries(o.queries.query);w<S.length;w++){for(var T=S[w],D=T[0],N=[],U=0,j=T[1];U<j.length;U++){var z=j[U];Wo(s,z.obsSet)?z.subscribers.forEach(function(M){return f.add(M)}):p&&N.push(z)}p&&b.push([D,N])}if(p)for(var R=0,F=b;R<F.length;R++){var K=F[R],D=K[0],N=K[1];o.queries.query[D]=N}}function Af(o){var s=o._state,f=o._deps.indexedDB;if(s.isBeingOpened||o.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?ut(s.dbOpenError):o});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var p=s.openCanceller,b=Math.round(10*o.verno),w=!1;function S(){if(s.openCanceller!==p)throw new me.DatabaseClosed("db.open() was cancelled")}function T(){return new be(function(z,R){if(S(),!f)throw new me.MissingAPI;var F=o.name,K=s.autoSchema||!b?f.open(F):f.open(F,b);if(!K)throw new me.MissingAPI;K.onerror=en(R),K.onblocked=et(o._fireOnBlocked),K.onupgradeneeded=et(function(M){var Y;U=K.transaction,s.autoSchema&&!o._options.allowEmptyDB?(K.onerror=qr,U.abort(),K.result.close(),(Y=f.deleteDatabase(F)).onsuccess=Y.onerror=et(function(){R(new me.NoSuchDatabase("Database ".concat(F," doesnt exist")))})):(U.onerror=en(R),M=M.oldVersion>Math.pow(2,62)?0:M.oldVersion,j=M<1,o.idbdb=K.result,w&&Ef(o,U),If(o,M/10,U,R))},R),K.onsuccess=et(function(){U=null;var M,Y,Z,X,re,ae=o.idbdb=K.result,pe=I(ae.objectStoreNames);if(0<pe.length)try{var se=ae.transaction((X=pe).length===1?X[0]:X,"readonly");if(s.autoSchema)Y=ae,Z=se,(M=o).verno=Y.version/10,Z=M._dbSchema=Ei(0,Y,Z),M._storeNames=I(Y.objectStoreNames,0),Si(M,[M._allTables],l(Z),Z);else if(Oi(o,o._dbSchema,se),((re=Fo(Ei(0,(re=o).idbdb,se),re._dbSchema)).add.length||re.change.some(function(ce){return ce.add.length||ce.change.length}))&&!w)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ae.close(),b=ae.version+1,w=!0,z(T());xi(o,se)}catch{}tr.push(o),ae.onversionchange=et(function(ce){s.vcFired=!0,o.on("versionchange").fire(ce)}),ae.onclose=et(function(ce){o.on("close").fire(ce)}),j&&(re=o._deps,se=F,ae=re.indexedDB,re=re.IDBKeyRange,Ko(ae)||se===gi||Bo(ae,re).put({name:se}).catch(Se)),z()},R)}).catch(function(z){switch(z==null?void 0:z.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),T();break;case"VersionError":if(0<b)return b=0,T()}return be.reject(z)})}var D,N=s.dbReadyResolve,U=null,j=!1;return be.race([p,(typeof navigator>"u"?be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(z){function R(){return indexedDB.databases().finally(z)}D=setInterval(R,100),R()}).finally(function(){return clearInterval(D)}):Promise.resolve()).then(T)]).then(function(){return S(),s.onReadyBeingFired=[],be.resolve(zo(function(){return o.on.ready.fire(o.vip)})).then(function z(){if(0<s.onReadyBeingFired.length){var R=s.onReadyBeingFired.reduce(Cr,Se);return s.onReadyBeingFired=[],be.resolve(zo(function(){return R(o.vip)})).then(z)}})}).finally(function(){s.openCanceller===p&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(z){s.dbOpenError=z;try{U&&U.abort()}catch{}return p===s.openCanceller&&o._close(),ut(z)}).finally(function(){s.openComplete=!0,N()}).then(function(){var z;return j&&(z={},o.tables.forEach(function(R){R.schema.indexes.forEach(function(F){F.name&&(z["idb://".concat(o.name,"/").concat(R.name,"/").concat(F.name)]=new wt(-1/0,[[[]]]))}),z["idb://".concat(o.name,"/").concat(R.name,"/")]=z["idb://".concat(o.name,"/").concat(R.name,"/:dels")]=new wt(-1/0,[[[]]])}),En(Fr).fire(z),Go(z,!0)),o})}function Jo(o){function s(w){return o.next(w)}var f=b(s),p=b(function(w){return o.throw(w)});function b(w){return function(D){var T=w(D),D=T.value;return T.done?D:D&&typeof D.then=="function"?D.then(f,p):c(D)?Promise.all(D).then(f,p):f(D)}}return b(s)()}function ji(o,s,f){for(var p=c(o)?o.slice():[o],b=0;b<f;++b)p.push(s);return p}var Cf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(o){return r(r({},o),{table:function(s){var f=o.table(s),p=f.schema,b={},w=[];function S(j,z,R){var F=Br(j),K=b[F]=b[F]||[],M=j==null?0:typeof j=="string"?1:j.length,Y=0<z,Y=r(r({},R),{name:Y?"".concat(F,"(virtual-from:").concat(R.name,")"):R.name,lowLevelIndex:R,isVirtual:Y,keyTail:z,keyLength:M,extractKey:Mo(j),unique:!Y&&R.unique});return K.push(Y),Y.isPrimaryKey||w.push(Y),1<M&&S(M===2?j[0]:j.slice(0,M-1),z+1,R),K.sort(function(Z,X){return Z.keyTail-X.keyTail}),Y}s=S(p.primaryKey.keyPath,0,p.primaryKey),b[":id"]=[s];for(var T=0,D=p.indexes;T<D.length;T++){var N=D[T];S(N.keyPath,0,N)}function U(j){var z,R=j.query.index;return R.isVirtual?r(r({},j),{query:{index:R.lowLevelIndex,range:(z=j.query.range,R=R.keyTail,{type:z.type===1?2:z.type,lower:ji(z.lower,z.lowerOpen?o.MAX_KEY:o.MIN_KEY,R),lowerOpen:!0,upper:ji(z.upper,z.upperOpen?o.MIN_KEY:o.MAX_KEY,R),upperOpen:!0})}}):j}return r(r({},f),{schema:r(r({},p),{primaryKey:s,indexes:w,getIndexByKeyPath:function(j){return(j=b[Br(j)])&&j[0]}}),count:function(j){return f.count(U(j))},query:function(j){return f.query(U(j))},openCursor:function(j){var z=j.query.index,R=z.keyTail,F=z.isVirtual,K=z.keyLength;return F?f.openCursor(U(j)).then(function(Y){return Y&&M(Y)}):f.openCursor(j);function M(Y){return Object.create(Y,{continue:{value:function(Z){Z!=null?Y.continue(ji(Z,j.reverse?o.MAX_KEY:o.MIN_KEY,R)):j.unique?Y.continue(Y.key.slice(0,K).concat(j.reverse?o.MIN_KEY:o.MAX_KEY,R)):Y.continue()}},continuePrimaryKey:{value:function(Z,X){Y.continuePrimaryKey(ji(Z,o.MAX_KEY,R),X)}},primaryKey:{get:function(){return Y.primaryKey}},key:{get:function(){var Z=Y.key;return K===1?Z[0]:Z.slice(0,K)}},value:{get:function(){return Y.value}}})}}})}})}};function Qo(o,s,f,p){return f=f||{},p=p||"",l(o).forEach(function(b){var w,S,T;m(s,b)?(w=o[b],S=s[b],typeof w=="object"&&typeof S=="object"&&w&&S?(T=ie(w))!==ie(S)?f[p+b]=s[b]:T==="Object"?Qo(w,S,f,p+b+"."):w!==S&&(f[p+b]=s[b]):w!==S&&(f[p+b]=s[b])):f[p+b]=void 0}),l(s).forEach(function(b){m(o,b)||(f[p+b]=s[b])}),f}function Zo(o,s){return s.type==="delete"?s.keys:s.keys||s.values.map(o.extractKey)}var Pf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return r(r({},o),{table:function(s){var f=o.table(s),p=f.schema.primaryKey;return r(r({},f),{mutate:function(b){var w=Ie.trans,S=w.table(s).hook,T=S.deleting,D=S.creating,N=S.updating;switch(b.type){case"add":if(D.fire===Se)break;return w._promise("readwrite",function(){return U(b)},!0);case"put":if(D.fire===Se&&N.fire===Se)break;return w._promise("readwrite",function(){return U(b)},!0);case"delete":if(T.fire===Se)break;return w._promise("readwrite",function(){return U(b)},!0);case"deleteRange":if(T.fire===Se)break;return w._promise("readwrite",function(){return function j(z,R,F){return f.query({trans:z,values:!1,query:{index:p,range:R},limit:F}).then(function(K){var M=K.result;return U({type:"delete",keys:M,trans:z}).then(function(Y){return 0<Y.numFailures?Promise.reject(Y.failures[0]):M.length<F?{failures:[],numFailures:0,lastResult:void 0}:j(z,r(r({},R),{lower:M[M.length-1],lowerOpen:!0}),F)})})}(b.trans,b.range,1e4)},!0)}return f.mutate(b);function U(j){var z,R,F,K=Ie.trans,M=j.keys||Zo(p,j);if(!M)throw new Error("Keys missing");return(j=j.type==="add"||j.type==="put"?r(r({},j),{keys:M}):r({},j)).type!=="delete"&&(j.values=i([],j.values)),j.keys&&(j.keys=i([],j.keys)),z=f,F=M,((R=j).type==="add"?Promise.resolve([]):z.getMany({trans:R.trans,keys:F,cache:"immutable"})).then(function(Y){var Z=M.map(function(X,re){var ae,pe,se,ce=Y[re],ye={onerror:null,onsuccess:null};return j.type==="delete"?T.fire.call(ye,X,ce,K):j.type==="add"||ce===void 0?(ae=D.fire.call(ye,X,j.values[re],K),X==null&&ae!=null&&(j.keys[re]=X=ae,p.outbound||V(j.values[re],p.keyPath,X))):(ae=Qo(ce,j.values[re]),(pe=N.fire.call(ye,ae,X,ce,K))&&(se=j.values[re],Object.keys(pe).forEach(function(ve){m(se,ve)?se[ve]=pe[ve]:V(se,ve,pe[ve])}))),ye});return f.mutate(j).then(function(X){for(var re=X.failures,ae=X.results,pe=X.numFailures,X=X.lastResult,se=0;se<M.length;++se){var ce=(ae||M)[se],ye=Z[se];ce==null?ye.onerror&&ye.onerror(re[se]):ye.onsuccess&&ye.onsuccess(j.type==="put"&&Y[se]?j.values[se]:ce)}return{failures:re,results:ae,numFailures:pe,lastResult:X}}).catch(function(X){return Z.forEach(function(re){return re.onerror&&re.onerror(X)}),Promise.reject(X)})})}}})}})}};function Bs(o,s,f){try{if(!s||s.keys.length<o.length)return null;for(var p=[],b=0,w=0;b<s.keys.length&&w<o.length;++b)Ye(s.keys[b],o[w])===0&&(p.push(f?H(s.values[b]):s.values[b]),++w);return p.length===o.length?p:null}catch{return null}}var Tf={stack:"dbcore",level:-1,create:function(o){return{table:function(s){var f=o.table(s);return r(r({},f),{getMany:function(p){if(!p.cache)return f.getMany(p);var b=Bs(p.keys,p.trans._cache,p.cache==="clone");return b?be.resolve(b):f.getMany(p).then(function(w){return p.trans._cache={keys:p.keys,values:p.cache==="clone"?H(w):w},w})},mutate:function(p){return p.type!=="add"&&(p.trans._cache=null),f.mutate(p)}})}}}};function Ks(o,s){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function zs(o,s){switch(o){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var jf={stack:"dbcore",level:0,name:"Observability",create:function(o){var s=o.schema.name,f=new wt(o.MIN_KEY,o.MAX_KEY);return r(r({},o),{transaction:function(p,b,w){if(Ie.subscr&&b!=="readonly")throw new me.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ie.querier));return o.transaction(p,b,w)},table:function(p){var b=o.table(p),w=b.schema,S=w.primaryKey,j=w.indexes,T=S.extractKey,D=S.outbound,N=S.autoIncrement&&j.filter(function(R){return R.compound&&R.keyPath.includes(S.keyPath)}),U=r(r({},b),{mutate:function(R){function F(ve){return ve="idb://".concat(s,"/").concat(p,"/").concat(ve),X[ve]||(X[ve]=new wt)}var K,M,Y,Z=R.trans,X=R.mutatedParts||(R.mutatedParts={}),re=F(""),ae=F(":dels"),pe=R.type,ye=R.type==="deleteRange"?[R.range]:R.type==="delete"?[R.keys]:R.values.length<50?[Zo(S,R).filter(function(ve){return ve}),R.values]:[],se=ye[0],ce=ye[1],ye=R.trans._cache;return c(se)?(re.addKeys(se),(ye=pe==="delete"||se.length===ce.length?Bs(se,ye):null)||ae.addKeys(se),(ye||ce)&&(K=F,M=ye,Y=ce,w.indexes.forEach(function(ve){var xe=K(ve.name||"");function Be(We){return We!=null?ve.extractKey(We):null}function Ve(We){return ve.multiEntry&&c(We)?We.forEach(function(jt){return xe.addKey(jt)}):xe.addKey(We)}(M||Y).forEach(function(We,kt){var Ue=M&&Be(M[kt]),kt=Y&&Be(Y[kt]);Ye(Ue,kt)!==0&&(Ue!=null&&Ve(Ue),kt!=null&&Ve(kt))})}))):se?(ce={from:(ce=se.lower)!==null&&ce!==void 0?ce:o.MIN_KEY,to:(ce=se.upper)!==null&&ce!==void 0?ce:o.MAX_KEY},ae.add(ce),re.add(ce)):(re.add(f),ae.add(f),w.indexes.forEach(function(ve){return F(ve.name).add(f)})),b.mutate(R).then(function(ve){return!se||R.type!=="add"&&R.type!=="put"||(re.addKeys(ve.results),N&&N.forEach(function(xe){for(var Be=R.values.map(function(Ue){return xe.extractKey(Ue)}),Ve=xe.keyPath.findIndex(function(Ue){return Ue===S.keyPath}),We=0,jt=ve.results.length;We<jt;++We)Be[We][Ve]=ve.results[We];F(xe.name).addKeys(Be)})),Z.mutatedParts=Pi(Z.mutatedParts||{},X),ve})}}),j=function(F){var K=F.query,F=K.index,K=K.range;return[F,new wt((F=K.lower)!==null&&F!==void 0?F:o.MIN_KEY,(K=K.upper)!==null&&K!==void 0?K:o.MAX_KEY)]},z={get:function(R){return[S,new wt(R.key)]},getMany:function(R){return[S,new wt().addKeys(R.keys)]},count:j,query:j,openCursor:j};return l(z).forEach(function(R){U[R]=function(F){var K=Ie.subscr,M=!!K,Y=Ks(Ie,b)&&zs(R,F)?F.obsSet={}:K;if(M){var Z=function(ce){return ce="idb://".concat(s,"/").concat(p,"/").concat(ce),Y[ce]||(Y[ce]=new wt)},X=Z(""),re=Z(":dels"),K=z[R](F),M=K[0],K=K[1];if((R==="query"&&M.isPrimaryKey&&!F.values?re:Z(M.name||"")).add(K),!M.isPrimaryKey){if(R!=="count"){var ae=R==="query"&&D&&F.values&&b.query(r(r({},F),{values:!1}));return b[R].apply(this,arguments).then(function(ce){if(R==="query"){if(D&&F.values)return ae.then(function(Be){return Be=Be.result,X.addKeys(Be),ce});var ye=F.values?ce.result.map(T):ce.result;(F.values?X:re).addKeys(ye)}else if(R==="openCursor"){var ve=ce,xe=F.values;return ve&&Object.create(ve,{key:{get:function(){return re.addKey(ve.primaryKey),ve.key}},primaryKey:{get:function(){var Be=ve.primaryKey;return re.addKey(Be),Be}},value:{get:function(){return xe&&X.addKey(ve.primaryKey),ve.value}}})}return ce})}re.add(f)}}return b[R].apply(this,arguments)}}),U}})}};function Vs(o,s,f){if(f.numFailures===0)return s;if(s.type==="deleteRange")return null;var p=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1;return f.numFailures===p?null:(s=r({},s),c(s.keys)&&(s.keys=s.keys.filter(function(b,w){return!(w in f.failures)})),"values"in s&&c(s.values)&&(s.values=s.values.filter(function(b,w){return!(w in f.failures)})),s)}function Xo(o,s){return f=o,((p=s).lower===void 0||(p.lowerOpen?0<Ye(f,p.lower):0<=Ye(f,p.lower)))&&(o=o,(s=s).upper===void 0||(s.upperOpen?Ye(o,s.upper)<0:Ye(o,s.upper)<=0));var f,p}function Ws(o,s,z,p,b,w){if(!z||z.length===0)return o;var S=s.query.index,T=S.multiEntry,D=s.query.range,N=p.schema.primaryKey.extractKey,U=S.extractKey,j=(S.lowLevelIndex||S).extractKey,z=z.reduce(function(R,F){var K=R,M=[];if(F.type==="add"||F.type==="put")for(var Y=new wt,Z=F.values.length-1;0<=Z;--Z){var X,re=F.values[Z],ae=N(re);Y.hasKey(ae)||(X=U(re),(T&&c(X)?X.some(function(ve){return Xo(ve,D)}):Xo(X,D))&&(Y.addKey(ae),M.push(re)))}switch(F.type){case"add":var pe=new wt().addKeys(s.values?R.map(function(xe){return N(xe)}):R),K=R.concat(s.values?M.filter(function(xe){return xe=N(xe),!pe.hasKey(xe)&&(pe.addKey(xe),!0)}):M.map(function(xe){return N(xe)}).filter(function(xe){return!pe.hasKey(xe)&&(pe.addKey(xe),!0)}));break;case"put":var se=new wt().addKeys(F.values.map(function(xe){return N(xe)}));K=R.filter(function(xe){return!se.hasKey(s.values?N(xe):xe)}).concat(s.values?M:M.map(function(xe){return N(xe)}));break;case"delete":var ce=new wt().addKeys(F.keys);K=R.filter(function(xe){return!ce.hasKey(s.values?N(xe):xe)});break;case"deleteRange":var ye=F.range;K=R.filter(function(xe){return!Xo(N(xe),ye)})}return K},o);return z===o?o:(z.sort(function(R,F){return Ye(j(R),j(F))||Ye(N(R),N(F))}),s.limit&&s.limit<1/0&&(z.length>s.limit?z.length=s.limit:o.length===s.limit&&z.length<s.limit&&(b.dirty=!0)),w?Object.freeze(z):z)}function Hs(o,s){return Ye(o.lower,s.lower)===0&&Ye(o.upper,s.upper)===0&&!!o.lowerOpen==!!s.lowerOpen&&!!o.upperOpen==!!s.upperOpen}function Df(o,s){return function(f,p,b,w){if(f===void 0)return p!==void 0?-1:0;if(p===void 0)return 1;if((p=Ye(f,p))===0){if(b&&w)return 0;if(b)return 1;if(w)return-1}return p}(o.lower,s.lower,o.lowerOpen,s.lowerOpen)<=0&&0<=function(f,p,b,w){if(f===void 0)return p!==void 0?1:0;if(p===void 0)return-1;if((p=Ye(f,p))===0){if(b&&w)return 0;if(b)return-1;if(w)return 1}return p}(o.upper,s.upper,o.upperOpen,s.upperOpen)}function Rf(o,s,f,p){o.subscribers.add(f),p.addEventListener("abort",function(){var b,w;o.subscribers.delete(f),o.subscribers.size===0&&(b=o,w=s,setTimeout(function(){b.subscribers.size===0&&je(w,b)},3e3))})}var Nf={stack:"dbcore",level:0,name:"Cache",create:function(o){var s=o.schema.name;return r(r({},o),{transaction:function(f,p,b){var w,S,T=o.transaction(f,p,b);return p==="readwrite"&&(S=(w=new AbortController).signal,b=function(D){return function(){if(w.abort(),p==="readwrite"){for(var N=new Set,U=0,j=f;U<j.length;U++){var z=j[U],R=Un["idb://".concat(s,"/").concat(z)];if(R){var F=o.table(z),K=R.optimisticOps.filter(function(xe){return xe.trans===T});if(T._explicit&&D&&T.mutatedParts)for(var M=0,Y=Object.values(R.queries.query);M<Y.length;M++)for(var Z=0,X=(pe=Y[M]).slice();Z<X.length;Z++)Wo((se=X[Z]).obsSet,T.mutatedParts)&&(je(pe,se),se.subscribers.forEach(function(xe){return N.add(xe)}));else if(0<K.length){R.optimisticOps=R.optimisticOps.filter(function(xe){return xe.trans!==T});for(var re=0,ae=Object.values(R.queries.query);re<ae.length;re++)for(var pe,se,ce,ye=0,ve=(pe=ae[re]).slice();ye<ve.length;ye++)(se=ve[ye]).res!=null&&T.mutatedParts&&(D&&!se.dirty?(ce=Object.isFrozen(se.res),ce=Ws(se.res,se.req,K,F,se,ce),se.dirty?(je(pe,se),se.subscribers.forEach(function(xe){return N.add(xe)})):ce!==se.res&&(se.res=ce,se.promise=be.resolve({result:ce}))):(se.dirty&&je(pe,se),se.subscribers.forEach(function(xe){return N.add(xe)})))}}}N.forEach(function(xe){return xe()})}}},T.addEventListener("abort",b(!1),{signal:S}),T.addEventListener("error",b(!1),{signal:S}),T.addEventListener("complete",b(!0),{signal:S})),T},table:function(f){var p=o.table(f),b=p.schema.primaryKey;return r(r({},p),{mutate:function(w){var S=Ie.trans;if(b.outbound||S.db._options.cache==="disabled"||S.explicit||S.idbtrans.mode!=="readwrite")return p.mutate(w);var T=Un["idb://".concat(s,"/").concat(f)];return T?(S=p.mutate(w),w.type!=="add"&&w.type!=="put"||!(50<=w.values.length||Zo(b,w).some(function(D){return D==null}))?(T.optimisticOps.push(w),w.mutatedParts&&Ti(w.mutatedParts),S.then(function(D){0<D.numFailures&&(je(T.optimisticOps,w),(D=Vs(0,w,D))&&T.optimisticOps.push(D),w.mutatedParts&&Ti(w.mutatedParts))}),S.catch(function(){je(T.optimisticOps,w),w.mutatedParts&&Ti(w.mutatedParts)})):S.then(function(D){var N=Vs(0,r(r({},w),{values:w.values.map(function(U,j){var z;return D.failures[j]?U:(U=(z=b.keyPath)!==null&&z!==void 0&&z.includes(".")?H(U):r({},U),V(U,b.keyPath,D.results[j]),U)})}),D);T.optimisticOps.push(N),queueMicrotask(function(){return w.mutatedParts&&Ti(w.mutatedParts)})}),S):p.mutate(w)},query:function(w){if(!Ks(Ie,p)||!zs("query",w))return p.query(w);var S=((N=Ie.trans)===null||N===void 0?void 0:N.db._options.cache)==="immutable",j=Ie,T=j.requery,D=j.signal,N=function(F,K,M,Y){var Z=Un["idb://".concat(F,"/").concat(K)];if(!Z)return[];if(!(K=Z.queries[M]))return[null,!1,Z,null];var X=K[(Y.query?Y.query.index.name:null)||""];if(!X)return[null,!1,Z,null];switch(M){case"query":var re=X.find(function(ae){return ae.req.limit===Y.limit&&ae.req.values===Y.values&&Hs(ae.req.query.range,Y.query.range)});return re?[re,!0,Z,X]:[X.find(function(ae){return("limit"in ae.req?ae.req.limit:1/0)>=Y.limit&&(!Y.values||ae.req.values)&&Df(ae.req.query.range,Y.query.range)}),!1,Z,X];case"count":return re=X.find(function(ae){return Hs(ae.req.query.range,Y.query.range)}),[re,!!re,Z,X]}}(s,f,"query",w),U=N[0],j=N[1],z=N[2],R=N[3];return U&&j?U.obsSet=w.obsSet:(j=p.query(w).then(function(F){var K=F.result;if(U&&(U.res=K),S){for(var M=0,Y=K.length;M<Y;++M)Object.freeze(K[M]);Object.freeze(K)}else F.result=H(K);return F}).catch(function(F){return R&&U&&je(R,U),Promise.reject(F)}),U={obsSet:w.obsSet,promise:j,subscribers:new Set,type:"query",req:w,dirty:!1},R?R.push(U):(R=[U],(z=z||(Un["idb://".concat(s,"/").concat(f)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[w.query.index.name||""]=R)),Rf(U,R,T,D),U.promise.then(function(F){return{result:Ws(F.result,w,z==null?void 0:z.optimisticOps,p,U,S)}})}})}})}};function Di(o,s){return new Proxy(o,{get:function(f,p,b){return p==="db"?s:Reflect.get(f,p,b)}})}var fn=(ct.prototype.version=function(o){if(isNaN(o)||o<.1)throw new me.Type("Given version is not a positive number");if(o=Math.round(10*o)/10,this.idbdb||this._state.isBeingOpened)throw new me.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,o);var s=this._versions,f=s.filter(function(p){return p._cfg.version===o})[0];return f||(f=new this.Version(o),s.push(f),s.sort(Sf),f.stores({}),this._state.autoSchema=!1,f)},ct.prototype._whenReady=function(o){var s=this;return this.idbdb&&(this._state.openComplete||Ie.letThrough||this._vip)?o():new be(function(f,p){if(s._state.openComplete)return p(new me.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void p(new me.DatabaseClosed);s.open().catch(Se)}s._state.dbReadyPromise.then(f,p)}).then(o)},ct.prototype.use=function(o){var s=o.stack,f=o.create,p=o.level,b=o.name;return b&&this.unuse({stack:s,name:b}),o=this._middlewares[s]||(this._middlewares[s]=[]),o.push({stack:s,create:f,level:p??10,name:b}),o.sort(function(w,S){return w.level-S.level}),this},ct.prototype.unuse=function(o){var s=o.stack,f=o.name,p=o.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(b){return p?b.create!==p:!!f&&b.name!==f})),this},ct.prototype.open=function(){var o=this;return Mn(qt,function(){return Af(o)})},ct.prototype._close=function(){var o=this._state,s=tr.indexOf(this);if(0<=s&&tr.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}o.isBeingOpened||(o.dbReadyPromise=new be(function(f){o.dbReadyResolve=f}),o.openCanceller=new be(function(f,p){o.cancelOpen=p}))},ct.prototype.close=function(f){var s=(f===void 0?{disableAutoOpen:!0}:f).disableAutoOpen,f=this._state;s?(f.isBeingOpened&&f.cancelOpen(new me.DatabaseClosed),this._close(),f.autoOpen=!1,f.dbOpenError=new me.DatabaseClosed):(this._close(),f.autoOpen=this._options.autoOpen||f.isBeingOpened,f.openComplete=!1,f.dbOpenError=null)},ct.prototype.delete=function(o){var s=this;o===void 0&&(o={disableAutoOpen:!0});var f=0<arguments.length&&typeof arguments[0]!="object",p=this._state;return new be(function(b,w){function S(){s.close(o);var T=s._deps.indexedDB.deleteDatabase(s.name);T.onsuccess=et(function(){var D,N,U;D=s._deps,N=s.name,U=D.indexedDB,D=D.IDBKeyRange,Ko(U)||N===gi||Bo(U,D).delete(N).catch(Se),b()}),T.onerror=en(w),T.onblocked=s._fireOnBlocked}if(f)throw new me.InvalidArgument("Invalid closeOptions argument to db.delete()");p.isBeingOpened?p.dbReadyPromise.then(S):S()})},ct.prototype.backendDB=function(){return this.idbdb},ct.prototype.isOpen=function(){return this.idbdb!==null},ct.prototype.hasBeenClosed=function(){var o=this._state.dbOpenError;return o&&o.name==="DatabaseClosed"},ct.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ct.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ct.prototype,"tables",{get:function(){var o=this;return l(this._allTables).map(function(s){return o._allTables[s]})},enumerable:!1,configurable:!0}),ct.prototype.transaction=function(){var o=(function(s,f,p){var b=arguments.length;if(b<2)throw new me.InvalidArgument("Too few arguments");for(var w=new Array(b-1);--b;)w[b-1]=arguments[b];return p=w.pop(),[s,G(w),p]}).apply(this,arguments);return this._transaction.apply(this,o)},ct.prototype._transaction=function(o,s,f){var p=this,b=Ie.trans;b&&b.db===this&&o.indexOf("!")===-1||(b=null);var w,S,T=o.indexOf("?")!==-1;o=o.replace("!","").replace("?","");try{if(S=s.map(function(N){if(N=N instanceof p.Table?N.name:N,typeof N!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return N}),o=="r"||o===Co)w=Co;else{if(o!="rw"&&o!=Po)throw new me.InvalidArgument("Invalid transaction mode: "+o);w=Po}if(b){if(b.mode===Co&&w===Po){if(!T)throw new me.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");b=null}b&&S.forEach(function(N){if(b&&b.storeNames.indexOf(N)===-1){if(!T)throw new me.SubTransaction("Table "+N+" not included in parent transaction.");b=null}}),T&&b&&!b.active&&(b=null)}}catch(N){return b?b._promise(null,function(U,j){j(N)}):ut(N)}var D=(function N(U,j,z,R,F){return be.resolve().then(function(){var K=Ie.transless||Ie,M=U._createTransaction(j,z,U._dbSchema,R);if(M.explicit=!0,K={trans:M,transless:K},R)M.idbtrans=R.idbtrans;else try{M.create(),M.idbtrans._explicit=!0,U._state.PR1398_maxLoop=3}catch(X){return X.name===qe.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return N(U,j,z,null,F)})):ut(X)}var Y,Z=Le(F);return Z&&xn(),K=be.follow(function(){var X;(Y=F.call(M,M))&&(Z?(X=Et.bind(null,null),Y.then(X,X)):typeof Y.next=="function"&&typeof Y.throw=="function"&&(Y=Jo(Y)))},K),(Y&&typeof Y.then=="function"?be.resolve(Y).then(function(X){return M.active?X:ut(new me.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):K.then(function(){return Y})).then(function(X){return R&&M._resolve(),M._completion.then(function(){return X})}).catch(function(X){return M._reject(X),ut(X)})})}).bind(null,this,w,S,b,f);return b?b._promise(w,D,"lock"):Ie.trans?Mn(Ie.transless,function(){return p._whenReady(D)}):this._whenReady(D)},ct.prototype.table=function(o){if(!m(this._allTables,o))throw new me.InvalidTable("Table ".concat(o," does not exist"));return this._allTables[o]},ct);function ct(o,s){var f=this;this._middlewares={},this.verno=0;var p=ct.dependencies;this._options=s=r({addons:ct.addons,autoOpen:!0,indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},p=s.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var b,w,S,T,D,N={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Se,dbReadyPromise:null,cancelOpen:Se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen};N.dbReadyPromise=new be(function(j){N.dbReadyResolve=j}),N.openCanceller=new be(function(j,z){N.cancelOpen=z}),this._state=N,this.name=o,this.on=Nr(this,"populate","blocked","versionchange","close",{ready:[Cr,Se]}),this.on.ready.subscribe=x(this.on.ready.subscribe,function(j){return function(z,R){ct.vip(function(){var F,K=f._state;K.openComplete?(K.dbOpenError||be.resolve().then(z),R&&j(z)):K.onReadyBeingFired?(K.onReadyBeingFired.push(z),R&&j(z)):(j(z),F=f,R||j(function M(){F.on.ready.unsubscribe(z),F.on.ready.unsubscribe(M)}))})}}),this.Collection=(b=this,Lr(mf.prototype,function(Y,M){this.db=b;var R=xs,F=null;if(M)try{R=M()}catch(Z){F=Z}var K=Y._ctx,M=K.table,Y=M.hook.reading.fire;this._ctx={table:M,index:K.index,isPrimKey:!K.index||M.schema.primKey.keyPath&&K.index===M.schema.primKey.name,range:R,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:F,or:K.or,valueMapper:Y!==Me?Y:null}})),this.Table=(w=this,Lr(Os.prototype,function(j,z,R){this.db=w,this._tx=R,this.name=j,this.schema=z,this.hook=w._allTables[j]?w._allTables[j].hook:Nr(null,{creating:[_t,Se],reading:[Te,Me],updating:[Dn,Se],deleting:[Ct,Se]})})),this.Transaction=(S=this,Lr(_f.prototype,function(j,z,R,F,K){var M=this;this.db=S,this.mode=j,this.storeNames=z,this.schema=R,this.chromeTransactionDurability=F,this.idbtrans=null,this.on=Nr(this,"complete","error","abort"),this.parent=K||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new be(function(Y,Z){M._resolve=Y,M._reject=Z}),this._completion.then(function(){M.active=!1,M.on.complete.fire()},function(Y){var Z=M.active;return M.active=!1,M.on.error.fire(Y),M.parent?M.parent._reject(Y):Z&&M.idbtrans&&M.idbtrans.abort(),ut(Y)})})),this.Version=(T=this,Lr(Of.prototype,function(j){this.db=T,this._cfg={version:j,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(D=this,Lr(js.prototype,function(j,z,R){if(this.db=D,this._ctx={table:j,index:z===":id"?null:z,or:R},this._cmp=this._ascending=Ye,this._descending=function(F,K){return Ye(K,F)},this._max=function(F,K){return 0<Ye(F,K)?F:K},this._min=function(F,K){return Ye(F,K)<0?F:K},this._IDBKeyRange=D._deps.IDBKeyRange,!this._IDBKeyRange)throw new me.MissingAPI})),this.on("versionchange",function(j){0<j.newVersion?console.warn("Another connection wants to upgrade database '".concat(f.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(f.name,"'. Closing db now to resume the delete request.")),f.close({disableAutoOpen:!1})}),this.on("blocked",function(j){!j.newVersion||j.newVersion<j.oldVersion?console.warn("Dexie.delete('".concat(f.name,"') was blocked")):console.warn("Upgrade '".concat(f.name,"' blocked by other connection holding version ").concat(j.oldVersion/10))}),this._maxKey=Ur(s.IDBKeyRange),this._createTransaction=function(j,z,R,F){return new f.Transaction(j,z,R,f._options.chromeTransactionDurability,F)},this._fireOnBlocked=function(j){f.on("blocked").fire(j),tr.filter(function(z){return z.name===f.name&&z!==f&&!z._state.vcFired}).map(function(z){return z.on("versionchange").fire(j)})},this.use(Tf),this.use(Nf),this.use(jf),this.use(Cf),this.use(Pf);var U=new Proxy(this,{get:function(j,z,R){if(z==="_vip")return!0;if(z==="table")return function(K){return Di(f.table(K),U)};var F=Reflect.get(j,z,R);return F instanceof Os?Di(F,U):z==="tables"?F.map(function(K){return Di(K,U)}):z==="_createTransaction"?function(){return Di(F.apply(this,arguments),U)}:F}});this.vip=U,p.forEach(function(j){return j(f)})}var Ri,Bt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Lf=($o.prototype.subscribe=function(o,s,f){return this._subscribe(o&&typeof o!="function"?o:{next:o,error:s,complete:f})},$o.prototype[Bt]=function(){return this},$o);function $o(o){this._subscribe=o}try{Ri={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Ri={indexedDB:null,IDBKeyRange:null}}function Ys(o){var s,f=!1,p=new Lf(function(b){var w=Le(o),S,T=!1,D={},N={},U={get closed(){return T},unsubscribe:function(){T||(T=!0,S&&S.abort(),j&&En.storagemutated.unsubscribe(R))}};b.start&&b.start(U);var j=!1,z=function(){return Ao(F)},R=function(K){Pi(D,K),Wo(N,D)&&z()},F=function(){var K,M,Y;!T&&Ri.indexedDB&&(D={},K={},S&&S.abort(),S=new AbortController,Y=function(Z){var X=kn();try{w&&xn();var re=$t(o,Z);return re=w?re.finally(Et):re}finally{X&&Pt()}}(M={subscr:K,signal:S.signal,requery:z,querier:o,trans:null}),Promise.resolve(Y).then(function(Z){f=!0,s=Z,T||M.signal.aborted||(D={},function(X){for(var re in X)if(m(X,re))return;return 1}(N=K)||j||(En(Fr,R),j=!0),Ao(function(){return!T&&b.next&&b.next(Z)}))},function(Z){f=!1,["DatabaseClosedError","AbortError"].includes(Z==null?void 0:Z.name)||T||Ao(function(){T||b.error&&b.error(Z)})}))};return setTimeout(z,0),U});return p.hasValue=function(){return f},p.getValue=function(){return s},p}var Bn=fn;function ea(o){var s=On;try{On=!0,En.storagemutated.fire(o),Go(o,!0)}finally{On=s}}h(Bn,r(r({},Pe),{delete:function(o){return new Bn(o,{addons:[]}).delete()},exists:function(o){return new Bn(o,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return s=Bn.dependencies,f=s.indexedDB,s=s.IDBKeyRange,(Ko(f)?Promise.resolve(f.databases()).then(function(p){return p.map(function(b){return b.name}).filter(function(b){return b!==gi})}):Bo(f,s).toCollection().primaryKeys()).then(o)}catch{return ut(new me.MissingAPI)}var s,f},defineClass:function(){return function(o){d(this,o)}},ignoreTransaction:function(o){return Ie.trans?Mn(Ie.transless,o):o()},vip:zo,async:function(o){return function(){try{var s=Jo(o.apply(this,arguments));return s&&typeof s.then=="function"?s:be.resolve(s)}catch(f){return ut(f)}}},spawn:function(o,s,f){try{var p=Jo(o.apply(f,s||[]));return p&&typeof p.then=="function"?p:be.resolve(p)}catch(b){return ut(b)}},currentTransaction:{get:function(){return Ie.trans||null}},waitFor:function(o,s){return s=be.resolve(typeof o=="function"?Bn.ignoreTransaction(o):o).timeout(s||6e4),Ie.trans?Ie.trans.waitFor(s):s},Promise:be,debug:{get:function(){return bt},set:function(o){Jn(o)}},derive:k,extend:d,props:h,override:x,Events:Nr,on:En,liveQuery:Ys,extendObservabilitySet:Pi,getByKeyPath:L,setByKeyPath:V,delByKeyPath:function(o,s){typeof s=="string"?V(o,s,void 0):"length"in s&&[].map.call(s,function(f){V(o,f,void 0)})},shallowClone:te,deepClone:H,getObjectDiff:Qo,cmp:Ye,asap:q,minKey:-1/0,addons:[],connections:tr,errnames:qe,dependencies:Ri,cache:Un,semVer:"4.0.11",version:"4.0.11".split(".").map(function(o){return parseInt(o)}).reduce(function(o,s,f){return o+s/Math.pow(10,2*f)})})),Bn.maxKey=Ur(Bn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(En(Fr,function(o){On||(o=new CustomEvent(Ro,{detail:o}),On=!0,dispatchEvent(o),On=!1)}),addEventListener(Ro,function(o){o=o.detail,On||ea(o)}));var ir,On=!1,Gs=function(){};return typeof BroadcastChannel<"u"&&((Gs=function(){(ir=new BroadcastChannel(Ro)).onmessage=function(o){return o.data&&ea(o.data)}})(),typeof ir.unref=="function"&&ir.unref(),En(Fr,function(o){On||ir.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!fn.disableBfCache&&o.persisted){bt&&console.debug("Dexie: handling persisted pagehide"),ir!=null&&ir.close();for(var s=0,f=tr;s<f.length;s++)f[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(o){!fn.disableBfCache&&o.persisted&&(bt&&console.debug("Dexie: handling persisted pageshow"),Gs(),ea({all:new wt(-1/0,[[]])}))})),be.rejectionMapper=function(o,s){return!o||o instanceof Ke||o instanceof TypeError||o instanceof SyntaxError||!o.name||!ke[o.name]?o:(s=new ke[o.name](s||o.message,o),"stack"in o&&_(s,"stack",{get:function(){return this.inner.stack}}),s)},Jn(bt),r(fn,Object.freeze({__proto__:null,Dexie:fn,liveQuery:Ys,Entity:Ss,cmp:Ye,PropModification:Mr,replacePrefix:function(o,s){return new Mr({replacePrefix:[o,s]})},add:function(o){return new Mr({add:o})},remove:function(o){return new Mr({remove:o})},default:fn,RangeSet:wt,mergeRanges:zr,rangesOverlap:Ms}),{default:fn}),fn})}(Yi)),Yi.exports}var Vd=zd();const Sa=Bd(Vd),ll=Symbol.for("Dexie"),at=globalThis[ll]||(globalThis[ll]=Sa);if(Sa.semVer!==at.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Sa.semVer} and ${at.semVer}`);const{liveQuery:ur,mergeRanges:Pb,rangesOverlap:Tb,RangeSet:jb,cmp:Wd,Entity:Db,PropModification:ul,replacePrefix:Rb,add:Nb,remove:Lb}=at;var Ia=function(e,t){return Ia=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ia(e,t)};function bn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ia(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Hd(e,t,n,r){function i(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function c(u){try{v(r.next(u))}catch(m){l(m)}}function d(u){try{v(r.throw(u))}catch(m){l(m)}}function v(u){u.done?a(u.value):i(u.value).then(c,d)}v((r=r.apply(e,t||[])).next())})}function Lu(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(v){return function(u){return d([v,u])}}function d(v){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,v[0]&&(n=0)),n;)try{if(r=1,i&&(a=v[0]&2?i.return:v[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,v[1])).done)return a;switch(i=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return n.label++,{value:v[1],done:!1};case 5:n.label++,i=v[1],v=[0];continue;case 7:v=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){n=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){n.label=v[1];break}if(v[0]===6&&n.label<a[1]){n.label=a[1],a=v;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(v);break}a[2]&&n.ops.pop(),n.trys.pop();continue}v=t.call(e,n)}catch(u){v=[6,u],i=0}finally{r=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}function yr(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yn(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],l;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){l={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(l)throw l.error}}return a}function mr(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function cr(e){return this instanceof cr?(this.v=e,this):new cr(e)}function Yd(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(g){return function(_){return Promise.resolve(_).then(g,m)}}function c(g,_){r[g]&&(i[g]=function(k){return new Promise(function(O,A){a.push([g,k,O,A])>1||d(g,k)})},_&&(i[g]=_(i[g])))}function d(g,_){try{v(r[g](_))}catch(k){h(a[0][3],k)}}function v(g){g.value instanceof cr?Promise.resolve(g.value.v).then(u,m):h(a[0][2],g)}function u(g){d("next",g)}function m(g){d("throw",g)}function h(g,_){g(_),a.shift(),a.length&&d(a[0][0],a[0][1])}}function Gd(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof yr=="function"?yr(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=e[a]&&function(l){return new Promise(function(c,d){l=e[a](l),i(c,d,l.done,l.value)})}}function i(a,l,c,d){Promise.resolve(d).then(function(v){a({value:v,done:c})},l)}}function $e(e){return typeof e=="function"}function $a(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var ua=$a(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function to(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Ir=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,i,a;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var c=yr(l),d=c.next();!d.done;d=c.next()){var v=d.value;v.remove(this)}}catch(k){t={error:k}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}else l.remove(this);var u=this.initialTeardown;if($e(u))try{u()}catch(k){a=k instanceof ua?k.errors:[k]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var h=yr(m),g=h.next();!g.done;g=h.next()){var _=g.value;try{cl(_)}catch(k){a=a??[],k instanceof ua?a=mr(mr([],Yn(a)),Yn(k.errors)):a.push(k)}}}catch(k){r={error:k}}finally{try{g&&!g.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(a)throw new ua(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)cl(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&to(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&to(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Mu=Ir.EMPTY;function qu(e){return e instanceof Ir||e&&"closed"in e&&$e(e.remove)&&$e(e.add)&&$e(e.unsubscribe)}function cl(e){$e(e)?e():e.unsubscribe()}var Jd={Promise:void 0},Qd={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,mr([e,t],Yn(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Fu(e){Qd.setTimeout(function(){throw e})}function fl(){}function Gi(e){e()}var es=function(e){bn(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,qu(n)&&n.add(r)):r.destination=$d,r}return t.create=function(n,r,i){return new gr(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Ir),Zd=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Mi(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Mi(r)}else Mi(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Mi(n)}},e}(),gr=function(e){bn(t,e);function t(n,r,i){var a=e.call(this)||this,l;return $e(n)||!n?l={next:n??void 0,error:r??void 0,complete:i??void 0}:l=n,a.destination=new Zd(l),a}return t}(es);function Mi(e){Fu(e)}function Xd(e){throw e}var $d={closed:!0,next:fl,error:Xd,complete:fl},ts=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function yo(e){return e}function ev(e){return e.length===0?yo:e.length===1?e[0]:function(n){return e.reduce(function(r,i){return i(r)},n)}}var yt=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i=this,a=nv(t)?t:new gr(t,n,r);return Gi(function(){var l=i,c=l.operator,d=l.source;a.add(c?c.call(a,d):d?i._subscribe(a):i._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=dl(n),new n(function(i,a){var l=new gr({next:function(c){try{t(c)}catch(d){a(d),l.unsubscribe()}},error:a,complete:i});r.subscribe(l)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[ts]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return ev(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=dl(t),new t(function(r,i){var a;n.subscribe(function(l){return a=l},function(l){return i(l)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function dl(e){var t;return(t=e??Jd.Promise)!==null&&t!==void 0?t:Promise}function tv(e){return e&&$e(e.next)&&$e(e.error)&&$e(e.complete)}function nv(e){return e&&e instanceof es||tv(e)&&qu(e)}function rv(e){return $e(e==null?void 0:e.lift)}function Er(e){return function(t){if(rv(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function br(e,t,n,r,i){return new iv(e,t,n,r,i)}var iv=function(e){bn(t,e);function t(n,r,i,a,l,c){var d=e.call(this,n)||this;return d.onFinalize=l,d.shouldUnsubscribe=c,d._next=r?function(v){try{r(v)}catch(u){n.error(u)}}:e.prototype._next,d._error=a?function(v){try{a(v)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,d._complete=i?function(){try{i()}catch(v){n.error(v)}finally{this.unsubscribe()}}:e.prototype._complete,d}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(es),ov=$a(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),fi=function(e){bn(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new vl(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new ov},t.prototype.next=function(n){var r=this;Gi(function(){var i,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var l=yr(r.currentObservers),c=l.next();!c.done;c=l.next()){var d=c.value;d.next(n)}}catch(v){i={error:v}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}})},t.prototype.error=function(n){var r=this;Gi(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},t.prototype.complete=function(){var n=this;Gi(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,i=this,a=i.hasError,l=i.isStopped,c=i.observers;return a||l?Mu:(this.currentObservers=null,c.push(n),new Ir(function(){r.currentObservers=null,to(c,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,a=r.thrownError,l=r.isStopped;i?n.error(a):l&&n.complete()},t.prototype.asObservable=function(){var n=new yt;return n.source=this,n},t.create=function(n,r){return new vl(n,r)},t}(yt),vl=function(e){bn(t,e);function t(n,r){var i=e.call(this)||this;return i.destination=n,i.source=r,i}return t.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},t.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:Mu},t}(fi),Gt=function(e){bn(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,a=n._value;if(r)throw i;return this._throwIfClosed(),a},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(fi),av={now:function(){return Date.now()}},sv=function(e){bn(t,e);function t(n,r){return e.call(this)||this}return t.prototype.schedule=function(n,r){return this},t}(Ir),hl={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,mr([e,t],Yn(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},lv=function(e){bn(t,e);function t(n,r){var i=e.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return t.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var a=this.id,l=this.scheduler;return a!=null&&(this.id=this.recycleAsyncId(l,a,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(l,this.id,r),this},t.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),hl.setInterval(n.flush.bind(n,this),i)},t.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&hl.clearInterval(r)},t.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(n,r){var i=!1,a;try{this.work(n)}catch(l){i=!0,a=l||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),a},t.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,a=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,to(a,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(sv),pl=function(){function e(t,n){n===void 0&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(t,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,t).schedule(r,n)},e.now=av.now,e}(),uv=function(e){bn(t,e);function t(n,r){r===void 0&&(r=pl.now);var i=e.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return t.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},t}(pl),cv=new uv(lv),fv=cv,dv=new yt(function(e){return e.complete()});function vv(e){return e&&$e(e.schedule)}function ns(e){return e[e.length-1]}function hv(e){return $e(ns(e))?e.pop():void 0}function rs(e){return vv(ns(e))?e.pop():void 0}function pv(e,t){return typeof ns(e)=="number"?e.pop():t}var is=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Uu(e){return $e(e==null?void 0:e.then)}function Bu(e){return $e(e[ts])}function Ku(e){return Symbol.asyncIterator&&$e(e==null?void 0:e[Symbol.asyncIterator])}function zu(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function yv(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Vu=yv();function Wu(e){return $e(e==null?void 0:e[Vu])}function Hu(e){return Yd(this,arguments,function(){var n,r,i,a;return Lu(this,function(l){switch(l.label){case 0:n=e.getReader(),l.label=1;case 1:l.trys.push([1,,9,10]),l.label=2;case 2:return[4,cr(n.read())];case 3:return r=l.sent(),i=r.value,a=r.done,a?[4,cr(void 0)]:[3,5];case 4:return[2,l.sent()];case 5:return[4,cr(i)];case 6:return[4,l.sent()];case 7:return l.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Yu(e){return $e(e==null?void 0:e.getReader)}function _n(e){if(e instanceof yt)return e;if(e!=null){if(Bu(e))return mv(e);if(is(e))return gv(e);if(Uu(e))return bv(e);if(Ku(e))return Gu(e);if(Wu(e))return _v(e);if(Yu(e))return wv(e)}throw zu(e)}function mv(e){return new yt(function(t){var n=e[ts]();if($e(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function gv(e){return new yt(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function bv(e){return new yt(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Fu)})}function _v(e){return new yt(function(t){var n,r;try{for(var i=yr(e),a=i.next();!a.done;a=i.next()){var l=a.value;if(t.next(l),t.closed)return}}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()})}function Gu(e){return new yt(function(t){kv(e,t).catch(function(n){return t.error(n)})})}function wv(e){return Gu(Hu(e))}function kv(e,t){var n,r,i,a;return Hd(this,void 0,void 0,function(){var l,c;return Lu(this,function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),n=Gd(e),d.label=1;case 1:return[4,n.next()];case 2:if(r=d.sent(),!!r.done)return[3,4];if(l=r.value,t.next(l),t.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=d.sent(),i={error:c},[3,11];case 6:return d.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Tn(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Ju(e,t){return t===void 0&&(t=0),Er(function(n,r){n.subscribe(br(r,function(i){return Tn(r,e,function(){return r.next(i)},t)},function(){return Tn(r,e,function(){return r.complete()},t)},function(i){return Tn(r,e,function(){return r.error(i)},t)}))})}function Qu(e,t){return t===void 0&&(t=0),Er(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function xv(e,t){return _n(e).pipe(Qu(t),Ju(t))}function Sv(e,t){return _n(e).pipe(Qu(t),Ju(t))}function Iv(e,t){return new yt(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function Ev(e,t){return new yt(function(n){var r;return Tn(n,t,function(){r=e[Vu](),Tn(n,t,function(){var i,a,l;try{i=r.next(),a=i.value,l=i.done}catch(c){n.error(c);return}l?n.complete():n.next(a)},0,!0)}),function(){return $e(r==null?void 0:r.return)&&r.return()}})}function Zu(e,t){if(!e)throw new Error("Iterable cannot be null");return new yt(function(n){Tn(n,t,function(){var r=e[Symbol.asyncIterator]();Tn(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function Ov(e,t){return Zu(Hu(e),t)}function Av(e,t){if(e!=null){if(Bu(e))return xv(e,t);if(is(e))return Iv(e,t);if(Uu(e))return Sv(e,t);if(Ku(e))return Zu(e,t);if(Wu(e))return Ev(e,t);if(Yu(e))return Ov(e,t)}throw zu(e)}function sn(e,t){return t?Av(e,t):_n(e)}function mn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=rs(e);return sn(e,n)}function yl(e,t){var n=$e(e)?e:function(){return e},r=function(i){return i.error(n())};return new yt(r)}var Cv=$a(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function fr(e,t){return new Promise(function(n,r){var i=new gr({next:function(a){n(a),i.unsubscribe()},error:r,complete:function(){r(new Cv)}});e.subscribe(i)})}function Pv(e){return e instanceof Date&&!isNaN(e)}function mo(e,t){return Er(function(n,r){var i=0;n.subscribe(br(r,function(a){r.next(e.call(t,a,i++))}))})}var Tv=Array.isArray;function jv(e,t){return Tv(t)?e.apply(void 0,mr([],Yn(t))):e(t)}function Xu(e){return mo(function(t){return jv(e,t)})}var Dv=Array.isArray,Rv=Object.getPrototypeOf,Nv=Object.prototype,Lv=Object.keys;function Mv(e){if(e.length===1){var t=e[0];if(Dv(t))return{args:t,keys:null};if(qv(t)){var n=Lv(t);return{args:n.map(function(r){return t[r]}),keys:n}}}return{args:e,keys:null}}function qv(e){return e&&typeof e=="object"&&Rv(e)===Nv}function Fv(e,t){return e.reduce(function(n,r,i){return n[r]=t[i],n},{})}function no(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=rs(e),r=hv(e),i=Mv(e),a=i.args,l=i.keys;if(a.length===0)return sn([],n);var c=new yt(Uv(a,n,l?function(d){return Fv(l,d)}:yo));return r?c.pipe(Xu(r)):c}function Uv(e,t,n){return n===void 0&&(n=yo),function(r){ml(t,function(){for(var i=e.length,a=new Array(i),l=i,c=i,d=function(u){ml(t,function(){var m=sn(e[u],t),h=!1;m.subscribe(br(r,function(g){a[u]=g,h||(h=!0,c--),c||r.next(n(a.slice()))},function(){--l||r.complete()}))},r)},v=0;v<i;v++)d(v)},r)}}function ml(e,t,n){e?Tn(n,e,t):t()}function Bv(e,t,n,r,i,a,l,c){var d=[],v=0,u=0,m=!1,h=function(){m&&!d.length&&!v&&t.complete()},g=function(k){return v<r?_(k):d.push(k)},_=function(k){v++;var O=!1;_n(n(k,u++)).subscribe(br(t,function(A){t.next(A)},function(){O=!0},void 0,function(){if(O)try{v--;for(var A=function(){var I=d.shift();l||_(I)};d.length&&v<r;)A();h()}catch(I){t.error(I)}}))};return e.subscribe(br(t,g,function(){m=!0,h()})),function(){}}function os(e,t,n){return n===void 0&&(n=1/0),$e(t)?os(function(r,i){return mo(function(a,l){return t(r,a,i,l)})(_n(e(r,i)))},n):(typeof t=="number"&&(n=t),Er(function(r,i){return Bv(r,i,e,n)}))}function Kv(e){return e===void 0&&(e=1/0),os(yo,e)}var zv=["addListener","removeListener"],Vv=["addEventListener","removeEventListener"],Wv=["on","off"];function on(e,t,n,r){if($e(n)&&(r=n,n=void 0),r)return on(e,t,n).pipe(Xu(r));var i=Yn(Gv(e)?Vv.map(function(c){return function(d){return e[c](t,d,n)}}):Hv(e)?zv.map(gl(e,t)):Yv(e)?Wv.map(gl(e,t)):[],2),a=i[0],l=i[1];if(!a&&is(e))return os(function(c){return on(c,t,n)})(_n(e));if(!a)throw new TypeError("Invalid event target");return new yt(function(c){var d=function(){for(var v=[],u=0;u<arguments.length;u++)v[u]=arguments[u];return c.next(1<v.length?v:v[0])};return a(d),function(){return l(d)}})}function gl(e,t){return function(n){return function(r){return e[n](t,r)}}}function Hv(e){return $e(e.addListener)&&$e(e.removeListener)}function Yv(e){return $e(e.on)&&$e(e.off)}function Gv(e){return $e(e.addEventListener)&&$e(e.removeEventListener)}function Jv(e,t,n){return n===void 0&&(n=fv),new yt(function(r){var i=Pv(e)?1e3-n.now():e;i<0&&(i=0);var a=0;return n.schedule(function(){r.closed||(r.next(a++),r.complete())},i)})}function $u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=rs(e),r=pv(e,1/0),i=e;return i.length?i.length===1?_n(i[0]):Kv(r)(sn(i,n)):dv}function Qv(e,t){return Er(function(n,r){var i=0;n.subscribe(br(r,function(a){return e.call(t,a,i++)&&r.next(a)}))})}function Zv(e){e===void 0&&(e={});var t=e.connector,n=t===void 0?function(){return new fi}:t,r=e.resetOnError,i=r===void 0?!0:r,a=e.resetOnComplete,l=a===void 0?!0:a,c=e.resetOnRefCountZero,d=c===void 0?!0:c;return function(v){var u,m,h,g=0,_=!1,k=!1,O=function(){m==null||m.unsubscribe(),m=void 0},A=function(){O(),u=h=void 0,_=k=!1},I=function(){var x=u;A(),x==null||x.unsubscribe()};return Er(function(x,C){g++,!k&&!_&&O();var q=h=h??n();C.add(function(){g--,g===0&&!k&&!_&&(m=ca(I,d))}),q.subscribe(C),!u&&g>0&&(u=new gr({next:function(L){return q.next(L)},error:function(L){k=!0,O(),m=ca(A,i,L),q.error(L)},complete:function(){_=!0,O(),m=ca(A,l),q.complete()}}),_n(x).subscribe(u))})(v)}}function ca(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t===!0){e();return}if(t!==!1){var i=new gr({next:function(){i.unsubscribe(),e()}});return _n(t.apply(void 0,mr([],Yn(n)))).subscribe(i)}}var Ea=function(e,t){return Ea=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ea(e,t)};function Or(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Ea(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Ce(e,t,n,r){return new(n||(n=Promise))(function(i,a){function l(v){try{d(r.next(v))}catch(u){a(u)}}function c(v){try{d(r.throw(v))}catch(u){a(u)}}function d(v){var u;v.done?i(v.value):(u=v.value,u instanceof n?u:new n(function(m){m(u)})).then(l,c)}d((r=r.apply(e,[])).next())})}function ec(e,t){var n,r,i,a,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(d){return function(v){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return l.label++,{value:u[1],done:!1};case 5:l.label++,r=u[1],u=[0];continue;case 7:u=l.ops.pop(),l.trys.pop();continue;default:if(i=l.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){l=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){l.label=u[1];break}if(u[0]===6&&l.label<i[1]){l.label=i[1],i=u;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(u);break}i[2]&&l.ops.pop(),l.trys.pop();continue}u=t.call(e,l)}catch(m){u=[6,m],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([d,v])}}}function ro(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ai(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),l=[];try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(c){i={error:c}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return l}function si(e,t,n){if(arguments.length===2)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function dr(e){return this instanceof dr?(this.v=e,this):new dr(e)}function Xv(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(m){i[m]&&(r[m]=function(h){return new Promise(function(g,_){a.push([m,h,g,_])>1||c(m,h)})})}function c(m,h){try{(function(g){g.value instanceof dr?Promise.resolve(g.value.v).then(d,v):u(a[0][2],g)})(i[m](h))}catch(g){u(a[0][3],g)}}function d(m){c("next",m)}function v(m){c("throw",m)}function u(m,h){m(h),a.shift(),a.length&&c(a[0][0],a[0][1])}}function $v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=ro(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(a){return new Promise(function(l,c){(function(d,v,u,m){Promise.resolve(m).then(function(h){d({value:h,done:u})},v)})(l,c,(a=e[i](a)).done,a.value)})}}}function tc(e){if(!e)throw new Error("Assertion Failed")}const eh={}.hasOwnProperty;function io(e,t,n){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){tc(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)io(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var l=t.substr(0,a),c=t.substr(a+1);if(c==="")n===void 0?Array.isArray(e)?isNaN(parseInt(l))||e.splice(parseInt(l),1):delete e[l]:e[l]=n;else{var d=e[l];d&&function(v,u){return eh.call(v,u)}(e,l)||(d=e[l]={}),io(d,c,n)}}else n===void 0?Array.isArray(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}const nc=typeof self<"u"&&typeof crypto<"u"?(e,t=crypto.getRandomValues.bind(crypto))=>{const n=new Uint8Array(e);return t(n),self.btoa(String.fromCharCode.apply(null,n))}:typeof Buffer<"u"?(e,t=th)=>{const n=Buffer.alloc(e);return t(n),n.toString("base64")}:()=>{throw new Error("No implementation of randomString was found")};function th(e){for(let t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}function as(e){return typeof e=="string"||!!(Array.isArray(e)&&e.some(t=>as(t))&&e.every(rc))}function rc(e){return typeof e=="string"||typeof e=="number"||Array.isArray(e)&&e.every(rc)}function nh(e,t,n){const r=e[t]||(e[t]={}),i=n.keys.map(a=>typeof a=="string"?a:JSON.stringify(a));switch(n.type){case"insert":case"upsert":i.forEach((a,l)=>{r[a]={type:"ups",val:n.values[l]}});break;case"update":case"modify":i.forEach((a,l)=>{const c=n.type==="update"?n.changeSpecs[l]:n.changeSpec,d=r[a];if(d)switch(d.type){case"ups":for(const[v,u]of Object.entries(c))io(d.val,v,u);break;case"del":break;case"upd":Object.assign(d.mod,c)}else r[a]={type:"upd",mod:c}});break;case"delete":i.forEach(a=>{r[a]={type:"del"}})}return e}function bl(e,t){for(const{table:n,muts:r}of t)for(const i of r)nh(e,n,i)}function vt(e){return typeof e=="function"}function Nt(e){return function(t){if(function(n){return vt(n==null?void 0:n.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var ic=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function oc(e){return vt(e==null?void 0:e.then)}var _l,qi,fa=(_l=function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}},(qi=_l(function(e){Error.call(e),e.stack=new Error().stack})).prototype=Object.create(Error.prototype),qi.prototype.constructor=qi,qi);function Oa(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var go=function(){function e(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var n,r,i,a,l;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var d=ro(c),v=d.next();!v.done;v=d.next())v.value.remove(this)}catch(k){n={error:k}}finally{try{v&&!v.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}else c.remove(this);var u=this.initialTeardown;if(vt(u))try{u()}catch(k){l=k instanceof fa?k.errors:[k]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var h=ro(m),g=h.next();!g.done;g=h.next()){var _=g.value;try{wl(_)}catch(k){l=l??[],k instanceof fa?l=si(si([],ai(l)),ai(k.errors)):l.push(k)}}}catch(k){i={error:k}}finally{try{g&&!g.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}}if(l)throw new fa(l)}},e.prototype.add=function(n){var r;if(n&&n!==this)if(this.closed)wl(n);else{if(n instanceof e){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(n)}},e.prototype._hasParent=function(n){var r=this._parentage;return r===n||Array.isArray(r)&&r.includes(n)},e.prototype._addParent=function(n){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(n),r):r?[r,n]:n},e.prototype._removeParent=function(n){var r=this._parentage;r===n?this._parentage=null:Array.isArray(r)&&Oa(r,n)},e.prototype.remove=function(n){var r=this._finalizers;r&&Oa(r,n),n instanceof e&&n._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function ac(e){return e instanceof go||e&&"closed"in e&&vt(e.remove)&&vt(e.add)&&vt(e.unsubscribe)}function wl(e){vt(e)?e():e.unsubscribe()}go.EMPTY;var rh={Promise:void 0},ih={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,si([e,t],ai(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function sc(e){ih.setTimeout(function(){throw e})}function Aa(){}var ss=function(e){function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,ac(n)&&n.add(r)):r.destination=ah,r}return Or(t,e),t.create=function(n,r,i){return new Ca(n,r,i)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(go),oh=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Fi(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Fi(r)}else Fi(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Fi(n)}},e}(),Ca=function(e){function t(n,r,i){var a,l=e.call(this)||this;return vt(n)||!n?a={next:n??void 0,error:r??void 0,complete:i??void 0}:a=n,l.destination=new oh(a),l}return Or(t,e),t}(ss);function Fi(e){sc(e)}var ah={closed:!0,next:Aa,error:function(e){throw e},complete:Aa},ls=typeof Symbol=="function"&&Symbol.observable||"@@observable";function bo(e){return e}var Jt=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var i,a=this,l=(i=t)&&i instanceof ss||function(c){return c&&vt(c.next)&&vt(c.error)&&vt(c.complete)}(i)&&ac(i)?t:new Ca(t,n,r);return function(){var c=a,d=c.operator,v=c.source;l.add(d?d.call(l,v):v?a._subscribe(l):a._trySubscribe(l))}(),l},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return new(n=kl(n))(function(i,a){var l=new Ca({next:function(c){try{t(c)}catch(d){a(d),l.unsubscribe()}},error:a,complete:i});r.subscribe(l)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[ls]=function(){return this},e.prototype.pipe=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return((t=n).length===0?bo:t.length===1?t[0]:function(i){return t.reduce(function(a,l){return l(a)},i)})(this)},e.prototype.toPromise=function(t){var n=this;return new(t=kl(t))(function(r,i){var a;n.subscribe(function(l){return a=l},function(l){return i(l)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function kl(e){var t;return(t=e??rh.Promise)!==null&&t!==void 0?t:Promise}function lc(e){return vt(e[ls])}function uc(e){return Symbol.asyncIterator&&vt(e==null?void 0:e[Symbol.asyncIterator])}function cc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var fc=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator";function dc(e){return vt(e==null?void 0:e[fc])}function vc(e){return Xv(this,arguments,function(){var t,n,r;return ec(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,dr(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,dr(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,dr(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function hc(e){return vt(e==null?void 0:e.getReader)}function Gn(e){if(e instanceof Jt)return e;if(e!=null){if(lc(e))return i=e,new Jt(function(a){var l=i[ls]();if(vt(l.subscribe))return l.subscribe(a);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(ic(e))return r=e,new Jt(function(a){for(var l=0;l<r.length&&!a.closed;l++)a.next(r[l]);a.complete()});if(oc(e))return n=e,new Jt(function(a){n.then(function(l){a.closed||(a.next(l),a.complete())},function(l){return a.error(l)}).then(null,sc)});if(uc(e))return xl(e);if(dc(e))return t=e,new Jt(function(a){var l,c;try{for(var d=ro(t),v=d.next();!v.done;v=d.next()){var u=v.value;if(a.next(u),a.closed)return}}catch(m){l={error:m}}finally{try{v&&!v.done&&(c=d.return)&&c.call(d)}finally{if(l)throw l.error}}a.complete()});if(hc(e))return xl(vc(e))}var t,n,r,i;throw cc(e)}function xl(e){return new Jt(function(t){(function(n,r){var i,a,l,c;return Ce(this,void 0,void 0,function(){var d,v;return ec(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),i=$v(n),u.label=1;case 1:return[4,i.next()];case 2:if((a=u.sent()).done)return[3,4];if(d=a.value,r.next(d),r.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return v=u.sent(),l={error:v},[3,11];case 6:return u.trys.push([6,,9,10]),a&&!a.done&&(c=i.return)?[4,c.call(i)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(l)throw l.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})})(e,t).catch(function(n){return t.error(n)})})}function Rt(e,t,n,r,i){return new sh(e,t,n,r,i)}var sh=function(e){function t(n,r,i,a,l,c){var d=e.call(this,n)||this;return d.onFinalize=l,d.shouldUnsubscribe=c,d._next=r?function(v){try{r(v)}catch(u){n.error(u)}}:e.prototype._next,d._error=a?function(v){try{a(v)}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._error,d._complete=i?function(){try{i()}catch(v){n.error(v)}finally{this.unsubscribe()}}:e.prototype._complete,d}return Or(t,e),t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(ss),lh=function(e){function t(n,r){return e.call(this)||this}return Or(t,e),t.prototype.schedule=function(n,r){return this},t}(go),Pa={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Pa.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,si([e,t],ai(n))):setInterval.apply(void 0,si([e,t],ai(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},uh=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return Or(t,e),t.prototype.schedule=function(n,r){if(r===void 0&&(r=0),this.closed)return this;this.state=n;var i=this.id,a=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(a,i,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(a,this.id,r),this},t.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),Pa.setInterval(n.flush.bind(n,this),i)},t.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;Pa.clearInterval(r)},t.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(n,r){var i,a=!1;try{this.work(n)}catch(l){a=!0,i=l||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),i},t.prototype.unsubscribe=function(){if(!this.closed){var n=this.id,r=this.scheduler,i=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Oa(i,this),n!=null&&(this.id=this.recycleAsyncId(r,n,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(lh),ch={now:function(){return Date.now()}},Sl=function(){function e(t,n){n===void 0&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(t,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,t).schedule(r,n)},e.now=ch.now,e}(),us=new(function(e){function t(n,r){r===void 0&&(r=Sl.now);var i=e.call(this,n,r)||this;return i.actions=[],i._active=!1,i._scheduled=void 0,i}return Or(t,e),t.prototype.flush=function(n){var r=this.actions;if(this._active)r.push(n);else{var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}}},t}(Sl))(uh),fh=us;function pc(e){return e&&vt(e.schedule)}function dh(e,t,n){e===void 0&&(e=0),n===void 0&&(n=fh);var r=-1;return t!=null&&(pc(t)?n=t:r=t),new Jt(function(i){var a,l=(a=e)instanceof Date&&!isNaN(a)?+e-n.now():e;l<0&&(l=0);var c=0;return n.schedule(function(){i.closed||(i.next(c++),0<=r?this.schedule(void 0,r):i.complete())},l)})}function yc(e){return pc((t=e)[t.length-1])?e.pop():void 0;var t}function jn(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Ta(e){return Nt(function(t,n){var r,i=null,a=!1;i=t.subscribe(Rt(n,void 0,void 0,function(l){r=Gn(e(l,Ta(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function Il(e,t){return t===void 0&&(t=0),Nt(function(n,r){n.subscribe(Rt(r,function(i){return jn(r,e,function(){return r.next(i)},t)},function(){return jn(r,e,function(){return r.complete()},t)},function(i){return jn(r,e,function(){return r.error(i)},t)}))})}function El(e,t){return t===void 0&&(t=0),Nt(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Ol(e,t){if(!e)throw new Error("Iterable cannot be null");return new Jt(function(n){jn(n,t,function(){var r=e[Symbol.asyncIterator]();jn(n,t,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function vh(e,t){if(e!=null){if(lc(e))return function(n,r){return Gn(n).pipe(El(r),Il(r))}(e,t);if(ic(e))return function(n,r){return new Jt(function(i){var a=0;return r.schedule(function(){a===n.length?i.complete():(i.next(n[a++]),i.closed||this.schedule())})})}(e,t);if(oc(e))return function(n,r){return Gn(n).pipe(El(r),Il(r))}(e,t);if(uc(e))return Ol(e,t);if(dc(e))return function(n,r){return new Jt(function(i){var a;return jn(i,r,function(){a=n[fc](),jn(i,r,function(){var l,c,d;try{c=(l=a.next()).value,d=l.done}catch(v){return void i.error(v)}d?i.complete():i.next(c)},0,!0)}),function(){return vt(a==null?void 0:a.return)&&a.return()}})}(e,t);if(hc(e))return function(n,r){return Ol(vc(n),r)}(e,t)}throw cc(e)}function an(e,t){return Nt(function(n,r){var i=0;n.subscribe(Rt(r,function(a){r.next(e.call(t,a,i++))}))})}function cs(e,t,n){return n===void 0&&(n=1/0),vt(t)?cs(function(r,i){return an(function(a,l){return t(r,a,i,l)})(Gn(e(r,i)))},n):(typeof t=="number"&&(n=t),Nt(function(r,i){return function(a,l,c,d,v,u,m,h){var g=[],_=0,k=0,O=!1,A=function(){!O||g.length||_||l.complete()},I=function(C){return _<d?x(C):g.push(C)},x=function(C){u&&l.next(C),_++;var q=!1;Gn(c(C,k++)).subscribe(Rt(l,function(L){v==null||v(L),u?I(L):l.next(L)},function(){q=!0},void 0,function(){if(q)try{_--;for(var L=function(){var V=g.shift();m?jn(l,m,function(){return x(V)}):x(V)};g.length&&_<d;)L();A()}catch(V){l.error(V)}}))};return a.subscribe(Rt(l,I,function(){O=!0,A()})),function(){h==null||h()}}(r,i,e,n)}))}function hh(){return(e=1)===void 0&&(e=1/0),cs(bo,e);var e}function Al(e,t){return t===void 0&&(t=us),Nt(function(n,r){var i=null,a=null,l=null,c=function(){if(i){i.unsubscribe(),i=null;var v=a;a=null,r.next(v)}};function d(){var v=l+e,u=t.now();if(u<v)return i=this.schedule(void 0,v-u),void r.add(i);c()}n.subscribe(Rt(r,function(v){a=v,l=t.now(),i||(i=t.schedule(d,e),r.add(i))},function(){c(),r.complete()},void 0,function(){a=i=null}))})}function ja(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return hh()((e=n,(t=yc(n))?vh(e,t):Gn(e)))}var ph=new Jt(function(e){return e.complete()});function lr(e){return e<=0?function(){return ph}:Nt(function(t,n){var r=0;t.subscribe(Rt(n,function(i){++r<=e&&(n.next(i),e<=r&&n.complete())}))})}function mc(e,t){return t?function(n){return ja(t.pipe(lr(1),Nt(function(r,i){r.subscribe(Rt(i,Aa))})),n.pipe(mc(e)))}:cs(function(n,r){return e(n,r).pipe(lr(1),function(i){return an(function(){return i})}(n))})}function gc(e,t){t===void 0&&(t=us);var n=dh(e,t);return mc(function(){return n})}function bc(e,t){return t===void 0&&(t=bo),e=e??yh,Nt(function(n,r){var i,a=!0;n.subscribe(Rt(r,function(l){var c=t(l);!a&&e(i,c)||(a=!1,i=c,r.next(l))}))})}function yh(e,t){return e===t}function rn(e,t){return Nt(function(n,r){var i=0;n.subscribe(Rt(r,function(a){return e.call(t,a,i++)&&r.next(a)}))})}function Cl(e){return rn(function(t,n){return e<=n})}function mh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=yc(e);return Nt(function(r,i){(n?ja(e,r,n):ja(e,r)).subscribe(i)})}function At(e,t){return Nt(function(n,r){var i=null,a=0,l=!1,c=function(){return l&&!i&&r.complete()};n.subscribe(Rt(r,function(d){i==null||i.unsubscribe();var v=0,u=a++;Gn(e(d,u)).subscribe(i=Rt(r,function(m){return r.next(t?t(d,m,u,v++):m)},function(){i=null,c()}))},function(){l=!0,c()}))})}function Pl(e,t,n){var r=vt(e)||t||n?{next:e,error:t,complete:n}:e;return r?Nt(function(i,a){var l;(l=r.subscribe)===null||l===void 0||l.call(r);var c=!0;i.subscribe(Rt(a,function(d){var v;(v=r.next)===null||v===void 0||v.call(r,d),a.next(d)},function(){var d;c=!1,(d=r.complete)===null||d===void 0||d.call(r),a.complete()},function(d){var v;c=!1,(v=r.error)===null||v===void 0||v.call(r,d),a.error(d)},function(){var d,v;c&&((d=r.unsubscribe)===null||d===void 0||d.call(r)),(v=r.finalize)===null||v===void 0||v.call(r)}))}):bo}function _c(e,t){return Ce(this,void 0,void 0,function*(){try{const n=yield navigator.serviceWorker.ready;if(t==="push"&&n.sync&&(yield n.sync.register(`dexie-cloud:${e.name}`)),!n.active)throw new Error("Failed to trigger sync - there's no active service worker");return void n.active.postMessage({type:"dexie-cloud-sync",dbName:e.name,purpose:t})}catch{}})}function yn(e,t){e.cloud.usingServiceWorker?_c(e,t):e.localSyncEvent.next({purpose:t})}const wc=typeof Buffer<"u"?e=>Buffer.from(e,"base64"):e=>{const t=atob(e),n=t.length,r=new Uint8Array(n);for(var i=0;i<n;i++)r[i]=t.charCodeAt(i);return r},di=typeof Buffer<"u"?e=>ArrayBuffer.isView(e)?Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"):Buffer.from(e).toString("base64"):e=>{const t=ArrayBuffer.isView(e)?e:new Uint8Array(e),n=[];for(let r=0,i=t.length;r<i;r+=4096){const a=t.subarray(r,r+4096);n.push(String.fromCharCode.apply(null,a))}return btoa(n.join(""))};class Da extends Error{constructor({title:t,message:n,messageCode:r,messageParams:i}){super(n),this.name="TokenErrorResponseError",this.title=t,this.messageCode=r,this.messageParams=i}}function vi(e,t){return new Promise((n,r)=>{const i=Object.assign(Object.assign({submitLabel:"Submit",cancelLabel:"Cancel"},t),{onSubmit:a=>{e.next(void 0),n(a)},onCancel:()=>{e.next(void 0),r(new at.AbortError("User cancelled"))}});e.next(i)})}function Ra(e,t,...n){return vi(e,{type:"message-alert",title:t,alerts:n,fields:{},submitLabel:"OK",cancelLabel:null})}function Tl(e,t,n){return Ce(this,void 0,void 0,function*(){let r=n||"";for(;!r||!/^[\w-+.]+@([\w-]+\.)+[\w-]{2,10}(\sas\s[\w-+.]+@([\w-]+\.)+[\w-]{2,10})?$/.test(r);)r=(yield vi(e,{type:"email",title:t,alerts:r?[{type:"error",messageCode:"INVALID_EMAIL",message:"Please enter a valid email address",messageParams:{}}]:[],fields:{email:{type:"email",placeholder:"you@somedomain.com"}}})).email;return r})}function jl(e,t,n){return Ce(this,void 0,void 0,function*(){const r=[{type:"info",messageCode:"OTP_SENT",message:"A One-Time password has been sent to {email}",messageParams:{email:t}}];n&&r.push(n);const{otp:i}=yield vi(e,{type:"otp",title:"Enter OTP",alerts:r,fields:{otp:{type:"otp",label:"OTP",placeholder:"Paste OTP here"}}});return i})}function fs(e){var t,n,r;return Ce(this,void 0,void 0,function*(){const i=yield e.getCurrentUser(),{accessToken:a,accessTokenExpiration:l,refreshToken:c,refreshTokenExpiration:d,claims:v}=i;if(!a)return null;if(((t=l==null?void 0:l.getTime())!==null&&t!==void 0?t:1/0)>Date.now()&&(((n=i.license)===null||n===void 0?void 0:n.status)||"ok")==="ok")return i;if(!c)throw new Error("Refresh token missing");if(((r=d==null?void 0:d.getTime())!==null&&r!==void 0?r:1/0)<=Date.now())throw new Error("Refresh token has expired");const u=yield _o(e.cloud.options.databaseUrl,i);return yield e.table("$logins").update(v.sub,{accessToken:u.accessToken,accessTokenExpiration:u.accessTokenExpiration,claims:u.claims,license:u.license}),u})}function gh(e,t,n,r,i){return Ce(this,void 0,void 0,function*(){return t.accessToken&&t.accessTokenExpiration.getTime()>Date.now()?t:t.refreshToken&&(!t.refreshTokenExpiration||t.refreshTokenExpiration.getTime()>Date.now())?yield _o(e,t):yield function(a,l,c,d){return Ce(this,void 0,void 0,function*(){if(!crypto.subtle)throw typeof location<"u"&&location.protocol==="http:"?new Error("Dexie Cloud Addon needs to use WebCrypto, but your browser has disabled it due to being served from an insecure location. Please serve it from https or http://localhost:<port> (See https://stackoverflow.com/questions/46670556/how-to-enable-crypto-subtle-for-unsecure-origins-in-chrome/46671627#46671627)"):new Error("This browser does not support WebCrypto.");const{privateKey:v,publicKey:u}=yield crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!1,["sign","verify"]);if(!v||!u)throw new Error("Could not generate RSA keypair");a.nonExportablePrivateKey=v;const m=function(h){const g=di(h);return function(_){let k=`-----BEGIN PUBLIC KEY-----
`;for(;_.length>0;)k+=_.substring(0,64)+`
`,_=_.substring(64);return k+="-----END PUBLIC KEY-----",k}(g)}(yield crypto.subtle.exportKey("spki",u));a.publicKey=u;try{const h=yield l({public_key:m,hints:d});if(h.type==="error")throw new Da(h);if(h.type!=="tokens")throw new Error(`Unexpected response type from token endpoint: ${h.type}`);return a.accessToken=h.accessToken,a.accessTokenExpiration=new Date(h.accessTokenExpiration),a.refreshToken=h.refreshToken,h.refreshTokenExpiration&&(a.refreshTokenExpiration=new Date(h.refreshTokenExpiration)),a.userId=h.claims.sub,a.email=h.claims.email,a.name=h.claims.name,a.claims=h.claims,a.license={type:h.userType,status:h.claims.license||"ok"},a.data=h.data,h.evalDaysLeft!=null&&(a.license.evalDaysLeft=h.evalDaysLeft),h.userValidUntil!=null&&(a.license.validUntil=new Date(h.userValidUntil)),h.alerts&&h.alerts.length>0&&(yield vi(c,{type:"message-alert",title:"Authentication Alert",fields:{},alerts:h.alerts})),a}catch(h){if(h instanceof Da)throw yield Ra(c,h.title,{type:"error",messageCode:h.messageCode,message:h.message,messageParams:{}}),h;let g="We're having a problem authenticating right now.";throw h instanceof TypeError&&(g=typeof navigator!==void 0&&!navigator.onLine?"You seem to be offline. Please connect to the internet and try again.":at.debug||typeof location<"u"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1")?`Could not connect to server. Please verify that your origin '${location.origin}' is whitelisted using \`npx dexie-cloud whitelist\``:"Could not connect to server. Please verify the connection.",yield Ra(c,"Authentication Failed",{type:"error",messageCode:"GENERIC_ERROR",message:g,messageParams:{}}).catch(()=>{})),h}})}(t,n,r,i)})}function _o(e,t){return Ce(this,void 0,void 0,function*(){if(!t.refreshToken)throw new Error("Cannot refresh token - refresh token is missing.");if(!t.nonExportablePrivateKey)throw new Error("login.nonExportablePrivateKey is missing - cannot sign refresh token without a private key.");const n=Date.now(),r="RSASSA-PKCS1-v1_5",i=new TextEncoder().encode(t.refreshToken+n),a=yield crypto.subtle.sign(r,t.nonExportablePrivateKey,i),l=di(a),c={grant_type:"refresh_token",refresh_token:t.refreshToken,scopes:["ACCESS_DB"],signature:l,signing_algorithm:r,time_stamp:n},d=yield fetch(`${e}/token`,{body:JSON.stringify(c),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});if(d.status!==200)throw new Error(`RefreshToken: Status ${d.status} from ${e}/token`);const v=yield d.json();if(v.type==="error")throw new Da(v);return t.accessToken=v.accessToken,t.accessTokenExpiration=v.accessTokenExpiration?new Date(v.accessTokenExpiration):void 0,t.claims=v.claims,t.license={type:v.userType,status:v.claims.license||"ok"},v.evalDaysLeft!=null&&(t.license.evalDaysLeft=v.evalDaysLeft),v.userValidUntil!=null&&(t.license.validUntil=new Date(v.userValidUntil)),v.data&&(t.data=v.data),t})}const Dl=new WeakMap;class ds{constructor(t,n){Dl.set(this,t),Object.assign(this,n)}static load(t,n){return t.table("$logins").get(n).then(r=>new ds(t,r||{userId:n,claims:{sub:n},lastLogin:new Date(0)}))}save(){return Ce(this,void 0,void 0,function*(){Dl.get(this).table("$logins").put(this)})}}const Dt={userId:"unauthorized",name:"Unauthorized",claims:{sub:"unauthorized"},lastLogin:new Date(0)};try{Object.freeze(Dt),Object.freeze(Dt.claims)}catch{}function kc(e,t){return fr(sn(e).pipe(Qv(t)))}function xc(e){return Ce(this,void 0,void 0,function*(){const t=yield Na(e);if(t){if(!(yield function(n,r,i){return Ce(this,void 0,void 0,function*(){const a=[{type:"warning",messageCode:"LOGOUT_CONFIRMATION",message:`{numUnsyncedChanges} unsynced changes will get lost!
                Logout anyway?`,messageParams:{currentUserId:r,numUnsyncedChanges:i.toString()}}];return yield vi(n,{type:"logout-confirmation",title:"Confirm Logout",alerts:a,fields:{},submitLabel:"Confirm logout",cancelLabel:"Cancel"}).then(()=>!0).catch(()=>!1)})}(e.cloud.userInteraction,e.cloud.currentUserId,t)))throw new Error("User cancelled logout due to unsynced changes");yield Na(e,{deleteUnsyncedData:!0})}})}function Na(e,{deleteUnsyncedData:t=!1}={}){return Ce(this,void 0,void 0,function*(){const[n,r]=yield e.dx.transaction("rw",e.dx.tables,i=>Ce(this,void 0,void 0,function*(){const a=i.idbtrans;a.disableChangeTracking=!0,a.disableAccessControl=!0;const l=i.storeNames.filter(d=>d.endsWith("_mutations")),c=(yield Promise.all(l.map(d=>i.table(d).count()))).reduce((d,v)=>d+v,0);if(c>0&&!t)return[c,!1];e.$syncState.delete("syncState");for(const d of e.dx.tables)d.name!=="$jobs"&&d.name!=="$syncState"&&d.clear();return[c,!0]}));return r&&(yield kc(e.cloud.currentUser,i=>i.userId===Dt.userId),yield e.cloud.sync({purpose:"pull",wait:!0})),n})}class La extends Error{constructor(t,n){super(n||`${t.status} ${t.statusText}`),this.httpStatus=t.status}get name(){return"HttpError"}}function Ui(e,...t){globalThis.console[e](...t)}function da(e,t){var n;return Ce(this,void 0,void 0,function*(){const r=yield e.getCurrentUser(),i=r.userId;if(r.isLoggedIn&&(!t||!t.email&&!t.userId)){if((((n=r.license)===null||n===void 0?void 0:n.status)||"ok")==="ok"&&r.accessToken&&(!r.accessTokenExpiration||r.accessTokenExpiration.getTime()>Date.now()))return!1;if(r.refreshToken&&(!r.refreshTokenExpiration||r.refreshTokenExpiration.getTime()>Date.now()))return yield fs(e),!1}const a=new ds(e,{claims:{},lastLogin:new Date(0)});return yield gh(e.cloud.options.databaseUrl,a,e.cloud.options.fetchTokens||function(l){const{userInteraction:c}=l.cloud;return function({public_key:d,hints:v}){var u;return Ce(this,void 0,void 0,function*(){let m;const h=(u=l.cloud.options)===null||u===void 0?void 0:u.databaseUrl;if(!h)throw new Error("No database URL given.");if((v==null?void 0:v.grant_type)==="demo")m={demo_user:yield Tl(c,"Enter a demo user email",(v==null?void 0:v.email)||(v==null?void 0:v.userId)),grant_type:"demo",scopes:["ACCESS_DB"],public_key:d};else if(v!=null&&v.otpId&&v.otp)m={grant_type:"otp",otp_id:v.otpId,otp:v.otp,scopes:["ACCESS_DB"],public_key:d};else{const k=yield Tl(c,"Enter email address",v==null?void 0:v.email);m=/@demo.local$/.test(k)?{demo_user:k,grant_type:"demo",scopes:["ACCESS_DB"],public_key:d}:{email:k,grant_type:"otp",scopes:["ACCESS_DB"]}}const g=yield fetch(`${h}/token`,{body:JSON.stringify(m),method:"post",headers:{"Content-Type":"application/json",mode:"cors"}});if(g.status!==200){const k=yield g.text();throw yield Ra(c,"Token request failed",{type:"error",messageCode:"GENERIC_ERROR",message:k,messageParams:{}}).catch(()=>{}),new La(g,k)}const _=yield g.json();if(_.type==="tokens"||_.type==="error")return _;if(m.grant_type==="otp"&&"email"in m){if(_.type!=="otp-sent")throw new Error(`Unexpected response from ${h}/token`);const k=yield jl(c,m.email),O=Object.assign(Object.assign({},m),{otp:k||"",otp_id:_.otp_id,public_key:d});let A=yield fetch(`${h}/token`,{body:JSON.stringify(O),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});for(;A.status===401;){const I=yield A.text();O.otp=yield jl(c,m.email,{type:"error",messageCode:"INVALID_OTP",message:I,messageParams:{}}),A=yield fetch(`${h}/token`,{body:JSON.stringify(O),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"})}if(A.status!==200){const I=yield A.text();throw new La(A,I)}return yield A.json()}throw new Error(`Unexpected response from ${h}/token`)})}}(e),e.cloud.userInteraction,t),i!==Dt.userId&&a.userId!==i&&(yield xc(e)),yield function(l,c){return Ce(this,void 0,void 0,function*(){if(c.userId===l.cloud.currentUserId)return;const d=l.table("$logins");yield l.transaction("rw",d,v=>Ce(this,void 0,void 0,function*(){const u=yield d.toArray();yield Promise.all(u.filter(m=>m.userId!==c.userId&&m.isLoggedIn).map(m=>(m.isLoggedIn=!1,d.put(m)))),c.isLoggedIn=!0,c.lastLogin=new Date;try{yield c.save()}catch(m){try{m.name==="DataCloneError"&&(Ui("debug","Login context property names:",Object.keys(c)),Ui("debug","Login context property names:",Object.keys(c)),Ui("debug","Login context:",c),Ui("debug","Login context JSON:",JSON.stringify(c)))}catch{}throw m}})),yield kc(l.cloud.currentUser,v=>v.userId===c.userId)})}(e,a),yn(e,"pull"),a.userId!==i})}const Ma={},ti=typeof self<"u"&&self.document&&typeof navigator<"u"&&navigator.serviceWorker;ti&&ti.ready.then(e=>Ma.registration=e),typeof self<"u"&&"clients"in self&&!self.document&&addEventListener("message",e=>{var t,n;!((n=(t=e.data)===null||t===void 0?void 0:t.type)===null||n===void 0)&&n.startsWith("sw-broadcast-")&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>{var i;return r.id!==((i=e.source)===null||i===void 0?void 0:i.id)&&r.postMessage(e.data)})});class va{constructor(t){this.name=t}subscribe(t){if(!ti)return()=>{};const n=r=>{var i;((i=r.data)===null||i===void 0?void 0:i.type)===`sw-broadcast-${this.name}`&&t(r.data.message)};return ti.addEventListener("message",n),()=>ti.removeEventListener("message",n)}postMessage(t){var n;typeof self.clients=="object"?[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:`sw-broadcast-${this.name}`,message:t})):Ma.registration&&((n=Ma.registration.active)===null||n===void 0||n.postMessage({type:`sw-broadcast-${this.name}`,message:t}))}}const Yr=globalThis["lbc-events"]||(globalThis["lbc-events"]=new Map);class Bi extends yt{constructor(t){const n=typeof BroadcastChannel>"u"?new va(t):new BroadcastChannel(t);super(r=>{function i(c){r.next(c.detail)}function a(c){r.next(c.data)}let l;(function(c,d){Yr.has(c)?Yr.get(c).push(d):Yr.set(c,[d])})(`lbc-${t}`,i);try{n instanceof va?l=n.subscribe(c=>r.next(c)):n.addEventListener("message",a)}catch{}return()=>{(function(c,d){const v=Yr.get(c);if(v){const u=v.indexOf(d);u!==-1&&v.splice(u,1)}})(`lbc-${t}`,i),n instanceof va?l():n.removeEventListener("message",a)}}),this.name=t,this.bc=n}next(t){this.bc.postMessage(t),function(n){const r=Yr.get(n.type);r&&r.forEach(i=>{try{i(n)}catch{}})}(new CustomEvent(`lbc-${this.name}`,{detail:t}))}}function qa({realms:e,inviteRealms:t}){return Ce(this,void 0,void 0,function*(){const n=JSON.stringify([...e.map(a=>({realmId:a,accepted:!0})),...t.map(a=>({realmId:a,accepted:!1}))].sort((a,l)=>a.realmId<l.realmId?-1:a.realmId>l.realmId?1:0)),r=new TextEncoder().encode(n),i=yield crypto.subtle.digest("SHA-1",r);return di(i)})}function Ji(e){return Object.entries(e.cloud.schema||{}).filter(([,{markedForSync:t}])=>t).map(([t])=>e.tables.filter(({name:n})=>n===t)[0]).filter(t=>t)}function vs(e){return`$${e}_mutations`}function Sc(e){var t;const n=(t=/^\$(.*)_mutations$/.exec(e))===null||t===void 0?void 0:t[1];if(!n)throw new Error(`Given mutationTable ${e} is not correct`);return n}const bh=[].concat;function Ic(e){return bh.apply([],e)}function Fa(e,t,{since:n={},limit:r=1/0}={}){return Ce(this,void 0,void 0,function*(){const i=Ic(yield Promise.all(e.map(d=>Ce(this,void 0,void 0,function*(){const v=Sc(d.name),u=n[v];let m=u?d.where("rev").above(u):d;return r<1/0&&(m=m.limit(r)),(yield m.toArray()).map(h=>({table:v,mut:h}))})))).sort((d,v)=>d.mut.txid===v.mut.txid?d.mut.opNo-v.mut.opNo:d.mut.ts-v.mut.ts),a=[];let l=null,c=null;for(const{table:d,mut:v}of i)l&&l.table===d&&c===v.txid?l.muts.push(v):(l={table:d,muts:[v]},c=v.txid,a.push(l));return a})}function Ec(e){const t=new Uint8Array(e);if(typeof crypto<"u")crypto.getRandomValues(t);else for(let n=0;n<e;n++)t[n]=Math.floor(256*Math.random());if(typeof Buffer<"u"&&Buffer.from)return Buffer.from(t).toString("base64");if(typeof btoa<"u")return btoa(String.fromCharCode.apply(null,t));throw new Error("No btoa or Buffer available")}const{toString:_h}={},Rl={replace:function(e){const t=Object.keys(e);let n=null;for(let i=0,a=t.length;i<a;++i)t[i][0]==="$"&&(n=n||[],n.push(t[i]));if(!n)return e;const r={...e};for(const i of n)delete r[i];for(const i of n)r["$"+i]=e[i];return r}};function Oc(...e){const t=e.reduce((r,i)=>({...r,...i}),e.reduce((r,i)=>({...i,...r}),{})),n=new WeakMap;return{stringify(r,i,a){return JSON.stringify(r,function(c){const d=this[c],v=function(u){const m=typeof u;switch(typeof u){case"object":case"function":{if(u===null)return null;const g=Object.getPrototypeOf(u);if(!g)return Rl;let _=n.get(g);if(_!==void 0)return _;const k=(h=u,_h.call(h).slice(8,-1)),O=Object.entries(t).find(([A,I])=>{var x,C;return(C=(x=I==null?void 0:I.test)===null||x===void 0?void 0:x.call(I,u,k))!==null&&C!==void 0?C:A===k});return _=O==null?void 0:O[1],_||(_=Array.isArray(u)?null:typeof u=="function"?t.function||null:Rl),n.set(g,_),_}default:return t[m]}var h}(d);return v?v.replace(d,i,t):d},a)},parse(r,i){const a=[];return JSON.parse(r,function(l,c){const d=c==null?void 0:c.$t;if(d){const u=t[d];c=u?u.revive(c,i,t):c}let v=a[a.length-1];if(v&&v[0]===c){c={...c};for(const u of v[1])delete c[u];for(const[u,m]of Object.entries(v[2]))c[u]=m;a.pop()}if(c===void 0||l[0]==="$"&&l!=="$t"){let u,m;v=a[a.length-1],v&&v[0]===this?(u=v[1],m=v[2]):a.push([this,u=[],m={}]),l[0]==="$"&&l!=="$t"?(u.push(l),m[l.substr(1)]=c):m[l]=void 0}return c})}}}const wh={Blob:{test:(e,t)=>t==="Blob",replace:(e,t)=>{const n=t.length;return t.push(e),{$t:"Blob",mimeType:e.type,i:n}},revive:({i:e,mimeType:t},n)=>new Blob([n[e]],{type:t})}};var kh={number:{replace:e=>{switch(!0){case isNaN(e):return{$t:"number",v:"NaN"};case e===1/0:return{$t:"number",v:"Infinity"};case e===-1/0:return{$t:"number",v:"-Infinity"};default:return e}},revive:({v:e})=>Number(e)}};const xh={bigint:{replace:e=>({$t:"bigint",v:""+e}),revive:e=>BigInt(e.v)}};var Sh={Date:{replace:e=>({$t:"Date",v:isNaN(e.getTime())?"NaN":e.toISOString()}),revive:({v:e})=>new Date(e==="NaN"?NaN:Date.parse(e))}},Ih={Set:{replace:e=>({$t:"Set",v:Array.from(e.entries())}),revive:({v:e})=>new Set(e)}},Eh={Map:{replace:e=>({$t:"Map",v:Array.from(e.entries())}),revive:({v:e})=>new Map(e)}};const Oh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0;var Ah=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","DataView","BigInt64Array","BigUint64Array"].reduce((e,t)=>({...e,[t]:{replace:(n,r,i)=>({$t:t,v:i.ArrayBuffer.replace(n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength),r,i).v}),revive:({v:n},r,i)=>{const a=Oh[t];return a&&new a(i.ArrayBuffer.revive({v:n},r,i))}}}),{});function Ac(e){return function(t){for(var n="",r=0,i=t.length;r<i;r++)n+=Cc[t[r]];return n}(di(e))}function Ch(e){return wc(function(t){if(typeof t!="string")throw new Error("invalid decoder input: "+t);for(var n="",r=0,i=t.length;r<i;r++)n+=Ua[t[r]];return n}(e))}const Ua={"-":"=",0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",A:"K",B:"L",C:"M",D:"N",E:"O",F:"P",G:"Q",H:"R",I:"S",J:"T",K:"U",L:"V",M:"W",N:"X",O:"Y",P:"Z",Q:"a",R:"b",S:"c",T:"d",U:"e",V:"f",W:"g",X:"h",Y:"i",Z:"j",_:"k",a:"l",b:"m",c:"n",d:"o",e:"p",f:"q",g:"r",h:"s",i:"t",j:"u",k:"v",l:"w",m:"x",n:"y",o:"z",p:"0",q:"1",r:"2",s:"3",t:"4",u:"5",v:"6",w:"7",x:"8",y:"9",z:"+","|":"/"},Cc={};for(const e of Object.keys(Ua))Cc[Ua[e]]=e;var Ph={ArrayBuffer:{replace:e=>({$t:"ArrayBuffer",v:Ac(e)}),revive:({v:e})=>{const t=Ch(e);return t.buffer.byteLength===t.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}}};class ha{constructor(t,n){this.buf=t,this.type=n}}function Th(e){const t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return t.responseText}function jh(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}var Dh={Blob:{test:(e,t)=>t==="Blob"||e instanceof ha,replace:e=>({$t:"Blob",v:di(e instanceof ha?e.buf:jh(Th(e))),type:e.type}),revive:({type:e,v:t})=>{const n=wc(t);return typeof Blob!==void 0?new Blob([n]):new ha(n.buffer,e)}}};const Pc={...kh,...xh,...Sh,...Ih,...Eh,...Ah,...Ph,...Dh};function Nl(e){return new Promise((t,n)=>{const r=new FileReader;r.onabort=i=>n(new Error("file read aborted")),r.onerror=i=>n(i.target.error),r.onload=i=>t(i.target.result),r.readAsArrayBuffer(e)})}var Rh={undefined:{replace:()=>({$t:"undefined"}),revive:()=>{}}};const Nh=typeof BigInt=="function"&&typeof BigInt(0)=="bigint";class Ll{toString(){return this.v}constructor(t){this.v=t}}const Lh=Nh?{}:{bigint:{test:e=>e instanceof Ll,replace:e=>Object.assign({$t:"bigint"},e),revive:({v:e})=>new Ll(e)}},Tc=Object.assign(Object.assign(Object.assign({},Rh),Lh),{PropModification:{test:e=>e instanceof ul,replace:e=>Object.assign({$t:"PropModification"},e["@@propmod"]),revive:e=>{var t=function(n,r){var i={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&r.indexOf(a)<0&&(i[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(a=Object.getOwnPropertySymbols(n);l<a.length;l++)r.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(n,a[l])&&(i[a[l]]=n[a[l]])}return i}(e,["$t"]);return new ul(t)}}}),oo=Oc(Pc,Tc),Mh=function(...e){const t=Oc(Pc,wh,...e);return{toBinary(n){const[r,i]=this.stringify(n),a=new ArrayBuffer(4);return new DataView(a).setUint32(0,r.size),new Blob([a,r,i])},stringify(n){const r=[],i=t.stringify(n,r);return[new Blob(r.map(l=>{const c=new ArrayBuffer(4);return new DataView(c).setUint32(0,"byteLength"in l?l.byteLength:l.size),new Blob([c,l])})),i]},async parse(n,r){let i=0;const a=[],l=await Nl(r),c=new DataView(l);for(;i<l.byteLength;){const d=c.getUint32(i);i+=4;const v=l.slice(i,i+d);i+=d,a.push(v)}return t.parse(n,a)},async fromBinary(n){const r=new DataView(await Nl(n.slice(0,4))).getUint32(0),i=n.slice(4,r+4),a=await function(l){return new Promise((c,d)=>{const v=new FileReader;v.onabort=u=>d(new Error("file read aborted")),v.onerror=u=>d(u.target.error),v.onload=u=>c(u.target.result),v.readAsText(l)})}(n.slice(r+4));return await this.parse(a,i)}}}(Tc);function qh(e,t,n){const r=[];for(let i of n){const{table:a,muts:l}=i,c=e.tables.find(u=>u.name===a);if(!c)throw new Error(`Internal error: table ${a} not found in DBCore schema`);const{primaryKey:d}=c;let v=i;l.forEach((u,m)=>{const h=!d.outbound&&(u.type==="upsert"||u.type==="insert");u.keys.forEach((g,_)=>{if(Array.isArray(g)){v===i&&(v=Ml(i,h));const k=v.muts[m],O=JSON.stringify(g);k.keys[_]=O}else if(g[0]==="#"){v===i&&(v=Ml(i,h));const k=v.muts[m];if(!t.isLoggedIn)throw new Error("Internal error: Cannot sync private IDs before authenticated");const O=`${g}:${t.userId}`;k.keys[_]=O,h&&at.setByKeyPath(k.values[_],d.keyPath,O)}})}),r.push(v)}return r}function Ml(e,t){return Object.assign(Object.assign({},e),{muts:t?e.muts.map(n=>n.type!=="insert"&&n.type!=="upsert"||!n.values?Object.assign(Object.assign({},n),{keys:n.keys.slice()}):Object.assign(Object.assign({},n),{keys:n.keys.slice(),values:n.values.slice()})):e.muts.map(n=>Object.assign(Object.assign({},n),{keys:n.keys.slice()}))})}let Ba=new WeakMap;function jc(e){var t,n;return Ce(this,void 0,void 0,function*(){const r=((n=(t=Ba.get(e))===null||t===void 0?void 0:t.getTime())!==null&&n!==void 0?n:0)-Date.now();r>0&&(yield new Promise(i=>setTimeout(i,r)))})}function Fh(e,t,n,r,i,a,l,c){return Ce(this,void 0,void 0,function*(){const d={Accept:"application/json, application/x-bison, application/x-bison-stream","Content-Type":"application/tson"},v=yield fs(r),u=v==null?void 0:v.accessToken;u&&(d.Authorization=`Bearer ${u}`);const m={v:2,dbID:t==null?void 0:t.remoteDbId,clientIdentity:l,schema:a||{},lastPull:t?{serverRevision:t.serverRevision,realms:t.realms,inviteRealms:t.inviteRealms}:void 0,baseRevs:n,changes:qh(r.dx.core.schema,c,e)};r.syncStateChangedEvent.next({phase:"pushing"});const h=yield fetch(`${i}/sync`,{method:"post",headers:d,credentials:"include",body:oo.stringify(m)});if(r.syncStateChangedEvent.next({phase:"pulling"}),function(g,_){const k=_.headers.get("Ratelimit-Limit"),O=_.headers.get("Ratelimit-Remaining"),A=_.headers.get("Ratelimit-Reset");if(k&&O&&A){const I=Number(k),x=Math.max(0,Number(O)),C=Number(A);if(x<I/2){const q=Math.ceil(C/(x+1));Ba.set(g,new Date(Date.now()+1e3*q))}else Ba.delete(g)}}(r,h),!h.ok)throw new La(h);if(h.headers.get("content-type")==="application/x-bison")return Mh.fromBinary(yield h.blob());{const g=yield h.text();return oo.parse(g)}})}function Gr(e){if(e!=null&&e.cancelled)throw new at.AbortError("Operation was cancelled")}let vr=!1;function Dc(e,t,n,r){return Ce(this,void 0,void 0,function*(){yield e.$baseRevs.bulkPut(Object.keys(t).filter(i=>t[i].markedForSync).map(i=>({tableName:i,clientRev:(n[i]||0)+1,serverRev:r}))),yield e.$baseRevs.where("tableName").noneOf(Object.keys(t).filter(i=>t[i].markedForSync)).delete()})}function Ka(e,t={}){for(const{table:n,muts:r}of e){const i=r.length>0?r[r.length-1].rev:null;t[n]=i||t[n]||0}return t}function Uh(e,t,n){return Ce(this,void 0,void 0,function*(){const r=yield e.bulkGet(t),i=[],a=[];t.forEach((l,c)=>{const d=r[c];if(d){for(const[v,u]of Object.entries(n[c]))if(v===e.schema.primKey.keyPath){if(Wd(u,l)!==0)throw new Error("Cannot change primary key")}else at.setByKeyPath(d,v,u);i.push(l),a.push(d)}}),yield e.schema.primKey.keyPath==null?e.bulkPut(a,i):e.bulkPut(a)})}function Rc(e,t){return Ce(this,void 0,void 0,function*(){for(const{table:n,muts:r}of e){const i=t.table(n);if(!i)continue;const{primaryKey:a}=i.core.schema,l=c=>{switch(c[0]){case"[":if(c.endsWith("]"))try{return JSON.parse(c)}catch{}return c;case"#":return c.endsWith(":"+t.cloud.currentUserId)?c.substr(0,c.length-t.cloud.currentUserId.length-1):c;default:return c}};for(const c of r){const d=c.keys.map(l);switch(c.type){case"insert":a.outbound?yield i.bulkAdd(c.values,d):(d.forEach((v,u)=>{at.setByKeyPath(c.values[u],a.keyPath,v)}),yield i.bulkAdd(c.values));break;case"upsert":a.outbound?yield i.bulkPut(c.values,d):(d.forEach((v,u)=>{at.setByKeyPath(c.values[u],a.keyPath,v)}),yield i.bulkPut(c.values));break;case"modify":d.length===1?yield i.update(d[0],c.changeSpec):yield i.where(":id").anyOf(d).modify(c.changeSpec);break;case"update":yield Uh(i,d,c.changeSpecs);break;case"delete":yield i.bulkDelete(d)}}}})}typeof self<"u"&&typeof navigator<"u"&&(vr=navigator.onLine,self.addEventListener("online",()=>vr=!0),self.addEventListener("offline",()=>vr=!1));const Bh="currentSyncWorker";function li(e,t,n,r){return Nc.apply(this,arguments).then(i=>(r!=null&&r.justCheckIfNeeded||e.syncStateChangedEvent.next({phase:"in-sync"}),i)).catch(i=>Ce(this,void 0,void 0,function*(){return r!=null&&r.justCheckIfNeeded?Promise.reject(i):vr&&(r!=null&&r.retryImmediatelyOnFetchError)&&(i==null?void 0:i.name)==="TypeError"&&/fetch/.test(i==null?void 0:i.message)?(e.syncStateChangedEvent.next({phase:"error",error:i}),yield new Promise(a=>setTimeout(a,500)),yield li(e,t,n,Object.assign(Object.assign({},r),{retryImmediatelyOnFetchError:!1}))):(yield e.$syncState.update("syncState",{timestamp:new Date,error:""+i}),e.syncStateChangedEvent.next({phase:vr?"error":"offline",error:new Error(""+(i==null?void 0:i.message)||i)}),Promise.reject(i))}))}function Nc(e,t,n,{isInitialSync:r,cancelToken:i,justCheckIfNeeded:a,purpose:l}={isInitialSync:!1}){var c;return Ce(this,void 0,void 0,function*(){if(!(!((c=e.cloud.options)===null||c===void 0)&&c.databaseUrl))throw new Error("Internal error: sync must not be called when no databaseUrl is configured");const{databaseUrl:d}=t,v=yield e.getCurrentUser(),u=v.isLoggedIn?Ji(e):[],m=u.map(te=>e.table(vs(te.name))),h=yield e.getPersistedSyncState(),g=!r&&v.isLoggedIn,_=g?function(te,J){const G=(J==null?void 0:J.syncedTables)||[];return Ji(te).filter(ne=>!G.includes(ne.name))}(e,h):[];Gr(i);const k=_.length>0;if(k){if(a)return!0;yield e.transaction("rw",_,te=>Ce(this,void 0,void 0,function*(){te.idbtrans.disableChangeTracking=!0,te.idbtrans.disableAccessControl=!0,yield function(J,G,ne){return Ce(this,void 0,void 0,function*(){const $=new Set(ne||[]);for(const H of J)H.name==="members"?yield H.toCollection().modify(ee=>{$.has(ee.realmId)||ee.userId&&ee.userId!==Dt.userId||(ee.userId=G.userId)}):H.name==="roles"||(H.name==="realms"?yield H.toCollection().modify(ee=>{$.has(ee.realmId)||ee.owner!==void 0&&ee.owner!==Dt.userId||(ee.owner=G.userId)}):yield H.toCollection().modify(ee=>{ee.realmId&&$.has(ee.realmId)||(ee.owner&&ee.owner!==Dt.userId||(ee.owner=G.userId),ee.realmId&&ee.realmId!==Dt.userId||(ee.realmId=G.userId))}))})}(_,v,h==null?void 0:h.realms)})),Gr(i)}const[O,A,I]=yield e.transaction("r",e.tables,()=>Ce(this,void 0,void 0,function*(){const te=yield e.getPersistedSyncState();let J=yield e.$baseRevs.toArray();J=J.filter(ne=>u.some($=>$.name===ne.tableName));let G=yield Fa(m);if(Gr(i),k){const ne=[...(h==null?void 0:h.realms)||[],...(h==null?void 0:h.inviteRealms)||[]],$=yield function(H,ee,ie,oe){return Ce(this,void 0,void 0,function*(){const Re=`upload-${Ec(8)}`;if(ee.isLoggedIn&&H.length>0){const je=new Set(oe||[]);return(yield Promise.all(H.map(le=>Ce(this,void 0,void 0,function*(){const{extractKey:B}=le.core.schema.primaryKey;if(!B)return{table:le.name,muts:[]};const Le=ie[le.name],Fe=Le!=null&&Le.generatedGlobalId?le.filter(Xe=>{return B(Xe),!je.has(Xe.realmId||"")&&(de=B(Xe),!(we=Le==null?void 0:Le.idPrefix)||typeof de=="string"&&de.startsWith(we));var de,we}):le.filter(Xe=>{const de=B(Xe);return!je.has(Xe.realmId||"")&&as(de)}),Ke=yield Fe.toArray();if(Ke.length>0){const Xe={type:"upsert",values:Ke,keys:Ke.map(B),userId:ee.userId,txid:Re};return{table:le.name,muts:[Xe]}}return{table:le.name,muts:[]}})))).filter(le=>le.muts.length>0)}return[]})}(_,v,n,ne);return Gr(i),G=G.concat($),[G,te,J]}return[G,te,J]})),x=O.some(te=>te.muts.some(J=>J.keys.length>0));if(a)return x;if(l==="push"&&!x)return!1;const C=Ka(O,A==null?void 0:A.latestRevisions),q=(A==null?void 0:A.clientIdentity)||nc(16);Gr(i);const L=yield Fh(O,A,I,e,d,n,q,v);return(yield e.transaction("rw",e.tables,te=>Ce(this,void 0,void 0,function*(){te.idbtrans.disableChangeTracking=!0,te.idbtrans.disableAccessControl=!0;for(const H of Object.keys(n))L.schema[H]&&(n[H]=L.schema[H]);yield e.$syncState.put(n,"schema");const J=yield Fa(m,0,{since:C});for(const H of m){const ee=Sc(H.name);if(J.some(ie=>ie.table===ee&&ie.muts.length>0)){if(C[ee]){const ie=C[ee]||0;yield Promise.all([H.where("rev").belowOrEqual(ie).delete(),e.$baseRevs.where(":id").between([ee,-1/0],[ee,ie+1],!0,!0).reverse().offset(1).delete()])}}else yield Promise.all([H.clear(),e.$baseRevs.where({tableName:ee}).delete()])}Ka(J,C),yield Dc(e,n,C,L.serverRevision);const G=yield e.getPersistedSyncState();yield function(H,ee,ie){return Ce(this,void 0,void 0,function*(){const oe=new Set,Re=new Set,je=ie?ie.realms:[],le=ie?ie.inviteRealms:[],B=new Set(ee.realms),Le=new Set(ee.realms.concat(ee.inviteRealms));for(const Fe of je)B.has(Fe)||(Re.add(Fe),Le.has(Fe)||oe.add(Fe));for(const Fe of le.concat(je))Le.has(Fe)||oe.add(Fe);if(oe.size>0||Re.size>0){const Fe=Ji(H);for(const Ke of Fe){let Xe=["realms","members","roles"].includes(Ke.name)?oe:Re;Xe.size!==0&&(Ke.schema.indexes.some(de=>de.keyPath==="realmId"||Array.isArray(de.keyPath)&&de.keyPath[0]==="realmId")?yield Ke.where("realmId").anyOf([...Xe]).delete():yield Ke.filter(de=>!!(de!=null&&de.realmId)&&Xe.has(de.realmId)).delete())}}})}(e,L,G);const ne=G||{syncedTables:[],latestRevisions:{},realms:[],inviteRealms:[],clientIdentity:q};g&&(ne.syncedTables=u.map(H=>H.name).concat(_.map(H=>H.name))),ne.latestRevisions=C,ne.remoteDbId=L.dbId,ne.initiallySynced=!0,ne.realms=L.realms,ne.inviteRealms=L.inviteRealms,ne.serverRevision=L.serverRevision,ne.timestamp=new Date,delete ne.error;const $=Lc(L.changes,J);return yield Rc($,e),e.$syncState.put(ne,"syncState"),J.length===0})))?(e.syncCompleteEvent.next(),!1):(yield jc(e),yield Nc(e,t,n,{isInitialSync:r,cancelToken:i}))})}function Lc(e,t){const n={};bl(n,e);const r={};return bl(r,t),function(i,a){var l,c,d;for(const[v,u]of Object.entries(a))for(const[m,h]of Object.entries(u))switch(h.type){case"ups":{const g=(l=i[v])===null||l===void 0?void 0:l[m];if(g)switch(g.type){case"ups":case"upd":delete i[v][m]}}break;case"del":(c=i[v])===null||c===void 0||delete c[m];break;case"upd":{const g=(d=i[v])===null||d===void 0?void 0:d[m];if(g)switch(g.type){case"ups":for(const[_,k]of Object.entries(h.mod))io(g.val,_,k);break;case"del":break;case"upd":for(const _ of Object.keys(h.mod))delete g.mod[_]}break}}}(n,r),function(i,a=""){a||(a=nc(16));const l={};for(const[d,v]of Object.entries(i))for(const[u,m]of Object.entries(v)){const h=l[d]||(l[d]={});(h[m.type]||(h[m.type]=[])).push(Object.assign({key:u},m))}const c=[];for(const[d,v]of Object.entries(l)){const u={table:d,muts:[]};for(const[m,h]of Object.entries(v))switch(m){case"ups":{const g={type:"upsert",keys:h.map(_=>_.key),values:h.map(_=>_.val),txid:a};u.muts.push(g);break}case"upd":{const g={type:"update",keys:h.map(_=>_.key),changeSpecs:h.map(_=>_.mod),txid:a};u.muts.push(g);break}case"del":{const g={type:"delete",keys:h.map(_=>_.key),txid:a};u.muts.push(g);break}}c.push(u)}return c}(n)}const Kh=10,zh=1e4,Vh=1e3;function Wh(e){const t=[],n=new Gt(!0),r=new Gt(null);let i=!1,a=new Array(Kh).fill(0);return r.subscribe(()=>Ce(this,void 0,void 0,function*(){if(!i&&t.length>0){i=!0,a.shift(),a.push(Date.now()),n.next(!1);try{yield function(){var l,c,d,v,u,m;return Ce(this,void 0,void 0,function*(){for(;t.length>0;){const h=t.shift();try{yield fr(e.cloud.syncState.pipe(rn(({phase:_})=>_==="in-sync"||_==="error")));const g=e.cloud.persistedSyncState.value;if(!h)continue;switch(h.type){case"token-expired":const _=e.cloud.currentUser.value,k=yield _o(e.cloud.options.databaseUrl,_);yield e.table("$logins").update(_.userId,{accessToken:k.accessToken,accessTokenExpiration:k.accessTokenExpiration,claims:k.claims,license:k.license,data:k.data});break;case"realm-added":!((l=g==null?void 0:g.realms)===null||l===void 0)&&l.includes(h.realm)||!((c=g==null?void 0:g.inviteRealms)===null||c===void 0)&&c.includes(h.realm)||(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-accepted":!((d=g==null?void 0:g.realms)===null||d===void 0)&&d.includes(h.realm)||(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realm-removed":(!((v=g==null?void 0:g.realms)===null||v===void 0)&&v.includes(h.realm)||!((u=g==null?void 0:g.inviteRealms)===null||u===void 0)&&u.includes(h.realm))&&(yield e.cloud.sync({purpose:"pull",wait:!0}));break;case"realms-changed":yield e.cloud.sync({purpose:"pull",wait:!0});break;case"changes":if(((m=e.cloud.syncState.value)===null||m===void 0?void 0:m.phase)==="error"){yn(e,"pull");break}yield e.transaction("rw",e.dx.tables,O=>Ce(this,void 0,void 0,function*(){O.idbtrans.disableChangeTracking=!0,O.idbtrans.disableAccessControl=!0;const[A,I,x]=yield Promise.all([e.getSchema(),e.getPersistedSyncState(),e.getCurrentUser()]);if(!I||!A||!x)return;if(h.baseRev!==I.serverRevision)return void(typeof h.baseRev!="string"||typeof I.serverRevision!="bigint"&&typeof I.serverRevision!="object"||yn(e,"pull"));if((yield at.waitFor(qa(I)))!==h.realmSetHash)return void yn(e,"pull");let C=[];if(x.isLoggedIn){const q=Ji(e).map(L=>e.table(vs(L.name)));C=yield Fa(q)}if(h.changes.length>0){const q=Lc(h.changes,C);yield Rc(q,e)}I.latestRevisions=Ka(C,I.latestRevisions),I.serverRevision=h.newRev,yield Dc(e,A,I.latestRevisions,h.newRev),yield e.$syncState.put(I,"syncState")}))}}catch{}}})}()}finally{a[a.length-1]-a[0]<zh&&(yield new Promise(l=>setTimeout(l,Vh))),i=!1,n.next(!0)}}})),{enqueue:function(l){t.push(l),r.next(null)},readyToServe:n}}const ql=new WeakMap,Ki={members:"@id, [userId+realmId], [email+realmId], realmId",roles:"[realmId+name]",realms:"@realmId",$jobs:"",$syncState:"",$baseRevs:"[tableName+clientRev]",$logins:"claims.sub, lastLogin"};let Hh=0;function vn(e){"vip"in e&&(e=e.vip);let t=ql.get(e.cloud);if(!t){const n=new fi;let r=new Bi(`syncstatechanged-${e.name}`),i=new Bi(`synccomplete-${e.name}`);n.id=++Hh;let a=!1;t={get name(){return e.name},close:()=>e.close(),transaction:e.transaction.bind(e),table:e.table.bind(e),get tables(){return e.tables},cloud:e.cloud,get $jobs(){return e.table("$jobs")},get $syncState(){return e.table("$syncState")},get $baseRevs(){return e.table("$baseRevs")},get $logins(){return e.table("$logins")},get realms(){return e.realms},get members(){return e.members},get roles(){return e.roles},get initiallySynced(){return a},localSyncEvent:n,get syncStateChangedEvent(){return r},get syncCompleteEvent(){return i},dx:e},Object.assign(t,{getCurrentUser:()=>t.$logins.toArray().then(c=>c.find(d=>d.isLoggedIn)||Dt),getPersistedSyncState:()=>t.$syncState.get("syncState"),getSchema:()=>t.$syncState.get("schema").then(c=>{if(c)for(const v of t.tables)v.schema.primKey&&v.schema.primKey.keyPath&&c[v.name]&&(c[v.name].primaryKey=typeof(d=v.schema.primKey.keyPath)=="string"?d:d?"["+[].join.call(d,"+")+"]":"");var d;return c}),getOptions:()=>t.$syncState.get("options"),setInitiallySynced(c){a=c},reconfigure(){r=new Bi(`syncstatechanged-${e.name}`),i=new Bi(`synccomplete-${e.name}`)}}),t.messageConsumer=Wh(t),ql.set(e.cloud,t)}return t}const Yh=typeof InstallTrigger<"u",Mc=typeof navigator<"u"&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\/|Edge\//.test(navigator.userAgent),Gh=Mc?[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]:NaN,Jh=Mc&&Gh<=605||Yh,Qh=typeof self<"u"&&"clients"in self&&!self.document;function qc(){throw new at.SchemaError("Version increment needed to allow dexie-cloud change tracking")}const{toString:Zh}={};function Fl(e){return Zh.call(e).slice(8,-1)}function pa(e,t){var n;return t.type==="delete"?t.keys:((n=t.keys)===null||n===void 0?void 0:n.slice())||t.values.map(e.extractKey)}const Xh=/b|c|d|f|g|h|j|k|l|m|n|p|q|r|s|t|v|x|y|z/i;let hn=0;function Fc(e,t){const n=new Uint8Array(18),r=new Uint8Array(n.buffer,0,6),i=Date.now();hn>=i?++hn:hn=i,r[0]=hn/1099511627776,r[1]=hn/4294967296,r[2]=hn/16777216,r[3]=hn/65536,r[4]=hn/256,r[5]=hn;const a=new Uint8Array(n.buffer,6);return crypto.getRandomValues(a),e+Ac(new Uint8Array(n.buffer))+(t||"")}function $h(e){return{stack:"dbcore",name:"idGenerationMiddleware",level:1,create:t=>Object.assign(Object.assign({},t),{table:n=>{const r=t.table(n);return Object.assign(Object.assign({},r),{mutate:i=>{var a,l;if(i.trans.disableChangeTracking)return r.mutate(i);if(i.type==="add"||i.type==="put"){const c=(a=e.cloud.schema)===null||a===void 0?void 0:a[n];if(c!=null&&c.generatedGlobalId){if(!((l=e.cloud.options)===null||l===void 0)&&l.databaseUrl&&!e.initiallySynced){const d=pa(r.schema.primaryKey,i);return r.getMany({keys:d,trans:i.trans,cache:"immutable"}).then(v=>{if(v.length<d.length)throw new Error("Unable to create new objects without an initial sync having been performed.");return r.mutate(i)})}return function(d,v){let u=null;const m=pa(r.schema.primaryKey,d);return m.forEach((h,g)=>{if(h===void 0){const _=d.values[g].realmId||e.cloud.currentUserId,k=_.substr(_.length-3);m[g]=Fc(v,k),r.schema.primaryKey.outbound||(u||(u=d.values.slice()),u[g]=at.deepClone(u[g]),at.setByKeyPath(u[g],r.schema.primaryKey.keyPath,m[g]))}else if(typeof h!="string"||!h.startsWith(v)&&!h.startsWith("#"+v))throw new at.ConstraintError(`The ID "${h}" is not valid for table "${n}". Primary '@' keys requires the key to be prefixed with "${v}" (or "#${v}).
If you want to generate IDs programmatically, remove '@' from the schema to get rid of this constraint. Dexie Cloud supports custom IDs as long as they are random and globally unique.`)}),r.mutate(Object.assign(Object.assign({},d),{keys:m,values:u||d.values}))}(i,c.idPrefix)}c!=null&&c.markedForSync&&pa(r.schema.primaryKey,i).forEach((d,v)=>{if(!as(d)){const u=Array.isArray(d)?d.map(Fl).join(","):Fl(d);throw new at.ConstraintError(`Invalid primary key type ${u} for table ${n}. Tables marked for sync has primary keys of type string or Array of string (and optional numbers)`)}})}return r.mutate(i)}})}})}}let ep=0;function Jr(e,t){return function(n){const{readers:r,writers:i}=n.trans[t]||(n.trans[t]={writers:[],readers:[]}),a=i.length,l=(a>0?i[a-1].then(()=>e(n),()=>e(n)):e(n)).finally(()=>{r.splice(r.indexOf(l))});return r.push(l),l}}function tp(e,t){return function(n){const{readers:r,writers:i}=n.trans[t]||(n.trans[t]={writers:[],readers:[]});let a=(i.length>0?i[i.length-1].then(()=>e(n),()=>e(n)):r.length>0?(l=r,new Promise(c=>{l.length===0&&c([]);let d=l.length;const v=new Array(d);l.forEach((u,m)=>Promise.resolve(u).then(h=>v[m]={status:"fulfilled",value:h},h=>v[m]={status:"rejected",reason:h}).then(()=>--d||c(v)))})).then(()=>e(n)):e(n)).finally(()=>{i.shift()});var l;return i.push(a),a}}const or=new Gt(new Set);function Uc(e){var t,n,r,i;return((t=e.cloud.options)===null||t===void 0?void 0:t.disableEagerSync)||((r=(n=e.cloud.currentUser.value)===null||n===void 0?void 0:n.license)===null||r===void 0?void 0:r.status)!=="ok"||!(!((i=e.cloud.options)===null||i===void 0)&&i.databaseUrl)}function np({currentUserObservable:e,db:t}){return{stack:"dbcore",name:"MutationTrackingMiddleware",level:1,create:n=>{const r=n.schema.tables.filter(a=>!/^\$/.test(a.name));let i;try{i=new Map(r.map(a=>[a.name,n.table(`$${a.name}_mutations`)]))}catch{qc()}return Object.assign(Object.assign({},n),{transaction:(a,l)=>{let c;if(l==="readwrite"){const d=a.filter(v=>{var u,m;return(m=(u=t.cloud.schema)===null||u===void 0?void 0:u[v])===null||m===void 0?void 0:m.markedForSync}).map(v=>vs(v));c=n.transaction([...a,...d],l)}else c=n.transaction(a,l);if(l==="readwrite"){c.txid=Ec(16),c.opCount=0,c.currentUser=e.value,or.value.add(c),or.next(or.value);const d=()=>{c.removeEventListener("complete",v),c.removeEventListener("error",d),c.removeEventListener("abort",d),or.value.delete(c),or.next(or.value)},v=()=>{c.mutationsAdded&&!Uc(t)&&yn(t,"push"),d()};c.addEventListener("complete",v),c.addEventListener("error",d),c.addEventListener("abort",d)}return c},table:a=>{const l=n.table(a);if(/^\$/.test(a))return a.endsWith("_mutations")?Object.assign(Object.assign({},l),{mutate:u=>(u.type!=="add"&&u.type!=="put"||(u.trans.mutationsAdded=!0),l.mutate(u))}):a==="$logins"?Object.assign(Object.assign({},l),{mutate:u=>l.mutate(u).then(m=>(u.trans.mutationsAdded=!0,m)).catch(m=>Promise.reject(m))}):l;const{schema:c}=l,d=i.get(a);return function(u){const m="$lock"+ ++ep;return Object.assign(Object.assign({},u),{count:Jr(u.count,m),get:Jr(u.get,m),getMany:Jr(u.getMany,m),openCursor:Jr(u.openCursor,m),query:Jr(u.query,m),mutate:tp(u.mutate,m)})}(Object.assign(Object.assign({},l),{mutate:u=>{var m,h,g;const _=u.trans;return _.txid?_.disableChangeTracking?l.mutate(u):!((h=(m=t.cloud.schema)===null||m===void 0?void 0:m[a])===null||h===void 0)&&h.markedForSync&&(!((g=_.currentUser)===null||g===void 0)&&g.isLoggedIn)?u.type==="deleteRange"?l.query({query:{range:u.range,index:c.primaryKey},trans:u.trans,values:!1}).then(k=>v({type:"delete",keys:k.result,trans:u.trans,criteria:{index:null,range:u.range}})):v(u):l.mutate(u):l.mutate(u)}}));function v(u){const m=u.trans;m.mutationsAdded=!0;const{txid:h,currentUser:{userId:g}}=m,{type:_}=u,k=++m.opCount;return l.mutate(u).then(O=>{const{numFailures:A,failures:I}=O;let x=_==="delete"?u.keys:O.results,C="values"in u?u.values:[],q="updates"in u&&u.updates;A&&(x=x.filter((te,J)=>!I[J]),C=C.filter((te,J)=>!I[J]));const L=Date.now(),V=u.type==="delete"?{type:"delete",ts:L,opNo:k,keys:x,criteria:u.criteria,txid:h,userId:g}:u.type==="add"?{type:"insert",ts:L,opNo:k,keys:x,txid:h,userId:g,values:C}:u.criteria&&u.changeSpec?{type:"modify",ts:L,opNo:k,keys:x,criteria:u.criteria,changeSpec:u.changeSpec,txid:h,userId:g}:q?{type:"update",ts:L,opNo:k,keys:q.keys,changeSpecs:q.changeSpecs,txid:h,userId:g}:{type:"upsert",ts:L,opNo:k,keys:x,values:C,txid:h,userId:g};return"isAdditionalChunk"in u&&u.isAdditionalChunk&&(V.isAdditionalChunk=!0),x.length>0||"criteria"in u&&u.criteria?d.mutate({type:"add",trans:m,values:[V]}).then(()=>O):O})}}})}}}function rp(e,t){return function(n,r){const i=Object.assign(Object.assign({},Ki),n);Object.keys(Ki).forEach(c=>{const d=i[c];if(d==null)throw new Error(`Cannot delete table ${c} as it is needed for access control of Dexie Cloud`);if(!n[c])return;const v=d.split(",").map(h=>h.trim()),u=Ki[c].split(",").map(h=>h.trim()),m=new Set(v.map(h=>h.replace(/([&*]|\+\+)/g,"")));if(v[0]!==u[0])throw new Error(`Cannot override primary key of table ${c}. Please declare it as {${c}: ${JSON.stringify(Ki[c])}`);for(let h=1;h<u.length;++h){const g=u[h];m.has(g.replace(/([&*]|\+\+)/g,""))||(i[c]+=`,${g}`)}});const a=t.cloud.schema||(t.cloud.schema={}),l=new Set;return Object.keys(i).forEach(c=>{const d=i[c],v=a[c]||(a[c]={});d!=null?(/^\@/.test(d)&&(i[c]=i[c].substr(1),v.generatedGlobalId=!0,v.idPrefix=function(u,m){let h=u[0].toLocaleLowerCase();for(let O=1,A=u.length;O<A&&h.length<3;++O)(Xh.test(u[O])||(g=u[O])>="A"&&g<="Z")&&(h+=u[O].toLowerCase());for(var g,_,k;m.has(h);){if(/\d/g.test(h)){if(h=h.substr(0,h.length-1)+(h[h.length-1]+1),!(h.length>3))continue;h=h.substr(0,3)}else if(h.length<3){h+="2";continue}let O=1,A=h;for(;m.has(A)&&O<8;)_=h,A=(1&(k=O)?_[0].toUpperCase():_[0].toLowerCase())+(2&k?_[1].toUpperCase():_[1].toLowerCase())+(4&k?_[2].toUpperCase():_[2].toLowerCase()),++O;if(O<8)h=A;else{let I=h.charCodeAt(2)+1&127;h=h.substr(0,2)+String.fromCharCode(I)}}return h}(c,l),l.add(v.idPrefix)),/^\$/.test(c)||(i[`$${c}_mutations`]="++rev",v.markedForSync=!0),v.deleted&&(v.deleted=!1)):(v.deleted=!0,v.markedForSync=!1,i[`$${c}_mutations`]=null)}),e.call(this,i,r)}}const ni=new Gt(!0),za=new Gt(!0);ni.pipe(At(e=>e?mn(!0):mn(!1).pipe(gc(2e4))),bc()).subscribe(za);const Bc=typeof document<"u"?on(document,"visibilitychange"):mn({}),ip=Bc.pipe(rn(()=>document.visibilityState==="hidden")),op=Bc.pipe(rn(()=>document.visibilityState==="visible")),Kc=typeof window<"u"?$u(op,on(window,"mousedown"),on(window,"mousemove"),on(window,"keydown"),on(window,"wheel"),on(window,"touchmove")):mn({});typeof document<"u"&&$u(mn(!0),ip,Kc).pipe(an(()=>document.visibilityState==="visible"),Pl(e=>{ni.value!==e&&ni.next(e)}),At(e=>e?mn(0).pipe(gc(16e4),Pl(()=>ni.next(!1))):mn(0))).subscribe(()=>{});class ap extends Error{constructor(){super(...arguments),this.name="TokenExpiredError"}}class sp extends yt{constructor(t,n,r,i,a,l,c,d){super(v=>new up(t,n,r,i,c,d,v,a,l))}}let lp=0;class up extends Ir{constructor(t,n,r,i,a,l,c,d,v){super(()=>this.teardown()),this.id=++lp,this.reconnecting=!1,this.databaseUrl=t,this.rev=n,this.realmSetHash=r,this.clientIdentity=i,this.token=a,this.tokenExpiration=l,this.subscriber=c,this.lastUserActivity=new Date,this.messageProducer=d,this.messageProducerSubscription=null,this.webSocketStatus=v,this.connect()}teardown(){this.disconnect()}disconnect(){if(this.webSocketStatus.next("disconnected"),this.pinger&&(clearInterval(this.pinger),this.pinger=null),this.ws)try{this.ws.close()}catch{}this.ws=null,this.messageProducerSubscription&&(this.messageProducerSubscription.unsubscribe(),this.messageProducerSubscription=null)}reconnect(){if(!this.reconnecting){this.reconnecting=!0;try{this.disconnect()}catch{}this.connect().catch(()=>{}).then(()=>this.reconnecting=!1)}}connect(){return Ce(this,void 0,void 0,function*(){if(this.lastServerActivity=new Date,this.pauseUntil&&this.pauseUntil>new Date)return;if(this.ws)throw new Error("Called connect() when a connection is already open");if(!this.databaseUrl)throw new Error("Cannot connect without a database URL");if(this.closed)return;if(this.tokenExpiration&&this.tokenExpiration<new Date)return void this.subscriber.error(new ap);this.webSocketStatus.next("connecting"),this.pinger=setInterval(()=>Ce(this,void 0,void 0,function*(){if(this.closed)this.teardown();else if(this.ws)try{this.ws.send(JSON.stringify({type:"ping"})),setTimeout(()=>{this.pinger&&(this.closed?this.teardown():this.lastServerActivity<new Date(Date.now()-2e4)&&this.reconnect())},2e4)}catch{this.reconnect()}else this.reconnect()}),3e4);const t=new URL(this.databaseUrl);t.protocol=t.protocol==="http:"?"ws":"wss";const n=new URLSearchParams;if(this.subscriber.closed)return;n.set("v","2"),n.set("rev",this.rev),n.set("realmsHash",this.realmSetHash),n.set("clientId",this.clientIdentity),this.token&&n.set("token",this.token);const r=this.ws=new WebSocket(`${t}/changes?${n}`);r.onclose=i=>{this.pinger&&this.reconnect()},r.onmessage=i=>{if(this.pinger){this.lastServerActivity=new Date;try{const a=oo.parse(i.data);if(a.type==="error")throw new Error(`Error message from dexie-cloud: ${a.error}`);a.type==="rev"&&(this.rev=a.rev),a.type!=="pong"&&this.subscriber.next(a)}catch(a){this.subscriber.error(a)}}};try{let i=!1;yield new Promise((a,l)=>{r.onopen=c=>{i=!0,a(null)},r.onerror=c=>{if(i)this.reconnect();else{const d=c.error||new Error("WebSocket Error");this.subscriber.error(d),this.webSocketStatus.next("error"),l(d)}}}),this.messageProducerSubscription=this.messageProducer.subscribe(a=>{var l;this.closed||(a.type==="ready"&&this.webSocketStatus.value!=="connected"&&this.webSocketStatus.next("connected"),(l=this.ws)===null||l===void 0||l.send(oo.stringify(a)))})}catch{this.pauseUntil=new Date(Date.now()+6e4)}})}}class cp extends Error{constructor(t){super(t==="expired"?"License expired":t==="deactivated"?"User deactivated":"Invalid license"),this.name="InvalidLicenseError",t&&(this.license=t)}}function fp(e){return Ce(this,void 0,void 0,function*(){var t;yield(t=3e3,new Promise(n=>setTimeout(n,t))),yield fr(Kc)})}function Ul(e){var t;return Ce(this,void 0,void 0,function*(){return!(!(!((t=e.cloud.options)===null||t===void 0)&&t.databaseUrl)||!e.cloud.schema)&&(yield li(e,e.cloud.options,e.cloud.schema,{justCheckIfNeeded:!0}))})}const zi=new WeakMap;function zc(e,t,n,r){const i=zi.get(e);if(i){if(i.pull||(r==null?void 0:r.purpose)==="push")return i.promise;{let l=!1;const c=e.cloud.syncState.subscribe(d=>{d.phase==="pulling"&&(l=!0)});return i.promise.then(()=>{c.unsubscribe()}).catch(d=>(c.unsubscribe(),Promise.reject(d))).then(()=>{if(!l)return zc(e,t,n,r)})}}const a=function(){return Ce(this,void 0,void 0,function*(){try{if(yield jc(e),e.cloud.isServiceWorkerDB)yield li(e,t,n,r);else{if(e.cloud.usingServiceWorker)throw tc(!1),new Error("Internal _syncIfPossible() - invalid precondition - should not have been called.");yield function(l,c,d){return typeof navigator<"u"&&navigator.locks?navigator.locks.request(l.name+"|"+c,()=>d()):d()}(e,Bh,()=>li(e,t,n,r))}zi.delete(e)}catch(l){throw zi.delete(e),l}})}();return zi.set(e,{promise:a,pull:(r==null?void 0:r.purpose)!=="push"}),a}const dp=6e4;function vp(e,t,n){let r=null,i={cancelled:!1},a=null,l=null;function c(v,u=1){setTimeout(()=>{a&&clearTimeout(a);const m=l==="pull"?"pull":v;a=null,l=null,zc(e,t,n,{cancelToken:i,retryImmediatelyOnFetchError:!0,purpose:m}).catch(h=>{if(i.cancelled)d();else if(u<3){const g=l&&l==="pull"?"pull":v,_=setTimeout(()=>c(g,u+1),[0,5,15][u]*dp);a&&clearTimeout(a),a=_,l=g}})},0)}const d=()=>{i.cancelled=!0,r&&r.unsubscribe()};return{start:()=>{r=e.localSyncEvent.subscribe(({purpose:v})=>{try{c(v||"pull")}catch{}})},stop:d}}function ya(e,t){if(e&&t&&t.unsyncedTables)for(const n of t.unsyncedTables)e[n]&&(e[n].markedForSync=!1)}var wo,ze,Vc,ri,Bl,ao={},Wc=[],hp=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Pn(e,t){for(var n in t)e[n]=t[n];return e}function Hc(e){var t=e.parentNode;t&&t.removeChild(e)}function ht(e,t,n){var r,i,a,l={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?wo.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)l[a]===void 0&&(l[a]=e.defaultProps[a]);return Qi(e,l,r,i,null)}function Qi(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++Vc};return i==null&&ze.vnode!=null&&ze.vnode(a),a}function _r(e){return e.children}function ii(e,t){this.props=e,this.context=t}function wr(e,t){if(t==null)return e.__?wr(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?wr(e):null}function Yc(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Yc(e)}}function Kl(e){(!e.__d&&(e.__d=!0)&&ri.push(e)&&!so.__r++||Bl!==ze.debounceRendering)&&((Bl=ze.debounceRendering)||setTimeout)(so)}function so(){for(var e;so.__r=ri.length;)e=ri.sort(function(t,n){return t.__v.__b-n.__v.__b}),ri=[],e.some(function(t){var n,r,i,a,l,c;t.__d&&(l=(a=(n=t).__v).__e,(c=n.__P)&&(r=[],(i=Pn({},a)).__v=a.__v+1,hs(c,a,i,n.__n,c.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??wr(a),a.__h),Zc(r,a),a.__e!=l&&Yc(a)))})}function Gc(e,t,n,r,i,a,l,c,d,v){var u,m,h,g,_,k,O,A=r&&r.__k||Wc,I=A.length;for(n.__k=[],u=0;u<t.length;u++)if((g=n.__k[u]=(g=t[u])==null||typeof g=="boolean"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?Qi(null,g,null,null,g):Array.isArray(g)?Qi(_r,{children:g},null,null,null):g.__b>0?Qi(g.type,g.props,g.key,null,g.__v):g)!=null){if(g.__=n,g.__b=n.__b+1,(h=A[u])===null||h&&g.key==h.key&&g.type===h.type)A[u]=void 0;else for(m=0;m<I;m++){if((h=A[m])&&g.key==h.key&&g.type===h.type){A[m]=void 0;break}h=null}hs(e,g,h=h||ao,i,a,l,c,d,v),_=g.__e,(m=g.ref)&&h.ref!=m&&(O||(O=[]),h.ref&&O.push(h.ref,null,g),O.push(m,g.__c||_,g)),_!=null?(k==null&&(k=_),typeof g.type=="function"&&g.__k===h.__k?g.__d=d=Jc(g,d,e):d=Qc(e,g,h,A,_,d),typeof n.type=="function"&&(n.__d=d)):d&&h.__e==d&&d.parentNode!=e&&(d=wr(h))}for(n.__e=k,u=I;u--;)A[u]!=null&&(typeof n.type=="function"&&A[u].__e!=null&&A[u].__e==n.__d&&(n.__d=wr(r,u+1)),$c(A[u],A[u]));if(O)for(u=0;u<O.length;u++)Xc(O[u],O[++u],O[++u])}function Jc(e,t,n){for(var r,i=e.__k,a=0;i&&a<i.length;a++)(r=i[a])&&(r.__=e,t=typeof r.type=="function"?Jc(r,t,n):Qc(n,r,r,i,r.__e,t));return t}function Qc(e,t,n,r,i,a){var l,c,d;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),l=null;else{for(c=a,d=0;(c=c.nextSibling)&&d<r.length;d+=2)if(c==i)break e;e.insertBefore(i,a),l=a}return l!==void 0?l:i.nextSibling}function zl(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||hp.test(t)?n:n+"px"}function Vi(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||zl(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||zl(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?Wl:Vl,a):e.removeEventListener(t,a?Wl:Vl,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function Vl(e){this.l[e.type+!1](ze.event?ze.event(e):e)}function Wl(e){this.l[e.type+!0](ze.event?ze.event(e):e)}function hs(e,t,n,r,i,a,l,c,d){var v,u,m,h,g,_,k,O,A,I,x,C,q,L=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(d=n.__h,c=t.__e=n.__e,t.__h=null,a=[c]),(v=ze.__b)&&v(t);try{e:if(typeof L=="function"){if(O=t.props,A=(v=L.contextType)&&r[v.__c],I=v?A?A.props.value:v.__:r,n.__c?k=(u=t.__c=n.__c).__=u.__E:("prototype"in L&&L.prototype.render?t.__c=u=new L(O,I):(t.__c=u=new ii(O,I),u.constructor=L,u.render=yp),A&&A.sub(u),u.props=O,u.state||(u.state={}),u.context=I,u.__n=r,m=u.__d=!0,u.__h=[]),u.__s==null&&(u.__s=u.state),L.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Pn({},u.__s)),Pn(u.__s,L.getDerivedStateFromProps(O,u.__s))),h=u.props,g=u.state,m)L.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(L.getDerivedStateFromProps==null&&O!==h&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(O,I),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(O,u.__s,I)===!1||t.__v===n.__v){u.props=O,u.state=u.__s,t.__v!==n.__v&&(u.__d=!1),u.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(V){V&&(V.__=t)}),u.__h.length&&l.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(O,u.__s,I),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(h,g,_)})}if(u.context=I,u.props=O,u.__v=t,u.__P=e,x=ze.__r,C=0,"prototype"in L&&L.prototype.render)u.state=u.__s,u.__d=!1,x&&x(t),v=u.render(u.props,u.state,u.context);else do u.__d=!1,x&&x(t),v=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++C<25);u.state=u.__s,u.getChildContext!=null&&(r=Pn(Pn({},r),u.getChildContext())),m||u.getSnapshotBeforeUpdate==null||(_=u.getSnapshotBeforeUpdate(h,g)),q=v!=null&&v.type===_r&&v.key==null?v.props.children:v,Gc(e,Array.isArray(q)?q:[q],t,n,r,i,a,l,c,d),u.base=t.__e,t.__h=null,u.__h.length&&l.push(u),k&&(u.__E=u.__=null),u.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=pp(n.__e,t,n,r,i,a,l,d);(v=ze.diffed)&&v(t)}catch(V){t.__v=null,(d||a!=null)&&(t.__e=c,t.__h=!!d,a[a.indexOf(c)]=null),ze.__e(V,t,n)}}function Zc(e,t){ze.__c&&ze.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){ze.__e(r,n.__v)}})}function pp(e,t,n,r,i,a,l,c){var d,v,u,m=n.props,h=t.props,g=t.type,_=0;if(g==="svg"&&(i=!0),a!=null){for(;_<a.length;_++)if((d=a[_])&&"setAttribute"in d==!!g&&(g?d.localName===g:d.nodeType===3)){e=d,a[_]=null;break}}if(e==null){if(g===null)return document.createTextNode(h);e=i?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,h.is&&h),a=null,c=!1}if(g===null)m===h||c&&e.data===h||(e.data=h);else{if(a=a&&wo.call(e.childNodes),v=(m=n.props||ao).dangerouslySetInnerHTML,u=h.dangerouslySetInnerHTML,!c){if(a!=null)for(m={},_=0;_<e.attributes.length;_++)m[e.attributes[_].name]=e.attributes[_].value;(u||v)&&(u&&(v&&u.__html==v.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(k,O,A,I,x){var C;for(C in A)C==="children"||C==="key"||C in O||Vi(k,C,null,A[C],I);for(C in O)x&&typeof O[C]!="function"||C==="children"||C==="key"||C==="value"||C==="checked"||A[C]===O[C]||Vi(k,C,O[C],A[C],I)}(e,h,m,i,c),u)t.__k=[];else if(_=t.props.children,Gc(e,Array.isArray(_)?_:[_],t,n,r,i&&g!=="foreignObject",a,l,a?a[0]:n.__k&&wr(n,0),c),a!=null)for(_=a.length;_--;)a[_]!=null&&Hc(a[_]);c||("value"in h&&(_=h.value)!==void 0&&(_!==e.value||g==="progress"&&!_||g==="option"&&_!==m.value)&&Vi(e,"value",_,m.value,!1),"checked"in h&&(_=h.checked)!==void 0&&_!==e.checked&&Vi(e,"checked",_,m.checked,!1))}return e}function Xc(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){ze.__e(r,n)}}function $c(e,t,n){var r,i;if(ze.unmount&&ze.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||Xc(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){ze.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&$c(r[i],t,typeof e.type!="function");n||e.__e==null||Hc(e.__e),e.__e=e.__d=void 0}function yp(e,t,n){return this.constructor(e,n)}function Hl(e,t,n){var r,i,a;ze.__&&ze.__(e,t),i=(r=!1)?null:t.__k,a=[],hs(t,e=t.__k=ht(_r,null,[e]),i||ao,ao,t.ownerSVGElement!==void 0,i?null:t.firstChild?wo.call(t.childNodes):null,a,i?i.__e:t.firstChild,r),Zc(a,e)}wo=Wc.slice,ze={__e:function(e,t,n,r){for(var i,a,l;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&a.getDerivedStateFromError!=null&&(i.setState(a.getDerivedStateFromError(e)),l=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,r||{}),l=i.__d),l)return i.__E=i}catch(c){e=c}throw e}},Vc=0,ii.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Pn({},this.state),typeof e=="function"&&(e=e(Pn({},n),this.props)),e&&Pn(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),Kl(this))},ii.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Kl(this))},ii.prototype.render=_r,ri=[],so.__r=0;const nn={Alert:{error:{color:"red",fontWeight:"bold"},warning:{color:"#f80",fontWeight:"bold"},info:{color:"black"}},Darken:{position:"fixed",top:0,left:0,opacity:.5,backgroundColor:"#000",width:"100vw",height:"100vh",zIndex:150,webkitBackdropFilter:"blur(2px)",backdropFilter:"blur(2px)"},DialogOuter:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:150,alignItems:"center",display:"flex",justifyContent:"center"},DialogInner:{position:"relative",color:"#222",backgroundColor:"#fff",padding:"30px",marginBottom:"2em",maxWidth:"90%",maxHeight:"90%",overflowY:"auto",border:"3px solid #3d3d5d",borderRadius:"8px",boxShadow:"0 0 80px 10px #666",width:"auto",fontFamily:"sans-serif"},Input:{height:"35px",width:"17em",borderColor:"#ccf4",outline:"none",fontSize:"17pt",padding:"8px"}};function mp({children:e,className:t}){return ht("div",{className:t},ht("div",{style:nn.Darken}),ht("div",{style:nn.DialogOuter},ht("div",{style:nn.DialogInner},e)))}var ko,pt,ma,Yl,lo=0,ef=[],Zi=[],Gl=ze.__b,Jl=ze.__r,Ql=ze.diffed,Zl=ze.__c,Xl=ze.unmount;function ps(e,t){ze.__h&&ze.__h(pt,e,lo||t),lo=0;var n=pt.__H||(pt.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Zi}),n.__[e]}function gp(e){return lo=1,function(t,n,r){var i=ps(ko++,2);if(i.t=t,!i.__c&&(i.__=[eu(void 0,n),function(l){var c=i.__N?i.__N[0]:i.__[0],d=i.t(c,l);c!==d&&(i.__N=[d,i.__[1]],i.__c.setState({}))}],i.__c=pt,!pt.u)){pt.u=!0;var a=pt.shouldComponentUpdate;pt.shouldComponentUpdate=function(l,c,d){if(!i.__c.__H)return!0;var v=i.__c.__H.__.filter(function(m){return m.__c});if(v.every(function(m){return!m.__N}))return!a||a.call(this,l,c,d);var u=!1;return v.forEach(function(m){if(m.__N){var h=m.__[0];m.__=m.__N,m.__N=void 0,h!==m.__[0]&&(u=!0)}}),!!u&&(!a||a.call(this,l,c,d))}}return i.__N||i.__}(eu,e)}function bp(e){return lo=5,function(t,n){var r=ps(ko++,7);return tf(r.__H,n)?(r.__V=t(),r.i=n,r.__h=t,r.__V):r.__}(function(){return{current:e}},[])}function _p(){for(var e;e=ef.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Xi),e.__H.__h.forEach(Va),e.__H.__h=[]}catch(t){e.__H.__h=[],ze.__e(t,e.__v)}}ze.__b=function(e){pt=null,Gl&&Gl(e)},ze.__r=function(e){Jl&&Jl(e),ko=0;var t=(pt=e.__c).__H;t&&(ma===pt?(t.__h=[],pt.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=Zi,n.__N=n.i=void 0})):(t.__h.forEach(Xi),t.__h.forEach(Va),t.__h=[])),ma=pt},ze.diffed=function(e){Ql&&Ql(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(ef.push(t)!==1&&Yl===ze.requestAnimationFrame||((Yl=ze.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),$l&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);$l&&(r=requestAnimationFrame(i))})(_p)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==Zi&&(n.__=n.__V),n.i=void 0,n.__V=Zi})),ma=pt=null},ze.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Xi),n.__h=n.__h.filter(function(r){return!r.__||Va(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],ze.__e(r,n.__v)}}),Zl&&Zl(e,t)},ze.unmount=function(e){Xl&&Xl(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{Xi(r)}catch(i){t=i}}),t&&ze.__e(t,n.__v))};var $l=typeof requestAnimationFrame=="function";function Xi(e){var t=pt,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),pt=t}function Va(e){var t=pt;e.__c=e.__(),pt=t}function tf(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function eu(e,t){return typeof t=="function"?t(e):t}function wp({message:e,messageCode:t,messageParams:n}){return e.replace(/\{\w+\}/gi,r=>n[r.substring(1,r.length-1)])}function kp({title:e,type:t,alerts:n,fields:r,submitLabel:i,cancelLabel:a,onCancel:l,onSubmit:c}){const[d,v]=gp({}),u=bp(null);return function(m,h){var g=ps(ko++,4);!ze.__s&&tf(g.__H,h)&&(g.__=m,g.i=h,pt.__h.push(g))}(()=>{var m;return(m=u.current)===null||m===void 0?void 0:m.focus()},[]),ht(mp,{className:"dxc-login-dlg"},ht(_r,null,ht("h3",{style:nn.WindowHeader},e),n.map(m=>ht("p",{style:nn.Alert[m.type]},wp(m))),ht("form",{onSubmit:m=>{m.preventDefault(),c(d)}},Object.entries(r).map(([m,{type:h,label:g,placeholder:_}],k)=>ht("label",{style:nn.Label,key:k},g?`${g}: `:"",ht("input",{ref:k===0?u:void 0,type:h,name:m,autoComplete:"on",style:nn.Input,autoFocus:!0,placeholder:_,value:d[m]||"",onInput:O=>{var A;const I=function(C,q){switch(C){case"email":return q.toLowerCase();case"otp":return q.toUpperCase();default:return q}}(h,(A=O.target)===null||A===void 0?void 0:A.value);let x=Object.assign(Object.assign({},d),{[m]:I});v(x),h==="otp"&&(I==null?void 0:I.trim().length)===8&&c(x)}}))))),ht("div",{style:nn.ButtonsDiv},ht(_r,null,ht("button",{type:"submit",style:nn.Button,onClick:()=>c(d)},i),a&&ht("button",{style:nn.Button,onClick:l},a))))}class tu extends ii{constructor(t){super(t),this.observer=n=>this.setState({userInteraction:n}),this.state={userInteraction:void 0}}componentDidMount(){this.subscription=sn(this.props.db.cloud.userInteraction).subscribe(this.observer)}componentWillUnmount(){this.subscription&&(this.subscription.unsubscribe(),delete this.subscription)}render(t,{userInteraction:n}){return n?ht(kp,Object.assign({},n)):null}}function hi(e){const t=new WeakMap;return n=>{let r=t.get(n);return r||(r=e(n),t.set(n,r)),r}}const uo=hi(e=>new Gt(Dt));function xo(e,t){let n=t,r=sn(e).pipe(mo(a=>n=a),Zv({resetOnRefCountZero:()=>Jv(1e3)}));const i=new yt(a=>{let l=!1;const c=r.subscribe({next(d){l=!0,a.next(d)},error(d){a.error(d)},complete(){a.complete()}});return l||c.closed||a.next(n),c});return i.getValue=()=>n,i}const nf=hi(e=>xo(ur(()=>e.roles.where({realmId:"rlm-public"}).toArray().then(t=>{const n={};for(const r of t.slice().sort((i,a)=>(i.sortOrder||0)-(a.sortOrder||0)))n[r.name]=r;return n})),{})),rf=hi(e=>xo(uo(e._novip).pipe(At(t=>ur(()=>e.transaction("r","realms","members",()=>Promise.all([e.members.where({userId:t.userId}).toArray(),e.realms.toArray(),t.userId]).then(([n,r,i])=>({selfMembers:n,realms:r,userId:i})))))),{selfMembers:[],realms:[],get userId(){return e.cloud.currentUserId}}));function xp(...e){return e.length===0?{}:e.reduce((n,r)=>{const i=Object.assign({},n);for(const[a,l]of Object.entries(r))if(a in i&&i[a]){if(i[a]==="*")continue;if(l==="*")i[a]="*";else if(Array.isArray(l)&&Array.isArray(i[a])){const c=i,d=c[a];c[a]=[...new Set([...d,...l])]}else if(typeof l=="object"&&l&&typeof i[a]=="object"){const c=i[a];for(const[d,v]of Object.entries(l))c[d]!=="*"&&(v==="*"?c[d]="*":Array.isArray(c[d])&&Array.isArray(v)&&(c[d]=[...new Set([...c[d],...v])]))}}else i[a]=r[a];return i})}const of=hi(e=>function(t,n){let r;const i=t.pipe(mo(a=>r=n(a)));return i.getValue=()=>r!==void 0?r:r=n(t.getValue()),i}(xo(no([rf(e._novip),nf(e._novip)]).pipe(an(([{selfMembers:t,realms:n,userId:r},i])=>({selfMembers:t,realms:n,userId:r,globalRoles:i}))),{selfMembers:[],realms:[],userId:Dt.userId,globalRoles:{}}),({selfMembers:t,realms:n,userId:r,globalRoles:i})=>n.map(l=>{const c=t.filter(u=>u.realmId===l.realmId),d=c.map(u=>u.permissions).filter(u=>u),v=Ic(c.map(u=>u.roles).filter(u=>u)).map(u=>i[u]).filter(u=>u).map(u=>u.permissions);return Object.assign(Object.assign({},l),{permissions:l.owner===r?{manage:"*"}:xp(...d,...v)})}).reduce((l,c)=>Object.assign(Object.assign({},l),{[c.realmId]:c}),{[r]:{realmId:r,owner:r,name:r,permissions:{manage:"*"}}})));class nu{constructor(t,n,r){this.permissions=t||{},this.tableName=n,this.isOwner=r}add(...t){var n;return this.permissions.manage==="*"||!!(!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))||this.permissions.add==="*"||!!t.every(r=>{var i;return(i=this.permissions.add)===null||i===void 0?void 0:i.includes(r)})}update(...t){var n,r;if(this.isOwner||this.permissions.manage==="*"||!((n=this.permissions.manage)===null||n===void 0)&&n.includes(this.tableName))return!0;if(this.permissions.update==="*")return t.every(a=>a!=="owner");const i=(r=this.permissions.update)===null||r===void 0?void 0:r[this.tableName];return i==="*"?t.every(a=>a!=="owner"):t.every(a=>i==null?void 0:i.some(l=>l===a||l==="*"&&a!=="owner"))}delete(){var t;return!(!this.isOwner&&this.permissions.manage!=="*")||!!(!((t=this.permissions.manage)===null||t===void 0)&&t.includes(this.tableName))}}const Sp=hi(e=>{const t=uo(e._novip).pipe(At(i=>ur(()=>e.members.where({email:i.email||""}).toArray()))),n=of(e._novip),r=rf(e._novip);return xo(no([t,r,n]).pipe(an(([i,a,l])=>{const c=(u,m)=>Object.assign(Object.assign({},u),{[m.id]:Object.assign(Object.assign({},m),{realm:l[m.realmId]})}),d=i.reduce(c,{}),v=a.selfMembers.reduce(c,d);return Object.values(v).filter(u=>!u.accepted).map(u=>Object.assign(Object.assign({},u),{accept(){return Ce(this,void 0,void 0,function*(){yield e.members.update(u.id,{accepted:new Date})})},reject(){return Ce(this,void 0,void 0,function*(){yield e.members.update(u.id,{rejected:new Date})})}}))})),[])}),Ip={nameSuffix:!0};function Wa(e){const t=e.name,n=uo(e),r=[];let i=!1,a=null;e.on("ready",u=>Ce(this,void 0,void 0,function*(){try{yield function(m){var h,g,_,k,O,A,I;return Ce(this,void 0,void 0,function*(){l=!1;const x=vn(m);typeof window<"u"&&typeof document<"u"&&(!((h=x.cloud.options)===null||h===void 0)&&h.customLoginGui||r.push(function(G){let ne=!1;const $=document.createElement("div");return document.body?(document.body.appendChild($),Hl(ht(tu,{db:G.vip}),$)):addEventListener("DOMContentLoaded",()=>{ne||(document.body.appendChild($),Hl(ht(tu,{db:G.vip}),$))}),{unsubscribe(){try{$.remove()}catch{}ne=!0},get closed(){return ne}}}(m))),x.cloud.isServiceWorkerDB||r.push(function(G){let ne=G.cloud.webSocketStatus.value;const $=G.cloud.webSocketStatus.pipe(At(H=>{const ee=ne;ne=H;const ie=mn(H);switch(H){case"disconnected":return ni.value?ie.pipe(Al(500)):ie;case"connecting":return ee==="not-started"||ee==="error"?ie:ie.pipe(Al(4e3));default:return ie}}));return no([$,G.syncStateChangedEvent.pipe(mh({phase:"initial"})),uo(G.dx._novip),za]).pipe(an(([H,ee,ie,oe])=>{var Re;if(!((Re=ie.license)===null||Re===void 0)&&Re.status&&ie.license.status!=="ok")return{phase:"offline",status:"offline",license:ie.license.status};let{phase:je,error:le,progress:B}=ee,Le=H;return je==="error"&&(Le="error"),H==="not-started"&&(je!=="pushing"&&je!=="pulling"||(Le="connecting")),G.cloud.syncState.value.phase!=="error"||ee.phase!=="pushing"&&ee.phase!=="pulling"||(Le="connecting"),oe||(Le="disconnected"),{phase:je,error:le,progress:B,status:vr?Le:"offline",license:"ok"}}))}(x).subscribe(m.cloud.syncState)),r.push(x.syncCompleteEvent.subscribe(d)),x.tables.every(G=>G.core)||qc();const C="serviceWorker"in navigator?yield navigator.serviceWorker.getRegistrations():[],[q,L]=yield x.transaction("rw",x.$syncState,()=>Ce(this,void 0,void 0,function*(){var G,ne;const{options:$,schema:H}=x.cloud,[ee,ie,oe]=yield Promise.all([x.getOptions(),x.getSchema(),x.getPersistedSyncState()]);if(i){if(!ee||JSON.stringify(ee)!==JSON.stringify($)){if(!$)throw new Error("Internal error");const Re=Object.assign({},$);delete Re.fetchTokens,yield x.$syncState.put(Re,"options")}}else x.cloud.options=ee||null;if(!((G=x.cloud.options)===null||G===void 0)&&G.tryUseServiceWorker&&"serviceWorker"in navigator&&C.length>0&&!Jh?x.cloud.usingServiceWorker=!0:(!((ne=x.cloud.options)===null||ne===void 0)&&ne.tryUseServiceWorker&&x.cloud.isServiceWorkerDB,x.cloud.usingServiceWorker=!1),ya(H,x.cloud.options),ya(ie,x.cloud.options),H){if(!ie||JSON.stringify(ie)!==JSON.stringify(H)){const Re=ie||{};for(const[je,le]of Object.entries(H)){const B=Re[je];B?(B.markedForSync=le.markedForSync,le.deleted=B.deleted,B.generatedGlobalId=le.generatedGlobalId):Re[je]=Object.assign({},le)}yield x.$syncState.put(Re,"schema"),Object.assign(H,Re)}}else x.cloud.schema=ie||null;return[oe==null?void 0:oe.initiallySynced,oe==null?void 0:oe.realms]}));q&&x.setInitiallySynced(!0),function(G){var ne,$;for(const H of G.tables)if(!(($=(ne=G.cloud.schema)===null||ne===void 0?void 0:ne[H.name])===null||$===void 0)&&$.markedForSync){if(H.schema.primKey.auto)throw new at.SchemaError(`Table ${H.name} is both autoIncremented and synced. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(H.name)}]}) to blacklist it from sync`);if(!H.schema.primKey.keyPath)throw new at.SchemaError(`Table ${H.name} cannot be both synced and outbound. Use db.cloud.configure({unsyncedTables: [${JSON.stringify(H.name)}]}) to blacklist it from sync`)}}(x),!((g=x.cloud.options)===null||g===void 0)&&g.databaseUrl&&!q&&(yield function(G,ne,$){return Ce(this,void 0,void 0,function*(){yield li(G,ne,$,{isInitialSync:!0})})}(x,x.cloud.options,x.cloud.schema),x.setInitiallySynced(!0)),c(),x.cloud.isServiceWorkerDB||(r.push(ur(()=>x.getCurrentUser()).subscribe(n)),r.push(ur(()=>x.getPersistedSyncState()).subscribe(x.cloud.persistedSyncState)),yield fr(no([n.pipe(Cl(1),lr(1)),x.cloud.persistedSyncState.pipe(Cl(1),lr(1))])));let V=!1;const te=yield x.getCurrentUser(),J=(_=x.cloud.options)===null||_===void 0?void 0:_.requireAuth;J&&(typeof J=="object"?(!te.isLoggedIn||J.userId&&te.userId!==J.userId||J.email&&te.email!==J.email)&&(V=yield da(x,J)):te.isLoggedIn||(V=yield da(x))),!te.isLoggedIn||L&&L.includes(te.userId)||(V=!0),a&&a.stop(),a=null,c(),x.cloud.usingServiceWorker&&(!((k=x.cloud.options)===null||k===void 0)&&k.databaseUrl)?(_c(x,V?"pull":"push").catch(()=>{}),function(G){var ne;return Ce(this,void 0,void 0,function*(){try{const{periodicSync:$}=yield navigator.serviceWorker.ready;if($)try{yield $.register(`dexie-cloud:${G.name}`,(ne=G.cloud.options)===null||ne===void 0?void 0:ne.periodicSync)}catch{}}catch{}})}(x).catch(()=>{})):!((O=x.cloud.options)===null||O===void 0)&&O.databaseUrl&&x.cloud.schema&&!x.cloud.isServiceWorkerDB&&(a=vp(x,x.cloud.options,x.cloud.schema),a.start(),yn(x,V?"pull":"push")),c(),x.cloud.isServiceWorkerDB||r.push(on(self,"online").subscribe(()=>{x.syncStateChangedEvent.next({phase:"not-in-sync"}),Uc(x)||yn(x,"push")}),on(self,"offline").subscribe(()=>{x.syncStateChangedEvent.next({phase:"offline"})})),!(!((A=x.cloud.options)===null||A===void 0)&&A.databaseUrl)||!((I=x.cloud.options)===null||I===void 0)&&I.disableWebSocket||Qh||r.push(function(G){var ne;if(!(!((ne=G.cloud.options)===null||ne===void 0)&&ne.databaseUrl))throw new Error("No database URL to connect WebSocket to");const $=G.messageConsumer.readyToServe.pipe(rn(H=>H),At(()=>G.getPersistedSyncState()),rn(H=>H&&H.serverRevision),At(H=>Ce(this,void 0,void 0,function*(){return{type:"ready",rev:H.serverRevision,realmSetHash:yield qa(H)}})));return function H(){return G.cloud.persistedSyncState.pipe(rn(ee=>ee==null?void 0:ee.serverRevision),lr(1),At(ee=>G.cloud.currentUser.pipe(an(ie=>[ie,ee]))),At(([ee,ie])=>za.pipe(an(oe=>[oe?ee:null,ie]))),At(([ee,ie])=>ee!=null&&ee.isLoggedIn&&!(ie!=null&&ie.realms.includes(ee.userId))?G.cloud.persistedSyncState.pipe(rn(oe=>(oe==null?void 0:oe.realms.includes(ee.userId))||!1),lr(1),an(oe=>[ee,oe])):new Gt([ee,ie])),At(([ee,ie])=>Ce(this,void 0,void 0,function*(){return[ee,yield qa(ie)]})),bc(([ee,ie],[oe,Re])=>ee===oe&&ie===Re),At(([ee,ie])=>{var oe;return!((oe=G.cloud.persistedSyncState)===null||oe===void 0)&&oe.value?ee?new sp(G.cloud.options.databaseUrl,G.cloud.persistedSyncState.value.serverRevision,ie,G.cloud.persistedSyncState.value.clientIdentity,$,G.cloud.webSocketStatus,ee.accessToken,ee.accessTokenExpiration):sn([]):H()}),Ta(ee=>(ee==null?void 0:ee.name)==="TokenExpiredError"?mn(!0).pipe(At(()=>Ce(this,void 0,void 0,function*(){const ie=yield G.getCurrentUser(),oe=yield _o(G.cloud.options.databaseUrl,ie);yield G.table("$logins").update(ie.userId,{accessToken:oe.accessToken,accessTokenExpiration:oe.accessTokenExpiration,claims:oe.claims,license:oe.license,data:oe.data})})),At(()=>H())):yl(()=>ee)),Ta(ee=>(G.cloud.webSocketStatus.next("error"),ee instanceof cp?yl(()=>ee):sn(fp()).pipe(At(()=>H())))))}().subscribe({next:H=>{H&&G.messageConsumer.enqueue(H)},error:H=>{},complete:()=>{}})}(x))})}(u)}catch{}}),!0);let l=!1;function c(){if(l)throw new at.DatabaseClosedError}(function(u,m){u.on.close.subscribe(m);const h=u._close;u._close=function(){h.call(this),m()}})(e,()=>{r.forEach(u=>u.unsubscribe()),l=!0,a&&a.stop(),a=null,n.next(Dt)});const d=new fi;var v;e.cloud={version:"4.0.12",options:Object.assign({},Ip),schema:null,get currentUserId(){return n.value.userId||Dt.userId},currentUser:n,syncState:new Gt({phase:"initial",status:"not-started"}),events:{syncComplete:d},persistedSyncState:new Gt(void 0),userInteraction:new Gt(void 0),webSocketStatus:new Gt("not-started"),login(u){return Ce(this,void 0,void 0,function*(){const m=vn(e);yield m.cloud.sync(),yield da(m,u)})},invites:Sp(e),roles:nf(e),configure(u){u=e.cloud.options=Object.assign(Object.assign({},e.cloud.options),u),i=!0,u.databaseUrl&&u.nameSuffix&&(e.name=`${t}-${function(m){const h=new URL(m);return h.pathname==="/"?h.hostname.split(".")[0]:h.pathname.split("/")[1]}(u.databaseUrl)}`,vn(e).reconfigure()),ya(e.cloud.schema,e.cloud.options)},logout({force:u}={}){return Ce(this,void 0,void 0,function*(){u?yield Na(vn(e),{deleteUnsyncedData:!0}):yield xc(vn(e))})},sync({wait:u,purpose:m}={wait:!0,purpose:"push"}){var h;return Ce(this,void 0,void 0,function*(){u===void 0&&(u=!0);const g=vn(e);if((((h=g.cloud.currentUser.value.license)===null||h===void 0?void 0:h.status)||"ok")!=="ok"&&(yield fs(g)),m==="pull"){const _=g.cloud.persistedSyncState.value;if(yn(g,m),u){const k=yield fr(g.cloud.persistedSyncState.pipe(rn(O=>(O==null?void 0:O.timestamp)!=null&&(!_||O.timestamp>_.timestamp))));if(k!=null&&k.error)throw new Error("Sync error: "+k.error)}}else if(yield Ul(g)){const _=g.cloud.persistedSyncState.value;yn(g,m),u&&(yield fr(sn(ur(()=>Ce(this,void 0,void 0,function*(){const k=yield Ul(g),O=yield g.getPersistedSyncState();if((O==null?void 0:O.timestamp)!==(_==null?void 0:_.timestamp)&&(O!=null&&O.error))throw new Error("Sync error: "+O.error);return k}))).pipe(rn(k=>!k))))}})},permissions:(u,m)=>function(h,g,_){if(!g)throw new TypeError("Cannot check permissions of undefined or null. A Dexie Cloud object with realmId and owner expected.");const{owner:k,realmId:O}=g;if(!_){if(typeof g.table!="function")throw new TypeError("Missing 'table' argument to permissions and table could not be extracted from entity");_=g.table()}const A=of(h),I=C=>{const q=C[O||h.cloud.currentUserId];return q?new nu(q.permissions,_,O===void 0||O===h.cloud.currentUserId||k===h.cloud.currentUserId):new nu({},_,!k||k===h.cloud.currentUserId)},x=A.pipe(an(I));return x.getValue=()=>I(A.getValue()),x}(e._novip,u,m)},e.Version.prototype._parseStoresSpec=at.override(e.Version.prototype._parseStoresSpec,u=>rp(u,e)),e.Table.prototype.newId=function({colocateWith:u}={}){const m=u&&u.substr(u.length-3);return Fc(e.cloud.schema[this.name].idPrefix||"",m)},e.Table.prototype.idPrefix=function(){var u,m;return((m=(u=this.db.cloud.schema)===null||u===void 0?void 0:u[this.name])===null||m===void 0?void 0:m.idPrefix)||""},e.use(np({currentUserObservable:e.cloud.currentUser,db:vn(e)})),e.use((v=vn(e),{stack:"dbcore",name:"implicitPropSetterMiddleware",level:1,create:u=>Object.assign(Object.assign({},u),{table:m=>{const h=u.table(m);return Object.assign(Object.assign({},h),{mutate:g=>{var _,k,O,A;if(g.trans.disableChangeTracking)return h.mutate(g);const I=g.trans;if(!((k=(_=v.cloud.schema)===null||_===void 0?void 0:_[m])===null||k===void 0)&&k.markedForSync){if(I.mode==="versionchange")return Promise.reject(new at.UpgradeError(`Dexie Cloud Addon: Cannot upgrade or populate synced table "${m}". See https://dexie.org/cloud/docs/best-practices`));if(g.type==="add"||g.type==="put"){if(m==="members")for(const x of g.values)typeof x.email=="string"&&(x.email=x.email.trim().toLowerCase());for(const x of g.values){x.owner||(x.owner=I.currentUser.userId),x.realmId||(x.realmId=I.currentUser.userId);const C=(A=(O=h.schema.primaryKey).extractKey)===null||A===void 0?void 0:A.call(O,x);typeof C=="string"&&C[0]==="#"&&g.type==="put"&&(delete g.criteria,delete g.changeSpec,delete g.updates,x.$ts=Date.now())}}}return h.mutate(g)}})}})})),e.use($h(vn(e)))}Wa.version="4.0.12",at.Cloud=Wa;class ys{constructor(){this._db=new at("FlavorAwesome",{addons:[Wa]}),this._db.version(20).stores({review:"id, created_at, updated_at, type",settings:"id"}),this._db.cloud.configure({customLoginGui:!0,databaseUrl:"https://zwa7o6jty.dexie.cloud",requireAuth:!1})}browseReview(t=null){return t===null?this._db.review.orderBy("updated_at").reverse().toArray():this._db.review.where("type").equals(t).reverse().sortBy("updated_at")}readReview(t){return this._db.review.where("id").equals(t).toArray().then(n=>n[0])}addReview(t,n){const r=Li(n);return r.id=crypto.randomUUID(),r.type=t,r.created_at=new Date,r.updated_at=new Date,r.weather=null,r.temperature=null,r.favorite=!1,this._db.review.add(r)}editReview(t){const n=Li(t);return n.updated_at=new Date,this._db.review.put(n).then(()=>this._db.review.where("id").equals(t.id).toArray().then(r=>r[0]))}deleteReview(t){return this._db.review.delete(t)}countReview(){return this._db.review.toArray().then(t=>t.reduce((n,r)=>(n.hasOwnProperty(r.type)?n[r.type]=n[r.type]+1:n[r.type]=1,n),{All:t.length}))}favoriteReview(t,n){return this._db.review.update(t,{favorite:n,updated_at:new Date}).then(()=>this._db.review.where("id").equals(t).toArray().then(r=>r[0]))}countReviews(){return this._db.review.toArray().then(t=>t.length)}createSettings(t){const n=Li(value);return n.created_at=new Date,n.updated_at=new Date,this._db.settings.add(n)}readSettings(){return this._db.settings.toArray().then(t=>t.length===0?null:t[0])}updateSettings(t){const n=Li(t);return n.updated_at=new Date,this._db.settings.put(n).then(()=>this._db.settings.toArray()).then(r=>r[0])}deleteSettings(){return this._db.settings.clear()}login(t){console.log("LOGIN EMAIL: "+t),this._db.cloud.login({email:t,grant_type:"otp"})}logout(){this._db.cloud.logout()}sync(){return console.log("DC SYNC"),this._db.cloud.sync({purpose:"pull",wait:!0})}get ui(){return this._db.cloud.userInteraction}get user(){return this._db.cloud.currentUser}get userId(){return this._db.cloud.currentUserId}}const af=/^[a-z0-9]+(-[a-z0-9]+)*$/,So=(e,t,n,r="")=>{const i=e.split(":");if(e.slice(0,1)==="@"){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const c=i.pop(),d=i.pop(),v={provider:i.length>0?i[0]:r,prefix:d,name:c};return t&&!$i(v)?null:v}const a=i[0],l=a.split("-");if(l.length>1){const c={provider:r,prefix:l.shift(),name:l.join("-")};return t&&!$i(c)?null:c}if(n&&r===""){const c={provider:r,prefix:"",name:a};return t&&!$i(c,n)?null:c}return null},$i=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1,sf=Object.freeze({left:0,top:0,width:16,height:16}),co=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Io=Object.freeze({...sf,...co}),Ha=Object.freeze({...Io,body:"",hidden:!1});function Ep(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function ru(e,t){const n=Ep(e,t);for(const r in Ha)r in co?r in e&&!(r in n)&&(n[r]=co[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function Op(e,t){const n=e.icons,r=e.aliases||Object.create(null),i=Object.create(null);function a(l){if(n[l])return i[l]=[];if(!(l in i)){i[l]=null;const c=r[l]&&r[l].parent,d=c&&a(c);d&&(i[l]=[c].concat(d))}return i[l]}return Object.keys(n).concat(Object.keys(r)).forEach(a),i}function Ap(e,t,n){const r=e.icons,i=e.aliases||Object.create(null);let a={};function l(c){a=ru(r[c]||i[c],a)}return l(t),n.forEach(l),ru(e,a)}function lf(e,t){const n=[];if(typeof e!="object"||typeof e.icons!="object")return n;e.not_found instanceof Array&&e.not_found.forEach(i=>{t(i,null),n.push(i)});const r=Op(e);for(const i in r){const a=r[i];a&&(t(i,Ap(e,i,a)),n.push(i))}return n}const Cp={provider:"",aliases:{},not_found:{},...sf};function ga(e,t){for(const n in t)if(n in e&&typeof e[n]!=typeof t[n])return!1;return!0}function uf(e){if(typeof e!="object"||e===null)return null;const t=e;if(typeof t.prefix!="string"||!e.icons||typeof e.icons!="object"||!ga(e,Cp))return null;const n=t.icons;for(const i in n){const a=n[i];if(!i||typeof a.body!="string"||!ga(a,Ha))return null}const r=t.aliases||Object.create(null);for(const i in r){const a=r[i],l=a.parent;if(!i||typeof l!="string"||!n[l]&&!r[l]||!ga(a,Ha))return null}return t}const iu=Object.create(null);function Pp(e,t){return{provider:e,prefix:t,icons:Object.create(null),missing:new Set}}function kr(e,t){const n=iu[e]||(iu[e]=Object.create(null));return n[t]||(n[t]=Pp(e,t))}function cf(e,t){return uf(t)?lf(t,(n,r)=>{r?e.icons[n]=r:e.missing.add(n)}):[]}function Tp(e,t,n){try{if(typeof n.body=="string")return e.icons[t]={...n},!0}catch{}return!1}let ui=!1;function ff(e){return typeof e=="boolean"&&(ui=e),ui}function jp(e){const t=typeof e=="string"?So(e,!0,ui):e;if(t){const n=kr(t.provider,t.prefix),r=t.name;return n.icons[r]||(n.missing.has(r)?null:void 0)}}function Dp(e,t){const n=So(e,!0,ui);if(!n)return!1;const r=kr(n.provider,n.prefix);return t?Tp(r,n.name,t):(r.missing.add(n.name),!0)}function Rp(e,t){if(typeof e!="object")return!1;if(typeof t!="string"&&(t=e.provider||""),ui&&!t&&!e.prefix){let i=!1;return uf(e)&&(e.prefix="",lf(e,(a,l)=>{Dp(a,l)&&(i=!0)})),i}const n=e.prefix;if(!$i({prefix:n,name:"a"}))return!1;const r=kr(t,n);return!!cf(r,e)}const df=Object.freeze({width:null,height:null}),vf=Object.freeze({...df,...co}),Np=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Lp=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function ou(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(Np);if(r===null||!r.length)return e;const i=[];let a=r.shift(),l=Lp.test(a);for(;;){if(l){const c=parseFloat(a);isNaN(c)?i.push(a):i.push(Math.ceil(c*t*n)/n)}else i.push(a);if(a=r.shift(),a===void 0)return i.join("");l=!l}}function Mp(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const i=e.indexOf(">",r),a=e.indexOf("</"+t);if(i===-1||a===-1)break;const l=e.indexOf(">",a);if(l===-1)break;n+=e.slice(i+1,a).trim(),e=e.slice(0,r).trim()+e.slice(l+1)}return{defs:n,content:e}}function qp(e,t){return e?"<defs>"+e+"</defs>"+t:t}function Fp(e,t,n){const r=Mp(e);return qp(r.defs,t+r.content+n)}const Up=e=>e==="unset"||e==="undefined"||e==="none";function Bp(e,t){const n={...Io,...e},r={...vf,...t},i={left:n.left,top:n.top,width:n.width,height:n.height};let a=n.body;[n,r].forEach(k=>{const O=[],A=k.hFlip,I=k.vFlip;let x=k.rotate;A?I?x+=2:(O.push("translate("+(i.width+i.left).toString()+" "+(0-i.top).toString()+")"),O.push("scale(-1 1)"),i.top=i.left=0):I&&(O.push("translate("+(0-i.left).toString()+" "+(i.height+i.top).toString()+")"),O.push("scale(1 -1)"),i.top=i.left=0);let C;switch(x<0&&(x-=Math.floor(x/4)*4),x=x%4,x){case 1:C=i.height/2+i.top,O.unshift("rotate(90 "+C.toString()+" "+C.toString()+")");break;case 2:O.unshift("rotate(180 "+(i.width/2+i.left).toString()+" "+(i.height/2+i.top).toString()+")");break;case 3:C=i.width/2+i.left,O.unshift("rotate(-90 "+C.toString()+" "+C.toString()+")");break}x%2===1&&(i.left!==i.top&&(C=i.left,i.left=i.top,i.top=C),i.width!==i.height&&(C=i.width,i.width=i.height,i.height=C)),O.length&&(a=Fp(a,'<g transform="'+O.join(" ")+'">',"</g>"))});const l=r.width,c=r.height,d=i.width,v=i.height;let u,m;l===null?(m=c===null?"1em":c==="auto"?v:c,u=ou(m,d/v)):(u=l==="auto"?d:l,m=c===null?ou(u,v/d):c==="auto"?v:c);const h={},g=(k,O)=>{Up(O)||(h[k]=O.toString())};g("width",u),g("height",m);const _=[i.left,i.top,d,v];return h.viewBox=_.join(" "),{attributes:h,viewBox:_,body:a}}const Kp=/\sid="(\S+)"/g,zp="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Vp=0;function Wp(e,t=zp){const n=[];let r;for(;r=Kp.exec(e);)n.push(r[1]);if(!n.length)return e;const i="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(a=>{const l=typeof t=="function"?t(a):t+(Vp++).toString(),c=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+c+')([")]|\\.[a-z])',"g"),"$1"+l+i+"$3")}),e=e.replace(new RegExp(i,"g"),""),e}const Ya=Object.create(null);function Hp(e,t){Ya[e]=t}function Ga(e){return Ya[e]||Ya[""]}function ms(e){let t;if(typeof e.resources=="string")t=[e.resources];else if(t=e.resources,!(t instanceof Array)||!t.length)return null;return{resources:t,path:e.path||"/",maxURL:e.maxURL||500,rotate:e.rotate||750,timeout:e.timeout||5e3,random:e.random===!0,index:e.index||0,dataAfterTimeout:e.dataAfterTimeout!==!1}}const gs=Object.create(null),Qr=["https://api.simplesvg.com","https://api.unisvg.com"],eo=[];for(;Qr.length>0;)Qr.length===1||Math.random()>.5?eo.push(Qr.shift()):eo.push(Qr.pop());gs[""]=ms({resources:["https://api.iconify.design"].concat(eo)});function Yp(e,t){const n=ms(t);return n===null?!1:(gs[e]=n,!0)}function bs(e){return gs[e]}const Gp=()=>{let e;try{if(e=fetch,typeof e=="function")return e}catch{}};let au=Gp();function Jp(e,t){const n=bs(e);if(!n)return 0;let r;if(!n.maxURL)r=0;else{let i=0;n.resources.forEach(l=>{i=Math.max(i,l.length)});const a=t+".json?icons=";r=n.maxURL-i-n.path.length-a.length}return r}function Qp(e){return e===404}const Zp=(e,t,n)=>{const r=[],i=Jp(e,t),a="icons";let l={type:a,provider:e,prefix:t,icons:[]},c=0;return n.forEach((d,v)=>{c+=d.length+1,c>=i&&v>0&&(r.push(l),l={type:a,provider:e,prefix:t,icons:[]},c=d.length),l.icons.push(d)}),r.push(l),r};function Xp(e){if(typeof e=="string"){const t=bs(e);if(t)return t.path}return"/"}const $p=(e,t,n)=>{if(!au){n("abort",424);return}let r=Xp(t.provider);switch(t.type){case"icons":{const a=t.prefix,c=t.icons.join(","),d=new URLSearchParams({icons:c});r+=a+".json?"+d.toString();break}case"custom":{const a=t.uri;r+=a.slice(0,1)==="/"?a.slice(1):a;break}default:n("abort",400);return}let i=503;au(e+r).then(a=>{const l=a.status;if(l!==200){setTimeout(()=>{n(Qp(l)?"abort":"next",l)});return}return i=501,a.json()}).then(a=>{if(typeof a!="object"||a===null){setTimeout(()=>{a===404?n("abort",a):n("next",i)});return}setTimeout(()=>{n("success",a)})}).catch(()=>{n("next",i)})},ey={prepare:Zp,send:$p};function ty(e){const t={loaded:[],missing:[],pending:[]},n=Object.create(null);e.sort((i,a)=>i.provider!==a.provider?i.provider.localeCompare(a.provider):i.prefix!==a.prefix?i.prefix.localeCompare(a.prefix):i.name.localeCompare(a.name));let r={provider:"",prefix:"",name:""};return e.forEach(i=>{if(r.name===i.name&&r.prefix===i.prefix&&r.provider===i.provider)return;r=i;const a=i.provider,l=i.prefix,c=i.name,d=n[a]||(n[a]=Object.create(null)),v=d[l]||(d[l]=kr(a,l));let u;c in v.icons?u=t.loaded:l===""||v.missing.has(c)?u=t.missing:u=t.pending;const m={provider:a,prefix:l,name:c};u.push(m)}),t}function hf(e,t){e.forEach(n=>{const r=n.loaderCallbacks;r&&(n.loaderCallbacks=r.filter(i=>i.id!==t))})}function ny(e){e.pendingCallbacksFlag||(e.pendingCallbacksFlag=!0,setTimeout(()=>{e.pendingCallbacksFlag=!1;const t=e.loaderCallbacks?e.loaderCallbacks.slice(0):[];if(!t.length)return;let n=!1;const r=e.provider,i=e.prefix;t.forEach(a=>{const l=a.icons,c=l.pending.length;l.pending=l.pending.filter(d=>{if(d.prefix!==i)return!0;const v=d.name;if(e.icons[v])l.loaded.push({provider:r,prefix:i,name:v});else if(e.missing.has(v))l.missing.push({provider:r,prefix:i,name:v});else return n=!0,!0;return!1}),l.pending.length!==c&&(n||hf([e],a.id),a.callback(l.loaded.slice(0),l.missing.slice(0),l.pending.slice(0),a.abort))})}))}let ry=0;function iy(e,t,n){const r=ry++,i=hf.bind(null,n,r);if(!t.pending.length)return i;const a={id:r,icons:t,callback:e,abort:i};return n.forEach(l=>{(l.loaderCallbacks||(l.loaderCallbacks=[])).push(a)}),i}function oy(e,t=!0,n=!1){const r=[];return e.forEach(i=>{const a=typeof i=="string"?So(i,t,n):i;a&&r.push(a)}),r}var ay={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function sy(e,t,n,r){const i=e.resources.length,a=e.random?Math.floor(Math.random()*i):e.index;let l;if(e.random){let L=e.resources.slice(0);for(l=[];L.length>1;){const V=Math.floor(Math.random()*L.length);l.push(L[V]),L=L.slice(0,V).concat(L.slice(V+1))}l=l.concat(L)}else l=e.resources.slice(a).concat(e.resources.slice(0,a));const c=Date.now();let d="pending",v=0,u,m=null,h=[],g=[];typeof r=="function"&&g.push(r);function _(){m&&(clearTimeout(m),m=null)}function k(){d==="pending"&&(d="aborted"),_(),h.forEach(L=>{L.status==="pending"&&(L.status="aborted")}),h=[]}function O(L,V){V&&(g=[]),typeof L=="function"&&g.push(L)}function A(){return{startTime:c,payload:t,status:d,queriesSent:v,queriesPending:h.length,subscribe:O,abort:k}}function I(){d="failed",g.forEach(L=>{L(void 0,u)})}function x(){h.forEach(L=>{L.status==="pending"&&(L.status="aborted")}),h=[]}function C(L,V,te){const J=V!=="success";switch(h=h.filter(G=>G!==L),d){case"pending":break;case"failed":if(J||!e.dataAfterTimeout)return;break;default:return}if(V==="abort"){u=te,I();return}if(J){u=te,h.length||(l.length?q():I());return}if(_(),x(),!e.random){const G=e.resources.indexOf(L.resource);G!==-1&&G!==e.index&&(e.index=G)}d="completed",g.forEach(G=>{G(te)})}function q(){if(d!=="pending")return;_();const L=l.shift();if(L===void 0){if(h.length){m=setTimeout(()=>{_(),d==="pending"&&(x(),I())},e.timeout);return}I();return}const V={status:"pending",resource:L,callback:(te,J)=>{C(V,te,J)}};h.push(V),v++,m=setTimeout(q,e.rotate),n(L,t,V.callback)}return setTimeout(q),A}function pf(e){const t={...ay,...e};let n=[];function r(){n=n.filter(c=>c().status==="pending")}function i(c,d,v){const u=sy(t,c,d,(m,h)=>{r(),v&&v(m,h)});return n.push(u),u}function a(c){return n.find(d=>c(d))||null}return{query:i,find:a,setIndex:c=>{t.index=c},getIndex:()=>t.index,cleanup:r}}function su(){}const ba=Object.create(null);function ly(e){if(!ba[e]){const t=bs(e);if(!t)return;const n=pf(t),r={config:t,redundancy:n};ba[e]=r}return ba[e]}function uy(e,t,n){let r,i;if(typeof e=="string"){const a=Ga(e);if(!a)return n(void 0,424),su;i=a.send;const l=ly(e);l&&(r=l.redundancy)}else{const a=ms(e);if(a){r=pf(a);const l=e.resources?e.resources[0]:"",c=Ga(l);c&&(i=c.send)}}return!r||!i?(n(void 0,424),su):r.query(t,i,n)().abort}function lu(){}function cy(e){e.iconsLoaderFlag||(e.iconsLoaderFlag=!0,setTimeout(()=>{e.iconsLoaderFlag=!1,ny(e)}))}function fy(e){const t=[],n=[];return e.forEach(r=>{(r.match(af)?t:n).push(r)}),{valid:t,invalid:n}}function Zr(e,t,n){function r(){const i=e.pendingIcons;t.forEach(a=>{i&&i.delete(a),e.icons[a]||e.missing.add(a)})}if(n&&typeof n=="object")try{if(!cf(e,n).length){r();return}}catch(i){console.error(i)}r(),cy(e)}function uu(e,t){e instanceof Promise?e.then(n=>{t(n)}).catch(()=>{t(null)}):t(e)}function dy(e,t){e.iconsToLoad?e.iconsToLoad=e.iconsToLoad.concat(t).sort():e.iconsToLoad=t,e.iconsQueueFlag||(e.iconsQueueFlag=!0,setTimeout(()=>{e.iconsQueueFlag=!1;const{provider:n,prefix:r}=e,i=e.iconsToLoad;if(delete e.iconsToLoad,!i||!i.length)return;const a=e.loadIcon;if(e.loadIcons&&(i.length>1||!a)){uu(e.loadIcons(i,r,n),u=>{Zr(e,i,u)});return}if(a){i.forEach(u=>{const m=a(u,r,n);uu(m,h=>{const g=h?{prefix:r,icons:{[u]:h}}:null;Zr(e,[u],g)})});return}const{valid:l,invalid:c}=fy(i);if(c.length&&Zr(e,c,null),!l.length)return;const d=r.match(af)?Ga(n):null;if(!d){Zr(e,l,null);return}d.prepare(n,r,l).forEach(u=>{uy(n,u,m=>{Zr(e,u.icons,m)})})}))}const vy=(e,t)=>{const n=oy(e,!0,ff()),r=ty(n);if(!r.pending.length){let d=!0;return t&&setTimeout(()=>{d&&t(r.loaded,r.missing,r.pending,lu)}),()=>{d=!1}}const i=Object.create(null),a=[];let l,c;return r.pending.forEach(d=>{const{provider:v,prefix:u}=d;if(u===c&&v===l)return;l=v,c=u,a.push(kr(v,u));const m=i[v]||(i[v]=Object.create(null));m[u]||(m[u]=[])}),r.pending.forEach(d=>{const{provider:v,prefix:u,name:m}=d,h=kr(v,u),g=h.pendingIcons||(h.pendingIcons=new Set);g.has(m)||(g.add(m),i[v][u].push(m))}),a.forEach(d=>{const v=i[d.provider][d.prefix];v.length&&dy(d,v)}),t?iy(t,r,a):lu};function hy(e,t){const n={...e};for(const r in t){const i=t[r],a=typeof i;r in df?(i===null||i&&(a==="string"||a==="number"))&&(n[r]=i):a===typeof n[r]&&(n[r]=r==="rotate"?i%4:i)}return n}const py=/[\s,]+/;function yy(e,t){t.split(py).forEach(n=>{switch(n.trim()){case"horizontal":e.hFlip=!0;break;case"vertical":e.vFlip=!0;break}})}function my(e,t=0){const n=e.replace(/^-?[0-9.]*/,"");function r(i){for(;i<0;)i+=4;return i%4}if(n===""){const i=parseInt(e);return isNaN(i)?0:r(i)}else if(n!==e){let i=0;switch(n){case"%":i=25;break;case"deg":i=90}if(i){let a=parseFloat(e.slice(0,e.length-n.length));return isNaN(a)?0:(a=a/i,a%1===0?r(a):0)}}return t}function gy(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}function by(e){return e.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function _y(e){return"data:image/svg+xml,"+by(e)}function wy(e){return'url("'+_y(e)+'")'}const cu={...vf,inline:!1},ky={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},xy={display:"inline-block"},Ja={"background-color":"currentColor"},yf={"background-color":"transparent"},fu={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},du={"-webkit-mask":Ja,mask:Ja,background:yf};for(const e in du){const t=du[e];for(const n in fu)t[e+"-"+n]=fu[n]}function Sy(e){return e+(e.match(/^[-0-9.]+$/)?"px":"")}function Iy(e,t){const n=hy(cu,t),r=t.mode||"svg",i=r==="svg"?{...ky}:{};e.body.indexOf("xlink:")===-1&&delete i["xmlns:xlink"];let a=typeof t.style=="string"?t.style:"";for(let A in t){const I=t[A];if(I!==void 0)switch(A){case"icon":case"style":case"onLoad":case"mode":case"ssr":break;case"inline":case"hFlip":case"vFlip":n[A]=I===!0||I==="true"||I===1;break;case"flip":typeof I=="string"&&yy(n,I);break;case"color":a=a+(a.length>0&&a.trim().slice(-1)!==";"?";":"")+"color: "+I+"; ";break;case"rotate":typeof I=="string"?n[A]=my(I):typeof I=="number"&&(n[A]=I);break;case"ariaHidden":case"aria-hidden":I!==!0&&I!=="true"&&delete i["aria-hidden"];break;default:if(A.slice(0,3)==="on:")break;cu[A]===void 0&&(i[A]=I)}}const l=Bp(e,n),c=l.attributes;if(n.inline&&(a="vertical-align: -0.125em; "+a),r==="svg"){Object.assign(i,c),a!==""&&(i.style=a);let A=0,I=t.id;return typeof I=="string"&&(I=I.replace(/-/g,"_")),{svg:!0,attributes:i,body:Wp(l.body,I?()=>I+"ID"+A++:"iconifySvelte")}}const{body:d,width:v,height:u}=e,m=r==="mask"||(r==="bg"?!1:d.indexOf("currentColor")!==-1),h=gy(d,{...c,width:v+"",height:u+""}),_={"--svg":wy(h)},k=A=>{const I=c[A];I&&(_[A]=Sy(I))};k("width"),k("height"),Object.assign(_,xy,m?Ja:yf);let O="";for(const A in _)O+=A+": "+_[A]+";";return i.style=O+a,{svg:!1,attributes:i}}ff(!0);Hp("",ey);if(typeof document<"u"&&typeof window<"u"){const e=window;if(e.IconifyPreload!==void 0){const t=e.IconifyPreload,n="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!Rp(r))&&console.error(n)}catch{console.error(n)}})}if(e.IconifyProviders!==void 0){const t=e.IconifyProviders;if(typeof t=="object"&&t!==null)for(let n in t){const r="IconifyProviders["+n+"] is invalid.";try{const i=t[n];if(typeof i!="object"||!i||i.resources===void 0)continue;Yp(n,i)||console.error(r)}catch{console.error(r)}}}}function Ey(e,t,n,r,i){function a(){t.loading&&(t.loading.abort(),t.loading=null)}if(typeof e=="object"&&e!==null&&typeof e.body=="string")return t.name="",a(),{data:{...Io,...e}};let l;if(typeof e!="string"||(l=So(e,!1,!0))===null)return a(),null;const c=jp(l);if(!c)return n&&(!t.loading||t.loading.name!==e)&&(a(),t.name="",t.loading={name:e,abort:vy([l],r)}),null;a(),t.name!==e&&(t.name=e,i&&!t.destroyed&&i(e));const d=["iconify"];return l.prefix!==""&&d.push("iconify--"+l.prefix),l.provider!==""&&d.push("iconify--"+l.provider),{data:c,classes:d}}function Oy(e,t){return e?Iy({...Io,...e},t):null}var Ay=It("<svg><!></svg>"),Cy=ue("<span></span>");function De(e,t){Qe(t,!0);const n={name:"",loading:null,destroyed:!1},r=_d(t,["$$slots","$$events","$$legacy"]);let i=Ge(!1),a=Ge(0),l=Ge(null);Sr(()=>{y(a);const m=!!t.ssr||y(i),h=Ey(t.icon,n,m,c,t.onload),g=h?Oy(h.data,r):null;g&&h.classes&&(g.attributes.class=(typeof r.class=="string"?r.class+" ":"")+h.classes.join(" ")),Ee(l,g,!0)});function c(){fd(a)}po(()=>{Ee(i,!0)}),wd(()=>{n.destroyed=!0,n.loading&&(n.loading.abort(),n.loading=null)});var d=He(),v=Ae(d);{var u=m=>{var h=He(),g=Ae(h);{var _=O=>{var A=Ay();let I;var x=P(A);Ed(x,()=>y(l).body,!0),E(A),_e(()=>I=ka(A,I,{...y(l).attributes})),Q(O,A)},k=O=>{var A=Cy();let I;_e(()=>I=ka(A,I,{...y(l).attributes})),Q(O,A)};he(g,O=>{y(l).svg?O(_):O(k,!1)})}Q(m,h)};he(v,m=>{y(l)&&m(u)})}Q(e,d),Ze()}var Py=ue('<button type="button" class="svelte-ltxfh7"><!></button>');function Kt(e,t){let n=ge(t,"size",3,"md"),r=fe(()=>{let d=40;switch(n()){case"sm":d=32;break;case"xl":d=56;break;case"2xl":d=96;break;default:d=136;break}return d}),i=fe(()=>{let d=24;switch(n()){case"sm":d=20;break;case"xl":d=32;break;case"2xl":d=40;break;default:d=24;break}return d});var a=Py();a.__click=function(...d){var v;(v=t.onclick)==null||v.apply(this,d)};let l;var c=P(a);De(c,{get height(){return y(i)},get icon(){return t.name},get width(){return y(i)}}),E(a),_e(()=>l=Wn(a,"",l,{height:y(r),width:y(r)})),Q(e,a)}it(["click"]);class Ty{constructor(t){const n=new Intl.NumberFormat(t).formatToParts(12345.6),r=[...new Intl.NumberFormat(t,{useGrouping:!1}).format(9876543210)].reverse(),i=new Map(r.map((a,l)=>[a,l]));this.group=new RegExp(`[${n.find(a=>a.type==="group").value}]`,"g"),this.decimal=new RegExp(`[${n.find(a=>a.type==="decimal").value}]`),this.numeral=new RegExp(`[${r.join("")}]`,"g"),this.index=a=>i.get(a)}parse(t){return(t=t.trim().replace(this.group,"").replace(this.decimal,".").replace(this.numeral,this.index))?+t:NaN}}function jy(e,t,n){t().trim().length===0&&t(null),n.onchange&&n.onchange({name:n.name,value:t()})}var Dy=ue('<p class="svelte-5clkhh"> </p>'),Ry=ue('<button tabindex="-1" type="button" class="svelte-5clkhh"><!></button>'),Ny=ue('<label class="svelte-5clkhh"><div class="field svelte-5clkhh"><p class="svelte-5clkhh"> </p> <div class="parts svelte-5clkhh"><input type="text" class="svelte-5clkhh"> <!></div></div> <!></label> <!>',1);function gn(e,t){Qe(t,!0);let n=ge(t,"mode",3,"text"),r=ge(t,"value",7,null),i;function a(C){C.preventDefault(),r(null),i.focus(),t.onchange&&t.onchange({name:t.name,value:r()})}function l(){if(n()==="numeric"||n()==="decimal"){const C=n()==="numeric"?0:2;r()!==null&&r(new Number(r()).toLocaleString(navigator.language,{minimumFractionDigits:C,maximumFractionDigits:C}))}}function c(){if((n()==="numeric"||n()==="decimal")&&r()!==null){const C=new Ty(navigator.language);r(C.parse(r()).toString(10))}}var d=Ny(),v=Ae(d),u=P(v),m=P(u),h=P(m,!0);E(m);var g=W(m,2),_=P(g);jd(_),_.__input=[jy,r,t],st(_,C=>i=C,()=>i);var k=W(_,2);{var O=C=>{var q=Dy(),L=P(q,!0);E(q),_e(()=>Oe(L,t.suffix)),Q(C,q)};he(k,C=>{t.suffix&&C(O)})}E(g),E(u);var A=W(u,2);{var I=C=>{var q=Ry();q.__click=a;var L=P(q);De(L,{height:"24",icon:"material-symbols:cancel-outline",width:"24"}),E(q),Q(C,q)};he(A,C=>{r()!==null&&C(I)})}E(v);var x=W(v,2);pn(x,()=>t.children??xr),_e(()=>{Oe(h,t.label),Ne(_,"inputmode",n()),Ne(_,"placeholder",t.placeholder)}),oi("blur",_,l),oi("focus",_,c),Ru(_,r),Q(e,d),Ze()}it(["input","click"]);function Ly(e,t,n,r){if(y(t)===null){alert("Name is required.");return}if(y(n)===null){alert("Email address is required.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y(n))){alert("Email address is invalid.");return}console.log("SEND: "+y(n)),r.login(y(n))}function My(e,t){t.logout()}function qy(e,t,n){console.log("OTP: "+y(t)),y(n).onSubmit({otp:y(t)})}var Fy=ue('<form class="svelte-154zepi"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <button type="button" class="svelte-154zepi">Sign in</button></form>'),Uy=ue('<img alt="Feature details" class="svelte-154zepi"> <ul class="upsell svelte-154zepi"><li class="svelte-154zepi">â All features</li> <li class="svelte-154zepi">â All flavors</li> <li class="svelte-154zepi">â Unlimited reviews</li></ul> <ul class="steps svelte-154zepi"><li class="selected svelte-154zepi"><p class="svelte-154zepi"><span class="svelte-154zepi"><!></span> Create an<br>account</p></li> <li class="svelte-154zepi"><p class="svelte-154zepi"><span class="svelte-154zepi"><!></span> Select<br>a plan</p></li> <li class="svelte-154zepi"><p class="svelte-154zepi"><span class="svelte-154zepi"><!></span> Enjoy the<br>Awesome</p></li></ul> <form class="svelte-154zepi"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <button type="button" class="svelte-154zepi">Send verification</button> <button type="button" class="svelte-154zepi">Logout</button></form>',1),By=ue('<section class="svelte-154zepi"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <article class="svelte-154zepi"><!></article></section>');function Ky(e,t){Qe(t,!0);let n=new ys,r,i=Ge(null),a=Ge(null),l=Ge(null),c=Ge(null),d=fe(()=>y(a)===null?"sign_in":y(a).type);function v(){return r.animate([{top:0},{top:"100vh"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished}function u(){r.animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"})}po(()=>{console.log("CURRENT"),console.log(n.userId),n.ui.subscribe(I=>{console.log("INTERACTION"),console.log(I),I===void 0?(console.log("INTERACTION:USER"),console.log(n.userId),n.userId!=="unauthorized"&&(console.log("INTERACTION: LOGGED IN"),n.sync().then(()=>{console.log("INTERACTION: INITIAL SYNC"),t.onchange&&t.onchange()})),Ee(a,null)):(console.log("MESSAGE"),console.log(I.messageCode),Ee(a,I,!0))})});function m(){v()}var h=By(),g=P(h);{const I=C=>{Kt(C,{name:"material-symbols:close",onclick:m})},x=C=>{Kt(C,{name:"material-symbols:done"})};sr(g,()=>({"--primary-accent-color":"#5fb2ff"})),Xa(g.lastChild,{label:"Account",variation:"sm",left:I,right:x}),E(g)}var _=W(g,2),k=P(_);{var O=I=>{var x=Fy(),C=P(x);sr(C,()=>({"--primary-accent-color":"#5fb2ff"})),gn(C.lastChild,{label:"OTP",onchange:L=>Ee(c,L.value,!0),placeholder:"One-time password from email"}),E(C);var q=W(C,2);q.__click=[qy,c,a],E(x),Q(I,x)},A=I=>{var x=Uy(),C=W(Ae(x),4),q=P(C),L=P(q),V=P(L),te=P(V);De(te,{height:"24",icon:"mynaui:one-circle-solid",width:"24"}),E(V),St(3),E(L),E(q);var J=W(q,2),G=P(J),ne=P(G),$=P(ne);De($,{height:"24",icon:"mynaui:two-circle",width:"24"}),E(ne),St(3),E(G),E(J);var H=W(J,2),ee=P(H),ie=P(ee),oe=P(ie);De(oe,{height:"24",icon:"mynaui:three-circle",width:"24"}),E(ie),St(3),E(ee),E(H),E(C);var Re=W(C,2),je=P(Re);sr(je,()=>({"--primary-accent-color":"#5fb2ff"})),gn(je.lastChild,{label:"Name",placeholder:"How should I refer to you?",onchange:Fe=>Ee(l,Fe.value,!0)}),E(je);var le=W(je,2);sr(le,()=>({"--primary-accent-color":"#5fb2ff"})),gn(le.lastChild,{label:"Email address",placeholder:"Use email to login",onchange:Fe=>Ee(i,Fe.value,!0)}),E(le);var B=W(le,2);B.__click=[Ly,l,i,n];var Le=W(B,2);Le.__click=[My,n],E(Re),Q(I,x)};he(k,I=>{y(d)==="otp"?I(O):I(A,!1)})}return E(_),E(h),st(h,I=>r=I,()=>r),Q(e,h),Ze({hide:v,show:u})}it(["click"]);var zy=It('<circle class="ring svelte-7yw9ie" cx="0" cy="0"></circle>'),Vy=It('<circle cx="0" r="2" class="svelte-7yw9ie"></circle>'),Wy=It('<g class="spoke"><rect width="1" x="-0.50" y="0" class="svelte-7yw9ie"></rect><!></g>'),Hy=It("<text> </text>"),Yy=It('<g class="labels"></g>'),Gy=It('<svg class="svelte-7yw9ie"><g class="chart svelte-7yw9ie"><g class="wheel svelte-7yw9ie"></g><g class="spokes svelte-7yw9ie"></g><!><path class="svelte-7yw9ie"></path></g></svg>');function fo(e,t){Qe(t,!0);let n=ge(t,"interactive",3,!1),r=ge(t,"labels",3,!0),i=ge(t,"maximum",3,5),a=ge(t,"rotate",3,0),l=ge(t,"spokes",19,()=>[]),c=ge(t,"value",19,()=>[]),d=Ge(void 0),v=Ge(void 0),u=150;Sr(()=>{if(y(v))if(n())y(d).setAttributeNS(null,"viewBox","-70 -150 140 200");else{const q=y(v).getBoundingClientRect();y(d).setAttributeNS(null,"viewBox",`${0-q.width/2} ${0-q.height/2} ${q.width} ${q.height}`)}});let m=fe(()=>{if(c().length===0)return"";const q=360/l().length*(Math.PI/180);let L=null;for(let V=0;V<c().length;V++){const te=c()[V]===0?.25:c()[V],J=(u-3)/i()*te,G={x:J*Math.cos(q*V-1.5708),y:J*Math.sin(q*V-1.5708)};V===0?L=`M ${G.x} ${G.y} `:L=L+`L ${G.x} ${G.y} `}return L+"Z"});function h(q){let L="middle",V="auto";const J=360/l().length*(Math.PI/180)*q*(180/Math.PI);return J===0?(L="middle",V="auto"):J>0&&J<90?(L="start",V="auto"):J===90?(L="start",V="middle"):J>90&&J<180?(L="start",V="hanging"):J===180?(L="middle",V="hanging"):J>180&&J<270?(L="end",V="hanging"):J===270?(L="end",V="middle"):(L="end",V="auto"),{"dominant-baseline":V,"text-anchor":L}}var g=Gy(),_=P(g);let k;var O=P(_);dt(O,21,()=>({length:i()}),ft,(q,L,V)=>{var te=zy();Ne(te,"stroke-width",V===0?3:1),Wn(te,"",{},{fill:V===0?"#ffffff":"none"}),_e(()=>Ne(te,"r",(u-3)/i()*(i()-V))),Q(q,te)}),E(O);var A=W(O);dt(A,21,l,ft,(q,L,V)=>{var te=Wy();let J;var G=P(te);Ne(G,"height",u-3);var ne=W(G);dt(ne,17,()=>({length:i()}),ft,($,H,ee)=>{var ie=Vy();_e(()=>Ne(ie,"cy",(u-3)/i()*(ee+1))),Q($,ie)}),E(te),_e(()=>J=Wn(te,"",J,{rotate:`${360/l().length*V}deg`})),Q(q,te)}),E(A);var I=W(A);{var x=q=>{var L=Yy();dt(L,21,l,ft,(V,te,J)=>{var G=Hy();const ne=fe(()=>360/l().length*(Math.PI/180));let $;var H=P(G,!0);E(G),_e((ee,ie,oe)=>{$=ka(G,$,{...ee,x:ie,y:oe},"svelte-7yw9ie"),Oe(H,y(te))},[()=>h(J),()=>(u+5)*Math.cos(y(ne)*J-1.5708),()=>(u+5)*Math.sin(y(ne)*J-1.5708)]),Q(V,G)}),E(L),Q(q,L)};he(I,q=>{r()&&q(x)})}var C=W(I);E(_),st(_,q=>Ee(v,q),()=>y(v)),E(g),st(g,q=>Ee(d,q),()=>y(d)),_e(()=>{k=Wn(_,"",k,{rotate:`${a()??""}deg`}),Ne(C,"d",y(m))}),Q(e,g),Ze()}var Jy=ue('<h3 class="svelte-1kvllfw">Profile</h3> <div class="wheel svelte-1kvllfw"><!></div> <h3 class="svelte-1kvllfw">Recommendations</h3>',1),Qy=ue('<article><h3 class="svelte-1kvllfw">At a Glance</h3> <div class="stats svelte-1kvllfw"><div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Entries</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Photos</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Day of posts</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Time of posts</p></div></div> <h3 class="svelte-1kvllfw">Ratings</h3> <div class="stats svelte-1kvllfw"><div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Ratings</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Average</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Middle</p></div> <div class="svelte-1kvllfw"><p class="svelte-1kvllfw"> </p> <p class="label svelte-1kvllfw">Most frequent</p></div></div> <!></article>');function Zy(e,t){Qe(t,!0);let n=ge(t,"flavor",3,null),r=ge(t,"hidden",3,!1),i=ge(t,"items",19,()=>[]);const a=fe(()=>i().length),l=fe(()=>i().reduce((ke,Pe)=>(ke=ke+(Pe.photos===null?0:Pe.photos.length),ke),0)),c=fe(()=>{if(i().length===0)return null;const ke={};for(let Te=0;Te<i().length;Te++)ke.hasOwnProperty(i()[Te].created_at.getDay())?ke[i()[Te].created_at.getDay()]=ke[i()[Te].created_at.getDay()]+1:ke[i()[Te].created_at.getDay()]=1;let Pe=0,Se=0;const Me=Object.keys(ke);for(let Te=0;Te<Me.length;Te++)ke[Me[Te]]>Pe&&(Pe=ke[Me[Te]],Se=Me[Te]);return Se}),d=fe(()=>{if(i().length===0)return null;const ke={};for(let Te=0;Te<i().length;Te++)ke.hasOwnProperty(i()[Te].created_at.getHours())?ke[i()[Te].created_at.getHours()]=ke[i()[Te].created_at.getHours()]+1:ke[i()[Te].created_at.getHours()]=1;let Pe=0,Se=0;const Me=Object.keys(ke);for(let Te=0;Te<Me.length;Te++)ke[Me[Te]]>Pe&&(Pe=ke[Me[Te]],Se=Me[Te]);return Se}),v=fe(()=>i().reduce((ke,Pe)=>(ke=ke+(Pe.rating===null?0:1),ke),0)),u=fe(()=>{const ke=i().reduce((Pe,Se)=>(Pe=Pe+(Se.rating===null?0:Se.rating),Pe),0);return y(v)===0?0:ke/y(v)}),m=fe(()=>{const ke=i().reduce((Se,Me)=>(Me.rating!==null&&Se.push(Me.rating),Se),[]);if(ke.length===0)return 0;ke.sort((Se,Me)=>Se>Me?1:Se<Me?-1:0);const Pe=Math.floor(ke.length/2);return ke.length%2===0?(ke[Pe-1]+ke[Pe])/2:ke[Pe]}),h=fe(()=>{const ke=i().reduce((Te,lt)=>(lt.rating!==null&&Te.push(lt.rating),Te),[]);if(ke.length===0)return[];const Pe={},Se=[];let Me=0;for(const Te of ke)Pe[Te]=(Pe[Te]||0)+1,Pe[Te]>Me&&(Me=Pe[Te]);for(const Te in Pe)Pe[Te]===Me&&Se.push(Number(Te));return Se.length===Object.keys(Pe).length?[]:Se});let g=fe(()=>{if(n()){for(let ke=0;ke<n().fields.length;ke++)if(n().fields[ke].kind==="profile")return n().fields[ke].options;return[]}return[]});function _(ke){const Pe=new Date,Se=ke-Pe.getDay();return Pe.setDate(Pe.getDate()+Se),new Intl.DateTimeFormat(navigator.language,{weekday:"long"}).format(Pe)}function k(ke){const Pe=new Date;return Pe.setHours(ke),Pe.toLocaleTimeString(navigator.language,{hour:"numeric",hour12:!0})}var O=Qy();let A;var I=W(P(O),2),x=P(I),C=P(x),q=P(C,!0);E(C),St(2),E(x);var L=W(x,2),V=P(L),te=P(V,!0);E(V),St(2),E(L);var J=W(L,2),G=P(J),ne=P(G,!0);E(G),St(2),E(J);var $=W(J,2),H=P($),ee=P(H,!0);E(H),St(2),E($),E(I);var ie=W(I,4),oe=P(ie),Re=P(oe),je=P(Re,!0);E(Re),St(2),E(oe);var le=W(oe,2),B=P(le),Le=P(B,!0);E(B),St(2),E(le);var Fe=W(le,2),Ke=P(Fe),Xe=P(Ke,!0);E(Ke),St(2),E(Fe);var de=W(Fe,2),we=P(de),qe=P(we,!0);E(we),St(2),E(de),E(ie);var ot=W(ie,2);{var me=ke=>{var Pe=Jy(),Se=W(Ae(Pe),2),Me=P(Se);fo(Me,{get spokes(){return y(g)}}),E(Se),St(2),Q(ke,Pe)};he(ot,ke=>{n()&&ke(me)})}E(O),_e((ke,Pe,Se,Me,Te,lt)=>{A=rt(O,1,"svelte-1kvllfw",null,A,ke),Oe(q,y(a)),Oe(te,y(l)),Oe(ne,Pe),Oe(ee,Se),Oe(je,y(v)),Oe(Le,Me),Oe(Xe,Te),Oe(qe,lt)},[()=>({hidden:r()}),()=>y(c)===null?"TBD":_(y(c)),()=>y(d)===null?"TBD":k(y(d)),()=>y(u).toFixed(2),()=>y(m).toFixed(2),()=>y(h).length===0?"0":y(h).join(", ")]),Q(e,O),Ze()}function Xy(e,t){window.open("https://flavorawesome.com","_blank"),t()}var $y=(e,t)=>t(),em=(e,t)=>t(null),tm=(e,t,n)=>t(y(n).id),nm=ue('<li><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i"> </span> <span class="svelte-84fq4i"> </span></button></li>'),rm=ue('<section class="svelte-84fq4i"><article class="scrim svelte-84fq4i"><button type="button" class="svelte-84fq4i"><!></button></article> <article class="drawer svelte-84fq4i"><h3 class="svelte-84fq4i">Flavors</h3> <ul class="svelte-84fq4i"><li><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">All</span> <span class="svelte-84fq4i"> </span></button></li> <!></ul> <ul class="svelte-84fq4i"><li class="svelte-84fq4i"><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">About Flavor Awesome</span> <span class="svelte-84fq4i"></span></button></li> <li class="svelte-84fq4i"><button type="button" class="svelte-84fq4i"><span class="svelte-84fq4i"><!></span> <span class="svelte-84fq4i">Help and Feedback</span> <span class="svelte-84fq4i"></span></button></li></ul></article></section>');function im(e,t){Qe(t,!0);let n=ge(t,"selected",7,null),r,i,a;function l(oe){n()!==oe?(n(oe),t.onchange&&(c(),t.onchange(n()))):c()}function c(){i.animate([{opacity:"1.0"},{opacity:"0"}],{duration:300,easing:"ease-in-out",fill:"forwards"}),r.animate([{left:"0"},{left:"-100vw"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{a.style.left="-100vw"})}function d(){a.style.left="0",i.animate([{opacity:"0"},{opacity:"1.0"}],{duration:300,easing:"ease-in-out",fill:"forwards"}),r.animate([{left:"-100vw"},{left:"0"}],{duration:300,easing:"ease-in-out",fill:"forwards"})}var v=rm(),u=P(v),m=P(u);m.__click=[$y,c];var h=P(m);De(h,{color:"#ffffff",height:"24",icon:"material-symbols:cancel-rounded",width:"24"}),E(m),E(u),st(u,oe=>i=oe,()=>i);var g=W(u,2),_=W(P(g),2),k=P(_);let O;var A=P(k);A.__click=[em,l];var I=P(A),x=P(I);De(x,{color:"#5fb2ff",height:"24",icon:"material-symbols:circle",width:"24"}),E(I);var C=W(I,4),q=P(C,!0);E(C),E(A),E(k);var L=W(k,2);dt(L,17,()=>t.items,ft,(oe,Re)=>{var je=nm();let le;var B=P(je);B.__click=[tm,l,Re];var Le=P(B),Fe=P(Le);De(Fe,{get color(){return y(Re).primary},height:"24",icon:"material-symbols:circle",width:"24"}),E(Le);var Ke=W(Le,2),Xe=P(Ke,!0);E(Ke);var de=W(Ke,2),we=P(de,!0);E(de),E(B),E(je),_e((qe,ot)=>{le=rt(je,1,"svelte-84fq4i",null,le,qe),Oe(Xe,y(Re).singular),Oe(we,ot)},[()=>({selected:y(Re).id===n()}),()=>t.count.hasOwnProperty(y(Re).singular)?t.count[y(Re).singular]:0]),Q(oe,je)}),E(_);var V=W(_,2),te=P(V),J=P(te);J.__click=[Xy,c];var G=P(J),ne=P(G);De(ne,{color:"#49454F",height:"24",icon:"material-symbols:info-rounded",width:"24"}),E(G),St(4),E(J),E(te);var $=W(te,2),H=P($),ee=P(H),ie=P(ee);return De(ie,{color:"#49454F",height:"24",icon:"material-symbols:help-rounded",width:"24"}),E(ee),St(4),E(H),E($),E(V),E(g),st(g,oe=>r=oe,()=>r),E(v),st(v,oe=>a=oe,()=>a),_e(oe=>{O=rt(k,1,"svelte-84fq4i",null,O,oe),Oe(q,t.count.All)},[()=>({selected:n()===null})]),Q(e,v),Ze({hide:c,show:d})}it(["click"]);var om=Uf(`<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""> <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="">
  <\/script>`,1),am=ue('<article><div class="svelte-hy6652"></div></article>');function sm(e,t){Qe(t,!0);let n=ge(t,"hidden",3,!1),r=ge(t,"items",19,()=>[]),i,a,l,c=null;function d(){if(i){c.clearLayers();for(let g=0;g<r().length;g++){const _=`<svg width="32" height="32" viewBox="0 0 24 24"><path fill="${r()[g].color}" d="M12 12q.825 0 1.413-.587T14 10t-.587-1.412T12 8t-1.412.588T10 10t.588 1.413T12 12m0 10q-4.025-3.425-6.012-6.362T4 10.2q0-3.75 2.413-5.975T12 2t5.588 2.225T20 10.2q0 2.5-1.987 5.438T12 22"/></svg>`,k=i.divIcon({className:"pin",iconSize:[32,32],iconAnchor:[16,32],html:_}),O=i.marker([r()[g].latitude,r()[g].longitude],{icon:k});O.data=r()[g].id,O.addTo(c).on("click",A=>{t.onchange&&t.onchange(A.target.data)})}}}function v(){i=window.L,a=i.map(l,{preferCanvas:!0,zoomControl:!1}).setView([39.51,-104.84],10),i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(a),c=i.layerGroup(),c.addTo(a),d()}Sr(()=>{r(),d()});var u=am();Eu(g=>{var _=om(),k=W(Ae(_),2);oi("load",k,v),Ou(k),Q(g,_)});let m;var h=P(u);return st(h,g=>l=g,()=>l),E(u),_e(g=>m=rt(u,1,"svelte-hy6652",null,m,g),[()=>({hidden:n()})]),Q(e,u),Ze({update:d})}var lm=ue('<nav class="svelte-1h9b4b6"><ul class="svelte-1h9b4b6"><!></ul></nav>');function um(e,t){var n=lm(),r=P(n),i=P(r);pn(i,()=>t.children),E(r),E(n),Q(e,n)}var cm=ue('<span class="icon svelte-wnxw5f"><!></span>'),fm=ue("<span> </span>"),dm=ue('<li class="svelte-wnxw5f"><button type="button"><!></button></li>');function Wi(e,t){var n=dm(),r=P(n);r.__click=function(...d){var v;(v=t.onclick)==null||v.apply(this,d)};let i;var a=P(r);{var l=d=>{var v=cm(),u=P(v);De(u,{height:"20",get icon(){return t.icon},width:"20"}),E(v),Q(d,v)},c=d=>{var v=fm(),u=P(v,!0);E(v),_e(()=>Oe(u,t.label)),Q(d,v)};he(a,d=>{t.icon?d(l):d(c,!1)})}E(r),E(n),_e(d=>i=rt(r,1,"svelte-wnxw5f",null,i,d),[()=>({active:t.active})]),Q(e,n)}it(["click"]);var vm=(e,t,n)=>t(y(n).id),hm=ue('<span class="svelte-1leb39h"><!></span>'),pm=ue('<li class="svelte-1leb39h"><button type="button" class="svelte-1leb39h"><img alt="Thumbnail" class="svelte-1leb39h"> <p class="date svelte-1leb39h"> </p> <p class="month svelte-1leb39h"> </p> <!></button></li>'),ym=ue('<ul class="svelte-1leb39h"></ul>'),mm=ue("<article><!></article>");function gm(e,t){Qe(t,!0);let n=ge(t,"hidden",3,!1),r=ge(t,"items",19,()=>[]);function i(m){return new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(m)}function a(m){t.onchange&&t.onchange(m)}var l=mm();let c;var d=P(l);{var v=m=>{var h=He(),g=Ae(h);pn(g,()=>t.children),Q(m,h)},u=m=>{var h=ym();dt(h,21,r,ft,(g,_)=>{var k=pm(),O=P(k);O.__click=[vm,a,_];var A=P(O),I=W(A,2),x=P(I,!0);E(I);var C=W(I,2),q=P(C,!0);E(C);var L=W(C,2);{var V=te=>{var J=hm(),G=P(J);De(G,{height:"24",icon:"material-symbols:favorite",width:"24"}),E(J),Q(te,J)};he(L,te=>{y(_).favorite&&te(V)})}E(O),E(k),_e((te,J)=>{Ne(A,"src",y(_).data),Oe(x,te),Oe(q,J)},[()=>y(_).created_at.getDate(),()=>i(y(_).created_at)]),Q(g,k)}),E(h),Q(m,h)};he(d,m=>{r().length===0?m(v):m(u,!1)})}E(l),_e(m=>c=rt(l,1,"svelte-1leb39h",null,c,m),[()=>({hidden:n()})]),Q(e,l),Ze()}it(["click"]);function bm(e,t,n){const r=new Date(parseInt(e.currentTarget.getAttribute("data-year")),parseInt(e.currentTarget.getAttribute("data-month")),parseInt(e.currentTarget.getAttribute("data-date")));t(new Date(r.getTime())),n.onchange&&n.onchange(t())}var _m=ue('<li class="svelte-hcex0j"><button type="button"> </button></li>'),wm=ue('<div class="svelte-hcex0j"><p class="svelte-hcex0j"> </p> <ul class="svelte-hcex0j"></ul></div>');function km(e,t){Qe(t,!0);let n=ge(t,"display",19,()=>new Date),r=ge(t,"value",7,null),i=fe(()=>new Intl.DateTimeFormat(navigator.language,{month:"long",year:"numeric"}).format(n())),a=fe(()=>{const m=new Date(n().getFullYear(),n().getMonth(),1),h=[],g=new Date;m.setDate(m.getDate()-m.getDay());const _=l(n().getFullYear(),n().getMonth()+1,m.getDay());for(let k=0;k<7*_;k++){let O=!0,A=!1,I=!1;r()===null?A=!1:m.getFullYear()===r().getFullYear()&&m.getMonth()===r().getMonth()&&m.getDate()===r().getDate()&&(A=!0),m.getFullYear()===n().getFullYear()&&m.getMonth()===n().getMonth()&&(O=!1),m.getFullYear()===g.getFullYear()&&m.getMonth()===g.getMonth()&&m.getDate()===g.getDate()&&(I=!0),h.push({date:m.getDate(),month:m.getMonth(),year:m.getFullYear(),outside:O,selected:A,today:I}),m.setDate(m.getDate()+1)}return h});function l(m,h,g=0){const _=g||0,k=new Date(m,h-1,1),A=new Date(m,h,0).getDate(),x=(k.getDay()-_+7)%7+A;return Math.ceil(x/7)}var c=wm(),d=P(c),v=P(d,!0);E(d);var u=W(d,2);dt(u,21,()=>y(a),ft,(m,h)=>{var g=_m(),_=P(g);let k;_.__click=[bm,r,t];var O=P(_,!0);E(_),E(g),_e(A=>{k=rt(_,1,"day svelte-hcex0j",null,k,A),Ne(_,"data-date",y(h).date),Ne(_,"data-month",y(h).month),Ne(_,"data-year",y(h).year),Oe(O,y(h).date)},[()=>({outside:y(h).outside,selected:y(h).selected,today:y(h).today})]),Q(m,g)}),E(u),E(c),_e(()=>Oe(v,y(i))),Q(e,c),Ze()}it(["click"]);var xm=ue('<li class="svelte-13buufu"> </li>'),Sm=ue('<section class="svelte-13buufu"><p class="svelte-13buufu"> </p> <h3 class="svelte-13buufu"> </h3> <ul class="svelte-13buufu"></ul> <article class="svelte-13buufu"></article> <footer class="svelte-13buufu"><button type="button" class="svelte-13buufu">Cancel</button> <button type="button" class="svelte-13buufu">Ok</button></footer></section>');function Im(e,t){Qe(t,!0);let n=ge(t,"display",19,()=>new Date),r=ge(t,"value",7),i=fe(()=>{let I=new Date(n().getTime());return r()!==null&&(I=new Date(r().getTime())),new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"short",weekday:"short",year:"numeric"}).format(I)}),a=Vn([]),l=Vn([]);po(()=>{const I=new Intl.DateTimeFormat(navigator.language,{weekday:"narrow"});let x=new Date;x.setDate(1),x.setDate(x.getDate()-x.getDay());for(let C=0;C<7;C++)l.push(I.format(x)),x.setDate(x.getDate()+1);x=new Date,x.setDate(15);for(let C=0;C<6;C++)a.push(new Date(x.getTime())),x.setMonth(x.getMonth()-1)});function c(I){r(new Date(I.getTime())),t.onchange&&t.onchange({name:t.name,value:r()})}var d=Sm(),v=P(d),u=P(v,!0);E(v);var m=W(v,2),h=P(m,!0);E(m);var g=W(m,2);dt(g,21,()=>l,ft,(I,x)=>{var C=xm(),q=P(C,!0);E(C),_e(()=>Oe(q,y(x))),Q(I,C)}),E(g);var _=W(g,2);dt(_,21,()=>a,ft,(I,x)=>{km(I,{get display(){return y(x)},onchange:c})}),E(_);var k=W(_,2),O=P(k);O.__click=function(...I){var x;(x=t.onclose)==null||x.apply(this,I)};var A=W(O,2);A.__click=function(...I){var x;(x=t.onsave)==null||x.apply(this,I)},E(k),E(d),_e(()=>{Oe(u,t.label),Oe(h,y(i))}),Q(e,d),Ze()}it(["click"]);var Em=ue('<dialog class="svelte-zsytrm"><header class="svelte-zsytrm"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <h3 class="svelte-zsytrm"> </h3> <button type="button" class="svelte-zsytrm">Save</button></header> <!></dialog>');function _s(e,t){Qe(t,!0);let n=Ge(void 0);function r(){y(n).close()}function i(){y(n).showModal()}var a=Em(),l=P(a),c=P(l);sr(c,()=>({"--icon-button-color":"var( --primary-accent-color )"})),Kt(c.lastChild,{name:"material-symbols:close",get onclick(){return t.onclose}}),E(c);var d=W(c,2),v=P(d,!0);E(d);var u=W(d,2);u.__click=function(...h){var g;(g=t.onsave)==null||g.apply(this,h)},E(l);var m=W(l,2);return pn(m,()=>t.children??xr),E(a),st(a,h=>Ee(n,h),()=>y(n)),_e(()=>Oe(v,t.label)),Q(e,a),Ze({close:r,showModal:i})}it(["click"]);var Om=ue('<div><span><!></span> <div class="svelte-1wl9158"><p class="svelte-1wl9158"> </p> <p class="svelte-1wl9158"> </p></div></div>');function Qt(e,t){let n=ge(t,"bottom",3,!0),r=ge(t,"gap",3,!0),i=ge(t,"top",3,!1);var a=Om();let l;var c=P(a);let d;var v=P(c);De(v,{height:"24",get icon(){return t.icon},width:"24"}),E(c);var u=W(c,2),m=P(u),h=P(m);E(m);var g=W(m,2),_=P(g,!0);E(g),E(u),E(a),_e((k,O)=>{l=rt(a,1,"svelte-1wl9158",null,l,k),d=rt(c,1,"svelte-1wl9158",null,d,O),Oe(h,`${t.value??""}${r()?" ":""}${t.suffix??""}`),Oe(_,t.label)},[()=>({bottom:n(),top:i()}),()=>({noicon:!t.icon})]),Q(e,a)}var Am=(e,t)=>y(t).showModal(),Cm=ue('<div class="svelte-1govqhv"><span class="svelte-1govqhv"><!></span> <button type="button" class="svelte-1govqhv"><p class="svelte-1govqhv"><span class="svelte-1govqhv"> </span> <span><!></span></p></button></div> <!>',1);function Pm(e,t){Qe(t,!0);let n=ge(t,"readonly",3,!1),r=ge(t,"value",7,null),i=Ge(void 0),a=fe(()=>r()!==null?new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"short",weekday:"short",year:"numeric"}).format(r()):"");function l(g){console.log(g),r(new Date(g.value.getTime())),t.onchange&&t.onchange({name:t.name,value:r()})}function c(){y(i).close()}function d(){y(i).close()}var v=He(),u=Ae(v);{var m=g=>{var _=He(),k=Ae(_);{var O=A=>{Qt(A,{icon:"material-symbols:calendar-month-outline",get label(){return t.label},get value(){return y(a)}})};he(k,A=>{r()&&A(O)})}Q(g,_)},h=g=>{var _=Cm(),k=Ae(_),O=P(k),A=P(O);De(A,{height:"24",icon:"material-symbols:calendar-month-outline",width:"24"}),E(O);var I=W(O,2);I.__click=[Am,i];var x=P(I),C=P(x),q=P(C,!0);E(C);var L=W(C,2);let V;var te=P(L);{var J=$=>{var H=$s();_e(()=>Oe(H,y(a))),Q($,H)},G=$=>{var H=$s();_e(()=>Oe(H,t.placeholder?t.placeholder:"")),Q($,H)};he(te,$=>{r()?$(J):$(G,!1)})}E(L),E(x),E(I),E(k);var ne=W(k,2);st(_s(ne,{onclose:c,onsave:d,children:($,H)=>{Im($,{onchange:l,onclose:c,onsave:d,name:"date",get label(){return t.label},get value(){return r()}})},$$slots:{default:!0}}),$=>Ee(i,$,!0),()=>y(i)),_e($=>{Oe(q,t.label),V=rt(L,1,"svelte-1govqhv",null,V,$)},[()=>({placeholder:!r()&&t.placeholder})]),Q(g,_)};he(u,g=>{n()?g(m):g(h,!1)})}Q(e,v),Ze()}it(["click"]);var Tm=ue('<div class="svelte-hm3w6m"><span><!></span> <!></div>');function jm(e,t){Qe(t,!0);let n=ge(t,"gap",3,!0),r=ge(t,"readonly",3,!1),i=ge(t,"value",7,null),a=fe(()=>{if(i()!==null)return i().toLocaleString(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})});function l(m){i(m.value),t.onchange&&t.onchange({name:t.name,value:i()===null?null:parseFloat(i())})}var c=He(),d=Ae(c);{var v=m=>{var h=He(),g=Ae(h);{var _=k=>{Qt(k,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get format(){return y(a)}})};he(g,k=>{i()!==null&&k(_)})}Q(m,h)},u=m=>{var h=Tm(),g=P(h);let _;var k=P(g);De(k,{height:"24",get icon(){return t.icon},width:"24"}),E(g);var O=W(g,2);gn(O,{get label(){return t.label},mode:"decimal",name:"decimal",onchange:l,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),E(h),_e(A=>_=rt(g,1,"svelte-hm3w6m",null,_,A),[()=>({noicon:!t.icon})]),Q(m,h)};he(d,m=>{r()?m(v):m(u,!1)})}Q(e,c),Ze()}const Dm=(e,t=xr)=>{var n=Lm(),r=W(P(n));let i;E(n),_e(a=>i=rt(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)},Rm=(e,t=xr)=>{var n=Mm(),r=W(P(n));let i;E(n),_e(a=>i=rt(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)},Nm=(e,t=xr)=>{var n=qm(),r=W(P(n));let i;E(n),_e(a=>i=rt(r,0,"inline svelte-ibqihf",null,i,a),[()=>({filled:t()})]),Q(e,n)};var Lm=It('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 20, -1 L 20, 36 A 8.5 8.5 0 0 1 3 36 L 3, -1 Z"></path><path d="M 7, -1 L 7, 36 A 3 3 0 0 0 16 36 L 16, -1 Z"></path></svg>'),Mm=It('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 3, -1 L 3, 48 L 20, 48 L 20, -1 Z"></path><path d="M 7, -1 L 7, 48 L 16, 48 L 16 -1 Z"></path></svg>'),qm=It('<svg width="24" height="48"><path class="outline svelte-ibqihf" d="M 3, 48 L 3, 12 A 8.5 8.5 0 0 1 20 12 L 20, 48 Z"></path><path d="M 7, 48 L 7, 12 A 3 3 0 0 1 16 12 L 16, 48 Z"></path></svg>'),Fm=ue('<li class="svelte-ibqihf"><button type="button" class="svelte-ibqihf"><span class="svelte-ibqihf"> </span> <!></button></li>'),Um=ue('<div class="svelte-ibqihf"><div class="svelte-ibqihf"><span class="svelte-ibqihf"><!></span> <p class="svelte-ibqihf"> </p></div> <ul class="svelte-ibqihf"></ul></div>');function Bm(e,t){Qe(t,!0);let n=ge(t,"items",19,()=>[]),r=ge(t,"readonly",3,!1),i=ge(t,"value",7,null),a=fe(()=>n().findIndex(h=>h===i()));function l(h){return i()===null?!0:!(h>=y(a))}function c(h){const g=h.currentTarget.getAttribute("data-value");i(i()===g?null:g),t.onchange&&t.onchange({name:t.name,value:i()})}var d=He(),v=Ae(d);{var u=h=>{var g=He(),_=Ae(g);{var k=O=>{Qt(O,{get icon(){return t.icon},get label(){return t.label},get value(){return i()}})};he(_,O=>{i()!==null&&O(k)})}Q(h,g)},m=h=>{var g=Um(),_=P(g),k=P(_),O=P(k);De(O,{height:"24",get icon(){return t.icon},width:"24"}),E(k);var A=W(k,2),I=P(A,!0);E(A),E(_);var x=W(_,2);dt(x,21,n,ft,(C,q,L)=>{var V=Fm();const te=fe(()=>l(L));var J=P(V);J.__click=c;var G=P(J),ne=P(G,!0);E(G);var $=W(G,2);{var H=ie=>{Nm(ie,()=>y(te))},ee=(ie,oe)=>{{var Re=le=>{Rm(le,()=>y(te))},je=le=>{Dm(le,()=>y(te))};he(ie,le=>{L>0&&L<n().length-1?le(Re):le(je,!1)},oe)}};he($,ie=>{L===0?ie(H):ie(ee,!1)})}E(J),E(V),_e(()=>{Ne(J,"data-value",y(q)),Oe(ne,y(q))}),Q(C,V)}),E(x),E(g),_e(()=>Oe(I,t.label)),Q(h,g)};he(v,h=>{r()?h(u):h(m,!1)})}Q(e,d),Ze()}it(["click"]);var Km=ue('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),zm=ue('<div class="svelte-1bz35xs"><span class="svelte-1bz35xs"><!></span> <!></div>');function Vm(e,t){Qe(t,!0);let n=ge(t,"readonly",3,!1),r=ge(t,"value",7,null);function i(v){r(v.value),t.onchange&&t.onchange({name:t.name,value:r()})}var a=He(),l=Ae(a);{var c=v=>{var u=He(),m=Ae(u);{var h=g=>{var _=Km(),k=Ae(_);sr(k,()=>({"--label-field-font-size":"22px","--label-field-line-height":"28px"})),Qt(k.lastChild,{icon:"material-symbols:label-outline",get label(){return t.label},get value(){return r()}}),E(k),Q(g,_)};he(m,g=>{r()!==null&&g(h)})}Q(v,u)},d=v=>{var u=zm(),m=P(u),h=P(m);De(h,{height:"24",icon:"material-symbols:label-outline",width:"24"}),E(m);var g=W(m,2);gn(g,{get label(){return t.label},name:"name",onchange:i,get placeholder(){return t.placeholder},get value(){return r()}}),E(u),Q(v,u)};he(l,v=>{n()?v(c):v(d,!1)})}Q(e,a),Ze()}function Wm(e,t,n){t().trim().length===0&&t(null),n.onchange&&n.onchange({name:n.name,value:t()})}var Hm=ue('<div class="label svelte-lsm8ct"><span class="svelte-lsm8ct"><!></span> <div class="svelte-lsm8ct"><p class="svelte-lsm8ct">Notes</p> <p class="svelte-lsm8ct"> </p></div></div>'),Ym=ue('<div class="field svelte-lsm8ct"><div class="svelte-lsm8ct"><span class="svelte-lsm8ct"><!></span> <p class="svelte-lsm8ct">Notes</p></div> <label class="svelte-lsm8ct"><textarea class="svelte-lsm8ct"></textarea></label></div>');function Gm(e,t){Qe(t,!0);let n=ge(t,"placeholder",3,"Notes"),r=ge(t,"value",7,null),i=Ge(void 0);Sr(()=>{t.readonly||r()!==null&&(y(i).style.height=y(i).scrollHeight+"px")});var a=He(),l=Ae(a);{var c=v=>{var u=He(),m=Ae(u);{var h=g=>{var _=Hm(),k=P(_),O=P(k);De(O,{height:"24",icon:"material-symbols:text-snippet-outline",width:"24"}),E(k);var A=W(k,2),I=W(P(A),2),x=P(I,!0);E(I),E(A),E(_),_e(()=>Oe(x,r())),Q(g,_)};he(m,g=>{r()!==null&&g(h)})}Q(v,u)},d=v=>{var u=Ym(),m=P(u),h=P(m),g=P(h);De(g,{height:"24",icon:"material-symbols:text-snippet-outline",width:"24"}),E(h),St(2),E(m);var _=W(m,2),k=P(_);bd(k),k.__input=[Wm,r,t],st(k,O=>Ee(i,O),()=>y(i)),E(_),E(u),_e(()=>Ne(k,"placeholder",n())),Ru(k,r),Q(v,u)};he(l,v=>{t.readonly?v(c):v(d,!1)})}Q(e,a),Ze()}it(["input"]);var Jm=ue('<div class="svelte-hm3w6m"><span><!></span> <!></div>');function Qm(e,t){Qe(t,!0);let n=ge(t,"gap",3,!0),r=ge(t,"readonly",3,!1),i=ge(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()===null?null:parseInt(i())})}var l=He(),c=Ae(l);{var d=u=>{var m=He(),h=Ae(m);{var g=_=>{Qt(_,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get value(){return i()}})};he(h,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=Jm(),h=P(m);let g;var _=P(h);De(_,{height:"24",get icon(){return t.icon},width:"24"}),E(h);var k=W(h,2);gn(k,{get label(){return t.label},mode:"numeric",name:"number",onchange:a,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),E(m),_e(O=>g=rt(h,1,"svelte-hm3w6m",null,g,O),[()=>({noicon:!t.icon})]),Q(u,m)};he(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ze()}function Zm(e,t){y(t).click()}function Xm(e,t,n,r){t().splice(y(n),1),t(t().length===0?null:[...t()]),Ee(n,y(n)===0?0:y(n)-1,!0),r.onchange&&r.onchange({name:r.name,value:t()})}function $m(e,t,n){y(t).files.length>0&&(Ee(n,[...y(t).files],!0),y(t).value="")}function vu(e,t,n){Ee(t,y(t)===n().length-1?0:y(t)+1,!0)}function hu(e,t,n){Ee(t,y(t)===0?n().length-1:y(t)-1,!0)}var eg=ue('<button aria-label="Previous photo" class="left svelte-1kbyvvc" type="button"><!></button> <button aria-label="Next photo" class="right svelte-1kbyvvc" type="button"><!></button>',1),tg=ue('<figure class="svelte-1kbyvvc"><img alt="Cigar" class="svelte-1kbyvvc"> <!></figure>'),ng=ue('<p class="svelte-1kbyvvc"> </p>'),rg=ue('<button aria-label="Previous photo" class="left svelte-1kbyvvc" type="button"><!></button> <button aria-label="Next photo" class="right svelte-1kbyvvc" type="button"><!></button>',1),ig=ue('<img class="svelte-1kbyvvc"> <!> <button aria-label="Delete photo" class="delete svelte-1kbyvvc" type="button"><!></button>',1),og=ue('<img alt="Loader. Not seen." class="loader svelte-1kbyvvc">'),ag=ue('<figure class="svelte-1kbyvvc"><!> <button aria-label="Add photo" class="add svelte-1kbyvvc" type="button"><!></button> <!> <canvas class="svelte-1kbyvvc"></canvas> <input accept="image/*" type="file" class="svelte-1kbyvvc"></figure>');function sg(e,t){Qe(t,!0);let n=ge(t,"placeholder",3,"Add photos"),r=ge(t,"readonly",3,!1),i=ge(t,"value",7,null),a=Ge(Vn([])),l=Ge(0),c=!0;const d=.8,v=1800;let u=Ge(void 0),m=Ge(void 0);Sr(()=>{i()===null&&(Ee(a,[],!0),Ee(l,0))});async function h(A){const I=A.currentTarget,x=I.getAttribute("data-type"),C=I.getAttribute("data-name"),q=C.lastIndexOf(".")+1;let L=I.width,V=I.height;const te=Math.max(L,V);if(te>v){const ne=v/te;L=L*ne,V=V*ne}y(u).width=L,y(u).height=V,y(u).getContext("2d").drawImage(I,0,0,L,V);const G={id:crypto.randomUUID(),created_at:new Date,updated_at:new Date,data:y(u).toDataURL(x,d),format:x,name:C,extension:C.substring(q),width:L,height:V};i()===null?i([G]):i([...i(),G]),Ee(l,i().length-1),A.target.remove(),t.onchange&&t.onchange({name:t.name,value:i()})}var g=He(),_=Ae(g);{var k=A=>{var I=He(),x=Ae(I);{var C=q=>{var L=tg(),V=P(L),te=W(V,2);{var J=G=>{var ne=eg(),$=Ae(ne);$.__click=[hu,l,i];var H=P($);De(H,{width:"24",height:"24",icon:"material-symbols:chevron-left"}),E($);var ee=W($,2);ee.__click=[vu,l,i];var ie=P(ee);De(ie,{width:"24",height:"24",icon:"material-symbols:chevron-right"}),E(ee),Q(G,ne)};he(te,G=>{i().length>1&&G(J)})}E(L),_e(()=>Ne(V,"src",i()[y(l)].data?i()[y(l)].data:i()[y(l)].storage_url)),Q(q,L)};he(x,q=>{i()!==null&&q(C)})}Q(A,I)},O=A=>{var I=ag(),x=P(I);{var C=ne=>{var $=ng(),H=P($,!0);E($),_e(()=>Oe(H,n())),Q(ne,$)},q=ne=>{var $=ig(),H=Ae($),ee=W(H,2);{var ie=je=>{var le=rg(),B=Ae(le);B.__click=[hu,l,i];var Le=P(B);De(Le,{width:"24",height:"24",icon:"material-symbols:chevron-left"}),E(B);var Fe=W(B,2);Fe.__click=[vu,l,i];var Ke=P(Fe);De(Ke,{width:"24",height:"24",icon:"material-symbols:chevron-right"}),E(Fe),Q(je,le)};he(ee,je=>{i().length>1&&je(ie)})}var oe=W(ee,2);oe.__click=[Xm,i,l,t];var Re=P(oe);De(Re,{width:"24",height:"24",icon:"material-symbols:delete-outline"}),E(oe),_e(()=>{Ne(H,"alt",t.label),Ne(H,"src",i()[y(l)].data?i()[y(l)].data:i()[y(l)].storage_url)}),Q(ne,$)};he(x,ne=>{i()===null||i().length===0?ne(C):ne(q,!1)})}var L=W(x,2);L.__click=[Zm,m];var V=P(L);De(V,{width:"24",height:"24",icon:"material-symbols:add-a-photo-outline"}),E(L);var te=W(L,2);dt(te,17,()=>y(a),ft,(ne,$)=>{var H=og();_e(ee=>{Ne(H,"data-name",y($).name),Ne(H,"data-type",y($).type),Ne(H,"src",ee)},[()=>URL.createObjectURL(y($))]),oi("load",H,h),Ou(H),Q(ne,H)});var J=W(te,2);st(J,ne=>Ee(u,ne),()=>y(u));var G=W(J,2);G.__change=[$m,m,a],st(G,ne=>Ee(m,ne),()=>y(m)),E(I),_e(()=>G.multiple=c),Q(A,I)};he(_,A=>{r()?A(k):A(O,!1)})}Q(e,g),Ze()}it(["click","change"]);function lg(e,t,n,r,i,a,l,c){if(t())return;e.preventDefault();const d=y(n).getBoundingClientRect(),v=r(e.offsetX,0,d.width,-1,1),u=r(e.offsetY,0,d.height,1,-1);i({x:v,y:u}),document.addEventListener("pointermove",a),document.addEventListener("pointerup",l),c.onchange&&c.onchange({name:c.name,value:i()})}var ug=It('<g><circle class="dot svelte-1p2qqpi" cx="0" cy="0" r="5.5"></circle><circle class="ring svelte-1p2qqpi" cx="0" cy="0" r="10"></circle></g>'),cg=It('<svg tabindex="-1" class="svelte-1p2qqpi"><rect y="-0.50" height="1" class="svelte-1p2qqpi"></rect><rect x="-0.50" width="1" class="svelte-1p2qqpi"></rect><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><path class="svelte-1p2qqpi"></path><text x="0" dominant-baseline="middle" text-anchor="middle" class="svelte-1p2qqpi"> </text><text x="0" dominant-baseline="middle" text-anchor="middle" class="svelte-1p2qqpi"> </text><text class="left svelte-1p2qqpi" x="0" dominant-baseline="middle" text-anchor="middle"> </text><text class="right svelte-1p2qqpi" x="0" dominant-baseline="middle" text-anchor="middle"> </text><!></svg>');function pu(e,t){Qe(t,!0);let n=ge(t,"readonly",3,!1),r=ge(t,"size",3,300),i=ge(t,"value",7,null),a=fe(()=>i()===null?null:{x:c(i().x,-1,1,0-r()/2,r()/2),y:c(i().y,1,-1,0-r()/2,r()/2)}),l=Ge(void 0);function c($,H,ee,ie,oe){return($-H)*(oe-ie)/(ee-H)+ie}function d($){if($.target===y(l)){$.preventDefault();const H=y(l).getBoundingClientRect(),ee=c($.offsetX,0,H.width,-1,1),ie=c($.offsetY,0,H.height,1,-1);i({x:ee,y:ie}),t.onchange&&t.onchange({name:t.name,value:i()})}}function v(){document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",v)}var u=cg();u.__pointerdown=[lg,n,l,c,i,d,v,t];let m;var h=P(u),g=W(h),_=W(g),k=W(_),O=W(k),A=W(O),I=W(A),x=P(I,!0);E(I);var C=W(I),q=P(C,!0);E(C);var L=W(C),V=P(L,!0);E(L);var te=W(L),J=P(te,!0);E(te);var G=W(te);{var ne=$=>{var H=ug();let ee;_e(()=>ee=Wn(H,"",ee,{translate:`${y(a).x??""}px ${y(a).y??""}px`})),Q($,H)};he(G,$=>{i()!==null&&$(ne)})}E(u),st(u,$=>Ee(l,$),()=>y(l)),_e(()=>{Ne(u,"role",n()?"none":"button"),Ne(u,"viewBox",`${0-r()/2} ${0-r()/2} ${r()??""} ${r()??""}`),m=Wn(u,"",m,{cursor:n()?"default":"crosshair"}),Ne(h,"x",0-r()/2),Ne(h,"width",r()),Ne(g,"y",0-r()/2),Ne(g,"height",r()),Ne(_,"d",`M ${0-r()/4} ${0-r()/2} L ${0-r()/4} ${r()??""}`),Ne(k,"d",`M ${r()/4} ${0-(r()-2)} L ${r()/4} ${r()??""}`),Ne(O,"d",`M ${0-r()/2} ${0-r()/4} L ${r()/2} ${0-r()/4}`),Ne(A,"d",`M ${0-r()/2} ${r()/4} L ${r()/2} ${r()/4}`),Ne(I,"y",(0-r()/8)*3),Oe(x,t.yhigh),Ne(C,"y",r()/8*3),Oe(q,t.ylow),Ne(L,"y",(0-r()/8)*3),Oe(V,t.xlow),Ne(te,"y",(0-r()/8)*3),Oe(J,t.xhigh)}),Q(e,u),Ze()}it(["pointerdown"]);var fg=ue('<div class="label svelte-1i5ik4b"><div class="svelte-1i5ik4b"><span class="svelte-1i5ik4b"><!></span> <p class="svelte-1i5ik4b"> </p></div> <div class="chart svelte-1i5ik4b"><!></div></div>'),dg=ue('<div class="field svelte-1i5ik4b"><div class="svelte-1i5ik4b"><span class="svelte-1i5ik4b"><!></span> <p class="svelte-1i5ik4b"> </p></div> <div class="chart svelte-1i5ik4b"><!></div></div>');function vg(e,t){Qe(t,!0);let n=ge(t,"icon",3,"material-symbols:texture"),r=ge(t,"readonly",3,!1),i=ge(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()})}var l=He(),c=Ae(l);{var d=u=>{var m=He(),h=Ae(m);{var g=_=>{var k=fg(),O=P(k),A=P(O),I=P(A);De(I,{height:"24",get icon(){return n()},width:"24"}),E(A);var x=W(A,2),C=P(x,!0);E(x),E(O);var q=W(O,2),L=P(q);pu(L,{get label(){return t.label},name:"plot",get readonly(){return r()},get value(){return i()},get xhigh(){return t.xhigh},get xlow(){return t.xlow},get yhigh(){return t.yhigh},get ylow(){return t.ylow}}),E(q),E(k),_e(()=>Oe(C,t.label)),Q(_,k)};he(h,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=dg(),h=P(m),g=P(h),_=P(g);De(_,{height:"24",get icon(){return n()},width:"24"}),E(g);var k=W(g,2),O=P(k,!0);E(k),E(h);var A=W(h,2),I=P(A);pu(I,{get label(){return t.label},name:"plot",onchange:a,get readonly(){return r()},get value(){return i()},get xhigh(){return t.xhigh},get xlow(){return t.xlow},get yhigh(){return t.yhigh},get ylow(){return t.ylow}}),E(A),E(m),_e(()=>Oe(O,t.label)),Q(u,m)};he(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ze()}function hg(e,t,n){t(e.currentTarget.getAttribute("data-value")),n.onchange&&n.onchange(t())}var pg=ue('<li class="svelte-1ry2dq3"><button type="button" class="svelte-1ry2dq3"><!> <span class="svelte-1ry2dq3"> </span> <!></button></li>'),yg=ue('<ul class="svelte-1ry2dq3"></ul>');function mg(e,t){Qe(t,!0);let n=ge(t,"items",19,()=>[]),r=ge(t,"value",7,"USD");var i=yg();dt(i,21,n,ft,(a,l)=>{var c=pg(),d=P(c);d.__click=[hg,r,t];var v=P(d);De(v,{height:"20",get icon(){return y(l).icon},width:"20"});var u=W(v,2),m=P(u,!0);E(u);var h=W(u,2);const g=fe(()=>y(l).value===r()?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");De(h,{height:"20",get icon(){return y(g)},width:"20"}),E(d),E(c),_e(()=>{Ne(d,"data-value",y(l).value),Oe(m,y(l).label)}),Q(a,c)}),E(i),Q(e,i),Ze()}it(["click"]);function gg(e,t){y(t).showModal()}var bg=ue('<div class="svelte-cc835x"><span class="svelte-cc835x"><!></span> <!> <button type="button" class="svelte-cc835x"><p class="svelte-cc835x"><span class="label svelte-cc835x">Currency</span> <span class="value svelte-cc835x"> </span></p> <span class="svelte-cc835x"><!></span></button></div> <!>',1);function _g(e,t){Qe(t,!0);let n=ge(t,"currency",7,"USD"),r=ge(t,"placeholder",3,"0.00"),i=ge(t,"readonly",3,!1),a=ge(t,"value",7,null);const l=[{value:"USD",label:"US Dollar",icon:"material-symbols:attach-money"},{value:"EUR",label:"Euro",icon:"material-symbols:euro"},{value:"JPY",label:"Japanese Yen",icon:"material-symbols:currency-yen"},{value:"GBP",label:"Great Britain Pound",icon:"material-symbols:currency-pound"},{value:"AUD",label:"Australian Dollar",icon:"material-symbols:attach-money"},{value:"CAD",label:"Canadian Dollar",icon:"material-symbols:attach-money"},{value:"CHF",label:"Swiss Franc",icon:"material-symbols:currency-franc"},{value:"CNY",label:"Chinese Yuan",icon:"material-symbols:currency-yuan"},{value:"HKD",label:"Hong Kong Dollar",icon:"material-symbols:attach-money"},{value:"NZD",label:"New Zealand Dollar",icon:"material-symbols:attach-money"}];let c=Ge(void 0),d=fe(()=>l.find(I=>I.value===n()).icon),v=null;function u(I){n(I),t.onchange&&t.onchange({name:t.name,value:n()})}function m(){y(c).close()}function h(I){n(v),y(c).close()}function g(I){a(I.value),t.onchange&&t.onchange({name:t.name,value:a()===null?null:parseFloat(a())})}var _=He(),k=Ae(_);{var O=I=>{var x=He(),C=Ae(x);{var q=L=>{Qt(L,{get icon(){return y(d)},label:"Price",get suffix(){return n()},get value(){return a()}})};he(C,L=>{a()!==null&&L(q)})}Q(I,x)},A=I=>{var x=bg(),C=Ae(x),q=P(C),L=P(q);De(L,{height:"24",get icon(){return y(d)},width:"24"}),E(q);var V=W(q,2);const te=fe(()=>typeof a()=="number"?a().toString(10):a());gn(V,{label:"Price",mode:"decimal",name:"price",onchange:g,get placeholder(){return r()},get value(){return y(te)}});var J=W(V,2);J.__click=[gg,c];var G=P(J),ne=W(P(G),2),$=P(ne,!0);E(ne),E(G);var H=W(G,2),ee=P(H);De(ee,{height:"24",icon:"material-symbols:arrow-drop-down",width:"24"}),E(H),E(J),E(C);var ie=W(C,2);st(_s(ie,{label:"Currency",onclose:m,onsave:h,children:(oe,Re)=>{mg(oe,{items:l,onchange:u,get value(){return n()}})},$$slots:{default:!0}}),oe=>Ee(c,oe,!0),()=>y(c)),_e(()=>Oe($,n())),Q(I,x)};he(k,I=>{i()?I(O):I(A,!1)})}Q(e,_),Ze()}it(["click"]);function wg(e,t,n,r){Ee(t,y(t)+1),y(n)===0?Ee(n,r.spokes.length-1):Ee(n,y(n)-1)}function Xr(e,t,n,r,i){t()===null&&t(new Array(n.spokes.length));const a=parseInt(e.currentTarget.getAttribute("data-value"));t()[y(r)]===a?t()[y(r)]=0:t()[y(r)]=a,t([...t()]),n.onchange&&n.onchange({name:n.name,value:t()}),i()}var kg=ue('<div class="profile svelte-ylrvbk"><div class="controls svelte-ylrvbk"><button type="button" class="svelte-ylrvbk"><!></button> <p class="svelte-ylrvbk"> </p> <button type="button" class="svelte-ylrvbk"><!></button></div> <!> <div class="value svelte-ylrvbk"><button data-value="5" type="button" class="svelte-ylrvbk">5</button> <button data-value="4" type="button" class="svelte-ylrvbk">4</button> <button data-value="3" type="button" class="svelte-ylrvbk">3</button> <button data-value="2" type="button" class="svelte-ylrvbk">2</button> <button data-value="1" type="button" class="svelte-ylrvbk">1</button></div></div>');function xg(e,t){Qe(t,!0);let n=ge(t,"value",7,null),r=Ge(0),i=Ge(0);function a(){Ee(i,y(i)-1),y(r)===t.spokes.length-1?Ee(r,0):Ee(r,y(r)+1)}var l=kg(),c=P(l),d=P(c);d.__click=[wg,i,r,t];var v=P(d);De(v,{height:"24",icon:"material-symbols:chevron-left",width:"24"}),E(d);var u=W(d,2),m=P(u,!0);E(u);var h=W(u,2);h.__click=a;var g=P(h);De(g,{height:"24",icon:"material-symbols:chevron-right",width:"24"}),E(h),E(c);var _=W(c,2);const k=fe(()=>n()===null?[]:n()),O=fe(()=>360/t.spokes.length*y(i));fo(_,{interactive:!0,labels:!1,get spokes(){return t.spokes},get value(){return y(k)},get rotate(){return y(O)}});var A=W(_,2),I=P(A);I.__click=[Xr,n,t,r,a];var x=W(I,2);x.__click=[Xr,n,t,r,a];var C=W(x,2);C.__click=[Xr,n,t,r,a];var q=W(C,2);q.__click=[Xr,n,t,r,a];var L=W(q,2);L.__click=[Xr,n,t,r,a],E(A),E(l),_e(()=>Oe(m,t.spokes[y(r)])),Q(e,l),Ze()}it(["click"]);function Sg(e,t){y(t).showModal()}var Ig=ue('<div class="label svelte-a3m5ng"><div class="svelte-a3m5ng"><span class="svelte-a3m5ng"><!></span> <p class="svelte-a3m5ng"> </p></div> <div class="chart svelte-a3m5ng"><!></div></div>'),Eg=ue('<div class="field svelte-a3m5ng"><div class="svelte-a3m5ng"><span class="svelte-a3m5ng"><!></span> <p class="svelte-a3m5ng"> </p></div> <button type="button" class="svelte-a3m5ng"><!></button></div> <!>',1);function Og(e,t){Qe(t,!0);let n=ge(t,"icon",3,"material-symbols:social-leaderboard-outline"),r=ge(t,"readonly",3,!1),i=ge(t,"spokes",19,()=>[]),a=ge(t,"value",7,null),l=Ge(void 0),c=Ge(void 0);function d(){y(l).close()}function v(){y(l).close()}function u(k){a([...k.value]),t.onchange&&t.onchange({name:t.name,value:k.value})}var m=He(),h=Ae(m);{var g=k=>{var O=He(),A=Ae(O);{var I=x=>{var C=Ig(),q=P(C),L=P(q),V=P(L);De(V,{height:"24",get icon(){return n()},width:"24"}),E(L);var te=W(L,2),J=P(te,!0);E(te),E(q);var G=W(q,2),ne=P(G);const $=fe(()=>y(c)/2),H=fe(()=>a()===null?[]:a());fo(ne,{get radius(){return y($)},get spokes(){return i()},get value(){return y(H)}}),E(G),E(C),_e(()=>Oe(J,t.label)),Q(x,C)};he(A,x=>{a()!==null&&x(I)})}Q(k,O)},_=k=>{var O=Eg(),A=Ae(O),I=P(A),x=P(I),C=P(x);De(C,{height:"24",get icon(){return n()},width:"24"}),E(x);var q=W(x,2),L=P(q,!0);E(q),E(I);var V=W(I,2);V.__click=[Sg,l];var te=P(V);const J=fe(()=>y(c)/2),G=fe(()=>a()===null?[]:a());fo(te,{get radius(){return y(J)},get spokes(){return i()},get value(){return y(G)}}),E(V),E(A);var ne=W(A,2);st(_s(ne,{onclose:d,onsave:v,get label(){return t.label},children:($,H)=>{xg($,{name:"profile",onchange:u,get spokes(){return i()},get value(){return a()}})},$$slots:{default:!0}}),$=>Ee(l,$,!0),()=>y(l)),_e(()=>Oe(L,t.label)),Nd(V,"clientWidth",$=>Ee(c,$)),Q(k,O)};he(h,k=>{r()?k(g):k(_,!1)})}Q(e,m),Ze()}it(["click"]);var Ag=ue('<li class="svelte-1fz3u9v"><!></li>'),Cg=ue('<div class="label svelte-1fz3u9v"><span class="svelte-1fz3u9v"><!></span> <div class="svelte-1fz3u9v"><ul class="svelte-1fz3u9v"></ul> <p class="svelte-1fz3u9v"> </p></div></div>'),Pg=ue('<li><button type="button" class="svelte-1fz3u9v"><!></button></li>'),Tg=ue('<div class="field svelte-1fz3u9v"><div class="svelte-1fz3u9v"><span class="svelte-1fz3u9v"><!></span> <p class="svelte-1fz3u9v"> </p></div> <ul class="svelte-1fz3u9v"></ul></div>');function jg(e,t){Qe(t,!0);let n=ge(t,"readonly",3,!1),r=ge(t,"value",7,null);function i(v){const u=parseInt(v.currentTarget.getAttribute("data-index"));u===r()?r(null):r(u),t.onchange&&t.onchange({name:t.name,value:r()})}var a=He(),l=Ae(a);{var c=v=>{var u=He(),m=Ae(u);{var h=g=>{var _=Cg(),k=P(_),O=P(k);De(O,{height:"24",icon:"material-symbols:stars-outline",width:"24"}),E(k);var A=W(k,2),I=P(A);dt(I,20,()=>({length:5}),ft,(q,L,V)=>{var te=Ag();const J=fe(()=>V<r()?"material-symbols:star":"material-symbols:star-outline");var G=P(te);De(G,{height:"24",get icon(){return y(J)},width:"24"}),E(te),Q(q,te)}),E(I);var x=W(I,2),C=P(x,!0);E(x),E(A),E(_),_e(()=>Oe(C,t.label)),Q(g,_)};he(m,g=>{r()!==null&&g(h)})}Q(v,u)},d=v=>{var u=Tg(),m=P(u),h=P(m),g=P(h);De(g,{height:"24",icon:"material-symbols:stars-outline",width:"24"}),E(h);var _=W(h,2),k=P(_,!0);E(_),E(m);var O=W(m,2);dt(O,20,()=>({length:5}),ft,(A,I,x)=>{var C=Pg();const q=fe(()=>r()===null?0:r()),L=fe(()=>x<y(q)?"material-symbols:star":"material-symbols:star-outline");var V=P(C);Ne(V,"aria-label",`Rating of ${x+1}`),Ne(V,"data-index",x+1),V.__click=i;var te=P(V);De(te,{height:"48",get icon(){return y(L)},width:"48"}),E(V),E(C),Q(A,C)}),E(O),E(u),_e(()=>Oe(k,t.label)),Q(v,u)};he(l,v=>{n()?v(c):v(d,!1)})}Q(e,a),Ze()}it(["click"]);function Dg(e,t){e.preventDefault(),y(t).focus()}function Rg(){}var Ng=ue('<li class="svelte-24e094"><button type="button" class="svelte-24e094"><span class="svelte-24e094"> </span> <!></button></li>'),Lg=ue('<li class="other svelte-24e094"><label class="svelte-24e094"><input placeholder="Other" text="text" class="svelte-24e094"> <button type="button" class="svelte-24e094"><!></button></label></li>'),Mg=ue('<div class="svelte-24e094"><div class="svelte-24e094"><span class="svelte-24e094"><!></span> <p class="svelte-24e094"> </p></div> <ul class="svelte-24e094"><!> <!></ul></div>');function qg(e,t){Qe(t,!0);let n=ge(t,"items",19,()=>[]),r=ge(t,"other",3,!1),i=ge(t,"readonly",3,!1),a=ge(t,"value",7,null),l=Ge(void 0);function c(g){const _=g.currentTarget.getAttribute("data-value");a(a()===_?null:_),t.onchange&&t.onchange({name:t.name,value:a()})}function d(){}var v=He(),u=Ae(v);{var m=g=>{var _=He(),k=Ae(_);{var O=A=>{Qt(A,{get icon(){return t.icon},get label(){return t.label},get value(){return a()}})};he(k,A=>{a()!==null&&A(O)})}Q(g,_)},h=g=>{var _=Mg(),k=P(_),O=P(k),A=P(O);De(A,{height:"24",get icon(){return t.icon},width:"24"}),E(O);var I=W(O,2),x=P(I,!0);E(I),E(k);var C=W(k,2),q=P(C);dt(q,17,n,ft,(te,J)=>{var G=Ng();const ne=fe(()=>a()===y(J)?"material-symbols:radio-button-checked-outline":"material-symbols:circle-outline");var $=P(G);$.__click=c;var H=P($),ee=P(H,!0);E(H);var ie=W(H,2);De(ie,{height:"24",get icon(){return y(ne)},width:"24"}),E($),E(G),_e(()=>{Ne($,"data-value",y(J)),Oe(ee,y(J))}),Q(te,G)});var L=W(q,2);{var V=te=>{var J=Lg(),G=P(J),ne=P(G);ne.__input=[Rg],st(ne,ee=>Ee(l,ee),()=>y(l));var $=W(ne,2);$.__click=[Dg,l];var H=P($);De(H,{height:"24",icon:"material-symbols:circle-outline",width:"24"}),E($),E(G),E(J),oi("focus",ne,d),Q(te,J)};he(L,te=>{r()&&te(V)})}E(C),E(_),_e(()=>Oe(x,t.label)),Q(g,_)};he(u,g=>{i()?g(m):g(h,!1)})}Q(e,v),Ze()}it(["click","input"]);const Fg=(e,t,n)=>{let r=Hn(()=>pr(t==null?void 0:t(),!1)),i=Hn(()=>pr(n==null?void 0:n(),!1));var a=Kg();let l;_e(c=>l=rt(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:y(r),selected:y(i)})]),Q(e,a)},Ug=(e,t,n)=>{let r=Hn(()=>pr(t==null?void 0:t(),!1)),i=Hn(()=>pr(n==null?void 0:n(),!1));var a=zg();let l;_e(c=>l=rt(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:y(r),selected:y(i)})]),Q(e,a)},Bg=(e,t,n)=>{let r=Hn(()=>pr(t==null?void 0:t(),!1)),i=Hn(()=>pr(n==null?void 0:n(),!1));var a=Vg();let l;_e(c=>l=rt(a,0,"svelte-jfhagg",null,l,c),[()=>({filled:y(r),selected:y(i)})]),Q(e,a)};var Kg=It('<svg><rect x="50%" y="50%" width="48" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),zg=It('<svg><rect x="0" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><rect x="50%" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),Vg=It('<svg><rect x="0" y="50%" width="50%" height="1" class="svelte-jfhagg"></rect><circle class="outline svelte-jfhagg" cx="50%" cy="50%" r="9"></circle><circle class="dot svelte-jfhagg" cx="50%" cy="50%" r="5"></circle></svg>'),Wg=It('<circle cy="12" r="8"></circle>'),Hg=ue('<div class="label svelte-jfhagg"><span class="svelte-jfhagg"><!></span> <div class="svelte-jfhagg"><p class="svelte-jfhagg"> </p> <svg class="svelte-jfhagg"><path class="svelte-jfhagg"></path><path class="filled svelte-jfhagg"></path><!><text dominant-baseline="hanging" x="0" y="28" class="svelte-jfhagg"> </text><text dominant-baseline="hanging" text-anchor="end" y="28" class="svelte-jfhagg"> </text></svg></div></div>'),Yg=ue('<button type="button" class="svelte-jfhagg"><!></button>'),Gg=ue('<div class="field svelte-jfhagg"><div class="svelte-jfhagg"><span class="svelte-jfhagg"><!></span> <p class="svelte-jfhagg"> </p></div> <div class="slider svelte-jfhagg"></div> <div class="range svelte-jfhagg"><p class="svelte-jfhagg"> </p> <p class="svelte-jfhagg"> </p></div></div>');function Jg(e,t){Qe(t,!0);let n=ge(t,"maximum",3,7),r=ge(t,"readonly",3,!1),i=ge(t,"value",7,null);function a(u){const m=parseInt(u.currentTarget.getAttribute("data-index"));m===i()?i(null):i(m),t.onchange&&t.onchange({name:t.name,value:i()})}var l=He(),c=Ae(l);{var d=u=>{var m=He(),h=Ae(m);{var g=_=>{var k=Hg(),O=P(k),A=P(O);De(A,{height:"24",get icon(){return t.icon},width:"24"}),E(O);var I=W(O,2),x=P(I),C=P(x,!0);E(x);var q=W(x,2),L=P(q),V=W(L),te=W(V);dt(te,17,()=>({length:n()}),ft,(H,ee,ie)=>{var oe=Wg();const Re=fe(()=>i()>ie);Ne(oe,"cx",10+ie*30);let je;_e(le=>je=rt(oe,0,"svelte-jfhagg",null,je,le),[()=>({filled:y(Re)})]),Q(H,oe)});var J=W(te),G=P(J,!0);E(J);var ne=W(J),$=P(ne,!0);E(ne),E(q),E(I),E(k),_e(()=>{Oe(C,t.label),Ne(L,"d",`M 10 12 L ${10+(n()-1)*30} 12`),Ne(V,"d",`M 10 12 L ${10+(i()-1)*30} 12`),Oe(G,t.low),Ne(ne,"x",(n()-2)*40),Oe($,t.high)}),Q(_,k)};he(h,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=Gg(),h=P(m),g=P(h),_=P(g);De(_,{height:"24",get icon(){return t.icon},width:"24"}),E(g);var k=W(g,2),O=P(k,!0);E(k),E(h);var A=W(h,2);dt(A,21,()=>({length:n()}),ft,(V,te,J)=>{var G=Yg();const ne=fe(()=>i()>J+1),$=fe(()=>i()===J+1);Ne(G,"aria-label",J),Ne(G,"data-index",J+1),G.__click=a;var H=P(G);{var ee=oe=>{Fg(oe,()=>y(ne),()=>y($))},ie=(oe,Re)=>{{var je=B=>{Ug(B,()=>y(ne),()=>y($))},le=(B,Le)=>{{var Fe=Ke=>{Bg(Ke,()=>y(ne),()=>y($))};he(B,Ke=>{J===n()-1&&Ke(Fe)},Le)}};he(oe,B=>{J<n()-1?B(je):B(le,!1)},Re)}};he(H,oe=>{J===0?oe(ee):oe(ie,!1)})}E(G),Q(V,G)}),E(A);var I=W(A,2),x=P(I),C=P(x,!0);E(x);var q=W(x,2),L=P(q,!0);E(q),E(I),E(m),_e(()=>{Oe(O,t.label),Oe(C,t.low),Oe(L,t.high)}),Q(u,m)};he(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ze()}it(["click"]);var Qg=ue('<div class="svelte-11ggxxf"><span><!></span> <!></div>');function Zg(e,t){Qe(t,!0);let n=ge(t,"gap",3,!0),r=ge(t,"readonly",3,!1),i=ge(t,"value",7,null);function a(u){i(u.value),t.onchange&&t.onchange({name:t.name,value:i()})}var l=He(),c=Ae(l);{var d=u=>{var m=He(),h=Ae(m);{var g=_=>{Qt(_,{get gap(){return n()},get icon(){return t.icon},get label(){return t.label},get suffix(){return t.suffix},get value(){return i()}})};he(h,_=>{i()!==null&&_(g)})}Q(u,m)},v=u=>{var m=Qg(),h=P(m);let g;var _=P(h);De(_,{height:"24",get icon(){return t.icon},width:"24"}),E(h);var k=W(h,2);gn(k,{get label(){return t.label},onchange:a,get placeholder(){return t.placeholder},get suffix(){return t.suffix},get value(){return i()}}),E(m),_e(O=>g=rt(h,1,"svelte-11ggxxf",null,g,O),[()=>({noicon:!t.icon})]),Q(u,m)};he(c,u=>{r()?u(d):u(v,!1)})}Q(e,l),Ze()}var Xg=ue('<button tabindex="-1" type="button" class="svelte-ng495u"><!></button>'),$g=ue('<div class="svelte-ng495u"><span><!></span> <!></div>');function eb(e,t){Qe(t,!0);let n=ge(t,"readonly",3,!1),r=ge(t,"value",7,null),i=Ge(Vn(r()===null?t.suffix[0]:r().units)),a=fe(()=>r()===null?null:r().measure.toLocaleString(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2}));function l(h){h.value===null?r(null):r({measure:h.value,units:y(i)}),t.onchange&&t.onchange({name:t.name,value:{measure:parseFloat(r().measure),units:y(i)}})}function c(){let h=t.suffix.indexOf(y(i));h===t.suffix.length-1?h=0:h=h+1,Ee(i,t.suffix[h],!0),r()!==null&&t.onchange&&t.onchange({name:t.name,value:{measure:parseFloat(r().measure),units:y(i)}})}var d=He(),v=Ae(d);{var u=h=>{var g=He(),_=Ae(g);{var k=O=>{Qt(O,{get icon(){return t.icon},get label(){return t.label},get suffix(){return r().units},get value(){return y(a)}})};he(_,O=>{r()!==null&&O(k)})}Q(h,g)},m=h=>{var g=$g(),_=P(g);let k;var O=P(_);De(O,{height:"24",get icon(){return t.icon},width:"24"}),E(_);var A=W(_,2);gn(A,{get label(){return t.label},mode:"decimal",name:"units",onchange:l,get placeholder(){return t.placeholder},get suffix(){return y(i)},get value(){return y(a)},children:(I,x)=>{var C=Xg();C.__click=c;var q=P(C);De(q,{height:"24",icon:"material-symbols:conversion-path",width:"24"}),E(C),Q(I,C)},$$slots:{default:!0}}),E(g),_e(I=>k=rt(_,1,"svelte-ng495u",null,k,I),[()=>({noicon:!t.icon})]),Q(h,g)};he(v,h=>{n()?h(u):h(m,!1)})}Q(e,d),Ze()}it(["click"]);var tb=ue("<!> <!> <!>",1),nb=ue('<div class="extra"><!></div>'),rb=ue('<div class="extra"><!></div>'),ib=ue('<section class="svelte-wtn90l"><!> <form><!> <!> <!></form></section>');function ob(e,t){Qe(t,!0);let n=ge(t,"flavor",3,null),r=Ge(void 0),i=Ge(!1),a=Ge(void 0),l=Ge(null),c=fe(()=>n()===null?null:n().fields),d=fe(()=>y(l)===null||y(l).id===null?`New ${n()===null?"":n().singular}`:y(i)?"":`Edit ${n()===null?"":n().singular}`),v=fe(()=>y(l)!==null&&y(l).name!==null);const u=new ys;let m=null,h=null,g=null,_=null,k=null,O=null;function A(){const le={id:null,photos:null};for(let B=0;B<y(c).length;B++)le[y(c)[B].name]=null;Ee(l,le,!0)}function I(){return y(a).animate([{top:0},{top:"100vh"}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{Ee(i,!0),y(r).scrollTo({top:0}),A()})}function x(le=null){le===null?(A(),Ee(i,!1),y(a).animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"}).finished.then(()=>{m=navigator.geolocation.watchPosition(B=>{h=B.coords.latitude,g=B.coords.longitude,navigator.geolocation.clearWatch(m),m=null,fetch(`/api/weather?location=${h},${g}`).then(Le=>Le.json()).then(Le=>{O=Le.icon,_=Le.temperature,k=Le.condition})})})):u.readReview(le).then(B=>{Ee(l,B,!0),Ee(i,!0),y(a).animate([{top:"100vh"},{top:0}],{duration:300,easing:"ease-in-out",fill:"forwards"})})}async function C(){y(l)===null||y(l).id===null?I():u.readReview(y(l).id).then(le=>{Ee(l,le,!0),Ee(i,!0)})}function q(){confirm("Are you sure you want to delete this review?")&&u.deleteReview(y(l).id).then(()=>{t.onchange(),I()})}function L(){if(y(v))y(l).id===null?(y(l).latitude=h,y(l).longitude=g,y(l).temperature=_,y(l).condition=k,y(l).weather=O,u.addReview(n().singular,y(l)).then(()=>{t.onchange(),I()})):(Ee(i,!0),u.editReview(y(l)).then(le=>{Ee(l,le,!0),t.onchange()}));else{const le=y(c).find(B=>B.name==="name");alert(`${le.label} is required.`)}}function V(){Ee(i,!1)}function te(){y(l).favorite=!y(l).favorite,u.favoriteReview(y(l).id,y(l).favorite).then(le=>{Ee(l,le,!0),t.onchange&&t.onchange()})}function J(le){y(l)!==null&&(y(l)[le.name]=le.value)}var G=ib(),ne=P(G);Xa(ne,{get label(){return y(d)},variation:"sm",left:Le=>{var Fe=He(),Ke=Ae(Fe);{var Xe=we=>{Kt(we,{name:"material-symbols:close",onclick:C})},de=we=>{Kt(we,{name:"material-symbols:arrow-back",onclick:()=>I()})};he(Ke,we=>{y(i)?we(de,!1):we(Xe)})}Q(Le,Fe)},right:Le=>{var Fe=He(),Ke=Ae(Fe);{var Xe=we=>{var qe=tb(),ot=Ae(qe);const me=fe(()=>y(l).favorite?"material-symbols:favorite":"material-symbols:favorite-outline");Kt(ot,{get name(){return y(me)},onclick:te});var ke=W(ot,2);Kt(ke,{name:"material-symbols:delete-outline-rounded",onclick:q});var Pe=W(ke,2);Kt(Pe,{name:"material-symbols:edit-outline-rounded",onclick:V}),Q(we,qe)},de=we=>{Kt(we,{onclick:L,name:"material-symbols:done"})};he(Ke,we=>{y(l)&&y(l).id!==null&&y(i)?we(Xe):we(de,!1)})}Q(Le,Fe)}});var $=W(ne,2);let H;var ee=P($);dt(ee,17,()=>y(c),ft,(le,B)=>{var Le=He(),Fe=Ae(Le);{var Ke=Xe=>{var de=He(),we=Ae(de);{var qe=me=>{const ke=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);sg(me,{get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get value(){return y(ke)}})},ot=(me,ke)=>{{var Pe=Me=>{const Te=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Vm(Me,{get label(){return y(B).label},get name(){return y(B).name},onchange:J,get placeholder(){return y(B).label},get readonly(){return y(i)},get value(){return y(Te)}})},Se=(Me,Te)=>{{var lt=Ct=>{const Dn=fe(()=>y(B).hint===null?y(B).label:y(B).hint),Ar=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Zg(Ct,{get icon(){return y(B).icon},get label(){return y(B).label},get name(){return y(B).name},onchange:J,get placeholder(){return y(Dn)},get readonly(){return y(i)},get value(){return y(Ar)}})},_t=(Ct,Dn)=>{{var Ar=bt=>{const Jn=fe(()=>y(B).hint===null?y(B).label:y(B).hint),ln=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);jm(bt,{get icon(){return y(B).icon},get label(){return y(B).label},get name(){return y(B).name},onchange:J,get placeholder(){return y(Jn)},get readonly(){return y(i)},get suffix(){return y(B).suffix},get value(){return y(ln)}})},Cr=(bt,Jn)=>{{var ln=Lt=>{const zt=fe(()=>y(B).hint===null?y(B).label:y(B).hint),Vt=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Qm(Lt,{get icon(){return y(B).icon},get label(){return y(B).label},get name(){return y(B).name},onchange:J,get placeholder(){return y(zt)},get readonly(){return y(i)},get suffix(){return y(B).suffix},get value(){return y(Vt)}})},pi=(Lt,zt)=>{{var Vt=Mt=>{const Rn=fe(()=>y(B).hint===null?y(B).label:y(B).hint),wn=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);eb(Mt,{get icon(){return y(B).icon},get label(){return y(B).label},get name(){return y(B).name},onchange:J,get placeholder(){return y(Rn)},get readonly(){return y(i)},get suffix(){return y(B).options},get value(){return y(wn)}})},Pr=(Mt,Rn)=>{{var wn=Wt=>{const Nn=fe(()=>y(l)&&y(l).currency?y(l).currency:"USD"),qt=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);_g(Wt,{get currency(){return y(Nn)},get label(){return y(B).label},get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get value(){return y(qt)}})},un=(Wt,Nn)=>{{var qt=Ft=>{const Ht=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Pm(Ft,{get label(){return y(B).label},get name(){return y(B).name},onchange:J,get placeholder(){return y(B).label},get readonly(){return y(i)},get value(){return y(Ht)}})},Ie=(Ft,Ht)=>{{var Qn=Zt=>{const Zn=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);jg(Zt,{get label(){return y(B).label},get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get value(){return y(Zn)}})},be=(Zt,Zn)=>{{var Tr=Xt=>{const jr=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Bm(Xt,{get icon(){return y(B).icon},get items(){return y(B).options},get label(){return y(B).label},get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get value(){return y(jr)}})},yi=(Xt,jr)=>{{var Eo=Pt=>{const Ln=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);qg(Pt,{get icon(){return y(B).icon},get items(){return y(B).options},get label(){return y(B).label},get name(){return y(B).name},onchange:J,get other(){return y(B).other},get readonly(){return y(i)},get value(){return y(Ln)}})},kn=(Pt,Ln)=>{{var Xn=tt=>{const Dr=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Og(tt,{get label(){return y(B).label},get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get spokes(){return y(B).options},get value(){return y(Dr)}})},et=(tt,Dr)=>{{var $n=Yt=>{const Rr=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Jg(Yt,{get icon(){return y(B).icon},get high(){return y(B).high},get label(){return y(B).label},get low(){return y(B).low},get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get value(){return y(Rr)}})},er=(Yt,Rr)=>{{var $t=Et=>{const Sn=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);vg(Et,{get label(){return y(B).label},get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get value(){return y(Sn)},get xhigh(){return y(B).xhigh},get xlow(){return y(B).xlow},get yhigh(){return y(B).yhigh},get ylow(){return y(B).ylow}})},xn=(Et,Sn)=>{{var Oo=Ut=>{const mi=fe(()=>y(l)&&y(l)[y(B).name]?y(l)[y(B).name]:null);Gm(Ut,{get name(){return y(B).name},onchange:J,get readonly(){return y(i)},get value(){return y(mi)}})};he(Et,Ut=>{y(B).kind==="notes"&&Ut(Oo)},Sn)}};he(Yt,Et=>{y(B).kind==="plot"?Et($t):Et(xn,!1)},Rr)}};he(tt,Yt=>{y(B).kind==="slider"?Yt($n):Yt(er,!1)},Dr)}};he(Pt,tt=>{y(B).kind==="profile"?tt(Xn):tt(et,!1)},Ln)}};he(Xt,Pt=>{y(B).kind==="radio"?Pt(Eo):Pt(kn,!1)},jr)}};he(Zt,Xt=>{y(B).kind==="meter"?Xt(Tr):Xt(yi,!1)},Zn)}};he(Ft,Zt=>{y(B).kind==="rating"?Zt(Qn):Zt(be,!1)},Ht)}};he(Wt,Ft=>{y(B).kind==="date"?Ft(qt):Ft(Ie,!1)},Nn)}};he(Mt,Wt=>{y(B).kind==="price"?Wt(wn):Wt(un,!1)},Rn)}};he(Lt,Mt=>{y(B).kind==="units"?Mt(Vt):Mt(Pr,!1)},zt)}};he(bt,Lt=>{y(B).kind==="number"?Lt(ln):Lt(pi,!1)},Jn)}};he(Ct,bt=>{y(B).kind==="decimal"?bt(Ar):bt(Cr,!1)},Dn)}};he(Me,Ct=>{y(B).kind==="text"?Ct(lt):Ct(_t,!1)},Te)}};he(me,Me=>{y(B).kind==="name"?Me(Pe):Me(Se,!1)},ke)}};he(we,me=>{y(B).kind==="photo"?me(qe):me(ot,!1)})}Q(Xe,de)};he(Fe,Xe=>{y(B).hidden||Xe(Ke)})}Q(le,Le)});var ie=W(ee,2);{var oe=le=>{var B=nb(),Le=P(B);const Fe=fe(()=>y(l).latitude.toFixed(5)),Ke=fe(()=>y(l).longitude.toFixed(5));Qt(Le,{bottom:!1,icon:"material-symbols:my-location-outline-rounded",label:"Coordinates",top:!0,get value(){return`${y(Fe)??""}, ${y(Ke)??""}`}}),E(B),Q(le,B)};he(ie,le=>{y(i)&&y(l)&&y(l).latitude&&le(oe)})}var Re=W(ie,2);{var je=le=>{var B=rb(),Le=P(B);const Fe=fe(()=>y(l).condition),Ke=fe(()=>y(l).temperature.toFixed(0));Qt(Le,{bottom:!1,get icon(){return y(l).weather},label:"Weather",top:!0,get value(){return`${y(Fe)??""}, ${y(Ke)??""}Â°F`}}),E(B),Q(le,B)};he(Re,le=>{y(i)&&y(l)&&y(l).weather&&le(je)})}return E($),st($,le=>Ee(r,le),()=>y(r)),E(G),st(G,le=>Ee(a,le),()=>y(a)),_e(le=>H=rt($,1,"svelte-wtn90l",null,H,le),[()=>({readonly:y(i)})]),Q(e,G),Ze({hide:I,show:x})}var ab=(e,t,n)=>t.onchange(y(n).id),sb=ue('<figcaption class="svelte-9ufrua"> </figcaption>'),lb=ue('<img alt="Thumbnail" height="64" width="100" class="svelte-9ufrua">'),ub=ue('<span class="svelte-9ufrua"><!></span>'),cb=ue('<li class="svelte-9ufrua"><button type="button" class="svelte-9ufrua"><figure class="svelte-9ufrua"><!> <!></figure> <div class="item svelte-9ufrua"><p class="created svelte-9ufrua"> </p> <div class="rating svelte-9ufrua"></div> <p class="name svelte-9ufrua"> </p></div></button></li>'),fb=ue('<ul class="svelte-9ufrua"></ul>'),db=ue("<article><!></article>");function vb(e,t){Qe(t,!0);let n=ge(t,"hidden",3,!1),r=ge(t,"items",19,()=>[]);function i(m){return new Intl.DateTimeFormat(navigator.language,{day:"numeric",month:"numeric",year:"numeric"}).format(m)}function a(m){const g=m.replace(/\([^()]*\)/g,"").split(" ");let _="";for(let k=0;k<g.length;k++){const O=g[k].trim();if(O.length===0)continue;let A=O.charAt(0);if(O.indexOf("-")>-1){const I=O.split("-");for(let x=1;x<I.length;x++)A=A+I[x].charAt(0)}_=_+A}return _.toUpperCase()}var l=db();let c;var d=P(l);{var v=m=>{var h=He(),g=Ae(h);pn(g,()=>t.children),Q(m,h)},u=m=>{var h=fb();dt(h,21,r,ft,(g,_)=>{var k=cb(),O=P(k);O.__click=[ab,t,_];var A=P(O),I=P(A);{var x=H=>{var ee=sb(),ie=P(ee,!0);E(ee),_e(oe=>Oe(ie,oe),[()=>a(y(_).name)]),Q(H,ee)},C=H=>{var ee=lb();_e(()=>Ne(ee,"src",y(_).photos[0].data)),Q(H,ee)};he(I,H=>{y(_).photos===null?H(x):H(C,!1)})}var q=W(I,2);{var L=H=>{var ee=ub(),ie=P(ee);De(ie,{height:"14",icon:"material-symbols:favorite",width:"14"}),E(ee),Q(H,ee)};he(q,H=>{y(_).favorite&&H(L)})}E(A);var V=W(A,2),te=P(V),J=P(te,!0);E(te);var G=W(te,2);dt(G,20,()=>({length:5}),ft,(H,ee,ie)=>{const oe=fe(()=>ie<y(_).rating?"material-symbols:star":"material-symbols:star-outline");De(H,{color:"#161616",height:"16",get icon(){return y(oe)},width:"16"})}),E(G);var ne=W(G,2),$=P(ne,!0);E(ne),E(V),E(O),E(k),_e(H=>{Oe(J,H),Oe($,y(_).name)},[()=>i(y(_).updated_at)]),Q(g,k)}),E(h),Q(m,h)};he(d,m=>{r().length===0?m(v):m(u,!1)})}E(l),_e(m=>c=rt(l,1,"svelte-9ufrua",null,c,m),[()=>({hidden:n()})]),Q(e,l),Ze()}it(["click"]);var hb=ue('<link rel="manifest" href="./manifest.json"> <meta name="theme-color">',1),pb=ue("<!> <!>",1),yb=ue("<!> <!> <!> <!>",1),mb=ue('<p class="svelte-cbft3s">Empty Timeline</p> <p class="svelte-cbft3s">Add a review to get started!</p>',1),gb=ue('<p class="svelte-cbft3s">Select a flavor to get started!</p> <button class="m3 svelte-cbft3s" type="button">Select a flavor</button>',1),bb=ue('<div class="empty svelte-cbft3s"><!></div>'),_b=ue('<div class="empty svelte-cbft3s"><p class="photos svelte-cbft3s">Empty Photos</p> <p class="photos svelte-cbft3s">There are no reviews with photos.</p></div>'),wb=ue('<button class="fab svelte-cbft3s" type="button"><span class="svelte-cbft3s"><!></span></button>'),kb=ue('<section class="svelte-cbft3s"><!> <!> <!> <!></section> <!> <!> <!>',1);function Mb(e,t){Qe(t,!0);let n,r,i,a=Ge(Vn({})),l=Ge(void 0),c=Ge(Vn([])),d=Ge(Vn({id:crypto.randomUUID(),book:null})),v=Ge(1),u=fe(()=>y(d).book),m=fe(()=>{var de;return(de=y(l))==null?void 0:de.tastes.reduce((we,qe)=>(we[qe.singular]=qe.primary,we),{})}),h=fe(()=>y(u)===null?null:y(l).tastes[y(u)]),g=fe(()=>y(c).reduce((de,we)=>{if(we.photos!==null)for(let qe=0;qe<we.photos.length;qe++)de.push({id:we.id,created_at:new Date(we.created_at.getTime()),data:we.photos[qe].data,favorite:we.favorite});return de},[])),_=fe(()=>y(c).reduce((de,we)=>(we.latitude!==null&&de.push({id:we.id,color:y(m)[we.type],latitude:we.latitude,longitude:we.longitude}),de),[])),k=fe(()=>y(u)===null?`You have made ${y(c).length} ${y(c).length===1?"review":"reviews"}`:y(c).length===0?"There are no reviews for this flavor":`You have made ${y(c).length} ${y(h).singular.toLowerCase()} ${y(c).length===1?"review":"reviews"}`),O=fe(()=>y(h)===null?"#5fb2ff":y(h).primary);const A=new ys;po(()=>{fetch("/flavors.json").then(de=>de.json()).then(de=>{const we=de.tastes.filter(qe=>qe.active);we.sort((qe,ot)=>qe.singular>ot.singular?1:qe.singular<ot.singular?-1:0),de.tastes=[...we],Ee(l,de,!0),A.readSettings().then(qe=>qe!==null?(Ee(d,qe,!0),y(h)===null?A.browseReview():A.browseReview(y(h).singular)):A.browseReview()).then(qe=>(Ee(c,[...qe],!0),A.countReview())).then(qe=>{Ee(a,qe,!0)})})}),Sr(()=>{y(h)?(document.documentElement.style.setProperty("--primary-accent-color",y(h).primary),document.documentElement.style.setProperty("--secondary-accent-color",y(h).secondary)):(document.documentElement.style.setProperty("--primary-accent-color","#5fb2ff"),document.documentElement.style.setProperty("--secondary-accent-color","#003f7f"))});function I(){console.log("SHOW ACCOUNT: "+A.userId),n.show()}function x(){A.userId==="unauthorized"?A.countReviews().then(de=>{de>=3?confirm("Create an account to continue?")&&n.show():r.show()}):r.show()}function C(de){Ee(c,[],!0),de===null?(y(d).book=null,A.updateSettings(y(d)),A.browseReview().then(we=>Ee(c,[...we],!0))):(y(d).book=y(l).tastes.findIndex(we=>we.id===de),A.updateSettings(y(d)),A.browseReview(y(h).singular).then(we=>Ee(c,[...we],!0))),i.hide()}function q(de){r.show(de)}function L(de){r.show(de)}function V(){A.browseReview(y(h).singular).then(de=>Ee(c,[...de],!0)),A.countReview().then(de=>Ee(a,de,!0))}function te(de){r.show(de)}var J=kb();Eu(de=>{var we=hb(),qe=W(Ae(we),2);_e(()=>Ne(qe,"content",y(O))),Q(de,we)});var G=Ae(J),ne=P(G);const $=fe(()=>y(h)?y(h).phrase:"Flavor Awesome");Xa(ne,{get label(){return y($)},get subtitle(){return y(k)},left:qe=>{Kt(qe,{name:"material-symbols:menu",onclick:()=>i.show()})},right:qe=>{var ot=pb(),me=Ae(ot);Kt(me,{name:"material-symbols:search"});var ke=W(me,2);Kt(ke,{name:"material-symbols:account-circle",onclick:I}),Q(qe,ot)}});var H=W(ne,2);um(H,{children:(de,we)=>{var qe=yb(),ot=Ae(qe);const me=fe(()=>y(v)===0);Wi(ot,{get active(){return y(me)},icon:"material-symbols:book-ribbon-outline-rounded",onclick:()=>Ee(v,0)});var ke=W(ot,2);const Pe=fe(()=>y(v)===1);Wi(ke,{get active(){return y(Pe)},onclick:()=>Ee(v,1),label:"Timeline"});var Se=W(ke,2);const Me=fe(()=>y(v)===2);Wi(Se,{get active(){return y(Me)},label:"Photos",onclick:()=>Ee(v,2)});var Te=W(Se,2);const lt=fe(()=>y(v)===3);Wi(Te,{get active(){return y(lt)},label:"Map",onclick:()=>Ee(v,3)}),Q(de,qe)}});var ee=W(H,2);{var ie=de=>{const we=fe(()=>y(v)!==0);Zy(de,{get flavor(){return y(h)},get hidden(){return y(we)},get items(){return y(c)}})},oe=(de,we)=>{{var qe=me=>{vb(me,{get items(){return y(c)},onchange:te,children:(ke,Pe)=>{var Se=bb(),Me=P(Se);{var Te=_t=>{var Ct=mb();St(2),Q(_t,Ct)},lt=_t=>{var Ct=gb(),Dn=W(Ae(Ct),2);Dn.__click=()=>i.show(),Q(_t,Ct)};he(Me,_t=>{y(h)?_t(Te):_t(lt,!1)})}E(Se),Q(ke,Se)},$$slots:{default:!0}})},ot=(me,ke)=>{{var Pe=Me=>{gm(Me,{get items(){return y(g)},onchange:L,children:(Te,lt)=>{var _t=_b();Q(Te,_t)},$$slots:{default:!0}})},Se=(Me,Te)=>{{var lt=_t=>{sm(_t,{get items(){return y(_)},onchange:q})};he(Me,_t=>{y(v)===3&&_t(lt)},Te)}};he(me,Me=>{y(v)===2?Me(Pe):Me(Se,!1)},ke)}};he(de,me=>{y(v)===1?me(qe):me(ot,!1)},we)}};he(ee,de=>{y(v)===0?de(ie):de(oe,!1)})}var Re=W(ee,2);{var je=de=>{var we=wb();we.__click=x;var qe=P(we),ot=P(qe);De(ot,{height:"24",icon:"material-symbols:add",width:"24"}),E(qe),E(we),Q(de,we)};he(Re,de=>{y(h)&&de(je)})}E(G);var le=W(G,2);const B=fe(()=>y(l)&&y(l).tastes?y(l).tastes:null),Le=fe(()=>y(h)?y(h).id:null);st(im(le,{get count(){return y(a)},get items(){return y(B)},onchange:C,get selected(){return y(Le)}}),de=>i=de,()=>i);var Fe=W(le,2);const Ke=fe(()=>y(h)?y(h):null);st(ob(Fe,{get flavor(){return y(Ke)},onchange:V}),de=>r=de,()=>r);var Xe=W(Fe,2);st(Ky(Xe,{onchange:V}),de=>n=de,()=>n),Q(e,J),Ze()}it(["click"]);export{Mb as component};
